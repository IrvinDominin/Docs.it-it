---
uid: mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
title: Aggiunta di una vista (VB) | Documenti Microsoft
author: Rick-Anderson
description: In questa esercitazione verrà fornite le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, ovvero...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/12/2011
ms.topic: article
ms.assetid: d3633f64-5d3c-45c9-ae4b-cb1563e3739f
ms.technology: dotnet-mvc
ms.prod: .net-framework
msc.legacyurl: /mvc/overview/older-versions/getting-started-with-aspnet-mvc3/vb/adding-a-view
msc.type: authoredcontent
ms.openlocfilehash: c9675eb7776116ecbe910d5515abfe9b4391df22
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="adding-a-view-vb"></a><span data-ttu-id="cc0d8-103">Aggiunta di una vista (VB)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-103">Adding a View (VB)</span></span>
====================
<span data-ttu-id="cc0d8-104">da [Rick Anderson](https://github.com/Rick-Anderson)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-104">by [Rick Anderson](https://github.com/Rick-Anderson)</span></span>

> <span data-ttu-id="cc0d8-105">In questa esercitazione verrà fornite le nozioni di base della creazione di un'applicazione Web MVC ASP.NET utilizzando Microsoft Visual Web Developer 2010 Express Service Pack 1, che è una versione gratuita di Microsoft Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-105">This tutorial will teach you the basics of building an ASP.NET MVC Web application using Microsoft Visual Web Developer 2010 Express Service Pack 1, which is a free version of Microsoft Visual Studio.</span></span> <span data-ttu-id="cc0d8-106">Prima di iniziare, assicurarsi di che aver installato i prerequisiti elencati di seguito.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-106">Before you start, make sure you've installed the prerequisites listed below.</span></span> <span data-ttu-id="cc0d8-107">È possibile installare tutti gli elementi facendo clic sul seguente collegamento: [installazione guidata piattaforma Web](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-107">You can install all of them by clicking the following link: [Web Platform Installer](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack).</span></span> <span data-ttu-id="cc0d8-108">In alternativa, è possibile installare singolarmente i prerequisiti utilizzando i collegamenti seguenti:</span><span class="sxs-lookup"><span data-stu-id="cc0d8-108">Alternatively, you can individually install the prerequisites using the following links:</span></span>
> 
> - [<span data-ttu-id="cc0d8-109">Prerequisiti di Visual Studio Web Developer Express SP1</span><span class="sxs-lookup"><span data-stu-id="cc0d8-109">Visual Studio Web Developer Express SP1 prerequisites</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appid=VWD2010SP1Pack)
> - [<span data-ttu-id="cc0d8-110">ASP.NET MVC 3 Tools Update</span><span class="sxs-lookup"><span data-stu-id="cc0d8-110">ASP.NET MVC 3 Tools Update</span></span>](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=MVC3)
> - <span data-ttu-id="cc0d8-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(supportano runtime + tools)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-111">[SQL Server Compact 4.0](https://www.microsoft.com/web/gallery/install.aspx?appid=SQLCE;SQLCEVSTools_4_0)(runtime + tools support)</span></span>
> 
> <span data-ttu-id="cc0d8-112">Se si utilizza Visual Studio 2010 anziché Visual Web Developer 2010, installare i prerequisiti, fare clic sul seguente collegamento: [prerequisiti di Visual Studio 2010](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-112">If you're using Visual Studio 2010 instead of Visual Web Developer 2010, install the prerequisites by clicking the following link: [Visual Studio 2010 prerequisites](https://www.microsoft.com/web/gallery/install.aspx?appsxml=&amp;appid=VS2010SP1Pack).</span></span>
> 
> <span data-ttu-id="cc0d8-113">Un progetto di Visual Web Developer con codice sorgente VB.NET complemento è disponibile in questo argomento.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-113">A Visual Web Developer project with VB.NET source code is available to accompany this topic.</span></span> <span data-ttu-id="cc0d8-114">[Scaricare la versione di Visual Basic.NET](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-114">[Download the VB.NET version](https://code.msdn.microsoft.com/Introduction-to-MVC-3-10d1b098).</span></span> <span data-ttu-id="cc0d8-115">Se si preferisce c#, passare il [c# versione](../cs/adding-a-view.md) di questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-115">If you prefer C#, switch to the [C# version](../cs/adding-a-view.md) of this tutorial.</span></span>


<span data-ttu-id="cc0d8-116">In questa sezione si intende modificare il `HelloWorldController` incapsulare di classe per utilizzare un file di modello di visualizzazione per correttamente il processo di generazione di risposte HTML a un client.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-116">In this section we're going to modify the `HelloWorldController` class to use a view template file to cleanly encapsulate the process of generating HTML responses to a client.</span></span>

<span data-ttu-id="cc0d8-117">Iniziamo con un modello di visualizzazione con il `Index` metodo la `HelloWorldController` classe.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-117">Let's start by using a view template with the `Index` method in the `HelloWorldController` class.</span></span> <span data-ttu-id="cc0d8-118">Attualmente il `Index` metodo restituisce una stringa con un messaggio a livello di codice all'interno della classe controller.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-118">Currently the `Index` method returns a string with a message that is hard-coded within the controller class.</span></span> <span data-ttu-id="cc0d8-119">Modifica il `Index` per restituire un `View` dell'oggetto, come illustrato nell'esempio seguente:</span><span class="sxs-lookup"><span data-stu-id="cc0d8-119">Change the `Index` method to return a `View` object, as shown in the following:</span></span>

[!code-vb[Main](adding-a-view/samples/sample1.vb)]

<span data-ttu-id="cc0d8-120">Aggiungere ora un modello di visualizzazione per il progetto che è possibile richiamare con il `Index` metodo.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-120">Let's now add a view template to our project that we can invoke with the `Index` method.</span></span> <span data-ttu-id="cc0d8-121">A tale scopo, fare doppio clic all'interno di `Index` (metodo) e fare clic su **Aggiungi visualizzazione**.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-121">To do this, right-click inside the `Index` method and click **Add View**.</span></span>

<span data-ttu-id="cc0d8-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-122">[![IndexAddView](adding-a-view/_static/image2.png "IndexAddView")](adding-a-view/_static/image1.png)</span></span>

<span data-ttu-id="cc0d8-123">Il **Aggiungi visualizzazione** viene visualizzata la finestra di dialogo.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-123">The **Add View** dialog box appears.</span></span> <span data-ttu-id="cc0d8-124">Lasciare le voci predefinite, quindi scegliere il **Aggiungi** pulsante.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-124">Leave the default entries and click the **Add** button.</span></span>

<span data-ttu-id="cc0d8-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-125">[![3addView](adding-a-view/_static/image4.png "3addView")](adding-a-view/_static/image3.png)</span></span>

<span data-ttu-id="cc0d8-126">Il *MvcMovie\Views\HelloWorld* cartella e *MvcMovie\Views\HelloWorld\Index.vbhtml* vengono creati i file.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-126">The *MvcMovie\Views\HelloWorld* folder and the *MvcMovie\Views\HelloWorld\Index.vbhtml* file are created.</span></span> <span data-ttu-id="cc0d8-127">È possibile visualizzarli in **Esplora**:</span><span class="sxs-lookup"><span data-stu-id="cc0d8-127">You can see them in **Solution Explorer**:</span></span>

<span data-ttu-id="cc0d8-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-128">[![SolnExpHelloWorldIndx](adding-a-view/_static/image6.png "SolnExpHelloWorldIndx")](adding-a-view/_static/image5.png)</span></span>

<span data-ttu-id="cc0d8-129">Aggiungere il codice HTML con il `<h2>` tag.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-129">Add some HTML under the `<h2>` tag.</span></span> <span data-ttu-id="cc0d8-130">Modificato *MvcMovie\Views\HelloWorld\Index.vbhtml* file è illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-130">The modified *MvcMovie\Views\HelloWorld\Index.vbhtml* file is shown below.</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample2.vbhtml)]

<span data-ttu-id="cc0d8-131">Eseguire l'applicazione e individuare il &quot;HelloWorld&quot; controller (`http://localhost:xxxx/HelloWorld`).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-131">Run the application and browse to the &quot;hello world&quot; controller (`http://localhost:xxxx/HelloWorld`).</span></span> <span data-ttu-id="cc0d8-132">Il `Index` metodo nel controller di non eseguire la quantità di lavoro, sufficiente eseguita l'istruzione `return View()`, per indicare che si desidera utilizzare un file di modello di visualizzazione per il rendering di una risposta al client.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-132">The `Index` method in your controller didn't do much work; it simply ran the statement `return View()`, which indicated that we wanted to use a view template file to render a response to the client.</span></span> <span data-ttu-id="cc0d8-133">Perché non è stato specificato il nome del file modello di visualizzazione da utilizzare in modo esplicito, ASP.NET MVC impostato sul valore predefinito utilizzando il *Index.vbhtml* Visualizza file all'interno di *\Views\HelloWorld* cartella.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-133">Because we did not explicitly specify the name of the view template file to use, ASP.NET MVC defaulted to using the *Index.vbhtml* view file within the *\Views\HelloWorld* folder.</span></span> <span data-ttu-id="cc0d8-134">L'immagine seguente mostra la stringa hardcoded nella vista.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-134">The image below shows the string hard-coded in the view.</span></span>

<span data-ttu-id="cc0d8-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-135">[![3HelloWorld](adding-a-view/_static/image8.png "3HelloWorld")](adding-a-view/_static/image7.png)</span></span>

<span data-ttu-id="cc0d8-136">È buona.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-136">Looks pretty good.</span></span> <span data-ttu-id="cc0d8-137">Si noti tuttavia che barra del titolo del browser indica &quot;indice&quot; e il titolo della pagina big afferma &quot;applicazione MVC.&quot; È necessario modificare quelle.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-137">However, notice that the browser's title bar says &quot;Index&quot; and the big title on the page says &quot;My MVC Application.&quot; Let's change those.</span></span>

## <a name="changing-views-and-layout-pages"></a><span data-ttu-id="cc0d8-138">Modifica delle viste e delle pagine di layout</span><span class="sxs-lookup"><span data-stu-id="cc0d8-138">Changing views and layout pages</span></span>

<span data-ttu-id="cc0d8-139">In primo luogo, modificare il testo &quot;applicazione MVC.&quot; Tale testo è condivisa e verrà visualizzato in ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-139">First, let's change the text &quot;My MVC Application.&quot; That text is shared and appears on every page.</span></span> <span data-ttu-id="cc0d8-140">In realtà solo in una posizione nel progetto, anche se è presente in ogni pagina nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-140">It actually appears in only one place in our project, even though it's on every page in our application.</span></span> <span data-ttu-id="cc0d8-141">Passare al */visualizzazioni/Shared* cartella **Esplora** e aprire il  *\_Layout.vbhtml* file.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-141">Go to the */Views/Shared* folder in **Solution Explorer** and open the *\_Layout.vbhtml* file.</span></span> <span data-ttu-id="cc0d8-142">Questo file è denominato a una pagina di layout ed è condiviso &quot;shell&quot; che utilizzano tutte le altre pagine.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-142">This file is called a layout page and it's the shared &quot;shell&quot; that all other pages use.</span></span>

<span data-ttu-id="cc0d8-143">Si noti il `@RenderBody()` riga di codice nella parte inferiore del file.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-143">Note the `@RenderBody()` line of code near the bottom of the file.</span></span> <span data-ttu-id="cc0d8-144">`RenderBody` è un segnaposto in cui tutte le pagine create visualizzati &quot;incapsulati&quot; nella pagina di layout.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-144">`RenderBody` is a placeholder where all the pages you create show up, &quot;wrapped&quot; in the layout page.</span></span> <span data-ttu-id="cc0d8-145">Modifica il `<h1>` intestazione da **&quot;** applicazione MVC personale&quot; a &quot;App cinematografica MVC&quot;.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-145">Change the `<h1>` heading from **&quot;** My MVC Application&quot; to &quot;MVC Movie App&quot;.</span></span>

[!code-html[Main](adding-a-view/samples/sample3.html)]

<span data-ttu-id="cc0d8-146">Eseguire l'applicazione e si noti ora è indicato &quot;App cinematografica MVC&quot;.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-146">Run the application and note it now says &quot;MVC Movie App&quot;.</span></span> <span data-ttu-id="cc0d8-147">Fare clic su di **su** collegamento e tale pagina vengono visualizzati &quot;App cinematografica MVC&quot;anche.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-147">Click the **About** link, and that page shows &quot;MVC Movie App&quot;, too.</span></span>

<span data-ttu-id="cc0d8-148">L'intero  *\_Layout.vbhtml* file è illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="cc0d8-148">The complete *\_Layout.vbhtml* file is shown below:</span></span>

[!code-cshtml[Main](adding-a-view/samples/sample4.cshtml)]

<span data-ttu-id="cc0d8-149">A questo punto, è necessario modificare il titolo della pagina di indice (visualizzazione).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-149">Now, let's change the title of the Index page (view).</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample5.vbhtml)]

<span data-ttu-id="cc0d8-150">Aprire *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-150">Open *MvcMovie\Views\HelloWorld\Index.vbhtml*.</span></span> <span data-ttu-id="cc0d8-151">Esistono due posizioni di apportare una modifica: in primo luogo, il testo che viene visualizzato nel titolo del browser, quindi nell'intestazione secondaria (la `<h2>` elemento).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-151">There are two places to make a change: first, the text that appears in the title of the browser, and then in the secondary header (the `<h2>` element).</span></span> <span data-ttu-id="cc0d8-152">Ci accerteremo li leggermente diversa in modo da visualizzare il frammento di codice modifica la parte dell'app.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-152">We'll make them slightly different so you can see which bit of code changes which part of the app.</span></span>

<span data-ttu-id="cc0d8-153">Eseguire l'applicazione e passare a`http://localhost:xx/HelloWorld`.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-153">Run the application and browse to`http://localhost:xx/HelloWorld`.</span></span> <span data-ttu-id="cc0d8-154">Si noti che il titolo del browser, l'intestazione primaria e le intestazioni secondarie sono cambiati.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-154">Notice that the browser title, the primary heading, and the secondary headings have changed.</span></span> <span data-ttu-id="cc0d8-155">È facile apportare modifiche nell'applicazione con piccole modifiche a una visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-155">It's easy to make big changes in your application with small changes to a view.</span></span> <span data-ttu-id="cc0d8-156">Se le modifiche non sono visibili nel browser, è possibile che si stia visualizzando il contenuto memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-156">(If you don't see changes in the browser, you might be viewing cached content.</span></span> <span data-ttu-id="cc0d8-157">Premere CTRL + F5 nel browser per forzare il caricamento della risposta dal server.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-157">Press Ctrl+F5 in your browser to force the response from the server to be loaded.)</span></span>

<span data-ttu-id="cc0d8-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-158">[![3_MyMovieList](adding-a-view/_static/image10.png "3_MyMovieList")](adding-a-view/_static/image9.png)</span></span>

<span data-ttu-id="cc0d8-159">Il numero minimo di &quot;dati&quot; (in questo caso il &quot;Hello World!&quot; messaggio) è hardcoded, tuttavia.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-159">Our little bit of &quot;data&quot; (in this case the &quot;Hello World!&quot; message) is hard-coded, though.</span></span> <span data-ttu-id="cc0d8-160">L'applicazione MVC è V (views) e abbiamo C (controller), ma ancora Nessun M (modello).</span><span class="sxs-lookup"><span data-stu-id="cc0d8-160">Our MVC application has V (views) and we've got C (controllers), but no M (model) yet.</span></span> <span data-ttu-id="cc0d8-161">Più avanti, verranno esaminati come creare un database e recuperare i dati del modello.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-161">Shortly, we'll walk through how create a database and retrieve model data from it.</span></span>

## <a name="passing-data-from-the-controller-to-the-view"></a><span data-ttu-id="cc0d8-162">Passaggio di dati dal controller alla vista</span><span class="sxs-lookup"><span data-stu-id="cc0d8-162">Passing Data from the Controller to the View</span></span>

<span data-ttu-id="cc0d8-163">Prima di passare a un database e descrivere i modelli, tuttavia, esaminiamo innanzitutto il passaggio di informazioni a una visualizzazione dal Controller.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-163">Before we go to a database and talk about models, though, let's first talk about passing information from the Controller to a View.</span></span> <span data-ttu-id="cc0d8-164">Si desidera passare le richieste per eseguire il rendering di una risposta HTML a un client da un modello di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-164">We want to pass what a view template requires in order to render an HTML response to a client.</span></span> <span data-ttu-id="cc0d8-165">Questi oggetti vengono in genere creati e passati da una classe controller per un modello di visualizzazione e devono contenere solo i dati che richiede il modello di visualizzazione, ovvero non maggiori.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-165">These objects are typically created and passed by a controller class to a view template, and they should contain only the data that the view template requires — and no more.</span></span>

<span data-ttu-id="cc0d8-166">In precedenza con il `HelloWorldController` (classe), il `Welcome` metodo di azione ha avuto un `name` e un `numTimes` parametro e quindi restituire i valori dei parametri per il browser.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-166">Previously with the `HelloWorldController` class, the `Welcome` action method took a `name` and a `numTimes` parameter and then output the parameter values to the browser.</span></span> <span data-ttu-id="cc0d8-167">Invece dispone di controller di continuare a eseguire il rendering la risposta direttamente, verrà invece è verrà inclusa che i dati in un contenitore per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-167">Rather than have the controller continue to render this response directly, let's instead we'll put that data in a bag for the View.</span></span> <span data-ttu-id="cc0d8-168">Controller e visualizzazioni è possono utilizzare un `ViewBag` oggetto che contenga i dati.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-168">Controllers and Views can use a `ViewBag` object to hold that data.</span></span> <span data-ttu-id="cc0d8-169">Che verranno trasmesse automaticamente un modello di visualizzazione ed usato per il rendering nella risposta HTML utilizzando il contenuto del contenitore come dati.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-169">That will be passed over to a view template automatically, and used to render the HTML response using the contents of the bag as data.</span></span> <span data-ttu-id="cc0d8-170">In questo modo è interessato il controller con un aspetto e il modello di visualizzazione con un altro, consentono di mantenere pulita &quot;separazione delle problematiche&quot; all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-170">That way the controller is concerned with one thing and the view template with another — enabling us to maintain clean &quot;separation of concerns&quot; within the application.</span></span>

<span data-ttu-id="cc0d8-171">In alternativa, è Impossibile definire una classe personalizzata, quindi creare un'istanza dell'oggetto nel nostro, inserirvi dati e passare alla visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-171">Alternatively, we could define a custom class, then create an instance of that object on our own, fill it with data and pass it to the View.</span></span> <span data-ttu-id="cc0d8-172">Che viene chiamato un ViewModel, spesso perché è un modello personalizzato per la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-172">That is often called a ViewModel, because it's a custom Model for the View.</span></span> <span data-ttu-id="cc0d8-173">Per piccole quantità di dati, tuttavia, ViewBag è efficace.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-173">For small amounts of data, however, the ViewBag works great.</span></span>

<span data-ttu-id="cc0d8-174">Restituito per il *HelloWorldController.vb* una modifica ai file di `Welcome` metodo all'interno di un controller di inserire il messaggio e NumTimes in ViewBag.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-174">Return to the *HelloWorldController.vb* file change the `Welcome` method inside the controller to put the Message and NumTimes into the ViewBag.</span></span> <span data-ttu-id="cc0d8-175">ViewBag è un oggetto dinamico.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-175">The ViewBag is a dynamic object.</span></span> <span data-ttu-id="cc0d8-176">Ciò significa che è possibile inserire elementi desiderati a esso.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-176">That means you can put whatever you want in to it.</span></span> <span data-ttu-id="cc0d8-177">ViewBag dispone di alcuna proprietà definito fino a quando non si inserisce un elemento all'interno.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-177">The ViewBag has no defined properties until you put something inside it.</span></span>

<span data-ttu-id="cc0d8-178">L'intero `HelloWorldController.vb` con la nuova classe nello stesso file.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-178">The complete `HelloWorldController.vb` with the new class in the same file.</span></span>

[!code-vb[Main](adding-a-view/samples/sample6.vb)]

<span data-ttu-id="cc0d8-179">Il nostro ViewBag contiene dati che verranno passati la vista automaticamente.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-179">Now our ViewBag contains data that will be passed over to the View automatically.</span></span> <span data-ttu-id="cc0d8-180">Nuovamente, in alternativa è possibile superati in un oggetto simile al seguente se è stato apprezzato:</span><span class="sxs-lookup"><span data-stu-id="cc0d8-180">Again, alternatively we could have passed in our own object like this if we liked:</span></span>

[!code-csharp[Main](adding-a-view/samples/sample7.cs)]

<span data-ttu-id="cc0d8-181">Ora è necessario un `WelcomeView` modello!</span><span class="sxs-lookup"><span data-stu-id="cc0d8-181">Now we need a `WelcomeView` template!</span></span> <span data-ttu-id="cc0d8-182">Eseguire l'applicazione in modo il nuovo codice viene compilato.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-182">Run the application so the new code is compiled.</span></span> <span data-ttu-id="cc0d8-183">Chiudere il browser, fare doppio clic all'interno di `Welcome` (metodo) e quindi fare clic su **Aggiungi visualizzazione**.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-183">Close the browser, right-click inside the `Welcome` method, and then click **Add View**.</span></span>

<span data-ttu-id="cc0d8-184">Ecco il **Aggiungi visualizzazione** la finestra di dialogo è simile.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-184">Here's what your **Add View** dialog box looks like.</span></span>

<span data-ttu-id="cc0d8-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-185">[![3AddWelcomeView](adding-a-view/_static/image12.png "3AddWelcomeView")](adding-a-view/_static/image11.png)</span></span>

<span data-ttu-id="cc0d8-186">Aggiungere il codice seguente sotto il `<h2>` elemento nel nuovo <em>iniziale.</em> file vbhtml.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-186">Add the following code under the `<h2>` element in the new <em>Welcome.</em>vbhtml file.</span></span> <span data-ttu-id="cc0d8-187">Verrà verificare un ciclo e pronunciare &quot;Hello&quot; le volte che l'utente indicato si deve!</span><span class="sxs-lookup"><span data-stu-id="cc0d8-187">We'll make a loop and say &quot;Hello&quot; as many times as the user says we should!</span></span>

[!code-vbhtml[Main](adding-a-view/samples/sample8.vbhtml)]

<span data-ttu-id="cc0d8-188">Eseguire l'applicazione e passare a `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span><span class="sxs-lookup"><span data-stu-id="cc0d8-188">Run the application and browse to `http://localhost:xx/HelloWorld/Welcome?name=Scott&numtimes=4`</span></span>

<span data-ttu-id="cc0d8-189">A questo punto dati viene portati dall'URL e passati automaticamente al controller.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-189">Now data is taken from the URL and passed to the controller automatically.</span></span> <span data-ttu-id="cc0d8-190">Il controller di pacchetti di dati in un `Model` oggetto e passa tale oggetto nella vista.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-190">The controller packages up the data into a `Model` object and passes that object to the view.</span></span> <span data-ttu-id="cc0d8-191">La vista che consente di visualizzare i dati in formato HTML per l'utente.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-191">The view than displays the data as HTML to the user.</span></span>

<span data-ttu-id="cc0d8-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-192">[![3Hello_Scott_4](adding-a-view/_static/image14.png "3Hello_Scott_4")](adding-a-view/_static/image13.png)</span></span>

<span data-ttu-id="cc0d8-193">Che è un tipo di un &quot;M&quot; per modello, ma non il tipo di database.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-193">Well, that was a kind of an &quot;M&quot; for model, but not the database kind.</span></span> <span data-ttu-id="cc0d8-194">Creare un database di film con i concetti appresi.</span><span class="sxs-lookup"><span data-stu-id="cc0d8-194">Let's take what we've learned and create a database of movies.</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="cc0d8-195">[Precedente](adding-a-controller.md)
> [Successivo](adding-a-model.md)</span><span class="sxs-lookup"><span data-stu-id="cc0d8-195">[Previous](adding-a-controller.md)
[Next](adding-a-model.md)</span></span>

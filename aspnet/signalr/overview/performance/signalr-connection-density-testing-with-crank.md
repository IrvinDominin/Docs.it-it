---
uid: signalr/overview/performance/signalr-connection-density-testing-with-crank
title: Densità di connessione SignalR test con Crank | Documenti Microsoft
author: tfitzmac
description: Densità di connessione SignalR test con perno
ms.author: aspnetcontent
manager: wpickett
ms.date: 02/22/2015
ms.topic: article
ms.assetid: 148d9ca7-1af1-44b6-a9fb-91e261b9b463
ms.technology: dotnet-signalr
ms.prod: .net-framework
msc.legacyurl: /signalr/overview/performance/signalr-connection-density-testing-with-crank
msc.type: authoredcontent
ms.openlocfilehash: a3e8fdb47bd80d819358f9c48cd82fd51d6c0400
ms.sourcegitcommit: fe880bf4ed1c8116071c0e47c0babf3623b7f44a
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 11/21/2017
ms.locfileid: "26535330"
---
<a name="signalr-connection-density-testing-with-crank"></a><span data-ttu-id="980e9-103">Densità di connessione SignalR test con perno</span><span class="sxs-lookup"><span data-stu-id="980e9-103">SignalR Connection Density Testing with Crank</span></span>
====================
<span data-ttu-id="980e9-104">da [Tom FitzMacken](https://github.com/tfitzmac)</span><span class="sxs-lookup"><span data-stu-id="980e9-104">by [Tom FitzMacken](https://github.com/tfitzmac)</span></span>

> <span data-ttu-id="980e9-105">In questo articolo viene descritto come utilizzare lo strumento Crank per testare un'applicazione con più client simulato.</span><span class="sxs-lookup"><span data-stu-id="980e9-105">This article describes how to use the Crank tool to test an application with multiple simulated clients.</span></span>


<span data-ttu-id="980e9-106">Quando l'applicazione è in esecuzione nel proprio ambiente di hosting (entrambi Azure un ruolo, IIS, web o in modo indipendente tramite Owin), è possibile testare la risposta dell'applicazione a un elevato livello di densità di connessione mediante lo strumento perno.</span><span class="sxs-lookup"><span data-stu-id="980e9-106">Once your application is running in its hosting environment (either an Azure web role, IIS, or self-hosted using Owin), you can test application's response to a high level of connection density using the Crank tool.</span></span> <span data-ttu-id="980e9-107">L'ambiente di hosting può essere un server Internet Information Services (IIS), un host Owin o un ruolo web Azure.</span><span class="sxs-lookup"><span data-stu-id="980e9-107">The hosting environment can be an Internet Information Services (IIS) server, an Owin host, or an Azure web role.</span></span> <span data-ttu-id="980e9-108">(Nota: i contatori delle prestazioni non sono disponibili nelle App Web di servizio App di Azure, pertanto, non sarà in grado di ottenere dati sulle prestazioni da un test di densità di connessione.)</span><span class="sxs-lookup"><span data-stu-id="980e9-108">(Note: Performance counters are not available on Azure App Service Web Apps, so you will not be able to get performance data from a connection density test.)</span></span>

<span data-ttu-id="980e9-109">Densità di connessione si riferisce al numero di connessioni TCP simultanee che è possibile stabilire in un server.</span><span class="sxs-lookup"><span data-stu-id="980e9-109">Connection Density refers to the number of simultaneous TCP connections that can be established on a server.</span></span> <span data-ttu-id="980e9-110">Ogni connessione TCP comporta il proprio overhead e apertura di un numero elevato di connessioni inattive che consentono di creare un collo di bottiglia della memoria.</span><span class="sxs-lookup"><span data-stu-id="980e9-110">Each TCP connection incurs its own overhead, and opening a large number of idle connections will eventually create a memory bottleneck.</span></span>

<span data-ttu-id="980e9-111">[SignalR codebase](https://github.com/signalr/signalr) include uno strumento di test di carico denominato **Crank**.</span><span class="sxs-lookup"><span data-stu-id="980e9-111">[The SignalR codebase](https://github.com/signalr/signalr) includes a load-testing tool called **Crank**.</span></span> <span data-ttu-id="980e9-112">La versione più recente del perno è reperibile [del branch Dev](https://github.com/SignalR/signalr/tree/dev) su GitHub.</span><span class="sxs-lookup"><span data-stu-id="980e9-112">The latest version of Crank can be found in [the Dev branch](https://github.com/SignalR/signalr/tree/dev) on GitHub.</span></span> <span data-ttu-id="980e9-113">È possibile scaricare un file Zip codebase archivio del branch Dev di SignalR [qui](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="980e9-113">You can download a Zip archive of the Dev branch of the SignalR codebase [here](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span>

<span data-ttu-id="980e9-114">Crank può essere utilizzato per saturare completamente la memoria del server per calcolare il numero totale di connessioni inattive in hardware del server.</span><span class="sxs-lookup"><span data-stu-id="980e9-114">Crank may be used to fully saturate the server's memory in order to calculate the total number of idle connections possible on the server hardware.</span></span> <span data-ttu-id="980e9-115">In alternativa, è possibile anche utilizzare Crank per test di carico il server in una certa quantità di memoria, da aumentando connessioni fino a quando non viene raggiunto un numero specifico o una soglia di memoria specifici.</span><span class="sxs-lookup"><span data-stu-id="980e9-115">Alternatively, you may also use Crank to load test the server under a certain amount of memory pressure, by ramping up connections until a specific count or a specific memory threshold is reached.</span></span>

<span data-ttu-id="980e9-116">Durante il test, è importante utilizzare client remoto per evitare eventuali conflitti per le risorse (ad esempio, le connessioni TCP e memoria).</span><span class="sxs-lookup"><span data-stu-id="980e9-116">When testing, it is important to use remote client(s) to avoid any competition for resources (i.e., TCP connections and memory).</span></span> <span data-ttu-id="980e9-117">Monitorare i computer client per assicurarsi che non raggiunge eventuali colli di bottiglia che potrebbero impedire il server di raggiungere la capacità massima (memoria o CPU).</span><span class="sxs-lookup"><span data-stu-id="980e9-117">Monitor the client(s) to ensure that they are not hitting any bottlenecks that may prevent the server from reaching its full capacity (memory or CPU).</span></span> <span data-ttu-id="980e9-118">Si potrebbe essere necessario aumentare il numero di client per caricare completamente il server.</span><span class="sxs-lookup"><span data-stu-id="980e9-118">You may need to increase the number of clients in order to fully load the server.</span></span>

### <a name="running-a-connection-density-test"></a><span data-ttu-id="980e9-119">Esecuzione di un Test di densità di connessione</span><span class="sxs-lookup"><span data-stu-id="980e9-119">Running a Connection Density Test</span></span>

<span data-ttu-id="980e9-120">Questa sezione descrive i passaggi necessari per eseguire un test di densità di connessione in un'applicazione di SignalR.</span><span class="sxs-lookup"><span data-stu-id="980e9-120">This section describes the steps needed to run a connection density test on a SignalR application.</span></span>

1. <span data-ttu-id="980e9-121">Scaricare e compilare il [codebase branch Dev di SignalR](https://github.com/SignalR/SignalR/archive/dev.zip).</span><span class="sxs-lookup"><span data-stu-id="980e9-121">Download and build the [Dev branch of the SignalR codebase](https://github.com/SignalR/SignalR/archive/dev.zip).</span></span> <span data-ttu-id="980e9-122">In un prompt dei comandi, passare a &lt;directory progetto&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span><span class="sxs-lookup"><span data-stu-id="980e9-122">In a command prompt, navigate to &lt;project directory&gt;\src\Microsoft.AspNet.SignalR.Crank\bin\debug.</span></span>
2. <span data-ttu-id="980e9-123">Distribuire l'applicazione in ambiente di hosting di destinazione.</span><span class="sxs-lookup"><span data-stu-id="980e9-123">Deploy your application to its intended hosting environment.</span></span> <span data-ttu-id="980e9-124">Prendere nota dell'endpoint che l'applicazione utilizza; ad esempio, nell'applicazione creata nel [esercitazione introduttiva](../getting-started/tutorial-getting-started-with-signalr.md), l'endpoint è `http://<yourhost>:8080/signalr`.</span><span class="sxs-lookup"><span data-stu-id="980e9-124">Make a note of the endpoint that your application uses; for example, in the application created in the [Getting Started tutorial](../getting-started/tutorial-getting-started-with-signalr.md), the endpoint is `http://<yourhost>:8080/signalr`.</span></span>
3. <span data-ttu-id="980e9-125">Installare [i contatori delle prestazioni di SignalR](signalr-performance.md#perfcounters) sul server.</span><span class="sxs-lookup"><span data-stu-id="980e9-125">Install [SignalR performance counters](signalr-performance.md#perfcounters) on the server.</span></span> <span data-ttu-id="980e9-126">Se l'applicazione è in esecuzione in Azure, vedere [utilizzando SignalR i contatori delle prestazioni in un ruolo Web Azure](using-signalr-performance-counters-in-an-azure-web-role.md).</span><span class="sxs-lookup"><span data-stu-id="980e9-126">If your application is running on Azure, see [Using SignalR Performance Counters in an Azure Web Role](using-signalr-performance-counters-in-an-azure-web-role.md).</span></span>

<span data-ttu-id="980e9-127">Dopo avere scaricato e compilato la codebase e i contatori delle prestazioni sull'host sia installato, lo strumento da riga di comando Crank è reperibile nel `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` cartella.</span><span class="sxs-lookup"><span data-stu-id="980e9-127">Once you've downloaded and built the codebase, and installed performance counters on your host, the Crank command-line tool can be found in the `src\Microsoft.AspNet.SignalR.Crank\bin\Debug` folder.</span></span>

<span data-ttu-id="980e9-128">Le opzioni disponibili per lo strumento Crank includono:</span><span class="sxs-lookup"><span data-stu-id="980e9-128">Available options for the Crank tool include:</span></span>

- <span data-ttu-id="980e9-129">**/?** : Mostra la schermata di Guida.</span><span class="sxs-lookup"><span data-stu-id="980e9-129">**/?**: Shows the help screen.</span></span> <span data-ttu-id="980e9-130">Le opzioni disponibili vengono visualizzate anche se il **Url** parametro viene omesso.</span><span class="sxs-lookup"><span data-stu-id="980e9-130">The available options are also displayed if the **Url** parameter is omitted.</span></span>
- <span data-ttu-id="980e9-131">**/ Url**: l'URL per le connessioni SignalR.</span><span class="sxs-lookup"><span data-stu-id="980e9-131">**/Url**: The URL for SignalR connections.</span></span> <span data-ttu-id="980e9-132">Questo parametro è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="980e9-132">This parameter is required.</span></span> <span data-ttu-id="980e9-133">Per un'applicazione di SignalR mediante il mapping predefinito, il percorso termina "/ signalr".</span><span class="sxs-lookup"><span data-stu-id="980e9-133">For a SignalR application using the default mapping, the path will end in "/signalr".</span></span>
- <span data-ttu-id="980e9-134">**/ Trasporto**: il nome del trasporto utilizzato.</span><span class="sxs-lookup"><span data-stu-id="980e9-134">**/Transport**: The name of the transport used.</span></span> <span data-ttu-id="980e9-135">Il valore predefinito è `auto`, che verrà selezionato il protocollo ottimale.</span><span class="sxs-lookup"><span data-stu-id="980e9-135">The default is `auto`, which will select the best available protocol.</span></span> <span data-ttu-id="980e9-136">Le opzioni includono `WebSockets`, `ServerSentEvents`, e `LongPolling` (`ForeverFrame` non è un'opzione per Crank, poiché il client .NET anziché viene utilizzato Internet Explorer).</span><span class="sxs-lookup"><span data-stu-id="980e9-136">Options include `WebSockets`, `ServerSentEvents`, and `LongPolling` (`ForeverFrame` is not an option for Crank, since the .NET client rather than Internet Explorer is used).</span></span> <span data-ttu-id="980e9-137">Per ulteriori informazioni su come SignalR seleziona i trasporti, vedere [trasporti e fallback](../getting-started/introduction-to-signalr.md#transports).</span><span class="sxs-lookup"><span data-stu-id="980e9-137">For more information on how SignalR selects transports, see [Transports and Fallbacks](../getting-started/introduction-to-signalr.md#transports).</span></span>
- <span data-ttu-id="980e9-138">**/ BatchSize**: il numero di client aggiunti in ogni batch.</span><span class="sxs-lookup"><span data-stu-id="980e9-138">**/BatchSize**: The number of clients added in each batch.</span></span> <span data-ttu-id="980e9-139">Il valore predefinito è 50.</span><span class="sxs-lookup"><span data-stu-id="980e9-139">The default is 50.</span></span>
- <span data-ttu-id="980e9-140">**/ ConnectInterval**: l'intervallo in millisecondi tra l'aggiunta di connessioni.</span><span class="sxs-lookup"><span data-stu-id="980e9-140">**/ConnectInterval**: The interval in milliseconds between adding connections.</span></span> <span data-ttu-id="980e9-141">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="980e9-141">The default is 500.</span></span>
- <span data-ttu-id="980e9-142">**/ Connessioni connessioni**: il numero di connessioni utilizzato per l'applicazione di test di carico.</span><span class="sxs-lookup"><span data-stu-id="980e9-142">**/Connections**: The number of connections used to load-test the application.</span></span> <span data-ttu-id="980e9-143">Il valore predefinito è 100.000.</span><span class="sxs-lookup"><span data-stu-id="980e9-143">The default is 100,000.</span></span>
- <span data-ttu-id="980e9-144">**/ ConnectTimeout**: il timeout in secondi prima di interrompere il test.</span><span class="sxs-lookup"><span data-stu-id="980e9-144">**/ConnectTimeout**: The timeout in seconds before aborting the test.</span></span> <span data-ttu-id="980e9-145">Il valore predefinito è 300.</span><span class="sxs-lookup"><span data-stu-id="980e9-145">The default is 300.</span></span>
- <span data-ttu-id="980e9-146">**MinServerMBytes**: I megabyte minima per il server di raggiungere.</span><span class="sxs-lookup"><span data-stu-id="980e9-146">**MinServerMBytes**: The minimum server megabytes to reach.</span></span> <span data-ttu-id="980e9-147">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="980e9-147">The default is 500.</span></span>
- <span data-ttu-id="980e9-148">**SendBytes**: la dimensione del payload inviato al server in byte.</span><span class="sxs-lookup"><span data-stu-id="980e9-148">**SendBytes**: The size of the payload sent to the server in bytes.</span></span> <span data-ttu-id="980e9-149">Il valore predefinito è 0.</span><span class="sxs-lookup"><span data-stu-id="980e9-149">The default is 0.</span></span>
- <span data-ttu-id="980e9-150">**SendInterval**: il ritardo in millisecondi tra i messaggi al server.</span><span class="sxs-lookup"><span data-stu-id="980e9-150">**SendInterval**: The delay in milliseconds between messages to the server.</span></span> <span data-ttu-id="980e9-151">Il valore predefinito è 500.</span><span class="sxs-lookup"><span data-stu-id="980e9-151">The default is 500.</span></span>
- <span data-ttu-id="980e9-152">**SendTimeout**: il timeout in millisecondi per i messaggi al server.</span><span class="sxs-lookup"><span data-stu-id="980e9-152">**SendTimeout**: The timeout in milliseconds for messages to the server.</span></span> <span data-ttu-id="980e9-153">Il valore predefinito è 300.</span><span class="sxs-lookup"><span data-stu-id="980e9-153">The default is 300.</span></span>
- <span data-ttu-id="980e9-154">**ControllerUrl**: l'Url in cui un client ospita un controller hub.</span><span class="sxs-lookup"><span data-stu-id="980e9-154">**ControllerUrl**: The Url where one client will host a controller hub.</span></span> <span data-ttu-id="980e9-155">Il valore predefinito è null (Nessun hub controller).</span><span class="sxs-lookup"><span data-stu-id="980e9-155">The default is null (no controller hub).</span></span> <span data-ttu-id="980e9-156">L'hub controller viene avviato all'avvio della sessione di Crank; senza ulteriore tra l'hub di controller e Crank contatto.</span><span class="sxs-lookup"><span data-stu-id="980e9-156">The controller hub is started when the Crank session starts; no further contact between the controller hub and Crank is made.</span></span>
- <span data-ttu-id="980e9-157">**NumClients**: il numero di client simulato per connettersi all'applicazione.</span><span class="sxs-lookup"><span data-stu-id="980e9-157">**NumClients**: The number of simulated clients to connect to the application.</span></span> <span data-ttu-id="980e9-158">Il valore predefinito è uno.</span><span class="sxs-lookup"><span data-stu-id="980e9-158">The default is one.</span></span>
- <span data-ttu-id="980e9-159">**File di registro**: il nome del file per il file di registro per l'esecuzione dei test.</span><span class="sxs-lookup"><span data-stu-id="980e9-159">**Logfile**: The filename for the logfile for the test run.</span></span> <span data-ttu-id="980e9-160">Il valore predefinito è `crank.csv`.</span><span class="sxs-lookup"><span data-stu-id="980e9-160">The default is `crank.csv`.</span></span>
- <span data-ttu-id="980e9-161">**SampleInterval**: il tempo in millisecondi tra i campioni del contatore delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="980e9-161">**SampleInterval**: The time in milliseconds between performance counter samples.</span></span> <span data-ttu-id="980e9-162">Il valore predefinito è 1000.</span><span class="sxs-lookup"><span data-stu-id="980e9-162">The default is 1000.</span></span>
- <span data-ttu-id="980e9-163">**SignalRInstance**: il nome dell'istanza dei contatori delle prestazioni nel server.</span><span class="sxs-lookup"><span data-stu-id="980e9-163">**SignalRInstance**: The instance name for the performance counters on the server.</span></span> <span data-ttu-id="980e9-164">Il valore predefinito consiste nell'utilizzare lo stato della connessione client.</span><span class="sxs-lookup"><span data-stu-id="980e9-164">The default is to use the client connection state.</span></span>

### <a name="example"></a><span data-ttu-id="980e9-165">Esempio</span><span class="sxs-lookup"><span data-stu-id="980e9-165">Example</span></span>

<span data-ttu-id="980e9-166">Il comando seguente verrà testare un sito denominato `pfsignalr` in Azure che ospita un'applicazione sulla porta 8080 con un hub denominato "ControllerHub", utilizzando 100 connessioni.</span><span class="sxs-lookup"><span data-stu-id="980e9-166">The following command will test a site called `pfsignalr` on Azure that hosts an application on port 8080 with a hub named "ControllerHub", using 100 connections.</span></span>

`crank /Connections:100 /Url:http://pfsignalr.cloudapp.net:8080/signalr`

---
uid: web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
title: Distribuzione di database di appartenenza per ambienti aziendali | Documenti Microsoft
author: jrjlee
description: "In questo argomento illustra le considerazioni chiave e i problemi, che è necessario risolvere quando si esegue il provisioning di database di servizi dell'applicazione ASP.NET (più comuni..."
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/04/2012
ms.topic: article
ms.assetid: 3cf765df-d311-4f68-a295-c9685ceea830
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/deployment/advanced-enterprise-web-deployment/deploying-membership-databases-to-enterprise-environments
msc.type: authoredcontent
ms.openlocfilehash: 27fade9fc5cae917579d4963da7bca12f6a5cda1
ms.sourcegitcommit: 493a215355576cfa481773365de021bcf04bb9c7
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 03/15/2018
---
<a name="deploying-membership-databases-to-enterprise-environments"></a><span data-ttu-id="a4f77-103">Distribuzione di database di appartenenza per ambienti aziendali</span><span class="sxs-lookup"><span data-stu-id="a4f77-103">Deploying Membership Databases to Enterprise Environments</span></span>
====================
<span data-ttu-id="a4f77-104">da [Jason Lee](https://github.com/jrjlee)</span><span class="sxs-lookup"><span data-stu-id="a4f77-104">by [Jason Lee](https://github.com/jrjlee)</span></span>

[<span data-ttu-id="a4f77-105">Scarica il PDF</span><span class="sxs-lookup"><span data-stu-id="a4f77-105">Download PDF</span></span>](https://msdnshared.blob.core.windows.net/media/MSDNBlogsFS/prod.evol.blogs.msdn.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/63/56/8130.DeployingWebAppsInEnterpriseScenarios.pdf)

> <span data-ttu-id="a4f77-106">Questo argomento illustra le considerazioni chiave e i problemi, che è necessario risolvere per database (più comunemente indicati come database di appartenenza) in ambienti di test, gestione temporanea o produzione dei servizi per eseguire il provisioning dell'applicazione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="a4f77-106">This topic explains the key considerations and challenges you'll need to overcome when you provision ASP.NET application services databases (more commonly referred to as membership databases) in test, staging, or production environments.</span></span> <span data-ttu-id="a4f77-107">Vengono inoltre descritti gli approcci che consente di soddisfare questi requisiti.</span><span class="sxs-lookup"><span data-stu-id="a4f77-107">It also describes approaches you can use to meet these challenges.</span></span>


<span data-ttu-id="a4f77-108">In questo argomento fa parte di una serie di esercitazioni basate su requisiti di distribuzione dell'organizzazione di una società fittizia denominata Fabrikam, Inc. Questa serie di esercitazioni utilizza una soluzione di esempio & #x 2014; il [soluzione responsabile contatto](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)& #x 2014; per rappresentare un'applicazione web con un livello di complessità, tra cui un'applicazione ASP.NET MVC 3, Windows realistico Servizio di Communication Foundation (WCF) e un progetto di database.</span><span class="sxs-lookup"><span data-stu-id="a4f77-108">This topic forms part of a series of tutorials based around the enterprise deployment requirements of a fictional company named Fabrikam, Inc. This tutorial series uses a sample solution&#x2014;the [Contact Manager solution](../web-deployment-in-the-enterprise/the-contact-manager-solution.md)&#x2014;to represent a web application with a realistic level of complexity, including an ASP.NET MVC 3 application, a Windows Communication Foundation (WCF) service, and a database project.</span></span>

<span data-ttu-id="a4f77-109">Il metodo di distribuzione il fulcro di queste esercitazioni si basa sul progetto file split approccio descritto in [informazioni sui File di progetto](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in cui il processo di compilazione è controllato da due progetti #x 2014; & file contenente una compilare le istruzioni che si applicano a ogni ambiente di destinazione e quella contenente impostazioni specifiche dell'ambiente di compilazione e distribuzione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-109">The deployment method at the heart of these tutorials is based on the split project file approach described in [Understanding the Project File](../web-deployment-in-the-enterprise/understanding-the-project-file.md), in which the build process is controlled by two project files&#x2014;one containing build instructions that apply to every destination environment, and one containing environment-specific build and deployment settings.</span></span> <span data-ttu-id="a4f77-110">In fase di compilazione, il file di progetto specifici dell'ambiente viene unito nel file di progetto indipendenti dall'ambiente in modo da formare un set completo di istruzioni di compilazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-110">At build time, the environment-specific project file is merged into the environment-agnostic project file to form a complete set of build instructions.</span></span>

## <a name="what-are-the-issues-when-you-deploy-a-membership-database"></a><span data-ttu-id="a4f77-111">Quali sono i problemi quando si distribuisce un Database di appartenenza?</span><span class="sxs-lookup"><span data-stu-id="a4f77-111">What Are the Issues When You Deploy a Membership Database?</span></span>

<span data-ttu-id="a4f77-112">Nella maggior parte dei casi, quando si escogitare una strategia di distribuzione per un database, la prima cosa che è necessario prendere in considerazione è i dati che si desidera distribuire.</span><span class="sxs-lookup"><span data-stu-id="a4f77-112">In most cases, when you devise a deployment strategy for a database, the first thing you need to consider is what data you want to deploy.</span></span> <span data-ttu-id="a4f77-113">In un ambiente di sviluppo o test, si potrebbe essere necessario distribuire i dati dell'account utente per semplificare il test in modo rapido e semplice.</span><span class="sxs-lookup"><span data-stu-id="a4f77-113">In a development or test environment, you might want to deploy user account data to facilitate quick and easy testing.</span></span> <span data-ttu-id="a4f77-114">In un ambiente di produzione o gestione temporanea, è molto improbabile che si desidera distribuire i dati dell'account utente.</span><span class="sxs-lookup"><span data-stu-id="a4f77-114">In a staging or production environment, it's very unlikely that you'd want to deploy user account data.</span></span>

<span data-ttu-id="a4f77-115">Sfortunatamente, i database di appartenenza ASP.NET introducono alcune problematiche specifiche prendere tale decisione molto più complesse:</span><span class="sxs-lookup"><span data-stu-id="a4f77-115">Unfortunately, ASP.NET membership databases introduce some specific challenges that make this decision a lot more complex:</span></span>

- <span data-ttu-id="a4f77-116">Una distribuzione solo allo schema verrà lascia il database di appartenenza in uno stato non operativo.</span><span class="sxs-lookup"><span data-stu-id="a4f77-116">A schema-only deployment will leave the membership database in a non-operational state.</span></span> <span data-ttu-id="a4f77-117">Perché il database delle appartenenze include alcuni dati di configurazione (nel **aspnet\_SchemaVersions** tabella) che richiede il database per il funzionamento.</span><span class="sxs-lookup"><span data-stu-id="a4f77-117">This is because the membership database includes some configuration data (in the **aspnet\_SchemaVersions** table) that the database requires in order to function.</span></span> <span data-ttu-id="a4f77-118">Di conseguenza, se si esegue una distribuzione solo allo schema del database di appartenenza per escludere i dati dell'account utente, è necessario eseguire uno script di post-distribuzione per aggiungere i dati di configurazione essenziali.</span><span class="sxs-lookup"><span data-stu-id="a4f77-118">As such, if you perform a schema-only deployment of your membership database in order to exclude user account data, you'll need to run a post-deployment script to add the essential configuration data.</span></span>
- <span data-ttu-id="a4f77-119">A seconda della configurazione del database di appartenenza, il provider di appartenenze può utilizzare la chiave del computer per crittografare le password e di archiviarli nel database.</span><span class="sxs-lookup"><span data-stu-id="a4f77-119">Depending on how your membership database is configured, the membership provider may use the machine key to encrypt passwords and store them in the database.</span></span> <span data-ttu-id="a4f77-120">In questo caso, i dati di account utente da distribuire con il database diventerà inutilizzabili nel server di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-120">In this case, any user account data you deploy with the database will become unusable on the destination server.</span></span> <span data-ttu-id="a4f77-121">Per questo motivo, la distribuzione di dati dell'account utente non è uno scenario supportato.</span><span class="sxs-lookup"><span data-stu-id="a4f77-121">For this reason, deploying user account data is not a supported scenario.</span></span>

## <a name="choosing-a-membership-database-strategy"></a><span data-ttu-id="a4f77-122">Scelta di una strategia di Database di appartenenza</span><span class="sxs-lookup"><span data-stu-id="a4f77-122">Choosing a Membership Database Strategy</span></span>

<span data-ttu-id="a4f77-123">Utilizzare queste linee guida quando si sceglie come eseguire il provisioning di un database di appartenenza in un ambiente server aziendale:</span><span class="sxs-lookup"><span data-stu-id="a4f77-123">Use these guidelines when you choose how to provision a membership database in an enterprise server environment:</span></span>

- <span data-ttu-id="a4f77-124">Laddove possibile, non distribuire i database di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="a4f77-124">Wherever possible, do not deploy membership databases.</span></span> <span data-ttu-id="a4f77-125">In alternativa, creare manualmente i database delle appartenenze nel server di database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-125">Instead, create the membership database manually on the target database server.</span></span> <span data-ttu-id="a4f77-126">Se lo schema del database di appartenenza non è stato personalizzato, è possibile semplicemente creare una nuova in situ di destinazione utilizzando il [strumento di registrazione di SQL Server ASP.NET (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-126">If you haven't customized your membership database schema, you can simply create a new one in situ at the destination using the [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span>
- <span data-ttu-id="a4f77-127">Se non esiste nessuna opzione ma come distribuire un database delle appartenenze & #x 2014; ad esempio, se sono state apportate modifiche estese allo schema del database & #x 2014; eseguire una distribuzione solo allo schema del database delle appartenenze, per escludere i dati dell'account utente, e quindi eseguire uno script di post-distribuzione per aggiungere i dati di configurazione necessarie.</span><span class="sxs-lookup"><span data-stu-id="a4f77-127">If you have no option but to deploy a membership database&#x2014;for example, if you've made extensive modifications to the database schema&#x2014;you should perform a schema-only deployment of the membership database, to exclude user account data, and then run a post-deployment script to add any required configuration data.</span></span> <span data-ttu-id="a4f77-128">È possibile trovare indicazioni generali su questi approcci in [procedura: distribuire ASP.NET l'appartenenza al Database senza tra account utente](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-128">You can find broad guidance on these approaches in [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

<span data-ttu-id="a4f77-129">È importante ricordare che *lo schema del database di appartenenza è probabile che sia abbastanza statico*.</span><span class="sxs-lookup"><span data-stu-id="a4f77-129">It's important to remember that *the schema of your membership database is likely to be fairly static*.</span></span> <span data-ttu-id="a4f77-130">Anche se è stato personalizzato il database delle appartenenze, è improbabile che è necessario aggiornare lo schema in un regolarmente & #x 2014; non verrà modificato con la stessa frequenza come il codice in un'applicazione web o un progetto di database.</span><span class="sxs-lookup"><span data-stu-id="a4f77-130">Even if you've customized the membership database, it's unlikely that you'll need to update the schema on a regular basis&#x2014;it's not going to change with the same frequency as the code in a web application or a database project.</span></span> <span data-ttu-id="a4f77-131">Non deve di conseguenza, è necessario includere il database delle appartenenze in tutti i processi di distribuzione automatica o passo-passo.</span><span class="sxs-lookup"><span data-stu-id="a4f77-131">As such, you shouldn't need to include the membership database in any automated or single-step deployment processes.</span></span>

## <a name="using-vsdbcmd-to-update-a-membership-database-schema"></a><span data-ttu-id="a4f77-132">L'utilizzo di VSDBCMD per aggiornare uno Schema di Database di appartenenza</span><span class="sxs-lookup"><span data-stu-id="a4f77-132">Using VSDBCMD to Update a Membership Database Schema</span></span>

<span data-ttu-id="a4f77-133">Se si modifica la struttura del database di appartenenza dopo la distribuzione prima, si desidera utilizzare lo strumento di distribuzione Web di Internet Information Services (IIS) (distribuzione Web) per ridistribuire il database.</span><span class="sxs-lookup"><span data-stu-id="a4f77-133">If you modify the structure of your membership database after your first deployment, you may not want to use the Internet Information Services (IIS) Web Deployment Tool (Web Deploy) to redeploy the database.</span></span> <span data-ttu-id="a4f77-134">La funzionalità di distribuzione di database di distribuzione Web non include la possibilità di rendere gli aggiornamenti differenziali in un database di destinazione e #x 2014, invece, distribuzione Web è necessario eliminare e ricreare il database.</span><span class="sxs-lookup"><span data-stu-id="a4f77-134">The database deployment functionality in Web Deploy doesn't include the capability to make differential updates to a destination database&#x2014;instead, Web Deploy must drop and re-create the database.</span></span> <span data-ttu-id="a4f77-135">Ciò significa che si perdono i dati di account utente esistenti, che è in genere indesiderati in ambienti di produzione o gestione temporanea.</span><span class="sxs-lookup"><span data-stu-id="a4f77-135">This means that you lose any existing user account data, which is typically undesirable in staging or production environments.</span></span>

<span data-ttu-id="a4f77-136">L'alternativa consiste nell'utilizzare l'utilità VSDBCMD per aggiornare lo schema del database di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-136">The alternative is to use the VSDBCMD utility to update the schema of your destination database.</span></span> <span data-ttu-id="a4f77-137">VSDBCMD include due funzionalità importanti.</span><span class="sxs-lookup"><span data-stu-id="a4f77-137">VSDBCMD includes two important capabilities.</span></span> <span data-ttu-id="a4f77-138">In primo luogo, è possibile importare lo schema di un database esistente in un file. dbschema.</span><span class="sxs-lookup"><span data-stu-id="a4f77-138">First, it can import the schema of an existing database into a .dbschema file.</span></span> <span data-ttu-id="a4f77-139">In secondo luogo, è possibile distribuire un file con estensione dbschema a un database esistente come un aggiornamento differenziale, che significa che è solo le modifiche necessarie per portare il database di destinazione aggiornato e non perdere i dati.</span><span class="sxs-lookup"><span data-stu-id="a4f77-139">Second, it can deploy a .dbschema file to an existing database as a differential update, which means that it only makes the changes required to bring the target database up to date and you don't lose any data.</span></span>

<span data-ttu-id="a4f77-140">È possibile utilizzare questi passaggi per aggiornare uno schema di database di appartenenza:</span><span class="sxs-lookup"><span data-stu-id="a4f77-140">You can use these high-level steps to update a membership database schema:</span></span>

1. <span data-ttu-id="a4f77-141">Utilizzare lo strumento VSDBCMD **importazione** azione per generare un file con estensione dbschema per il database di appartenenza di origine.</span><span class="sxs-lookup"><span data-stu-id="a4f77-141">Use the VSDBCMD **Import** action to generate a .dbschema file for your source membership database.</span></span> <span data-ttu-id="a4f77-142">Questa procedura è descritta [procedura: importare uno Schema da un prompt dei comandi](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-142">This procedure is described in [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span>
2. <span data-ttu-id="a4f77-143">Utilizzare lo strumento VSDBCMD **Distribuisci** azione per distribuire il file con estensione dbschema nel database di appartenenza di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-143">Use the VSDBCMD **Deploy** action to deploy the .dbschema file to your destination membership database.</span></span> <span data-ttu-id="a4f77-144">Questa procedura è descritta [riferimento della riga di comando per VSDBCMD. EXE (distribuzione e importazione dello Schema)](https://msdn.microsoft.com/library/dd193283.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-144">This procedure is described in [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx).</span></span>

## <a name="conclusion"></a><span data-ttu-id="a4f77-145">Conclusione</span><span class="sxs-lookup"><span data-stu-id="a4f77-145">Conclusion</span></span>

<span data-ttu-id="a4f77-146">In questo argomento descritte alcune delle problematiche potrebbero verificarsi quando è necessario eseguire il provisioning di database di appartenenza ASP.NET in vari ambienti di destinazione.</span><span class="sxs-lookup"><span data-stu-id="a4f77-146">This topic described some of the challenges you may face when you need to provision ASP.NET membership databases in various target environments.</span></span> <span data-ttu-id="a4f77-147">In particolare, illustrato perché le distribuzioni di solo schema lascerà database delle appartenenze in uno stato non operativo e perché la distribuzione di dati dell'account utente non è supportata.</span><span class="sxs-lookup"><span data-stu-id="a4f77-147">In particular, it explained why schema-only deployments will leave the membership database in a non-operational state and why deploying user account data is not supported.</span></span> <span data-ttu-id="a4f77-148">L'articolo presenta anche informazioni aggiuntive su come eseguire il provisioning, distribuire e aggiornare i database di appartenenza in diversi scenari.</span><span class="sxs-lookup"><span data-stu-id="a4f77-148">The topic also presented guidance on how to provision, deploy, and update membership databases in different scenarios.</span></span>

## <a name="further-reading"></a><span data-ttu-id="a4f77-149">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="a4f77-149">Further Reading</span></span>

<span data-ttu-id="a4f77-150">Per ulteriori istruzioni ed esempi di come utilizzare VSDBCMD, vedere [riferimento della riga di comando per VSDBCMD. EXE (distribuzione e importazione dello Schema)](https://msdn.microsoft.com/library/dd193283.aspx) e [procedura: importare uno Schema da un prompt dei comandi](https://msdn.microsoft.com/library/dd172135.aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-150">For more guidance and examples of how to use VSDBCMD, see [Command-Line Reference for VSDBCMD.EXE (Deployment and Schema Import)](https://msdn.microsoft.com/library/dd193283.aspx) and [How to: Import a Schema from a Command Prompt](https://msdn.microsoft.com/library/dd172135.aspx).</span></span> <span data-ttu-id="a4f77-151">Per ulteriori informazioni sull'utilizzo aspnet\_regsql.exe per creare il database di appartenenza, vedere [strumento di registrazione di SQL Server ASP.NET (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-151">For more information on using aspnet\_regsql.exe to create membership databases, see [ASP.NET SQL Server Registration Tool (aspnet\_regsql.exe)](https://msdn.microsoft.com/library/ms229862(v=vs.100).aspx).</span></span> <span data-ttu-id="a4f77-152">Per istruzioni generali sulla distribuzione di database di appartenenza, vedere [procedura: distribuire ASP.NET l'appartenenza al Database senza tra account utente](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span><span class="sxs-lookup"><span data-stu-id="a4f77-152">For more general guidance on deploying membership databases, see [How to: Deploy the ASP.NET Membership Database Without Including User Accounts](https://msdn.microsoft.com/library/ff361972(v=vs.100).aspx).</span></span>

>[!div class="step-by-step"]
<span data-ttu-id="a4f77-153">[Precedente](deploying-database-role-memberships-to-test-environments.md)
[Successivo](excluding-files-and-folders-from-deployment.md)</span><span class="sxs-lookup"><span data-stu-id="a4f77-153">[Previous](deploying-database-role-memberships-to-test-environments.md)
[Next](excluding-files-and-folders-from-deployment.md)</span></span>

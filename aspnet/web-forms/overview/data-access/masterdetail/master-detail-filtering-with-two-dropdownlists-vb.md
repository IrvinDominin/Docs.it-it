---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
title: Master-Details filtri con due controlli DropDownList (VB) | Documenti Microsoft
author: rick-anderson
description: In questa esercitazione si espande la relazione master-Details per aggiungere un terzo livello, usando due controlli DropDownList per selezionare il recor padre e l'elemento padre del padre desiderato...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: 11ae4f64-01ba-4823-95f4-a2fe1f84f7d7
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-two-dropdownlists-vb
msc.type: authoredcontent
ms.openlocfilehash: ee0232cf8f7c0533703a51a4629522fd887f216f
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30887226"
---
<a name="masterdetail-filtering-with-two-dropdownlists-vb"></a><span data-ttu-id="2c5ff-103">Master-Details filtri con due controlli DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-103">Master/Detail Filtering With Two DropDownLists (VB)</span></span>
====================
<span data-ttu-id="2c5ff-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2c5ff-105">[Scaricare App di esempio](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) o [Scarica il PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_8_VB.exe) or [Download PDF](master-detail-filtering-with-two-dropdownlists-vb/_static/datatutorial08vb1.pdf)</span></span>

> <span data-ttu-id="2c5ff-106">In questa esercitazione si espande la relazione master-Details per aggiungere un terzo livello, usando due controlli DropDownList per selezionare i record padre e l'elemento padre del padre desiderati.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-106">This tutorial expands the master/detail relationship to add a third layer, using two DropDownList controls to select the desired parent and grandparent records.</span></span>


## <a name="introduction"></a><span data-ttu-id="2c5ff-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="2c5ff-107">Introduction</span></span>

<span data-ttu-id="2c5ff-108">Nel [esercitazione precedente](master-detail-filtering-with-a-dropdownlist-vb.md) abbiamo esaminato come visualizzare un report semplice master/dettagli mediante un unico DropDownList popolato con le categorie e un controllo GridView con i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-108">In the [previous tutorial](master-detail-filtering-with-a-dropdownlist-vb.md) we examined how to display a simple master/details report using a single DropDownList populated with the categories and a GridView showing those products that belong to the selected category.</span></span> <span data-ttu-id="2c5ff-109">Questo modello di report funziona bene quando la visualizzazione di record che includono una relazione uno-a-molti e può essere facilmente esteso per lavorare con gli scenari che includono più relazioni uno-a-molti.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-109">This report pattern works well when displaying records that have a one-to-many relationship and can easily be extended to work for scenarios that include multiple one-to-many relationships.</span></span> <span data-ttu-id="2c5ff-110">Ad esempio, un sistema di immissione ordini avrebbe le tabelle che corrispondono ai clienti, ordini e voci dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-110">For example, an order entry system would have tables that correspond to customers, orders, and order line items.</span></span> <span data-ttu-id="2c5ff-111">Un determinato cliente può disporre di più ordini con ogni ordine composta da più elementi.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-111">A given customer may have multiple orders with each order consisting of multiple items.</span></span> <span data-ttu-id="2c5ff-112">Tali dati possono essere presentati all'utente con due controlli DropDownList e un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-112">Such data can be presented to the user with two DropDownLists and a GridView.</span></span> <span data-ttu-id="2c5ff-113">Il primo DropDownList avrebbe una voce di elenco per ogni cliente nel database con il secondo il contenuto viene ordini effettuati dal cliente selezionato.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-113">The first DropDownList would have a list item for each customer in the database with the second one's contents being the orders placed by the selected customer.</span></span> <span data-ttu-id="2c5ff-114">Un controllo GridView verrà elencati gli elementi di riga dell'ordine selezionato.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-114">A GridView would list the line items from the selected order.</span></span>

<span data-ttu-id="2c5ff-115">Quando il database Northwind include informazioni cliente/ordine canonico nella relativa `Customers`, `Orders`, e `Order Details` , queste tabelle non vengono acquisite nell'architettura.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-115">While the Northwind database include the canonical customer/order/order details information in its `Customers`, `Orders`, and `Order Details` tables, these tables aren't captured in our architecture.</span></span> <span data-ttu-id="2c5ff-116">Ciononostante, è comunque possibile descrivere mediante due controlli DropDownList dipendenti.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-116">Nonetheless, we can still illustrate using two dependent DropDownLists.</span></span> <span data-ttu-id="2c5ff-117">Il primo DropDownList sono elencate le categorie e il secondo i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-117">The first DropDownList will list the categories and the second the products belonging to the selected category.</span></span> <span data-ttu-id="2c5ff-118">Un controllo DetailsView verranno quindi elencati i dettagli del prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-118">A DetailsView will then list the details of the selected product.</span></span>

## <a name="step-1-creating-and-populating-the-categories-dropdownlist"></a><span data-ttu-id="2c5ff-119">Passaggio 1: Creazione e popolamento DropDownList categorie</span><span class="sxs-lookup"><span data-stu-id="2c5ff-119">Step 1: Creating and Populating the Categories DropDownList</span></span>

<span data-ttu-id="2c5ff-120">Il primo obiettivo consiste nell'aggiungere DropDownList che elenca le categorie.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-120">Our first goal is to add the DropDownList that lists the categories.</span></span> <span data-ttu-id="2c5ff-121">Questi passaggi sono stati esaminati in dettaglio nell'esercitazione precedente, ma sono riepilogati di seguito per motivi di completezza.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-121">These steps were examined in detail in the preceding tutorial, but are summarized here for completeness.</span></span>

<span data-ttu-id="2c5ff-122">Aprire il `MasterDetailsDetails.aspx` nella pagina il `Filtering` cartella, aggiungere un controllo DropDownList alla pagina, imposta il relativo `ID` proprietà `Categories`e fare clic sul collegamento Configura origine dati in smart tag.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-122">Open the `MasterDetailsDetails.aspx` page in the `Filtering` folder, add a DropDownList to the page, set its `ID` property to `Categories`, and then click the Configure Data Source link in its smart tag.</span></span> <span data-ttu-id="2c5ff-123">Scegliere la configurazione guidata origine dati per aggiungere una nuova origine dati.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-123">From the Data Source Configuration Wizard choose to add a new data source.</span></span>


<span data-ttu-id="2c5ff-124">[![Aggiungere una nuova origine dati per DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-124">[![Add a New Data Source for the DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image2.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image1.png)</span></span>

<span data-ttu-id="2c5ff-125">**Figura 1**: aggiungere una nuova origine dati per DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-125">**Figure 1**: Add a New Data Source for the DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image3.png))</span></span>


<span data-ttu-id="2c5ff-126">La nuova origine dati, naturalmente, dovrebbe essere ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-126">The new data source should, naturally, be an ObjectDataSource.</span></span> <span data-ttu-id="2c5ff-127">Nome nuovo ObjectDataSource `CategoriesDataSource` e richiamare il `CategoriesBLL` dell'oggetto `GetCategories()` metodo.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-127">Name this new ObjectDataSource `CategoriesDataSource` and have it invoke the `CategoriesBLL` object's `GetCategories()` method.</span></span>


<span data-ttu-id="2c5ff-128">[![Scegliere di utilizzare la classe CategoriesBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image5.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image4.png)</span></span>

<span data-ttu-id="2c5ff-129">**Figura 2**: scegliere di utilizzare il `CategoriesBLL` classe ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-129">**Figure 2**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image6.png))</span></span>


<span data-ttu-id="2c5ff-130">[![Configurare ObjectDataSource per utilizzare il metodo GetCategories()](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image8.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image7.png)</span></span>

<span data-ttu-id="2c5ff-131">**Figura 3**: configurare ObjectDataSource per utilizzare il `GetCategories()` metodo ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-131">**Figure 3**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image9.png))</span></span>


<span data-ttu-id="2c5ff-132">Dopo aver configurato il ObjectDataSource è comunque necessario specificare quale campo dell'origine dati deve essere visualizzato nel `Categories` DropDownList e quale deve essere configurato come il valore della voce di elenco.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-132">After configuring the ObjectDataSource we still need to specify which data source field should be displayed in the `Categories` DropDownList and which one should be configured as the value for the list item.</span></span> <span data-ttu-id="2c5ff-133">Impostare il `CategoryName` campo come la visualizzazione e `CategoryID` come valore per ogni elemento nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-133">Set the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="2c5ff-134">[![Avere la visualizzazione DropDownList campo CategoryName e CategoryID utilizzare come valore](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-two-dropdownlists-vb/_static/image11.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image10.png)</span></span>

<span data-ttu-id="2c5ff-135">**Figura 4**: la visualizzazione DropDownList il `CategoryName` campo e utilizzare `CategoryID` come valore ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-135">**Figure 4**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image12.png))</span></span>


<span data-ttu-id="2c5ff-136">A questo punto si dispone di un controllo DropDownList (`Categories`) che viene popolata con i record di `Categories` tabella.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-136">At this point we have a DropDownList control (`Categories`) that's populated with the records from the `Categories` table.</span></span> <span data-ttu-id="2c5ff-137">Quando l'utente sceglie una nuova categoria da DropDownList è opportuno un postback per aggiornare il prodotto DropDownList che si intende creare nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-137">When the user chooses a new category from the DropDownList we'll want a postback to occur in order to refresh the product DropDownList that we're going to create in Step 2.</span></span> <span data-ttu-id="2c5ff-138">Pertanto, selezionare l'opzione di attivare un postback automatico dal `categories` smart tag del DropDownList.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-138">Therefore, check the Enable AutoPostBack option from the `categories` DropDownList's smart tag.</span></span>


<span data-ttu-id="2c5ff-139">[![Abilitare un postback automatico per DropDownList categorie](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-139">[![Enable AutoPostBack for the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image14.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image13.png)</span></span>

<span data-ttu-id="2c5ff-140">**Figura 5**: abilitare un postback automatico per il `Categories` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-140">**Figure 5**: Enable AutoPostBack for the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image15.png))</span></span>


## <a name="step-2-displaying-the-selected-categorys-products-in-a-second-dropdownlist"></a><span data-ttu-id="2c5ff-141">Passaggio 2: Visualizzazione dei prodotti della categoria selezionata in un secondo DropDownList</span><span class="sxs-lookup"><span data-stu-id="2c5ff-141">Step 2: Displaying the Selected Category's Products in a Second DropDownList</span></span>

<span data-ttu-id="2c5ff-142">Con il `Categories` DropDownList completato, il passaggio successivo consiste nella visualizzazione di un controllo DropDownList dei prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-142">With the `Categories` DropDownList completed, our next step is to display a DropDownList of products belonging to the selected category.</span></span> <span data-ttu-id="2c5ff-143">A tale scopo, aggiungere un altro DropDownList denominato `ProductsByCategory`.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-143">To accomplish this, add another DropDownList to the page named `ProductsByCategory`.</span></span> <span data-ttu-id="2c5ff-144">Come con la `Categories` DropDownList, creare un nuovo oggetto ObjectDataSource per la `ProductsByCategory` DropDownList denominato `ProductsByCategoryDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-144">As with the `Categories` DropDownList, create a new ObjectDataSource for the `ProductsByCategory` DropDownList named `ProductsByCategoryDataSource`.</span></span>


<span data-ttu-id="2c5ff-145">[![Aggiungere una nuova origine dati per ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-145">[![Add a New Data Source for the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image17.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image16.png)</span></span>

<span data-ttu-id="2c5ff-146">**Figura 6**: aggiungere una nuova origine dati per il `ProductsByCategory` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-146">**Figure 6**: Add a New Data Source for the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image18.png))</span></span>


<span data-ttu-id="2c5ff-147">[![Creare un nuovo oggetto ObjectDataSource denominato ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-147">[![Create a New ObjectDataSource Named ProductsByCategoryDataSource](master-detail-filtering-with-two-dropdownlists-vb/_static/image20.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image19.png)</span></span>

<span data-ttu-id="2c5ff-148">**Figura 7**: creare un nuovo denominato ObjectDataSource `ProductsByCategoryDataSource` ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-148">**Figure 7**: Create a New ObjectDataSource Named `ProductsByCategoryDataSource` ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image21.png))</span></span>


<span data-ttu-id="2c5ff-149">Poiché il `ProductsByCategory` DropDownList esigenze per visualizzare solo i prodotti appartenenti alla categoria selezionata, avere ObjectDataSource richiama il `GetProductsByCategoryID(categoryID)` metodo il `ProductsBLL` oggetto.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-149">Since the `ProductsByCategory` DropDownList needs to display just those products belonging to the selected category, have the ObjectDataSource invoke the `GetProductsByCategoryID(categoryID)` method from the `ProductsBLL` object.</span></span>


<span data-ttu-id="2c5ff-150">[![Scegliere di utilizzare la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-150">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image23.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image22.png)</span></span>

<span data-ttu-id="2c5ff-151">**Figura 8**: scegliere di utilizzare il `ProductsBLL` classe ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-151">**Figure 8**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image24.png))</span></span>


<span data-ttu-id="2c5ff-152">[![Configurare ObjectDataSource per utilizzare il metodo GetProductsByCategoryID(categoryID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-152">[![Configure the ObjectDataSource to Use the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image26.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image25.png)</span></span>

<span data-ttu-id="2c5ff-153">**Figura 9**: configurare ObjectDataSource per utilizzare il `GetProductsByCategoryID(categoryID)` metodo ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-153">**Figure 9**: Configure the ObjectDataSource to Use the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image27.png))</span></span>


<span data-ttu-id="2c5ff-154">Nel passaggio finale della procedura guidata è necessario specificare il valore di *`categoryID`* parametro.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-154">In the final step of the wizard we need to specify the value of the *`categoryID`* parameter.</span></span> <span data-ttu-id="2c5ff-155">Assegnare questo parametro per l'elemento selezionato dal `Categories` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-155">Assign this parameter to the selected item from the `Categories` DropDownList.</span></span>


<span data-ttu-id="2c5ff-156">[![Effettuare il pull categoryID valore del parametro da DropDownList categorie](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-156">[![Pull the categoryID Parameter Value from the Categories DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image29.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image28.png)</span></span>

<span data-ttu-id="2c5ff-157">**Figura 10**: effettuare il Pull di *`categoryID`* valore del parametro dal `Categories` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-157">**Figure 10**: Pull the *`categoryID`* Parameter Value from the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image30.png))</span></span>


<span data-ttu-id="2c5ff-158">Con ObjectDataSource configurato, è comunque per specificare quali campi dell'origine dati vengono utilizzate per la visualizzazione e il valore degli elementi del DropDownList.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-158">With the ObjectDataSource configured, all that remains is to specify what data source fields are used for the display and value of the DropDownList's items.</span></span> <span data-ttu-id="2c5ff-159">Visualizzazione di `ProductName` campo e utilizzare il `ProductID` campo come valore.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-159">Display the `ProductName` field and use the `ProductID` field as the value.</span></span>


<span data-ttu-id="2c5ff-160">[![Specificare i campi di origine dati utilizzati per oggetti ListItem del DropDownList testo e le proprietà di valore](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-160">[![Specify the Data Source Fields Used for the DropDownList's ListItems' Text and Value Properties](master-detail-filtering-with-two-dropdownlists-vb/_static/image32.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image31.png)</span></span>

<span data-ttu-id="2c5ff-161">**Figura 11**: specificare campi di origine dati utilizzata per il controllo DropDownList `ListItem` s' `Text` e `Value` delle proprietà ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-161">**Figure 11**: Specify the Data Source Fields Used for the DropDownList's `ListItem` s' `Text` and `Value` Properties ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image33.png))</span></span>


<span data-ttu-id="2c5ff-162">Con ObjectDataSource e `ProductsByCategory` DropDownList configurato nostra pagina verranno visualizzati due controlli DropDownList: il primo elencherà tutte le categorie mentre il secondo verrà elencati i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-162">With the ObjectDataSource and `ProductsByCategory` DropDownList configured our page will display two DropDownLists: the first will list all of the categories while the second will list those products belonging to the selected category.</span></span> <span data-ttu-id="2c5ff-163">Quando l'utente seleziona una nuova categoria dal primo DropDownList, verrà insorgere un postback e verrà riassociati DropDownList secondo, con i prodotti che appartengono alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-163">When the user selects a new category from the first DropDownList, a postback will ensue and the second DropDownList will be rebound, showing those products that belong to the newly selected category.</span></span> <span data-ttu-id="2c5ff-164">Figure 12 e 13 mostra `MasterDetailsDetails.aspx` nell'azione quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-164">Figures 12 and 13 show `MasterDetailsDetails.aspx` in action when viewed through a browser.</span></span>


<span data-ttu-id="2c5ff-165">[![Durante la prima visita la pagina, della categoria Beverages è selezionata](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-165">[![When First Visiting the Page, the Beverages Category is Selected](master-detail-filtering-with-two-dropdownlists-vb/_static/image35.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image34.png)</span></span>

<span data-ttu-id="2c5ff-166">**Figura 12**: durante la prima visita la pagina, della categoria Beverages è selezionata ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-166">**Figure 12**: When First Visiting the Page, the Beverages Category is Selected ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image36.png))</span></span>


<span data-ttu-id="2c5ff-167">[![Scelta di una categoria diversi Visualizza di prodotti le nuove categorie](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-167">[![Choosing a Different Category Displays the New Category's Products](master-detail-filtering-with-two-dropdownlists-vb/_static/image38.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image37.png)</span></span>

<span data-ttu-id="2c5ff-168">**Figura 13**: scegliere di prodotti le nuove categorie diversi Visualizza categoria ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-168">**Figure 13**: Choosing a Different Category Displays the New Category's Products ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image39.png))</span></span>


<span data-ttu-id="2c5ff-169">Attualmente il `productsByCategory` DropDownList, quando vengono modificate, *non* provocato un postback.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-169">Currently the `productsByCategory` DropDownList, when changed, does *not* cause a postback.</span></span> <span data-ttu-id="2c5ff-170">È tuttavia, sarà necessario un postback al verificarsi di una volta che viene aggiunto un controllo DetailsView per visualizzare i dettagli del prodotto selezionato (passaggio 3).</span><span class="sxs-lookup"><span data-stu-id="2c5ff-170">However, we will want a postback to occur once we add a DetailsView to display the selected product's details (Step 3).</span></span> <span data-ttu-id="2c5ff-171">Di conseguenza, verificare la casella di controllo Abilita un postback automatico di `productsByCategory` smart tag del DropDownList.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-171">Therefore, check the Enable AutoPostBack checkbox from the `productsByCategory` DropDownList's smart tag.</span></span>


<span data-ttu-id="2c5ff-172">[![Abilitare la funzionalità di un postback automatico per productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-172">[![Enable the AutoPostBack Feature for the productsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image41.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image40.png)</span></span>

<span data-ttu-id="2c5ff-173">**Figura 14**: abilitare la funzionalità di un postback automatico per il `productsByCategory` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-173">**Figure 14**: Enable the AutoPostBack Feature for the `productsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image42.png))</span></span>


## <a name="step-3-using-a-detailsview-to-display-details-for-the-selected-product"></a><span data-ttu-id="2c5ff-174">Passaggio 3: Utilizzo di un controllo DetailsView per visualizzare i dettagli per il prodotto selezionato</span><span class="sxs-lookup"><span data-stu-id="2c5ff-174">Step 3: Using a DetailsView to Display Details for the Selected Product</span></span>

<span data-ttu-id="2c5ff-175">Il passaggio finale consiste per visualizzare i dettagli per il prodotto selezionato in un controllo DetailsView.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-175">The final step is to display the details for the selected product in a DetailsView.</span></span> <span data-ttu-id="2c5ff-176">A tale scopo, aggiungere un controllo DetailsView alla pagina, impostare il relativo `ID` proprietà `ProductDetails`e creare un nuovo oggetto ObjectDataSource per essa.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-176">To accomplish this, add a DetailsView to the page, set its `ID` property to `ProductDetails`, and create a new ObjectDataSource for it.</span></span> <span data-ttu-id="2c5ff-177">Configurare ObjectDataSource per estrarre i dati di `ProductsBLL` della classe `GetProductByProductID(productID)` metodo usando il valore selezionato del `ProductsByCategory` DropDownList per il valore del *`productID`* parametro.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-177">Configure this ObjectDataSource to pull its data from the `ProductsBLL` class's `GetProductByProductID(productID)` method using the selected value of the `ProductsByCategory` DropDownList for the value of the *`productID`* parameter.</span></span>


<span data-ttu-id="2c5ff-178">[![Scegliere di utilizzare la classe ProductsBLL](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-178">[![Choose to Use the ProductsBLL Class](master-detail-filtering-with-two-dropdownlists-vb/_static/image44.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image43.png)</span></span>

<span data-ttu-id="2c5ff-179">**Figura 15**: scegliere di utilizzare il `ProductsBLL` classe ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-179">**Figure 15**: Choose to Use the `ProductsBLL` Class ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image45.png))</span></span>


<span data-ttu-id="2c5ff-180">[![Configurare ObjectDataSource per utilizzare il metodo GetProductByProductID(productID)](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-180">[![Configure the ObjectDataSource to Use the GetProductByProductID(productID) Method](master-detail-filtering-with-two-dropdownlists-vb/_static/image47.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image46.png)</span></span>

<span data-ttu-id="2c5ff-181">**Figura 16**: configurare ObjectDataSource per utilizzare il `GetProductByProductID(productID)` metodo ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-181">**Figure 16**: Configure the ObjectDataSource to Use the `GetProductByProductID(productID)` Method ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image48.png))</span></span>


<span data-ttu-id="2c5ff-182">[![Effettuare il pull productID valore del parametro da ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-182">[![Pull the productID Parameter Value from the ProductsByCategory DropDownList](master-detail-filtering-with-two-dropdownlists-vb/_static/image50.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image49.png)</span></span>

<span data-ttu-id="2c5ff-183">**Figura 17**: effettuare il Pull di *`productID`* valore del parametro dal `ProductsByCategory` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-183">**Figure 17**: Pull the *`productID`* Parameter Value from the `ProductsByCategory` DropDownList ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image51.png))</span></span>


<span data-ttu-id="2c5ff-184">È possibile scegliere di visualizzare uno qualsiasi dei campi disponibili il `ProductDetails` DetailsView.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-184">You can choose to display any of the available fields in the `ProductDetails` DetailsView.</span></span> <span data-ttu-id="2c5ff-185">È stato scelto di rimuovere il `ProductID`, `SupplierID`, e `CategoryID` campi e riordinare e formattati i campi rimanenti.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-185">I've opted to remove the `ProductID`, `SupplierID`, and `CategoryID` fields and reordered and formatted the remaining fields.</span></span> <span data-ttu-id="2c5ff-186">Inoltre, sono deselezionate out di DetailsView `Height` e `Width` proprietà, consentendo di DetailsView espandere la larghezza necessari per una visualizzazione ottimale dei dati anziché è vincolata alle dimensioni specificate.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-186">In addition, I cleared out the DetailsView's `Height` and `Width` properties, allowing the DetailsView to expand to the width needed to best display its data rather than having it constrained to a specified size.</span></span> <span data-ttu-id="2c5ff-187">Il markup completo viene visualizzato di seguito:</span><span class="sxs-lookup"><span data-stu-id="2c5ff-187">The full markup appears below:</span></span>


[!code-aspx[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample1.aspx)]

<span data-ttu-id="2c5ff-188">È opportuno provare il `MasterDetailsDetails.aspx` pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-188">Take a moment to try out the `MasterDetailsDetails.aspx` page in a browser.</span></span> <span data-ttu-id="2c5ff-189">A prima vista potrebbe sembrare che funzionino nel modo desiderato, ma si verifica un problema complesso.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-189">At first glance it may appear that everything is working as desired, but there's a subtle problem.</span></span> <span data-ttu-id="2c5ff-190">Quando si sceglie una nuova categoria di `ProductsByCategory` DropDownList viene aggiornata per includere i prodotti per la categoria selezionata, ma la `ProductDetails` DetailsView continua a visualizzare le informazioni sul prodotto precedente.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-190">When you choose a new category the `ProductsByCategory` DropDownList is updated to include those products for the selected category, but the `ProductDetails` DetailsView continued to show the previous product information.</span></span> <span data-ttu-id="2c5ff-191">DetailsView viene aggiornata quando si sceglie un prodotto diverso per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-191">The DetailsView is updated when choosing a different product for the selected category.</span></span> <span data-ttu-id="2c5ff-192">Inoltre, se si prova sufficientemente attentamente, si noterà che se si sceglie continuamente nuove categorie (optando bevande dal `Categories` DropDownList quindi condimenti, quindi dolciumi) ogni altra selezione della categoria comporta il `ProductDetails`DetailsView da aggiornare.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-192">Furthermore, if you test thoroughly enough, you'll find that if you continually choose new categories (such as choosing Beverages from the `Categories` DropDownList, then Condiments, then Confections) every other category selection causes the `ProductDetails` DetailsView to be refreshed.</span></span>

<span data-ttu-id="2c5ff-193">Per facilitare la concretizzare la questo problema, esaminiamo un esempio specifico.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-193">To help concretize this problem, let's look at a specific example.</span></span> <span data-ttu-id="2c5ff-194">Quando si visita prima la pagina è selezionata la categoria delle bevande e i prodotti correlati vengono caricati nel `ProductsByCategory` DropDownList.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-194">When you first visit the page the Beverages category is selected and the related products are loaded in the `ProductsByCategory` DropDownList.</span></span> <span data-ttu-id="2c5ff-195">Chai è il prodotto selezionato e cui vengono visualizzati i dettagli di `ProductDetails` DetailsView, come illustrato nella figura 18.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-195">Chai is the selected product and its details are displayed in the `ProductDetails` DetailsView, as shown in Figure 18.</span></span>


<span data-ttu-id="2c5ff-196">[![I dettagli del prodotto selezionato vengono visualizzati in un controllo DetailsView.](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-196">[![The Selected Product's Details are Displayed in a DetailsView](master-detail-filtering-with-two-dropdownlists-vb/_static/image53.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image52.png)</span></span>

<span data-ttu-id="2c5ff-197">**Figura 18**: dettagli del prodotto selezionato il vengono visualizzati in un controllo DetailsView ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-197">**Figure 18**: The Selected Product's Details are Displayed in a DetailsView ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image54.png))</span></span>


<span data-ttu-id="2c5ff-198">Se si modifica la selezione della categoria da bevande a condimenti, si verifica un postback e `ProductsByCategory` DropDownList viene aggiornato di conseguenza, ma controllo DetailsView vengono ancora visualizzati i dettagli per Chai.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-198">If you change the category selection from Beverages to Condiments, a postback occurs and the `ProductsByCategory` DropDownList is updated accordingly, but the DetailsView still displays details for Chai.</span></span>


<span data-ttu-id="2c5ff-199">[![Dettagli precedentemente selezionata del prodotto sono ancora visualizzati](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-199">[![The Previously Selected Product's Details are Still Displayed](master-detail-filtering-with-two-dropdownlists-vb/_static/image56.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image55.png)</span></span>

<span data-ttu-id="2c5ff-200">**Figura 19**: dettagli del prodotto selezionata precedentemente il sono ancora visualizzati ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-200">**Figure 19**: The Previously Selected Product's Details are Still Displayed ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image57.png))</span></span>


<span data-ttu-id="2c5ff-201">Selezione di un nuovo prodotto nell'elenco Aggiorna DetailsView come previsto.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-201">Picking a new product from the list refreshes the DetailsView as expected.</span></span> <span data-ttu-id="2c5ff-202">Se si seleziona una categoria di nuovo dopo aver modificato il prodotto, non aggiorna il controllo DetailsView nuovamente.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-202">If you pick a new category after changing the product, the DetailsView again won't refresh.</span></span> <span data-ttu-id="2c5ff-203">Tuttavia, se invece un nuovo prodotto è stata selezionata una nuova categoria, è necessario riavviare DetailsView.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-203">However, if instead of choosing a new product you selected a new category, the DetailsView would refresh.</span></span> <span data-ttu-id="2c5ff-204">Nel mondo andamento qui?</span><span class="sxs-lookup"><span data-stu-id="2c5ff-204">What in the world is going on here?</span></span>

<span data-ttu-id="2c5ff-205">Il problema è un problema di temporizzazione nel ciclo di vita della pagina.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-205">The problem is a timing issue in the page's lifecycle.</span></span> <span data-ttu-id="2c5ff-206">Ogni volta che viene richiesta una pagina che procede attraverso una serie di operazioni come il rendering.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-206">Whenever a page is requested it proceeds through a number of steps as its rendering.</span></span> <span data-ttu-id="2c5ff-207">In uno di questi passaggi ObjectDataSource controlla per verificare se uno dei relativi `SelectParameters` valori sono stati modificati.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-207">In one of these steps the ObjectDataSource controls check to see if any of their `SelectParameters` values have changed.</span></span> <span data-ttu-id="2c5ff-208">Se in tal caso, il controllo Web di dati associato a ObjectDataSource sa che è necessario aggiornare la visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-208">If so, the data Web control bound to the ObjectDataSource knows that it needs to refresh its display.</span></span> <span data-ttu-id="2c5ff-209">Ad esempio, quando è selezionata una nuova categoria, il `ProductsByCategoryDataSource` ObjectDataSource rileva che i valori di parametro sono stati modificati e `ProductsByCategory` DropDownList riassocia, ottenere i prodotti per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-209">For example, when a new category is selected, the `ProductsByCategoryDataSource` ObjectDataSource detects that its parameter values have changed and the `ProductsByCategory` DropDownList rebinds itself, getting the products for the selected category.</span></span>

<span data-ttu-id="2c5ff-210">Il problema che si manifesta in questa situazione è che si verifica il punto di vita che consentono di controllare il ObjectDataSources per i parametri modificati *prima* la riassociazione dei controlli Web di dati associati.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-210">The problem that arises in this situation is that the point in the page lifecycle that the ObjectDataSources check for changed parameters occurs *before* the rebinding of the associated data Web controls.</span></span> <span data-ttu-id="2c5ff-211">Pertanto, quando si seleziona una nuova categoria di `ProductsByCategoryDataSource` ObjectDataSource rileva una modifica nel valore del relativo parametro.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-211">Therefore, when selecting a new category the `ProductsByCategoryDataSource` ObjectDataSource detects a change in its parameter's value.</span></span> <span data-ttu-id="2c5ff-212">Utilizzato da ObjectDataSource il `ProductDetails` DetailsView, tuttavia, non nota tali modifiche poiché il `ProductsByCategory` DropDownList deve ancora essere riassociati.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-212">The ObjectDataSource used by the `ProductDetails` DetailsView, however, doesn't note any such changes because the `ProductsByCategory` DropDownList has yet to be rebound.</span></span> <span data-ttu-id="2c5ff-213">Più avanti nel ciclo di vita di `ProductsByCategory` DropDownList riassocia di ObjectDataSource cattura i prodotti per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-213">Later in the lifecycle the `ProductsByCategory` DropDownList rebinds to its ObjectDataSource, grabbing the products for the newly selected category.</span></span> <span data-ttu-id="2c5ff-214">Mentre il `ProductsByCategory` valore del DropDownList è stata modificata, il `ProductDetails` DetailsView ObjectDataSource ha già eseguito il controllo del valore del parametro; di conseguenza, il controllo DetailsView visualizza i risultati precedenti.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-214">While the `ProductsByCategory` DropDownList's value has changed, the `ProductDetails` DetailsView's ObjectDataSource has already done its parameter value check; therefore, the DetailsView displays its previous results.</span></span> <span data-ttu-id="2c5ff-215">Questa interazione viene rappresentata nella figura 20.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-215">This interaction is depicted in Figure 20.</span></span>


<span data-ttu-id="2c5ff-216">[![Il valore ProductsByCategory DropDownList cambia dopo ObjectDataSource di ProductDetails DetailsView verifica la presenza di modifiche](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-216">[![The ProductsByCategory DropDownList Value Changes After the ProductDetails DetailsView's ObjectDataSource Checks for Changes](master-detail-filtering-with-two-dropdownlists-vb/_static/image59.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image58.png)</span></span>

<span data-ttu-id="2c5ff-217">**Figura 20**: il `ProductsByCategory` DropDownList valore modifiche dopo il `ProductDetails` ObjectDataSource verifica DetailsView la presenza di modifiche ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-217">**Figure 20**: The `ProductsByCategory` DropDownList Value Changes After the `ProductDetails` DetailsView's ObjectDataSource Checks for Changes ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image60.png))</span></span>


<span data-ttu-id="2c5ff-218">Per risolvere questo è necessario riassociare in modo esplicito il `ProductDetails` DetailsView dopo il `ProductsByCategory` DropDownList è stato associato.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-218">To remedy this we need to explicitly rebind the `ProductDetails` DetailsView after the `ProductsByCategory` DropDownList has been bound.</span></span> <span data-ttu-id="2c5ff-219">A questo scopo, è possibile chiamare il `ProductDetails` DetailsView `DataBind()` metodo quando il `ProductsByCategory` del DropDownList `DataBound` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-219">We can accomplish this by calling the `ProductDetails` DetailsView's `DataBind()` method when the `ProductsByCategory` DropDownList's `DataBound` event fires.</span></span> <span data-ttu-id="2c5ff-220">Aggiungere il seguente codice del gestore eventi per il `MasterDetailsDetails.aspx` classe code-behind della pagina (vedere il "[a livello di codice impostando i valori dei parametri di ObjectDataSource](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" per una discussione su come aggiungere un gestore eventi):</span><span class="sxs-lookup"><span data-stu-id="2c5ff-220">Add the following event handler code to the `MasterDetailsDetails.aspx` page's code-behind class (refer to the "[Programmatically Setting the ObjectDataSource's Parameter Values](../basic-reporting/programmatically-setting-the-objectdatasource-s-parameter-values-cs.md)" for a discussion on how to add an event handler):</span></span>


[!code-vb[Main](master-detail-filtering-with-two-dropdownlists-vb/samples/sample2.vb)]

<span data-ttu-id="2c5ff-221">Dopo questa chiamata esplicita al `ProductDetails` DetailsView `DataBind()` metodo è stato aggiunto, l'esercitazione funziona come previsto.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-221">After this explicit call to the `ProductDetails` DetailsView's `DataBind()` method has been added, the tutorial works as expected.</span></span> <span data-ttu-id="2c5ff-222">Figura 21 evidenzia come modificare questo risolto il problema precedente.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-222">Figure 21 highlights how this changed remedied our earlier problem.</span></span>


<span data-ttu-id="2c5ff-223">[![ProductDetails DetailsView è attivazione dell'esplicitamente aggiornati quando il ProductsByCategory DropDownList dell'evento associato a dati](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-223">[![The ProductDetails DetailsView is Explicitly Refreshed When the ProductsByCategory DropDownList's DataBound Event Fires](master-detail-filtering-with-two-dropdownlists-vb/_static/image62.png)](master-detail-filtering-with-two-dropdownlists-vb/_static/image61.png)</span></span>

<span data-ttu-id="2c5ff-224">**Figura 21**: il `ProductDetails` DetailsView è in modo esplicito aggiornati quando il `ProductsByCategory` del DropDownList `DataBound` attivazione dell'evento ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span><span class="sxs-lookup"><span data-stu-id="2c5ff-224">**Figure 21**: The `ProductDetails` DetailsView is Explicitly Refreshed When the `ProductsByCategory` DropDownList's `DataBound` Event Fires ([Click to view full-size image](master-detail-filtering-with-two-dropdownlists-vb/_static/image63.png))</span></span>


## <a name="summary"></a><span data-ttu-id="2c5ff-225">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="2c5ff-225">Summary</span></span>

<span data-ttu-id="2c5ff-226">DropDownList funge da un elemento dell'interfaccia utente ideale per i report master/dettaglio in cui vi sia una relazione uno-a-molti tra i record master e di dettaglio.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-226">The DropDownList serves as an ideal user interface element for master/detail reports where there is a one-to-many relationship between the master and detail records.</span></span> <span data-ttu-id="2c5ff-227">Nell'esercitazione precedente è stato illustrato come usare un singolo DropDownList per filtrare i prodotti visualizzati in base alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-227">In the preceding tutorial we saw how to use a single DropDownList to filter the products displayed by the selected category.</span></span> <span data-ttu-id="2c5ff-228">In questa esercitazione è sostituito GridView dei prodotti con un controllo DropDownList e usato un controllo DetailsView per visualizzare i dettagli del prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-228">In this tutorial we replaced the GridView of products with a DropDownList, and used a DetailsView to display the details of the selected product.</span></span> <span data-ttu-id="2c5ff-229">I concetti illustrati in questa esercitazione possono essere esteso facilmente ai modelli di dati che coinvolgono più relazioni uno-a-molti, ad esempio clienti, ordini e ordinare gli articoli.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-229">The concepts discussed in this tutorial can easily be extended to data models involving multiple one-to-many relationships, such as customers, orders, and order items.</span></span> <span data-ttu-id="2c5ff-230">In generale, è sempre possibile aggiungere un controllo DropDownList per ognuna delle entità nelle relazioni uno-a-molti "uno".</span><span class="sxs-lookup"><span data-stu-id="2c5ff-230">In general, you can always add a DropDownList for each of the "one" entities in the one-to-many relationships.</span></span>

<span data-ttu-id="2c5ff-231">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="2c5ff-231">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2c5ff-232">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="2c5ff-232">About the Author</span></span>

<span data-ttu-id="2c5ff-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-233">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2c5ff-234">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-234">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2c5ff-235">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2c5ff-235">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2c5ff-236">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2c5ff-236">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2c5ff-237">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="2c5ff-237">Special Thanks To</span></span>

<span data-ttu-id="2c5ff-238">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-238">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2c5ff-239">Il revisore per questa esercitazione Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="2c5ff-239">Lead reviewer for this tutorial was Hilton Giesenow.</span></span> <span data-ttu-id="2c5ff-240">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="2c5ff-240">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2c5ff-241">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-241">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2c5ff-242">[Precedente](master-detail-filtering-with-a-dropdownlist-vb.md)
> [Successivo](master-detail-filtering-across-two-pages-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2c5ff-242">[Previous](master-detail-filtering-with-a-dropdownlist-vb.md)
[Next](master-detail-filtering-across-two-pages-vb.md)</span></span>

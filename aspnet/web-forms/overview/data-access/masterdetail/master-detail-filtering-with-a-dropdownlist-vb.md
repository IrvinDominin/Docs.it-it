---
uid: web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
title: Master-Details filtri con un controllo DropDownList (VB) | Documenti Microsoft
author: rick-anderson
description: In questa esercitazione vedremo come visualizzare i record master in un controllo DropDownList e i dettagli dell'elemento di elenco selezionato in un controllo GridView.
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/31/2010
ms.topic: article
ms.assetid: ea44717e-ab2e-46cd-a692-e4a9c0de194c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/masterdetail/master-detail-filtering-with-a-dropdownlist-vb
msc.type: authoredcontent
ms.openlocfilehash: 5d1ae660ddbc6c8e2874190ade6f3deddeebe820
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="masterdetail-filtering-with-a-dropdownlist-vb"></a><span data-ttu-id="17089-103">Master-Details filtri con un controllo DropDownList (VB)</span><span class="sxs-lookup"><span data-stu-id="17089-103">Master/Detail Filtering With a DropDownList (VB)</span></span>
====================
<span data-ttu-id="17089-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="17089-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="17089-105">[Scaricare App di esempio](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) o [Scarica il PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="17089-105">[Download Sample App](http://download.microsoft.com/download/5/d/7/5d7571fc-d0b7-4798-ad4a-c976c02363ce/ASPNET_Data_Tutorial_7_VB.exe) or [Download PDF](master-detail-filtering-with-a-dropdownlist-vb/_static/datatutorial07vb1.pdf)</span></span>

> <span data-ttu-id="17089-106">In questa esercitazione vedremo come visualizzare i record master in un controllo DropDownList e i dettagli dell'elemento di elenco selezionato in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="17089-106">In this tutorial we'll see how to display the master records in a DropDownList control and the details of the selected list item in a GridView.</span></span>


## <a name="introduction"></a><span data-ttu-id="17089-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="17089-107">Introduction</span></span>

<span data-ttu-id="17089-108">Un tipo comune di report è il *master-details report*, in cui inizia il report tramite la visualizzazione di un set di record "master".</span><span class="sxs-lookup"><span data-stu-id="17089-108">A common type of report is the *master/detail report*, in which the report begins by showing some set of "master" records.</span></span> <span data-ttu-id="17089-109">L'utente può quindi drill-down in uno dei record master, in tal modo la visualizzazione "i dettagli." del record master</span><span class="sxs-lookup"><span data-stu-id="17089-109">The user can then drill down into one of the master records, thereby viewing that master record's "details."</span></span> <span data-ttu-id="17089-110">Master-Details report è la scelta ideale per la visualizzazione delle relazioni uno-a-molti, ad esempio un report che mostra tutte le categorie e quindi consentire all'utente di selezionare una categoria specifica e visualizzare i prodotti associati.</span><span class="sxs-lookup"><span data-stu-id="17089-110">Master/detail reports are an ideal choice for visualizing one-to-many relationships, such as a report showing all of the categories and then allowing a user to select a particular category and display its associated products.</span></span> <span data-ttu-id="17089-111">Master-details report sono inoltre utili per la visualizzazione di informazioni dettagliate dalle tabelle particolarmente "wide" (quelli che dispone di numerose colonne).</span><span class="sxs-lookup"><span data-stu-id="17089-111">Additionally, master/detail reports are useful for displaying detailed information from particularly "wide" tables (ones that have a lot of columns).</span></span> <span data-ttu-id="17089-112">Ad esempio, il livello di un report master-details "master" potrebbe mostrare solo il prodotto nome e il prezzo unitario dei prodotti del database e il drill-down in un determinato prodotto permetterebbe di visualizzare i campi prodotto aggiuntive (categoria, fornitore, la quantità per unità, e così via).</span><span class="sxs-lookup"><span data-stu-id="17089-112">For example, the "master" level of a master/detail report might show just the product name and unit price of the products in the database, and drilling down into a particular product would show the additional product fields (category, supplier, quantity per unit, and so on).</span></span>

<span data-ttu-id="17089-113">Esistono molti modi con cui può essere implementata una relazione master-details.</span><span class="sxs-lookup"><span data-stu-id="17089-113">There are many ways with which a master/detail report can be implemented.</span></span> <span data-ttu-id="17089-114">In questa e le esercitazioni successive tre esamineremo una varietà di report master-details.</span><span class="sxs-lookup"><span data-stu-id="17089-114">Over this and the next three tutorials we'll look at a variety of master/detail reports.</span></span> <span data-ttu-id="17089-115">In questa esercitazione si vedrà come visualizzare i record master in un [controllo DropDownList](https://msdn.microsoft.com/library/dtx91y0z.aspx) e i dettagli dell'elemento di elenco selezionato in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="17089-115">In this tutorial we'll see how to display the master records in a [DropDownList control](https://msdn.microsoft.com/library/dtx91y0z.aspx) and the details of the selected list item in a GridView.</span></span> <span data-ttu-id="17089-116">Relazione master-details dell'esercitazione, in particolare, le informazioni di category e product.</span><span class="sxs-lookup"><span data-stu-id="17089-116">In particular, this tutorial's master/detail report will list category and product information.</span></span>

## <a name="step-1-displaying-the-categories-in-a-dropdownlist"></a><span data-ttu-id="17089-117">Passaggio 1: Visualizzare le categorie in un controllo DropDownList</span><span class="sxs-lookup"><span data-stu-id="17089-117">Step 1: Displaying the Categories in a DropDownList</span></span>

<span data-ttu-id="17089-118">Il report master-details elencherà le categorie in un controllo DropDownList, con i prodotti della voce di elenco selezionato visualizzati più in basso nella pagina un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="17089-118">Our master/detail report will list the categories in a DropDownList, with the selected list item's products displayed further down in the page in a GridView.</span></span> <span data-ttu-id="17089-119">La prima attività precedono us, è quindi, per le categorie visualizzate in un controllo DropDownList.</span><span class="sxs-lookup"><span data-stu-id="17089-119">The first task ahead of us, then, is to have the categories displayed in a DropDownList.</span></span> <span data-ttu-id="17089-120">Aprire il `FilterByDropDownList.aspx` nella pagina il `Filtering` cartella, trascinare un controllo DropDownList dalla casella degli strumenti nella finestra di progettazione della pagina e impostare il relativo `ID` proprietà `Categories`.</span><span class="sxs-lookup"><span data-stu-id="17089-120">Open the `FilterByDropDownList.aspx` page in the `Filtering` folder, drag on a DropDownList from the Toolbox onto the page's designer, and set its `ID` property to `Categories`.</span></span> <span data-ttu-id="17089-121">Fare clic sul collegamento smart tag del DropDownList Scegli origine dati.</span><span class="sxs-lookup"><span data-stu-id="17089-121">Next, click on the Choose Data Source link from the DropDownList's smart tag.</span></span> <span data-ttu-id="17089-122">Verrà visualizzata la configurazione guidata origine dati.</span><span class="sxs-lookup"><span data-stu-id="17089-122">This will display the Data Source Configuration wizard.</span></span>


<span data-ttu-id="17089-123">[![Specificare l'origine dati del DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="17089-123">[![Specify the DropDownList's Data Source](master-detail-filtering-with-a-dropdownlist-vb/_static/image2.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image1.png)</span></span>

<span data-ttu-id="17089-124">**Figura 1**: specificare l'origine dati del DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="17089-124">**Figure 1**: Specify the DropDownList's Data Source ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image3.png))</span></span>


<span data-ttu-id="17089-125">Scegliere di aggiungere un nuovo oggetto ObjectDataSource denominato `CategoriesDataSource` che richiama la `CategoriesBLL` della classe `GetCategories()` metodo.</span><span class="sxs-lookup"><span data-stu-id="17089-125">Choose to add a new ObjectDataSource named `CategoriesDataSource` that invokes the `CategoriesBLL` class's `GetCategories()` method.</span></span>


<span data-ttu-id="17089-126">[![Aggiungere un nuovo oggetto ObjectDataSource denominato CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="17089-126">[![Add a New ObjectDataSource Named CategoriesDataSource](master-detail-filtering-with-a-dropdownlist-vb/_static/image5.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image4.png)</span></span>

<span data-ttu-id="17089-127">**Figura 2**: aggiungere un nuovo denominato ObjectDataSource `CategoriesDataSource` ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="17089-127">**Figure 2**: Add a New ObjectDataSource Named `CategoriesDataSource` ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image6.png))</span></span>


<span data-ttu-id="17089-128">[![Scegliere di utilizzare la classe CategoriesBLL](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="17089-128">[![Choose to Use the CategoriesBLL Class](master-detail-filtering-with-a-dropdownlist-vb/_static/image8.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image7.png)</span></span>

<span data-ttu-id="17089-129">**Figura 3**: scegliere di utilizzare il `CategoriesBLL` classe ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="17089-129">**Figure 3**: Choose to Use the `CategoriesBLL` Class ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image9.png))</span></span>


<span data-ttu-id="17089-130">[![Configurare ObjectDataSource per utilizzare il metodo GetCategories()](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="17089-130">[![Configure the ObjectDataSource to Use the GetCategories() Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image11.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image10.png)</span></span>

<span data-ttu-id="17089-131">**Figura 4**: configurare ObjectDataSource per utilizzare il `GetCategories()` metodo ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="17089-131">**Figure 4**: Configure the ObjectDataSource to Use the `GetCategories()` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image12.png))</span></span>


<span data-ttu-id="17089-132">Dopo aver configurato il ObjectDataSource è comunque necessario specificare quale campo dell'origine dati deve essere visualizzato in DropDownList e che uno deve essere associato come valore per l'elemento dell'elenco.</span><span class="sxs-lookup"><span data-stu-id="17089-132">After configuring the ObjectDataSource we still need to specify what data source field should be displayed in DropDownList and which one should be associated as the value for the list item.</span></span> <span data-ttu-id="17089-133">Dispone il `CategoryName` campo come la visualizzazione e `CategoryID` come valore per ogni elemento nell'elenco.</span><span class="sxs-lookup"><span data-stu-id="17089-133">Have the `CategoryName` field as the display and `CategoryID` as the value for each list item.</span></span>


<span data-ttu-id="17089-134">[![Avere la visualizzazione DropDownList campo CategoryName e CategoryID utilizzare come valore](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="17089-134">[![Have the DropDownList Display the CategoryName Field and Use CategoryID as the Value](master-detail-filtering-with-a-dropdownlist-vb/_static/image14.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image13.png)</span></span>

<span data-ttu-id="17089-135">**Figura 5**: la visualizzazione DropDownList il `CategoryName` campo e utilizzare `CategoryID` come valore ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="17089-135">**Figure 5**: Have the DropDownList Display the `CategoryName` Field and Use `CategoryID` as the Value ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image15.png))</span></span>


<span data-ttu-id="17089-136">A questo punto si dispongono di un controllo DropDownList che viene popolato con i record di `Categories` tabella (all eseguita in circa sei secondi).</span><span class="sxs-lookup"><span data-stu-id="17089-136">At this point we have a DropDownList control that's populated with the records from the `Categories` table (all accomplished in about six seconds).</span></span> <span data-ttu-id="17089-137">Figura 6 mostra l'avanzamento finora quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="17089-137">Figure 6 shows our progress thus far when viewed through a browser.</span></span>


<span data-ttu-id="17089-138">[![Un elenco a discesa sono elencate le categorie corrente](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="17089-138">[![A Drop-Down Lists the Current Categories](master-detail-filtering-with-a-dropdownlist-vb/_static/image17.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image16.png)</span></span>

<span data-ttu-id="17089-139">**Figura 6**: un elenco a discesa sono elencate le categorie corrente ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="17089-139">**Figure 6**: A Drop-Down Lists the Current Categories ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image18.png))</span></span>


## <a name="step-2-adding-the-products-gridview"></a><span data-ttu-id="17089-140">Passaggio 2: Aggiunta di prodotti GridView</span><span class="sxs-lookup"><span data-stu-id="17089-140">Step 2: Adding the Products GridView</span></span>

<span data-ttu-id="17089-141">Quest'ultimo passaggio nel report master-Details è per elencare i prodotti associati alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="17089-141">That last step in our master/detail report is to list the products associated with the selected category.</span></span> <span data-ttu-id="17089-142">A tale scopo, aggiungere un controllo GridView alla pagina e creare un nuovo oggetto ObjectDataSource denominato `productsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="17089-142">To accomplish this, add a GridView to the page and create a new ObjectDataSource named `productsDataSource`.</span></span> <span data-ttu-id="17089-143">Dispone il `productsDataSource` controllo selezionare i dati di `ProductsBLL` della classe `GetProductsByCategoryID(categoryID)` (metodo).</span><span class="sxs-lookup"><span data-stu-id="17089-143">Have the `productsDataSource` control cull its data from the `ProductsBLL` class's `GetProductsByCategoryID(categoryID)` method.</span></span>


<span data-ttu-id="17089-144">[![Selezionare il metodo GetProductsByCategoryID(categoryID)](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="17089-144">[![Select the GetProductsByCategoryID(categoryID) Method](master-detail-filtering-with-a-dropdownlist-vb/_static/image20.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image19.png)</span></span>

<span data-ttu-id="17089-145">**Figura 7**: selezionare il `GetProductsByCategoryID(categoryID)` metodo ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="17089-145">**Figure 7**: Select the `GetProductsByCategoryID(categoryID)` Method ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image21.png))</span></span>


<span data-ttu-id="17089-146">Dopo aver scelto questo metodo, la procedura guidata ObjectDataSource richiede us per il valore per il metodo *`categoryID`* parametro.</span><span class="sxs-lookup"><span data-stu-id="17089-146">After choosing this method, the ObjectDataSource wizard prompts us for the value for the method's *`categoryID`* parameter.</span></span> <span data-ttu-id="17089-147">Per utilizzare il valore dell'oggetto selezionato `categories` DropDownList elemento imposta l'origine di parametro al controllo e il ControlID per `Categories`.</span><span class="sxs-lookup"><span data-stu-id="17089-147">To use the value of the selected `categories` DropDownList item set the Parameter source to Control and the ControlID to `Categories`.</span></span>


<span data-ttu-id="17089-148">[![Impostare il valore di DropDownList categorie categoryID parametro](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="17089-148">[![Set the categoryID Parameter to the Value of the Categories DropDownList](master-detail-filtering-with-a-dropdownlist-vb/_static/image23.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image22.png)</span></span>

<span data-ttu-id="17089-149">**Figura 8**: impostare il *`categoryID`* parametro per il valore della `Categories` DropDownList ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="17089-149">**Figure 8**: Set the *`categoryID`* Parameter to the Value of the `Categories` DropDownList ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image24.png))</span></span>


<span data-ttu-id="17089-150">Richiedere qualche istante per l'estrazione di stato di avanzamento in un browser.</span><span class="sxs-lookup"><span data-stu-id="17089-150">Take a moment to check out our progress in a browser.</span></span> <span data-ttu-id="17089-151">Durante la prima visita la pagina, tali prodotti appartengono alla categoria selezionata (bibite) vengono visualizzate (come illustrato nella figura 9), ma modifica DropDownList non aggiorna i dati.</span><span class="sxs-lookup"><span data-stu-id="17089-151">When first visiting the page, those products belong to the selected category (Beverages) are displayed (as shown in Figure 9), but changing the DropDownList doesn't update the data.</span></span> <span data-ttu-id="17089-152">Infatti, deve verificarsi un postback per il controllo GridView aggiornare.</span><span class="sxs-lookup"><span data-stu-id="17089-152">This is because a postback must occur for the GridView to update.</span></span> <span data-ttu-id="17089-153">A tale scopo che sono disponibili due opzioni (nessuna delle quali è necessario scrivere codice):</span><span class="sxs-lookup"><span data-stu-id="17089-153">To accomplish this we have two options (neither of which requires writing any code):</span></span>

- <span data-ttu-id="17089-154">**Impostare le categorie DropDownList**[proprietà di un postback automatico](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**su True.**</span><span class="sxs-lookup"><span data-stu-id="17089-154">**Set the categories DropDownList's**[AutoPostBack property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.listcontrol.autopostback%28VS.80%29.aspx)**to True.**</span></span> <span data-ttu-id="17089-155">(È possibile eseguire questo selezionando l'opzione di attivare un postback automatico smart tag del DropDownList.) Che attiverà un postback ogni volta che il controllo DropDownList selezionata elemento è stato modificato dall'utente.</span><span class="sxs-lookup"><span data-stu-id="17089-155">(You can accomplish this by checking the Enable AutoPostBack option in the DropDownList's smart tag.) This will trigger a postback whenever the DropDownList's selected item is changed by the user.</span></span> <span data-ttu-id="17089-156">Pertanto, quando l'utente seleziona una nuova categoria da DropDownList verrà insorgere un postback e GridView verrà aggiornato con i prodotti per la categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="17089-156">Therefore, when the user selects a new category from the DropDownList a postback will ensue and the GridView will be updated with the products for the newly selected category.</span></span> <span data-ttu-id="17089-157">(Questo è l'approccio che ho utilizzato in questa esercitazione).</span><span class="sxs-lookup"><span data-stu-id="17089-157">(This is the approach I've used in this tutorial.)</span></span>
- <span data-ttu-id="17089-158">**Aggiungere un controllo pulsante Web accanto DropDownList.**</span><span class="sxs-lookup"><span data-stu-id="17089-158">**Add a Button Web control next to the DropDownList.**</span></span> <span data-ttu-id="17089-159">Impostare il relativo `Text` proprietà per l'aggiornamento o un attributo simile.</span><span class="sxs-lookup"><span data-stu-id="17089-159">Set its `Text` property to Refresh or something similar.</span></span> <span data-ttu-id="17089-160">Con questo approccio, l'utente sarà necessario selezionare una nuova categoria e quindi fare clic sul pulsante.</span><span class="sxs-lookup"><span data-stu-id="17089-160">With this approach, the user will need to select a new category and then click the Button.</span></span> <span data-ttu-id="17089-161">Fare clic sul pulsante causerà un postback e aggiorna il GridView per elencare i prodotti della categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="17089-161">Clicking the Button will cause a postback and update the GridView to list those products of the selected category.</span></span>

<span data-ttu-id="17089-162">Figure 9 e 10 viene illustrato il report master/dettaglio in azione.</span><span class="sxs-lookup"><span data-stu-id="17089-162">Figures 9 and 10 illustrate the master/detail report in action.</span></span>


<span data-ttu-id="17089-163">[![Durante la prima visita la pagina, vengono visualizzati i prodotti delle bibite](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="17089-163">[![When First Visiting the Page, the Beverage Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image26.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image25.png)</span></span>

<span data-ttu-id="17089-164">**Figura 9**: durante la prima visita la pagina, vengono visualizzati i prodotti delle bibite ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="17089-164">**Figure 9**: When First Visiting the Page, the Beverage Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image27.png))</span></span>


<span data-ttu-id="17089-165">[![Se si seleziona un nuovo prodotto (prodotto) automaticamente, un PostBack, l'aggiornamento di GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="17089-165">[![Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView](master-detail-filtering-with-a-dropdownlist-vb/_static/image29.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image28.png)</span></span>

<span data-ttu-id="17089-166">**Figura 10**: se si seleziona un nuovo prodotto (prodotto) automaticamente, un PostBack, l'aggiornamento di GridView ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="17089-166">**Figure 10**: Selecting a New Product (Produce) Automatically Causes a PostBack, Updating the GridView ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image30.png))</span></span>


## <a name="adding-a----choose-a-category----list-item"></a><span data-ttu-id="17089-167">Aggiunta di un elemento di elenco "-consente di scegliere una categoria"</span><span class="sxs-lookup"><span data-stu-id="17089-167">Adding a "-- Choose a Category --" List Item</span></span>

<span data-ttu-id="17089-168">Durante la visita prima la `FilterByDropDownList.aspx` pagina le categorie primo elemento di elenco del DropDownList (bibite) è selezionata per impostazione predefinita, che mostra i prodotti delle bibite in GridView.</span><span class="sxs-lookup"><span data-stu-id="17089-168">When first visiting the `FilterByDropDownList.aspx` page the categories DropDownList's first list item (Beverages) is selected by default, showing the beverage products in the GridView.</span></span> <span data-ttu-id="17089-169">Anziché con i prodotti della categoria prima, che si può decidere di creare invece un elemento di DropDownList selezionata che è simile al seguente, "-consente di scegliere una categoria,".</span><span class="sxs-lookup"><span data-stu-id="17089-169">Rather than showing the first category's products, we may want to instead have a DropDownList item selected that says something like, "-- Choose a Category --".</span></span>

<span data-ttu-id="17089-170">Per aggiungere un nuovo elemento elenco DropDownList, passare alla finestra proprietà e fare clic sui puntini di sospensione nel `Items` proprietà.</span><span class="sxs-lookup"><span data-stu-id="17089-170">To add a new list item to the DropDownList, go to the Properties window and click on the ellipses in the `Items` property.</span></span> <span data-ttu-id="17089-171">Aggiungere un nuovo elemento di elenco con il `Text` "-consente di scegliere una categoria-" e `Value` `-1`.</span><span class="sxs-lookup"><span data-stu-id="17089-171">Add a new list item with the `Text` "-- Choose a Category --" and the `Value` `-1`.</span></span>


<span data-ttu-id="17089-172">[![Aggiungere un - selezionare una categoria - voce di elenco](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="17089-172">[![Add a -- Choose a Category -- List Item](master-detail-filtering-with-a-dropdownlist-vb/_static/image32.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image31.png)</span></span>

<span data-ttu-id="17089-173">**Figura 11**: aggiungere un - selezionare una categoria - voce di elenco ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="17089-173">**Figure 11**: Add a -- Choose a Category -- List Item ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image33.png))</span></span>


<span data-ttu-id="17089-174">In alternativa, è possibile aggiungere la voce di elenco aggiungendovi DropDownList il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="17089-174">Alternatively, you can add the list item by adding the following markup to the DropDownList:</span></span>


[!code-aspx[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample1.aspx)]

<span data-ttu-id="17089-175">Inoltre, è necessario impostare il controllo DropDownList `AppendDataBoundItems` su True perché quando le categorie vengono associate a DropDownList da ObjectDataSource queste sovrascrivono gli elementi dell'elenco aggiunto manualmente se `AppendDataBoundItems` non è True.</span><span class="sxs-lookup"><span data-stu-id="17089-175">Additionally, we need to set the DropDownList control's `AppendDataBoundItems` to True because when the categories are bound to the DropDownList from the ObjectDataSource they'll overwrite any manually-added list items if `AppendDataBoundItems` isn't True.</span></span>


![Impostare la proprietà AppendDataBoundItems su True](master-detail-filtering-with-a-dropdownlist-vb/_static/image34.png)

<span data-ttu-id="17089-177">**Figura 12**: impostare il `AppendDataBoundItems` proprietà su True</span><span class="sxs-lookup"><span data-stu-id="17089-177">**Figure 12**: Set the `AppendDataBoundItems` Property to True</span></span>


<span data-ttu-id="17089-178">Dopo aver apportato queste modifiche, durante la prima visita la pagina è selezionata l'opzione "-consente di scegliere una categoria," e non i prodotti vengono visualizzati.</span><span class="sxs-lookup"><span data-stu-id="17089-178">After these changes, when first visiting the page the "-- Choose a Category --" option is selected and no products are displayed.</span></span>


<span data-ttu-id="17089-179">[![Il caricamento della pagina iniziale prodotti non vengono visualizzati](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span><span class="sxs-lookup"><span data-stu-id="17089-179">[![On the Initial Page Load No Products are Displayed](master-detail-filtering-with-a-dropdownlist-vb/_static/image36.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image35.png)</span></span>

<span data-ttu-id="17089-180">**Figura 13**: in the iniziale pagina carico No i prodotti vengono visualizzati ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span><span class="sxs-lookup"><span data-stu-id="17089-180">**Figure 13**: On the Initial Page Load No Products are Displayed ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image37.png))</span></span>


<span data-ttu-id="17089-181">Nessun prodotto viene visualizzato quando perché l'elemento di elenco "-consente di scegliere una categoria," è selezionato, infatti, il valore è `-1` e non sono presenti prodotti nel database con un `CategoryID` di `-1`.</span><span class="sxs-lookup"><span data-stu-id="17089-181">The reason no products are displayed when because the "-- Choose a Category --" list item is selected is because its value is `-1` and there are no products in the database with a `CategoryID` of `-1`.</span></span> <span data-ttu-id="17089-182">Se si tratta del comportamento di cui che si desidera la apportate a questo punto!</span><span class="sxs-lookup"><span data-stu-id="17089-182">If this is the behavior you want then you're done at this point!</span></span> <span data-ttu-id="17089-183">Se, tuttavia, si desidera visualizzare *tutti* delle categorie quando è selezionata la voce di elenco "-consente di scegliere una categoria,", tornare al `ProductsBLL` classe e personalizzare il `GetProductsByCategoryID(categoryID)` metodo in modo che richiama il `GetProducts()` metodo se il valore passato in *`categoryID`* parametro è minore di zero:</span><span class="sxs-lookup"><span data-stu-id="17089-183">If, however, you want to display *all* of the categories when the "-- Choose a Category --" list item is selected, return to the `ProductsBLL` class and customize the `GetProductsByCategoryID(categoryID)` method so that it invokes the `GetProducts()` method if the passed in *`categoryID`* parameter is less than zero:</span></span>


[!code-vb[Main](master-detail-filtering-with-a-dropdownlist-vb/samples/sample2.vb)]

<span data-ttu-id="17089-184">La tecnica usata in questo esempio è simile all'approccio è utilizzati per visualizzare tutti i fornitori nuovamente il [parametri dichiarativi](../basic-reporting/declarative-parameters-cs.md) dell'esercitazione, anche se per questo esempio si usa un valore di `-1` per indicare che tutti i record devono essere recuperare anziché `Nothing`.</span><span class="sxs-lookup"><span data-stu-id="17089-184">The technique used here is similar to the approach we used to display all suppliers back in the [Declarative Parameters](../basic-reporting/declarative-parameters-cs.md) tutorial, although for this example we're using a value of `-1` to indicate that all records should be retrieved as opposed to `Nothing`.</span></span> <span data-ttu-id="17089-185">In questo modo il *`categoryID`* parametro del `GetProductsByCategoryID(categoryID)` metodo prevede che al valore passato valore intero, mentre nell'esercitazione parametri dichiarativi si stava passando un parametro di input di stringa.</span><span class="sxs-lookup"><span data-stu-id="17089-185">This is because the *`categoryID`* parameter of the `GetProductsByCategoryID(categoryID)` method expects as integer value passed in, whereas in the Declarative Parameters tutorial we were passing in a string input parameter.</span></span>

<span data-ttu-id="17089-186">La figura 14 mostra una schermata di `FilterByDropDownList.aspx` quando è selezionata l'opzione "-consente di scegliere una categoria,".</span><span class="sxs-lookup"><span data-stu-id="17089-186">Figure 14 shows a screen shot of `FilterByDropDownList.aspx` when the "-- Choose a Category --" option is selected.</span></span> <span data-ttu-id="17089-187">In questo caso, tutti i prodotti vengono visualizzati per impostazione predefinita, e l'utente è possibile limitare la visualizzazione scegliendo una categoria specifica.</span><span class="sxs-lookup"><span data-stu-id="17089-187">Here, all of the products are displayed by default, and the user can narrow the display by choosing a specific category.</span></span>


<span data-ttu-id="17089-188">[![Tutti i prodotti sono ora elencati per impostazione predefinita](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span><span class="sxs-lookup"><span data-stu-id="17089-188">[![All of the Products are Now Listed By Default](master-detail-filtering-with-a-dropdownlist-vb/_static/image39.png)](master-detail-filtering-with-a-dropdownlist-vb/_static/image38.png)</span></span>

<span data-ttu-id="17089-189">**Figura 14**: tutti i prodotti sono ora elencati per impostazione predefinita ([fare clic per visualizzare l'immagine ingrandita](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span><span class="sxs-lookup"><span data-stu-id="17089-189">**Figure 14**: All of the Products are Now Listed By Default ([Click to view full-size image](master-detail-filtering-with-a-dropdownlist-vb/_static/image40.png))</span></span>


## <a name="summary"></a><span data-ttu-id="17089-190">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="17089-190">Summary</span></span>

<span data-ttu-id="17089-191">Quando si visualizzano dati correlati in modo gerarchico, è spesso utile per presentare i dati di utilizzo dei report master/dettaglio, da cui l'utente può iniziare ad analizzare i dati dalla parte superiore della gerarchia e drill-down nei dettagli.</span><span class="sxs-lookup"><span data-stu-id="17089-191">When displaying hierarchically-related data, it often helps to present the data using master/detail reports, from which the user can start perusing the data from the top of the hierarchy and drill down into details.</span></span> <span data-ttu-id="17089-192">In questa esercitazione sono state esaminate la creazione di un report semplice master-details che mostri i prodotti della categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="17089-192">In this tutorial we examined building a simple master/detail report showing a selected category's products.</span></span> <span data-ttu-id="17089-193">Questa operazione è stata eseguita utilizzando un controllo DropDownList per l'elenco di categorie e GridView per i prodotti appartenenti alla categoria selezionata.</span><span class="sxs-lookup"><span data-stu-id="17089-193">This was accomplished by using a DropDownList for the list of categories and a GridView for the products belonging to the selected category.</span></span>

<span data-ttu-id="17089-194">Nel [esercitazione successiva](master-detail-filtering-with-two-dropdownlists-vb.md) l'utente verrà reindirizzato, inoltre, il passaggio di un'interfaccia DropDownList mediante due controlli DropDownList.</span><span class="sxs-lookup"><span data-stu-id="17089-194">In the [next tutorial](master-detail-filtering-with-two-dropdownlists-vb.md) we'll take the DropDownList interface one step further, using two DropDownLists.</span></span>

<span data-ttu-id="17089-195">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="17089-195">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="17089-196">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="17089-196">About the Author</span></span>

<span data-ttu-id="17089-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="17089-197">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="17089-198">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="17089-198">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="17089-199">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="17089-199">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="17089-200">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="17089-200">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="17089-201">[Precedente](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
> [Successivo](master-detail-filtering-with-two-dropdownlists-vb.md)</span><span class="sxs-lookup"><span data-stu-id="17089-201">[Previous](master-detail-using-a-selectable-master-gridview-with-a-details-detailview-cs.md)
[Next](master-detail-filtering-with-two-dropdownlists-vb.md)</span></span>

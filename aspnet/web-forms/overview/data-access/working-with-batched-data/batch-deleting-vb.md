---
uid: web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
title: Batch di eliminazione (VB) | Documenti Microsoft
author: rick-anderson
description: Informazioni su come eliminare più record di database in un'unica operazione. Il Layer dell'interfaccia utente è di ampliare un GridView avanzata creato nella versione precedente tut...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: 4fb72f75-32ab-4bf7-a764-be20367be726
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-deleting-vb
msc.type: authoredcontent
ms.openlocfilehash: 0d17ec6ec20be65b3ec9369f1c5a08d5970ec0dd
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30880115"
---
<a name="batch-deleting-vb"></a><span data-ttu-id="8340a-104">Batch di eliminazione (VB)</span><span class="sxs-lookup"><span data-stu-id="8340a-104">Batch Deleting (VB)</span></span>
====================
<span data-ttu-id="8340a-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8340a-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8340a-106">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) o [Scarica il PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8340a-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_65_VB.zip) or [Download PDF](batch-deleting-vb/_static/datatutorial65vb1.pdf)</span></span>

> <span data-ttu-id="8340a-107">Informazioni su come eliminare più record di database in un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-107">Learn how to delete multiple database records in a single operation.</span></span> <span data-ttu-id="8340a-108">Il Layer dell'interfaccia utente è di ampliare un GridView avanzata creata in un'esercitazione precedente.</span><span class="sxs-lookup"><span data-stu-id="8340a-108">In the User Interface Layer we build upon an enhanced GridView created in an earlier tutorial.</span></span> <span data-ttu-id="8340a-109">Nel livello di accesso ai dati si eseguono il wrapping di più operazioni di eliminazione in una transazione per garantire che tutte le eliminazioni completata o vengono eseguito il rollback di tutte le eliminazioni.</span><span class="sxs-lookup"><span data-stu-id="8340a-109">In the Data Access Layer we wrap the multiple Delete operations within a transaction to ensure that all deletions succeed or all deletions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="8340a-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="8340a-110">Introduction</span></span>

<span data-ttu-id="8340a-111">Il [esercitazione precedente](batch-updating-vb.md) esplorata come creare un batch Modifica interfaccia usando un GridView completamente modificabile.</span><span class="sxs-lookup"><span data-stu-id="8340a-111">The [preceding tutorial](batch-updating-vb.md) explored how to create a batch editing interface using a fully-editable GridView.</span></span> <span data-ttu-id="8340a-112">In situazioni in cui gli utenti sono in genere modifica numero di record in una sola volta, un batch di interfaccia di modifica richiederà meno postback e il contesto di mouse da tastiera per commutatori, migliorando l'efficienza di s utente finale.</span><span class="sxs-lookup"><span data-stu-id="8340a-112">In situations where users are commonly editing many records at once, a batch editing interface will require far fewer postbacks and keyboard-to-mouse context switches, thereby improving the end user s efficiency.</span></span> <span data-ttu-id="8340a-113">Questa tecnica è allo stesso modo utile per le pagine in cui è comune per gli utenti di eliminare più record in un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-113">This technique is similarly useful for pages where it is common for users to delete many records in one go.</span></span>

<span data-ttu-id="8340a-114">Chi ha utilizzato un client di posta elettronica online ha già familiarità con uno dei più comuni batch l'eliminazione di interfacce: pulsante di una casella di controllo in ogni riga in una griglia con un corrispondente eliminare tutti gli elementi selezionati (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="8340a-114">Anyone who has used an online email client is already familiar with one of the most common batch deleting interfaces: a checkbox in each row in a grid with a corresponding Delete All Checked Items button (see Figure 1).</span></span> <span data-ttu-id="8340a-115">In questa esercitazione è piuttosto breve perché è ve già tutte le operazioni di disco rigida nelle esercitazioni precedenti per creare sia l'interfaccia basata sul web e un metodo per eliminare una serie di record come una singola operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="8340a-115">This tutorial is rather short because we ve already done all of the hard work in previous tutorials in creating both the web-based interface and a method to delete a series of records as a single atomic operation.</span></span> <span data-ttu-id="8340a-116">Nel [aggiunta di una colonna di GridView di caselle di controllo](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) è creato un controllo GridView con una colonna di caselle di controllo e nell'esercitazione di [di wrapping delle modifiche del Database all'interno di una transazione](wrapping-database-modifications-within-a-transaction-vb.md) esercitazione è stato creato un metodo in il livello Business LOGIC che usa una transazione per eliminare un `List<T>` di `ProductID` valori.</span><span class="sxs-lookup"><span data-stu-id="8340a-116">In the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial we created a GridView with a column of checkboxes and in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial we created a method in the BLL that would use a transaction to delete a `List<T>` of `ProductID` values.</span></span> <span data-ttu-id="8340a-117">In questa esercitazione verrà si basano e unire il nostro esperienze precedenti per creare un batch di lavoro, l'eliminazione di esempio.</span><span class="sxs-lookup"><span data-stu-id="8340a-117">In this tutorial, we will build upon and merge our previous experiences to create a working batch deleting example.</span></span>


<span data-ttu-id="8340a-118">[![Ogni riga include una casella di controllo](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8340a-118">[![Each Row Includes a Checkbox](batch-deleting-vb/_static/image1.gif)](batch-deleting-vb/_static/image1.png)</span></span>

<span data-ttu-id="8340a-119">**Figura 1**: ogni riga include una casella di controllo ([fare clic per visualizzare l'immagine ingrandita](batch-deleting-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="8340a-119">**Figure 1**: Each Row Includes a Checkbox ([Click to view full-size image](batch-deleting-vb/_static/image2.png))</span></span>


## <a name="step-1-creating-the-batch-deleting-interface"></a><span data-ttu-id="8340a-120">Passaggio 1: Creazione di Batch di eliminazione di interfaccia</span><span class="sxs-lookup"><span data-stu-id="8340a-120">Step 1: Creating the Batch Deleting Interface</span></span>

<span data-ttu-id="8340a-121">Poiché è già stato creato il batch, l'eliminazione di interfaccia di [aggiunta di una colonna di GridView di caselle di controllo](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) esercitazione, è possibile semplicemente copiare `BatchDelete.aspx` anziché crearlo da zero.</span><span class="sxs-lookup"><span data-stu-id="8340a-121">Since we already created the batch deleting interface in the [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) tutorial, we can simply copy it to `BatchDelete.aspx` rather than creating it from scratch.</span></span> <span data-ttu-id="8340a-122">Avvia aprendo il `BatchDelete.aspx` nella pagina di `BatchData` cartella e il `CheckBoxField.aspx` nella pagina di `EnhancedGridView` cartella.</span><span class="sxs-lookup"><span data-stu-id="8340a-122">Start by opening the `BatchDelete.aspx` page in the `BatchData` folder and the `CheckBoxField.aspx` page in the `EnhancedGridView` folder.</span></span> <span data-ttu-id="8340a-123">Dal `CheckBoxField.aspx` pagina, passare alla visualizzazione origine e copiare il codice tra le `<asp:Content>` tag come illustrato nella figura 2.</span><span class="sxs-lookup"><span data-stu-id="8340a-123">From the `CheckBoxField.aspx` page, go to the Source view and copy the markup between the `<asp:Content>` tags as shown in Figure 2.</span></span>


<span data-ttu-id="8340a-124">[![Copiare il Markup dichiarativo di CheckBoxField.aspx negli Appunti](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="8340a-124">[![Copy the Declarative Markup of CheckBoxField.aspx to the Clipboard](batch-deleting-vb/_static/image2.gif)](batch-deleting-vb/_static/image3.png)</span></span>

<span data-ttu-id="8340a-125">**Figura 2**: copiare il Markup dichiarativo del `CheckBoxField.aspx` negli Appunti ([fare clic per visualizzare l'immagine ingrandita](batch-deleting-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="8340a-125">**Figure 2**: Copy the Declarative Markup of `CheckBoxField.aspx` to the Clipboard ([Click to view full-size image](batch-deleting-vb/_static/image4.png))</span></span>


<span data-ttu-id="8340a-126">Successivamente, passare alla visualizzazione origine in `BatchDelete.aspx` e incollare il contenuto degli Appunti all'interno di `<asp:Content>` tag.</span><span class="sxs-lookup"><span data-stu-id="8340a-126">Next, go to the Source view in `BatchDelete.aspx` and paste the contents of the clipboard within the `<asp:Content>` tags.</span></span> <span data-ttu-id="8340a-127">Anche copiare e incollare il codice dall'interno la classe code-behind in `CheckBoxField.aspx.vb` all'interno di classe code-behind in `BatchDelete.aspx.vb` (il `DeleteSelectedProducts` pulsante s `Click` gestore dell'evento, il `ToggleCheckState` (metodo) e `Click` gestori eventi per il `CheckAll` e `UncheckAll` pulsanti).</span><span class="sxs-lookup"><span data-stu-id="8340a-127">Also copy and paste the code from within the code-behind class in `CheckBoxField.aspx.vb` to within the code-behind class in `BatchDelete.aspx.vb` (the `DeleteSelectedProducts` Button s `Click` event handler, the `ToggleCheckState` method, and the `Click` event handlers for the `CheckAll` and `UncheckAll` Buttons).</span></span> <span data-ttu-id="8340a-128">Dopo aver copiato il contenuto, la `BatchDelete.aspx` classe code-behind s pagina deve contenere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="8340a-128">After copying over this content, the `BatchDelete.aspx` page s code-behind class should contain the following code:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample1.vb)]

<span data-ttu-id="8340a-129">Dopo aver copiato il markup dichiarativo e codice sorgente, è opportuno testare `BatchDelete.aspx` visualizzandolo tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8340a-129">After copying over the declarative markup and source code, take a moment to test `BatchDelete.aspx` by viewing it through a browser.</span></span> <span data-ttu-id="8340a-130">Verrà visualizzato un elenco dei primi dieci prodotti in un controllo GridView con ogni riga Elenca il nome del prodotto s, categoria e prezzo insieme a una casella di controllo di GridView.</span><span class="sxs-lookup"><span data-stu-id="8340a-130">You should see a GridView listing the first ten products in a GridView with each row listing the product s name, category, and price along with a checkbox.</span></span> <span data-ttu-id="8340a-131">Dovrebbero essere presenti tre pulsanti: controllare tutti deselezionare tutti i prodotti ed eliminare selezionato.</span><span class="sxs-lookup"><span data-stu-id="8340a-131">There should be three buttons: Check All, Uncheck All, and Delete Selected Products.</span></span> <span data-ttu-id="8340a-132">Fare clic sul pulsante Seleziona tutto seleziona tutte le caselle di controllo, mentre tutti deselezionare Cancella tutte le caselle di controllo.</span><span class="sxs-lookup"><span data-stu-id="8340a-132">Clicking the Check All button selects all checkboxes, while Uncheck All clears all checkboxes.</span></span> <span data-ttu-id="8340a-133">Facendo clic di eliminare i prodotti selezionati viene visualizzato un messaggio in cui sono elencati i `ProductID` i valori dei prodotti selezionati, ma non elimina effettivamente i prodotti.</span><span class="sxs-lookup"><span data-stu-id="8340a-133">Clicking Delete Selected Products displays a message that lists the `ProductID` values of the selected products, but does not actually delete the products.</span></span>


<span data-ttu-id="8340a-134">[![L'interfaccia da CheckBoxField.aspx è stata spostata in BatchDeleting.aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="8340a-134">[![The Interface from CheckBoxField.aspx has been Moved to BatchDeleting.aspx](batch-deleting-vb/_static/image3.gif)](batch-deleting-vb/_static/image5.png)</span></span>

<span data-ttu-id="8340a-135">**Figura 3**: l'interfaccia da `CheckBoxField.aspx` sono state spostate in `BatchDeleting.aspx` ([fare clic per visualizzare l'immagine ingrandita](batch-deleting-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8340a-135">**Figure 3**: The Interface from `CheckBoxField.aspx` has been Moved to `BatchDeleting.aspx` ([Click to view full-size image](batch-deleting-vb/_static/image6.png))</span></span>


## <a name="step-2-deleting-the-checked-products-using-transactions"></a><span data-ttu-id="8340a-136">Passaggio 2: Eliminazione dei prodotti selezionati utilizzando transazioni</span><span class="sxs-lookup"><span data-stu-id="8340a-136">Step 2: Deleting the Checked Products Using Transactions</span></span>

<span data-ttu-id="8340a-137">Con il batch eliminando interfaccia copiata di `BatchDeleting.aspx`tutti che rimane consiste nell'aggiornare il codice in modo che il pulsante Elimina prodotti selezionati Elimina i prodotti selezionati utilizzando il `DeleteProductsWithTransaction` metodo nel `ProductsBLL` classe.</span><span class="sxs-lookup"><span data-stu-id="8340a-137">With the batch deleting interface successfully copied over to `BatchDeleting.aspx`, all that remains is to update the code so that the Delete Selected Products button deletes the checked products using the `DeleteProductsWithTransaction` method in the `ProductsBLL` class.</span></span> <span data-ttu-id="8340a-138">Questo metodo, aggiunto nel [di wrapping delle modifiche del Database all'interno di una transazione](wrapping-database-modifications-within-a-transaction-vb.md) esercitazione accetta come input un `List(Of T)` di `ProductID` valori ed elimina ogni corrispondente `ProductID` all'interno dell'ambito di un transazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-138">This method, added in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md) tutorial, accepts as its input a `List(Of T)` of `ProductID` values and deletes each corresponding `ProductID` within the scope of a transaction.</span></span>

<span data-ttu-id="8340a-139">Il `DeleteSelectedProducts` pulsante s `Click` gestore dell'evento attualmente utilizza il seguente `For Each` ciclo per scorrere ogni riga GridView:</span><span class="sxs-lookup"><span data-stu-id="8340a-139">The `DeleteSelectedProducts` Button s `Click` event handler currently uses the following `For Each` loop to iterate through each GridView row:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample2.vb)]

<span data-ttu-id="8340a-140">Per ogni riga, il `ProductSelector` controllo casella di controllo Web a livello di codice a cui fa riferimento.</span><span class="sxs-lookup"><span data-stu-id="8340a-140">For each row, the `ProductSelector` CheckBox Web control is programmatically referenced.</span></span> <span data-ttu-id="8340a-141">Se è selezionata, la riga s `ProductID` viene recuperato dal `DataKeys` insieme e `DeleteResults` etichetta s `Text` proprietà viene aggiornata per includere un messaggio che indica che la riga è stata selezionata per l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-141">If it is checked, the row s `ProductID` is retrieved from the `DataKeys` collection and the `DeleteResults` Label s `Text` property is updated to include a message indicating that the row was selected for deletion.</span></span>

<span data-ttu-id="8340a-142">Il codice precedente non viene eliminato alcun record come la chiamata al `ProductsBLL` classe s `Delete` metodo è impostato come commento. Sono stati questa logica di eliminazione da applicare, il codice di eliminare i prodotti ma non all'interno di un'operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="8340a-142">The above code does not actually delete any records as the call to the `ProductsBLL` class s `Delete` method is commented out. Were this delete logic to be applied, the code would delete the products but not within an atomic operation.</span></span> <span data-ttu-id="8340a-143">Ovvero, se le eliminazioni alcuni prima nella sequenza ha avuto esito positivo, ma una versione più recente non riuscito (probabilmente a causa di una violazione di vincolo di chiave esterna), verrebbe generata un'eccezione ma restano eliminati i prodotti già eliminati.</span><span class="sxs-lookup"><span data-stu-id="8340a-143">That is, if the first few deletes in the sequence succeeded, but a later one failed (perhaps due to a foreign key constraint violation), an exception would be thrown but those products already deleted would remain deleted.</span></span>

<span data-ttu-id="8340a-144">Per garantire l'atomicità, è necessario usare invece il `ProductsBLL` classe s `DeleteProductsWithTransaction` metodo.</span><span class="sxs-lookup"><span data-stu-id="8340a-144">In order to assure atomicity, we need to instead use the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="8340a-145">Poiché questo metodo accetta un elenco di `ProductID` valori, è necessario innanzitutto compilare questo elenco dalla griglia e quindi passarlo come parametro.</span><span class="sxs-lookup"><span data-stu-id="8340a-145">Because this method accepts a list of `ProductID` values, we need to first compile this list from the grid and then pass it as a parameter.</span></span> <span data-ttu-id="8340a-146">È necessario creare un'istanza di un `List(Of T)` di tipo `Integer`.</span><span class="sxs-lookup"><span data-stu-id="8340a-146">We first create an instance of a `List(Of T)` of type `Integer`.</span></span> <span data-ttu-id="8340a-147">All'interno di `For Each` ciclo è necessario aggiungere i prodotti selezionati `ProductID` valori a questo `List(Of T)`.</span><span class="sxs-lookup"><span data-stu-id="8340a-147">Within the `For Each` loop we need to add the selected products `ProductID` values to this `List(Of T)`.</span></span> <span data-ttu-id="8340a-148">Dopo il ciclo si `List(Of T)` deve essere passato al `ProductsBLL` classe s `DeleteProductsWithTransaction` metodo.</span><span class="sxs-lookup"><span data-stu-id="8340a-148">After the loop this `List(Of T)` must be passed to the `ProductsBLL` class s `DeleteProductsWithTransaction` method.</span></span> <span data-ttu-id="8340a-149">Aggiornamento di `DeleteSelectedProducts` pulsante s `Click` gestore dell'evento con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="8340a-149">Update the `DeleteSelectedProducts` Button s `Click` event handler with the following code:</span></span>


[!code-vb[Main](batch-deleting-vb/samples/sample3.vb)]

<span data-ttu-id="8340a-150">Crea il codice aggiornato un `List(Of T)` di tipo `Integer` (`productIDsToDelete`) e la popola con il `ProductID` valori da eliminare.</span><span class="sxs-lookup"><span data-stu-id="8340a-150">The updated code creates a `List(Of T)` of type `Integer` (`productIDsToDelete`) and populates it with the `ProductID` values to delete.</span></span> <span data-ttu-id="8340a-151">Dopo il `For Each` ciclo, se è presente almeno un prodotto selezionato, il `ProductsBLL` classe s `DeleteProductsWithTransaction` metodo viene chiamato e passato a questo elenco.</span><span class="sxs-lookup"><span data-stu-id="8340a-151">After the `For Each` loop, if there is at least one product selected, the `ProductsBLL` class s `DeleteProductsWithTransaction` method is called and passed this list.</span></span> <span data-ttu-id="8340a-152">Il `DeleteResults` viene visualizzata anche l'etichetta e i dati riassociati a GridView (in modo che i record eliminati appena più visualizzati come righe della griglia).</span><span class="sxs-lookup"><span data-stu-id="8340a-152">The `DeleteResults` Label is also displayed and the data rebound to the GridView (so that the newly-deleted records no longer appear as rows in the grid).</span></span>

<span data-ttu-id="8340a-153">La figura 4 mostra GridView dopo aver selezionato un numero di righe per l'eliminazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-153">Figure 4 shows the GridView after a number of rows have been selected for deletion.</span></span> <span data-ttu-id="8340a-154">Figura 5 mostra la schermata immediatamente dopo aver scelto il pulsante Elimina prodotti selezionati.</span><span class="sxs-lookup"><span data-stu-id="8340a-154">Figure 5 shows the screen immediately after the Delete Selected Products button has been clicked.</span></span> <span data-ttu-id="8340a-155">Si noti che nella figura 5 di `ProductID` nell'etichetta sotto controllo GridView. vengono visualizzati i valori dei record eliminati e le righe non sono più in GridView.</span><span class="sxs-lookup"><span data-stu-id="8340a-155">Note that in Figure 5 the `ProductID` values of the deleted records are displayed in the Label beneath the GridView and those rows are no longer in the GridView.</span></span>


<span data-ttu-id="8340a-156">[![I prodotti selezionati verranno eliminati](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8340a-156">[![The Selected Products Will Be Deleted](batch-deleting-vb/_static/image4.gif)](batch-deleting-vb/_static/image7.png)</span></span>

<span data-ttu-id="8340a-157">**Figura 4**: il selezionati i prodotti verranno eliminati ([fare clic per visualizzare l'immagine ingrandita](batch-deleting-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8340a-157">**Figure 4**: The Selected Products Will Be Deleted ([Click to view full-size image](batch-deleting-vb/_static/image8.png))</span></span>


<span data-ttu-id="8340a-158">[![I valori di ProductID prodotti eliminato sono elencati sotto il controllo GridView.](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8340a-158">[![The Deleted Products ProductID Values are Listed Beneath the GridView](batch-deleting-vb/_static/image5.gif)](batch-deleting-vb/_static/image9.png)</span></span>

<span data-ttu-id="8340a-159">**Figura 5**: il prodotti eliminato `ProductID` i valori sono elencati sotto il controllo GridView. ([fare clic per visualizzare l'immagine ingrandita](batch-deleting-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="8340a-159">**Figure 5**: The Deleted Products `ProductID` Values are Listed Beneath the GridView ([Click to view full-size image](batch-deleting-vb/_static/image10.png))</span></span>


> [!NOTE]
> <span data-ttu-id="8340a-160">Per testare il `DeleteProductsWithTransaction` atomicità metodo s, aggiungere manualmente una voce per un prodotto di `Order Details` tabella e quindi si tenta di eliminare tale prodotto (insieme ad altri utenti).</span><span class="sxs-lookup"><span data-stu-id="8340a-160">To test the `DeleteProductsWithTransaction` method s atomicity, manually add an entry for a product in the `Order Details` table and then attempt to delete that product (along with others).</span></span> <span data-ttu-id="8340a-161">Si riceverà una violazione di vincolo di chiave esterna quando si tenta di eliminare il prodotto con un ordine associato, ma si noti come le altre operazioni di eliminazione prodotti selezionati viene eseguito il rollback.</span><span class="sxs-lookup"><span data-stu-id="8340a-161">You will receive a foreign key constraint violation when attempting to delete the product with an associated order, but note how the other selected products deletions are rolled back.</span></span>


## <a name="summary"></a><span data-ttu-id="8340a-162">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="8340a-162">Summary</span></span>

<span data-ttu-id="8340a-163">Creazione di un batch di eliminazione interfaccia prevede l'aggiunta di un controllo GridView con una colonna di caselle di controllo e un pulsante che, quando selezionato, verranno eliminate tutte le righe selezionate come una singola operazione atomica.</span><span class="sxs-lookup"><span data-stu-id="8340a-163">Creating a batch deleting interface involves adding a GridView with a column of checkboxes and a Button Web control that, when clicked, will delete all of the selected rows as a single atomic operation.</span></span> <span data-ttu-id="8340a-164">In questa esercitazione tale interfaccia è compilata da riunire lavoro svolto in due esercitazioni precedenti, [aggiunta di una colonna di GridView di caselle di controllo](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) e [di wrapping delle modifiche del Database all'interno di una transazione](wrapping-database-modifications-within-a-transaction-vb.md).</span><span class="sxs-lookup"><span data-stu-id="8340a-164">In this tutorial we built such an interface by piecing together work done in two previous tutorials, [Adding a GridView Column of Checkboxes](../enhancing-the-gridview/adding-a-gridview-column-of-checkboxes-vb.md) and [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-vb.md).</span></span> <span data-ttu-id="8340a-165">Nella prima esercitazione è stato creato un GridView con una colonna di caselle di controllo e in quest'ultimo è implementato un metodo in BLL che, quando viene passato un `List(Of T)` di `ProductID` valori, sono stati eliminati nell'ambito di una transazione.</span><span class="sxs-lookup"><span data-stu-id="8340a-165">In the first tutorial we created a GridView with a column of checkboxes and in the latter we implemented a method in the BLL that, when passed a `List(Of T)` of `ProductID` values, deleted them all within the scope of a transaction.</span></span>

<span data-ttu-id="8340a-166">Nella prossima esercitazione si creerà un'interfaccia per l'esecuzione di inserimenti batch.</span><span class="sxs-lookup"><span data-stu-id="8340a-166">In the next tutorial we'll create an interface for performing batch inserts.</span></span>

<span data-ttu-id="8340a-167">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="8340a-167">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="8340a-168">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="8340a-168">About the Author</span></span>

<span data-ttu-id="8340a-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="8340a-169">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8340a-170">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="8340a-170">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8340a-171">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8340a-171">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8340a-172">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8340a-172">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8340a-173">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="8340a-173">Special Thanks To</span></span>

<span data-ttu-id="8340a-174">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="8340a-174">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8340a-175">Lead revisori per questa esercitazione sono stati Hilton Giesenow e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="8340a-175">Lead reviewers for this tutorial were Hilton Giesenow and Teresa Murphy.</span></span> <span data-ttu-id="8340a-176">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="8340a-176">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8340a-177">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8340a-177">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8340a-178">[Precedente](batch-updating-vb.md)
> [Successivo](batch-inserting-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8340a-178">[Previous](batch-updating-vb.md)
[Next](batch-inserting-vb.md)</span></span>

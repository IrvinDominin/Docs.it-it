---
uid: web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
title: Batch di inserimento (c#) | Documenti Microsoft
author: rick-anderson
description: Informazioni su come inserire più record di database in un'unica operazione. Il Layer dell'interfaccia utente estende GridView per consentire all'utente di immettere più di n...
ms.author: aspnetcontent
manager: wpickett
ms.date: 06/26/2007
ms.topic: article
ms.assetid: cf025e08-48fc-4385-b176-8610aa7b5565
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-batched-data/batch-inserting-cs
msc.type: authoredcontent
ms.openlocfilehash: c8995592d9206fb17a7769414212369946304c54
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30888409"
---
<a name="batch-inserting-c"></a><span data-ttu-id="54b7c-104">Batch di inserimento (c#)</span><span class="sxs-lookup"><span data-stu-id="54b7c-104">Batch Inserting (C#)</span></span>
====================
<span data-ttu-id="54b7c-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="54b7c-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="54b7c-106">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) o [Scarica il PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="54b7c-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_66_CS.zip) or [Download PDF](batch-inserting-cs/_static/datatutorial66cs1.pdf)</span></span>

> <span data-ttu-id="54b7c-107">Informazioni su come inserire più record di database in un'unica operazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-107">Learn how to insert multiple database records in a single operation.</span></span> <span data-ttu-id="54b7c-108">Il Layer dell'interfaccia utente estende GridView per consentire all'utente di immettere più nuovi record.</span><span class="sxs-lookup"><span data-stu-id="54b7c-108">In the User Interface Layer we extend the GridView to allow the user to enter multiple new records.</span></span> <span data-ttu-id="54b7c-109">Nel livello di accesso ai dati si eseguono il wrapping di più operazioni di inserimento all'interno di una transazione per garantire che tutti gli inserimenti completata o viene eseguito il rollback di tutte le operazioni di inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-109">In the Data Access Layer we wrap the multiple Insert operations within a transaction to ensure that all insertions succeed or all insertions are rolled back.</span></span>


## <a name="introduction"></a><span data-ttu-id="54b7c-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="54b7c-110">Introduction</span></span>

<span data-ttu-id="54b7c-111">Nel [l'aggiornamento in Batch](batch-updating-cs.md) esercitazione è stato esaminato personalizzazione del controllo GridView per presentare un'interfaccia in cui più record sono modificabili.</span><span class="sxs-lookup"><span data-stu-id="54b7c-111">In the [Batch Updating](batch-updating-cs.md) tutorial we looked at customizing the GridView control to present an interface where multiple records were editable.</span></span> <span data-ttu-id="54b7c-112">L'utente visita la pagina potrebbe eseguire una serie di modifiche e quindi, con un singolo clic del pulsante, eseguire un aggiornamento batch.</span><span class="sxs-lookup"><span data-stu-id="54b7c-112">The user visiting the page could make a series of changes and then, with a single button click, perform a batch update.</span></span> <span data-ttu-id="54b7c-113">Per situazioni in cui gli utenti in genere aggiornano il numero di record in un'unica operazione, tale interfaccia consente di risparmiare innumerevoli clic e commutazioni di tastiera per mouse rispetto all'impostazione predefinita le funzionalità di modifica che sono state illustrate innanzitutto in per ogni riga di [un Panoramica di inserimento, aggiornamento ed eliminazione di dati](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-113">For situations where users commonly update many records in one go, such an interface can save countless clicks and keyboard-to-mouse context switches when compared to the default per-row editing features that were first explored back in the [An Overview of Inserting, Updating, and Deleting Data](../editing-inserting-and-deleting-data/an-overview-of-inserting-updating-and-deleting-data-cs.md) tutorial.</span></span>

<span data-ttu-id="54b7c-114">Questo concetto può inoltre essere applicato durante l'aggiunta di record.</span><span class="sxs-lookup"><span data-stu-id="54b7c-114">This concept can also be applied when adding records.</span></span> <span data-ttu-id="54b7c-115">Si supponga che in questo caso Northwind Traders comunemente riceviamo spedizioni fornitori che contengono un numero di prodotti per una categoria specifica.</span><span class="sxs-lookup"><span data-stu-id="54b7c-115">Imagine that here at Northwind Traders we commonly receive shipments from suppliers that contain a number of products for a particular category.</span></span> <span data-ttu-id="54b7c-116">Ad esempio, potrebbe essere riceviamo una spedizione di sei diversi tè e prodotti Tokyo Traders.</span><span class="sxs-lookup"><span data-stu-id="54b7c-116">As an example, we might receive a shipment of six different tea and coffee products from Tokyo Traders.</span></span> <span data-ttu-id="54b7c-117">Se un utente immette i sei prodotti uno alla volta tramite un controllo DetailsView, sarà necessario scegliere molti degli stessi valori in modo continuativo: sarà necessario scegliere la stessa categoria (bibite), il fornitore stesso (Tokyo Traders), lo stesso sospeso (valore False) e le stesse unità nel valore dell'ordine (0).</span><span class="sxs-lookup"><span data-stu-id="54b7c-117">If a user enters the six products one at a time through a DetailsView control, they will have to choose many of the same values over and over again: they will need to choose the same category (Beverages), the same supplier (Tokyo Traders), the same discontinued value (False), and the same units on order value (0).</span></span> <span data-ttu-id="54b7c-118">Questa voce di dati ripetitivi non solo molto tempo, ma è soggetta a errori.</span><span class="sxs-lookup"><span data-stu-id="54b7c-118">This repetitive data entry is not only time consuming, but is prone to errors.</span></span>

<span data-ttu-id="54b7c-119">Con un minimo sforzo è possibile creare un batch di inserimento di interfaccia che consente all'utente di scegliere il fornitore e la categoria una volta, immettere una serie di nomi di prodotto e prezzo unitario minore e quindi fare clic su un pulsante per aggiungere i nuovi prodotti nel database (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="54b7c-119">With a little work we can create a batch inserting interface that enables the user to choose the supplier and category once, enter a series of product names and unit prices, and then click a button to add the new products to the database (see Figure 1).</span></span> <span data-ttu-id="54b7c-120">Poiché viene aggiunto ogni prodotto, il relativo `ProductName` e `UnitPrice` campi dati vengono assegnati i valori immessi nelle caselle di testo, mentre il `CategoryID` e `SupplierID` valori vengono assegnati i valori da controlli di DropDownList nel fo superiore, il modulo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-120">As each product is added, its `ProductName` and `UnitPrice` data fields are assigned the values entered in the TextBoxes, while its `CategoryID` and `SupplierID` values are assigned the values from the DropDownLists at the top fo the form.</span></span> <span data-ttu-id="54b7c-121">Il `Discontinued` e `UnitsOnOrder` valori vengono impostati i valori hardcoded di `false` e 0, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-121">The `Discontinued` and `UnitsOnOrder` values are set to the hard-coded values of `false` and 0, respectively.</span></span>


<span data-ttu-id="54b7c-122">[![L'interfaccia di inserimento Batch](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-122">[![The Batch Inserting Interface](batch-inserting-cs/_static/image2.png)](batch-inserting-cs/_static/image1.png)</span></span>

<span data-ttu-id="54b7c-123">**Figura 1**: l'interfaccia di inserimento Batch ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-123">**Figure 1**: The Batch Inserting Interface ([Click to view full-size image](batch-inserting-cs/_static/image3.png))</span></span>


<span data-ttu-id="54b7c-124">In questa esercitazione si creerà una pagina che implementa il batch inserimento interfaccia illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="54b7c-124">In this tutorial we will create a page that implements the batch inserting interface shown in Figure 1.</span></span> <span data-ttu-id="54b7c-125">Come con le esercitazioni di due precedenti, si eseguirà il wrapping gli inserimenti all'interno dell'ambito di una transazione per garantire l'atomicità.</span><span class="sxs-lookup"><span data-stu-id="54b7c-125">As with the previous two tutorials, we will wrap the insertions within the scope of a transaction to ensure atomicity.</span></span> <span data-ttu-id="54b7c-126">Let s iniziare!</span><span class="sxs-lookup"><span data-stu-id="54b7c-126">Let s get started!</span></span>

## <a name="step-1-creating-the-display-interface"></a><span data-ttu-id="54b7c-127">Passaggio 1: Creazione dell'interfaccia di visualizzazione</span><span class="sxs-lookup"><span data-stu-id="54b7c-127">Step 1: Creating the Display Interface</span></span>

<span data-ttu-id="54b7c-128">In questa esercitazione sarà costituito da una singola pagina divisa in due aree: un'area di visualizzazione e un'area di inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-128">This tutorial will consist of a single page that is divided into two regions: a display region and an inserting region.</span></span> <span data-ttu-id="54b7c-129">L'interfaccia di visualizzazione, che verrà creata in questo passaggio, Mostra i prodotti in un controllo GridView e include un pulsante denominato processo di spedizione del prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-129">The display interface, which we'll create in this step, shows the products in a GridView and includes a button titled Process Product Shipment.</span></span> <span data-ttu-id="54b7c-130">Quando viene fatto clic su questo pulsante, l'interfaccia di visualizzazione viene sostituito con l'interfaccia di inserimento, come illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="54b7c-130">When this button is clicked, the display interface is replaced with the inserting interface, which is shown in Figure 1.</span></span> <span data-ttu-id="54b7c-131">L'interfaccia di visualizzazione restituisce dopo Aggiungi prodotti da spedizione o vengono selezionati i pulsanti Annulla.</span><span class="sxs-lookup"><span data-stu-id="54b7c-131">The display interface returns after the Add Products from Shipment or Cancel buttons are clicked.</span></span> <span data-ttu-id="54b7c-132">L'interfaccia di inserimento verrà creata nel passaggio 2.</span><span class="sxs-lookup"><span data-stu-id="54b7c-132">We'll create the inserting interface in Step 2.</span></span>

<span data-ttu-id="54b7c-133">Quando la creazione di una pagina che ha due interfacce, solo uno dei quali è visibile alla volta, ogni interfaccia in genere viene inserito all'interno di un [controllo Web Panel](http://www.w3schools.com/aspnet/control_panel.asp), che funge da contenitore per altri controlli.</span><span class="sxs-lookup"><span data-stu-id="54b7c-133">When creating a page that has two interfaces, only one of which is visible at a time, each interface typically is placed within a [Panel Web control](http://www.w3schools.com/aspnet/control_panel.asp), which serves as a container for other controls.</span></span> <span data-ttu-id="54b7c-134">La pagina sarà pertanto presenti due controlli pannello uno per ogni interfaccia.</span><span class="sxs-lookup"><span data-stu-id="54b7c-134">Therefore, our page will have two Panel controls one for each interface.</span></span>

<span data-ttu-id="54b7c-135">Aprire il `BatchInsert.aspx` nella pagina di `BatchData` cartelle e trascinare un pannello dalla casella degli strumenti nella finestra di progettazione (vedere la figura 2).</span><span class="sxs-lookup"><span data-stu-id="54b7c-135">Start by opening the `BatchInsert.aspx` page in the `BatchData` folder and drag a Panel from the Toolbox onto the Designer (see Figure 2).</span></span> <span data-ttu-id="54b7c-136">Impostare il pannello s `ID` proprietà `DisplayInterface`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-136">Set the Panel s `ID` property to `DisplayInterface`.</span></span> <span data-ttu-id="54b7c-137">Quando si aggiunge il pannello alla finestra di progettazione, il relativo `Height` e `Width` proprietà vengono impostate su 50px e 125px, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-137">When adding the Panel to the Designer, its `Height` and `Width` properties are set to 50px and 125px, respectively.</span></span> <span data-ttu-id="54b7c-138">Cancellare i valori delle proprietà dalla finestra delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="54b7c-138">Clear out these property values from the Properties window.</span></span>


<span data-ttu-id="54b7c-139">[![Trascinare un pannello dalla casella degli strumenti nella finestra di progettazione](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-139">[![Drag a Panel from the Toolbox onto the Designer](batch-inserting-cs/_static/image5.png)](batch-inserting-cs/_static/image4.png)</span></span>

<span data-ttu-id="54b7c-140">**Figura 2**: trascinare un pannello dalla casella degli strumenti nella finestra di progettazione ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-140">**Figure 2**: Drag a Panel from the Toolbox onto the Designer ([Click to view full-size image](batch-inserting-cs/_static/image6.png))</span></span>


<span data-ttu-id="54b7c-141">Successivamente, trascinare un controllo pulsante e GridView nel pannello.</span><span class="sxs-lookup"><span data-stu-id="54b7c-141">Next, drag a Button and GridView control into the Panel.</span></span> <span data-ttu-id="54b7c-142">Impostare il pulsante s `ID` proprietà `ProcessShipment` e il relativo `Text` proprietà processo di spedizione del prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-142">Set the Button s `ID` property to `ProcessShipment` and its `Text` property to Process Product Shipment.</span></span> <span data-ttu-id="54b7c-143">Impostare i dispositivi di GridView `ID` proprietà `ProductsGrid` e dal suo smart tag, associarlo a un nuovo oggetto ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-143">Set the GridView s `ID` property to `ProductsGrid` and, from its smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="54b7c-144">Configurare ObjectDataSource per estrarre i dati di `ProductsBLL` classe s `GetProducts` metodo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-144">Configure the ObjectDataSource to pull its data from the `ProductsBLL` class s `GetProducts` method.</span></span> <span data-ttu-id="54b7c-145">Poiché questo GridView viene utilizzato solo per visualizzare i dati, impostare gli elenchi a discesa nell'aggiornamento, inserimento ed eliminare le schede su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="54b7c-145">Since this GridView is used only to display data, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None).</span></span> <span data-ttu-id="54b7c-146">Fare clic su Fine per completare la configurazione guidata origine dati.</span><span class="sxs-lookup"><span data-stu-id="54b7c-146">Click Finish to complete the Configure Data Source wizard.</span></span>


<span data-ttu-id="54b7c-147">[![Visualizzare i dati restituiti dal metodo GetProducts ProductsBLL classe s](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-147">[![Display the Data Returned from the ProductsBLL Class s GetProducts Method](batch-inserting-cs/_static/image8.png)](batch-inserting-cs/_static/image7.png)</span></span>

<span data-ttu-id="54b7c-148">**Figura 3**: visualizzare i dati restituiti dal `ProductsBLL` classe s `GetProducts` metodo ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-148">**Figure 3**: Display the Data Returned from the `ProductsBLL` Class s `GetProducts` Method ([Click to view full-size image](batch-inserting-cs/_static/image9.png))</span></span>


<span data-ttu-id="54b7c-149">[![Impostare gli elenchi a discesa in UPDATE, INSERT ed eliminare le tabulazioni su (nessuno)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-149">[![Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None)](batch-inserting-cs/_static/image11.png)](batch-inserting-cs/_static/image10.png)</span></span>

<span data-ttu-id="54b7c-150">**Figura 4**: impostare l'elenco a discesa sono elencati nelle schede DELETE, INSERT e UPDATE (nessuno) ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-150">**Figure 4**: Set the Drop-Down Lists in the UPDATE, INSERT, and DELETE Tabs to (None) ([Click to view full-size image](batch-inserting-cs/_static/image12.png))</span></span>


<span data-ttu-id="54b7c-151">Dopo aver completato la procedura guidata ObjectDataSource, Visual Studio aggiungerà BoundField e un CheckBoxField per i campi di dati di prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-151">After completing the ObjectDataSource wizard, Visual Studio will add BoundFields and a CheckBoxField for the product data fields.</span></span> <span data-ttu-id="54b7c-152">Rimuovere tutto tranne il `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, e `Discontinued` campi.</span><span class="sxs-lookup"><span data-stu-id="54b7c-152">Remove all but the `ProductName`, `CategoryName`, `SupplierName`, `UnitPrice`, and `Discontinued` fields.</span></span> <span data-ttu-id="54b7c-153">È possibile apportare le personalizzazioni estetiche.</span><span class="sxs-lookup"><span data-stu-id="54b7c-153">Feel free to make any aesthetic customizations.</span></span> <span data-ttu-id="54b7c-154">Ho deciso di formattare il `UnitPrice` campo come valore di valuta, riordinare i campi e molti dei campi rinominati `HeaderText` valori.</span><span class="sxs-lookup"><span data-stu-id="54b7c-154">I decided to format the `UnitPrice` field as a currency value, reordered the fields, and renamed several of the fields `HeaderText` values.</span></span> <span data-ttu-id="54b7c-155">Configurare inoltre GridView per includere il paging e supporto per l'ordinamento selezionando le caselle di controllo Abilita Paging e Abilita ordinamento nello smart tag GridView s.</span><span class="sxs-lookup"><span data-stu-id="54b7c-155">Also configure the GridView to include paging and sorting support by checking the Enable Paging and Enable Sorting checkboxes in the GridView s smart tag.</span></span>

<span data-ttu-id="54b7c-156">Dopo aver aggiunto i controlli pannello, pulsante, GridView e ObjectDataSource e personalizzare i campi s GridView, markup dichiarativo pagina s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="54b7c-156">After adding the Panel, Button, GridView, and ObjectDataSource controls and customizing the GridView s fields, your page s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](batch-inserting-cs/samples/sample1.aspx)]

<span data-ttu-id="54b7c-157">Si noti che il markup per il pulsante e GridView visualizzati all'interno di apertura e chiusura `<asp:Panel>` tag.</span><span class="sxs-lookup"><span data-stu-id="54b7c-157">Note that the markup for the Button and GridView appear within the opening and closing `<asp:Panel>` tags.</span></span> <span data-ttu-id="54b7c-158">Poiché questi controlli sono all'interno di `DisplayInterface` pannello, è possibile nasconderle impostando semplicemente il pannello s `Visible` proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-158">Since these controls are within the `DisplayInterface` Panel, we can hide them by simply setting the Panel s `Visible` property to `false`.</span></span> <span data-ttu-id="54b7c-159">Passaggio 3 esamina la modifica a livello di codice il pannello s `Visible` fare clic su proprietà in risposta a un pulsante per visualizzare un'interfaccia e l'altro nasconderla.</span><span class="sxs-lookup"><span data-stu-id="54b7c-159">Step 3 looks at programmatically changing the Panel s `Visible` property in response to a button click to show one interface while hiding the other.</span></span>

<span data-ttu-id="54b7c-160">Richiedere qualche istante per visualizzare l'avanzamento attraverso un browser.</span><span class="sxs-lookup"><span data-stu-id="54b7c-160">Take a moment to view our progress through a browser.</span></span> <span data-ttu-id="54b7c-161">Come illustrato nella figura 5, si verrà visualizzato un pulsante di spedizione del prodotto processo di sopra di un controllo GridView in cui sono elencati i prodotti dieci alla volta.</span><span class="sxs-lookup"><span data-stu-id="54b7c-161">As Figure 5 shows, you should see a Process Product Shipment button above a GridView that lists the products ten at a time.</span></span>


<span data-ttu-id="54b7c-162">[![GridView sono elencati i prodotti e offre l'ordinamento e le funzionalità di Paging](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-162">[![The GridView Lists the Products and Offers Sorting and Paging Capabilities](batch-inserting-cs/_static/image14.png)](batch-inserting-cs/_static/image13.png)</span></span>

<span data-ttu-id="54b7c-163">**Figura 5**: GridView sono elencati i prodotti e offre l'ordinamento e le funzionalità di Paging ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-163">**Figure 5**: The GridView Lists the Products and Offers Sorting and Paging Capabilities ([Click to view full-size image](batch-inserting-cs/_static/image15.png))</span></span>


## <a name="step-2-creating-the-inserting-interface"></a><span data-ttu-id="54b7c-164">Passaggio 2: Creazione dell'interfaccia di inserimento</span><span class="sxs-lookup"><span data-stu-id="54b7c-164">Step 2: Creating the Inserting Interface</span></span>

<span data-ttu-id="54b7c-165">Con l'interfaccia di visualizzazione completa, è nuovamente pronto per creare l'inserimento di interfaccia.</span><span class="sxs-lookup"><span data-stu-id="54b7c-165">With the display interface complete, we re ready to create the inserting interface.</span></span> <span data-ttu-id="54b7c-166">Per questa esercitazione, lasciare s creare un'interfaccia di inserimento che richiede un singolo valore di categoria e fornitore e quindi consente all'utente di immettere fino a cinque nomi di prodotto e i valori di unità di prezzo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-166">For this tutorial, let s create an inserting interface that prompts for a single supplier and category value and then allows the user to enter up to five product names and unit price values.</span></span> <span data-ttu-id="54b7c-167">Con questa interfaccia, l'utente può aggiungere un massimo di cinque nuovi prodotti che condividono la stessa categoria e il fornitore, ma di prezzi e i nomi di prodotto univoco.</span><span class="sxs-lookup"><span data-stu-id="54b7c-167">With this interface, the user can add one to five new products that all share the same category and supplier, but have unique product names and prices.</span></span>

<span data-ttu-id="54b7c-168">Avvio mediante il trascinamento di un pannello dalla casella degli strumenti nella finestra di progettazione, posizionarlo sotto esistente `DisplayInterface` pannello.</span><span class="sxs-lookup"><span data-stu-id="54b7c-168">Start by dragging a Panel from the Toolbox onto the Designer, placing it beneath the existing `DisplayInterface` Panel.</span></span> <span data-ttu-id="54b7c-169">Impostare il `ID` Pannello di aggiunta di proprietà di questo `InsertingInterface` e impostare il relativo `Visible` proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-169">Set the `ID` property of this newly added Panel to `InsertingInterface` and set its `Visible` property to `false`.</span></span> <span data-ttu-id="54b7c-170">Verrà aggiunto codice che imposta il `InsertingInterface` pannello s `Visible` proprietà `true` nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="54b7c-170">We'll add code that sets the `InsertingInterface` Panel s `Visible` property to `true` in Step 3.</span></span> <span data-ttu-id="54b7c-171">Cancellare anche il pannello s `Height` e `Width` i valori delle proprietà.</span><span class="sxs-lookup"><span data-stu-id="54b7c-171">Also clear out the Panel s `Height` and `Width` property values.</span></span>

<span data-ttu-id="54b7c-172">Successivamente, è necessario creare l'interfaccia di inserimento che è stato illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="54b7c-172">Next, we need to create the inserting interface that was shown back in Figure 1.</span></span> <span data-ttu-id="54b7c-173">Questa interfaccia può essere creata tramite varie tecniche HTML, ma verrà utilizzata una semplice: una tabella di sette righe e quattro colonne.</span><span class="sxs-lookup"><span data-stu-id="54b7c-173">This interface can be created through a variety of HTML techniques, but we will use a fairly straightforward one: a four-column, seven-row table.</span></span>

> [!NOTE]
> <span data-ttu-id="54b7c-174">Quando si immettono markup per HTML `<table>` elementi, è preferibile utilizzare la vista di origine.</span><span class="sxs-lookup"><span data-stu-id="54b7c-174">When entering markup for HTML `<table>` elements, I prefer to use the Source view.</span></span> <span data-ttu-id="54b7c-175">Mentre in Visual Studio sono strumenti per l'aggiunta di `<table>` elementi tramite la finestra di progettazione, sembra tutti troppo disposto a inserire la finestra di progettazione non richiesto non desiderato per `style` impostazioni nel markup.</span><span class="sxs-lookup"><span data-stu-id="54b7c-175">While Visual Studio does have tools for adding `<table>` elements through the Designer, the Designer seems all too willing to inject unasked for `style` settings into the markup.</span></span> <span data-ttu-id="54b7c-176">Dopo aver creato il `<table>` markup, in genere visualizzare nella finestra di progettazione per aggiungere i controlli Web e impostare le relative proprietà.</span><span class="sxs-lookup"><span data-stu-id="54b7c-176">Once I have created the `<table>` markup, I usually return to the Designer to add the Web controls and set their properties.</span></span> <span data-ttu-id="54b7c-177">Durante la creazione di tabelle con colonne predeterminate e righe preferisce utilizzare HTML statico invece di [controllo Web Table](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) perché tutti i controlli Web inseriti all'interno di un controllo tabella Web è possibile accedere solo tramite il `FindControl("controlID")` modello.</span><span class="sxs-lookup"><span data-stu-id="54b7c-177">When creating tables with pre-determined columns and rows I prefer using static HTML rather than the [Table Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.table.aspx) because any Web controls placed within a Table Web control can only be accessed using the `FindControl("controlID")` pattern.</span></span> <span data-ttu-id="54b7c-178">, Tuttavia, usare i controlli Web di tabella per le tabelle di dimensioni in modo dinamico (quelli il cui righe o colonne si basano su alcuni database o i criteri specificati dall'utente), dal Web tabella controllo può essere costruito a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="54b7c-178">I do, however, use Table Web controls for dynamically-sized tables (ones whose rows or columns are based on some database or user-specified criteria), since the Table Web control can be constructed programmatically.</span></span>


<span data-ttu-id="54b7c-179">Immettere il seguente codice all'interno di `<asp:Panel>` tag del `InsertingInterface` pannello:</span><span class="sxs-lookup"><span data-stu-id="54b7c-179">Enter the following markup within the `<asp:Panel>` tags of the `InsertingInterface` Panel:</span></span>


[!code-html[Main](batch-inserting-cs/samples/sample2.html)]

<span data-ttu-id="54b7c-180">Questo `<table>` markup non include tutti i controlli Web ancora, aggiungeremo quelli temporaneamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-180">This `<table>` markup does not include any Web controls yet, we'll add those momentarily.</span></span> <span data-ttu-id="54b7c-181">Si noti che ogni `<tr>` elemento contiene una particolare impostazione classe CSS: `BatchInsertHeaderRow` per la riga di intestazione in cui verrà salvato il fornitore e la categoria controlli DropDownList; `BatchInsertFooterRow` per la riga di piè di pagina in cui verrà salvato; Aggiungi prodotti di spedizione e pulsanti Annulla e alternati `BatchInsertRow` e `BatchInsertAlternatingRow` i valori per le righe contenenti il prodotto e l'unità di prezzo controlli casella di testo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-181">Note that each `<tr>` element contains a particular CSS class setting: `BatchInsertHeaderRow` for the header row where the supplier and category DropDownLists will go; `BatchInsertFooterRow` for the footer row where the Add Products from Shipment and Cancel Buttons will go; and alternating `BatchInsertRow` and `BatchInsertAlternatingRow` values for the rows that will contain the product and unit price TextBox controls.</span></span> <span data-ttu-id="54b7c-182">Ho creato classi CSS corrispondenti di `Styles.css` file per fornire l'interfaccia di inserimento di un aspetto simile a GridView e DetailsView controlla si va utilizzata in queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="54b7c-182">I ve created corresponding CSS classes in the `Styles.css` file to give the inserting interface an appearance similar to the GridView and DetailsView controls we ve used throughout these tutorials.</span></span> <span data-ttu-id="54b7c-183">Queste classi CSS è illustrate di seguito.</span><span class="sxs-lookup"><span data-stu-id="54b7c-183">These CSS classes are shown below.</span></span>


[!code-css[Main](batch-inserting-cs/samples/sample3.css)]

<span data-ttu-id="54b7c-184">Con questo markup immesso, tornare alla visualizzazione progettazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-184">With this markup entered, return to the Design view.</span></span> <span data-ttu-id="54b7c-185">Questo `<table>` dovrà essere visualizzato in una tabella di sette righe e quattro colonne nella finestra di progettazione, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="54b7c-185">This `<table>` should show as a four-column, seven-row table in the Designer, as Figure 6 illustrates.</span></span>


<span data-ttu-id="54b7c-186">[![L'interfaccia di inserimento è costituito da quattro-di una colonna tabella sette righe](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-186">[![The Inserting Interface is Composed of a Four-Column, Seven-Row Table](batch-inserting-cs/_static/image17.png)](batch-inserting-cs/_static/image16.png)</span></span>

<span data-ttu-id="54b7c-187">**Figura 6**: l'interfaccia di inserimento è costituito da quattro-di una colonna tabella sette righe ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-187">**Figure 6**: The Inserting Interface is Composed of a Four-Column, Seven-Row Table ([Click to view full-size image](batch-inserting-cs/_static/image18.png))</span></span>


<span data-ttu-id="54b7c-188">È re ora pronti per aggiungere i controlli Web per l'interfaccia di inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-188">We re now ready to add the Web controls to the inserting interface.</span></span> <span data-ttu-id="54b7c-189">Trascinare due controlli DropDownList dalla casella degli strumenti nelle celle della tabella per il fornitore e uno per la categoria appropriate.</span><span class="sxs-lookup"><span data-stu-id="54b7c-189">Drag two DropDownLists from the Toolbox into the appropriate cells in the table one for the supplier and one for the category.</span></span>

<span data-ttu-id="54b7c-190">Impostare il fornitore DropDownList s `ID` proprietà `Suppliers` e associarlo a un nuovo oggetto ObjectDataSource denominato `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-190">Set the supplier DropDownList s `ID` property to `Suppliers` and bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="54b7c-191">Configura il nuovo ObjectDataSource per recuperare i dati di `SuppliersBLL` classe s `GetSuppliers` metodo e impostare l'aggiornamento scheda elenco a discesa s su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="54b7c-191">Configure the new ObjectDataSource to retrieve its data from the `SuppliersBLL` class s `GetSuppliers` method and set the UPDATE tab s drop-down list to (None).</span></span> <span data-ttu-id="54b7c-192">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="54b7c-192">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="54b7c-193">[![Configurare ObjectDataSource per utilizzare il metodo GetSuppliers SuppliersBLL classe s](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-193">[![Configure the ObjectDataSource to Use the SuppliersBLL Class s GetSuppliers Method](batch-inserting-cs/_static/image20.png)](batch-inserting-cs/_static/image19.png)</span></span>

<span data-ttu-id="54b7c-194">**Figura 7**: configurare ObjectDataSource per utilizzare il `SuppliersBLL` classe s `GetSuppliers` metodo ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-194">**Figure 7**: Configure the ObjectDataSource to Use the `SuppliersBLL` Class s `GetSuppliers` Method ([Click to view full-size image](batch-inserting-cs/_static/image21.png))</span></span>


<span data-ttu-id="54b7c-195">Dispone il `Suppliers` DropDownList visualizzazione il `CompanyName` campo dati e utilizzare il `SupplierID` campo dati come relativo `ListItem` valori s.</span><span class="sxs-lookup"><span data-stu-id="54b7c-195">Have the `Suppliers` DropDownList display the `CompanyName` data field and use the `SupplierID` data field as its `ListItem` s values.</span></span>


<span data-ttu-id="54b7c-196">[![Visualizzare il campo dei dati di CompanyName e utilizzare SupplierID uguale al valore](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-196">[![Display the CompanyName Data Field and Use SupplierID as the Value](batch-inserting-cs/_static/image23.png)](batch-inserting-cs/_static/image22.png)</span></span>

<span data-ttu-id="54b7c-197">**Figura 8**: visualizzazione di `CompanyName` campo dati e utilizzare `SupplierID` come valore ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-197">**Figure 8**: Display the `CompanyName` Data Field and Use `SupplierID` as the Value ([Click to view full-size image](batch-inserting-cs/_static/image24.png))</span></span>


<span data-ttu-id="54b7c-198">Nome DropDownList secondo `Categories` e associarlo a un nuovo oggetto ObjectDataSource denominato `CategoriesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-198">Name the second DropDownList `Categories` and bind it to a new ObjectDataSource named `CategoriesDataSource`.</span></span> <span data-ttu-id="54b7c-199">Configurare il `CategoriesDataSource` ObjectDataSource per utilizzare il `CategoriesBLL` classe s `GetCategories` (metodo); impostare l'elenco a discesa sono elencati in schede UPDATE e DELETE su (nessuno) e fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="54b7c-199">Configure the `CategoriesDataSource` ObjectDataSource to use the `CategoriesBLL` class s `GetCategories` method; set the drop-down lists in the UPDATE and DELETE tabs to (None) and click Finish to complete the wizard.</span></span> <span data-ttu-id="54b7c-200">Infine, avere la visualizzazione DropDownList il `CategoryName` campo dati e utilizzare il `CategoryID` come valore.</span><span class="sxs-lookup"><span data-stu-id="54b7c-200">Finally, have the DropDownList display the `CategoryName` data field and use the `CategoryID` as the value.</span></span>

<span data-ttu-id="54b7c-201">Dopo questi due controlli DropDownList aggiunto e associato a ObjectDataSources configurato in modo appropriato, la schermata dovrebbe essere simile alla figura 9.</span><span class="sxs-lookup"><span data-stu-id="54b7c-201">After these two DropDownLists have been added and bound to appropriately configured ObjectDataSources, your screen should look similar to Figure 9.</span></span>


<span data-ttu-id="54b7c-202">[![La riga di intestazione contiene ora i fornitori e i controlli DropDownList categorie](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-202">[![The Header Row Now Contains the Suppliers and Categories DropDownLists](batch-inserting-cs/_static/image26.png)](batch-inserting-cs/_static/image25.png)</span></span>

<span data-ttu-id="54b7c-203">**Figura 9**: l'intestazione di riga contiene ora il `Suppliers` e `Categories` controlli DropDownList ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-203">**Figure 9**: The Header Row Now Contains the `Suppliers` and `Categories` DropDownLists ([Click to view full-size image](batch-inserting-cs/_static/image27.png))</span></span>


<span data-ttu-id="54b7c-204">È ora necessario creare caselle di testo per raccogliere il nome e il prezzo per ogni nuovo prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-204">We now need to create the TextBoxes to collect the name and price for each new product.</span></span> <span data-ttu-id="54b7c-205">Trascinare un controllo casella di testo dalla casella degli strumenti nella finestra di progettazione per ognuna delle righe di nome e il prezzo del cinque prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-205">Drag a TextBox control from the Toolbox onto the Designer for each of the five product name and price rows.</span></span> <span data-ttu-id="54b7c-206">Impostare il `ID` le proprietà delle caselle di testo per `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`e così via.</span><span class="sxs-lookup"><span data-stu-id="54b7c-206">Set the `ID` properties of the TextBoxes to `ProductName1`, `UnitPrice1`, `ProductName2`, `UnitPrice2`, `ProductName3`, `UnitPrice3`, and so on.</span></span>

<span data-ttu-id="54b7c-207">Aggiungere un controllo CompareValidator dopo ogni del prezzo unitario nelle caselle di testo, l'impostazione di `ControlToValidate` proprietà appropriati `ID`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-207">Add a CompareValidator after each of the unit price TextBoxes, setting the `ControlToValidate` property to the appropriate `ID`.</span></span> <span data-ttu-id="54b7c-208">Impostare inoltre il `Operator` proprietà `GreaterThanEqual`, `ValueToCompare` su 0, e `Type` per `Currency`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-208">Also set the `Operator` property to `GreaterThanEqual`, `ValueToCompare` to 0, and `Type` to `Currency`.</span></span> <span data-ttu-id="54b7c-209">Queste impostazioni indicano CompareValidator per assicurarsi che il prezzo, se specificato, è un valore di valuta validi che è maggiore o uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="54b7c-209">These settings instruct the CompareValidator to ensure that the price, if entered, is a valid currency value that is greater than or equal to zero.</span></span> <span data-ttu-id="54b7c-210">Impostare il `Text` proprietà \*, e `ErrorMessage` al prezzo deve essere maggiore o uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="54b7c-210">Set the `Text` property to \*, and `ErrorMessage` to The price must be greater than or equal to zero.</span></span> <span data-ttu-id="54b7c-211">Inoltre, per omettere i simboli di valuta.</span><span class="sxs-lookup"><span data-stu-id="54b7c-211">Also, please omit any currency symbols.</span></span>

> [!NOTE]
> <span data-ttu-id="54b7c-212">L'inserimento di interfaccia non include tutti i controlli RequiredFieldValidator, anche se il `ProductName` campo il `Products` non consente la tabella di database `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="54b7c-212">The inserting interface does not include any RequiredFieldValidator controls, even though the `ProductName` field in the `Products` database table does not allow `NULL` values.</span></span> <span data-ttu-id="54b7c-213">In questo modo si desidera consentire all'utente di immettere fino a cinque prodotti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-213">This is because we want to let the user enter up to five products.</span></span> <span data-ttu-id="54b7c-214">Ad esempio, se l'utente per fornire il prezzo del prodotto, nome e l'unità per le prime tre righe, lasciando vuota, le ultime due righe d è sufficiente aggiungere tre nuovi prodotti al sistema.</span><span class="sxs-lookup"><span data-stu-id="54b7c-214">For example, if the user were to provide the product name and unit price for the first three rows, leaving the last two rows blank, we d just add three new products to the system.</span></span> <span data-ttu-id="54b7c-215">Poiché `ProductName` è obbligatorio, tuttavia, è necessario controllare a livello di codice per assicurarsi che se un prezzo unitario viene immesso viene fornito un valore di nome di prodotto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-215">Since `ProductName` is required, however, we will need to programmatically check to ensure that if a unit price is entered that a corresponding product name value is provided.</span></span> <span data-ttu-id="54b7c-216">È possibile affrontare questo controllo nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="54b7c-216">We'll tackle this check in Step 4.</span></span>


<span data-ttu-id="54b7c-217">Quando si convalida l'input dell'utente s, il controllo CompareValidator report dati non valido se il valore contiene un simbolo di valuta.</span><span class="sxs-lookup"><span data-stu-id="54b7c-217">When validating the user s input, the CompareValidator reports invalid data if the value contains a currency symbol.</span></span> <span data-ttu-id="54b7c-218">Aggiungere un $ all'inizio di ogni del prezzo unitario nelle caselle di testo come un segnale visivo che indica all'utente di omettere il simbolo di valuta, quando si immette il prezzo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-218">Add a $ in front of each of the unit price TextBoxes to serve as a visual cue that instructs the user to omit the currency symbol when entering the price.</span></span>

<span data-ttu-id="54b7c-219">Infine, aggiungere un controllo ValidationSummary all'interno di `InsertingInterface` pannello impostazioni relativo `ShowMessageBox` proprietà `true` e il relativo `ShowSummary` proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-219">Lastly, add a ValidationSummary control within the `InsertingInterface` Panel, settings its `ShowMessageBox` property to `true` and its `ShowSummary` property to `false`.</span></span> <span data-ttu-id="54b7c-220">Con queste impostazioni, se l'utente immette un valore del prezzo unitario non valido, verrà visualizzato un asterisco accanto i controlli casella di testo contenente l'errore e il controllo ValidationSummary visualizzerà una finestra di messaggio sul lato client che verrà visualizzato il messaggio di errore che è specificati in precedenza.</span><span class="sxs-lookup"><span data-stu-id="54b7c-220">With these settings, if the user enters an invalid unit price value, an asterisk will appear next to the offending TextBox controls and the ValidationSummary will display a client-side messagebox that shows the error message we specified earlier.</span></span>

<span data-ttu-id="54b7c-221">A questo punto, la schermata dovrebbe essere simile alla figura 10.</span><span class="sxs-lookup"><span data-stu-id="54b7c-221">At this point, your screen should look similar to Figure 10.</span></span>


<span data-ttu-id="54b7c-222">[![L'interfaccia inserimento ora include caselle di testo per i prodotti i nomi e sui prezzi](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-222">[![The Inserting Interface Now Includes TextBoxes for the Products Names and Prices](batch-inserting-cs/_static/image29.png)](batch-inserting-cs/_static/image28.png)</span></span>

<span data-ttu-id="54b7c-223">**Figura 10**: l'inserimento di interfaccia ora include caselle di testo per i nomi di prodotti e i prezzi ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-223">**Figure 10**: The Inserting Interface Now Includes TextBoxes for the Products Names and Prices ([Click to view full-size image](batch-inserting-cs/_static/image30.png))</span></span>


<span data-ttu-id="54b7c-224">Successivamente è necessario aggiungere Aggiungi prodotti dai pulsanti Annulla e di spedizione per la riga di piè di pagina.</span><span class="sxs-lookup"><span data-stu-id="54b7c-224">Next we need to add the Add Products from Shipment and Cancel buttons to the footer row.</span></span> <span data-ttu-id="54b7c-225">Trascinare due controlli pulsante dalla casella degli strumenti nel piè di pagina dell'interfaccia, inserire i pulsanti di impostazione `ID` proprietà `AddProducts` e `CancelButton` e `Text` proprietà per aggiungere i prodotti di spedizione e Annulla, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-225">Drag two Button controls from the Toolbox into the footer of the inserting interface, setting the Buttons `ID` properties to `AddProducts` and `CancelButton` and `Text` properties to Add Products from Shipment and Cancel, respectively.</span></span> <span data-ttu-id="54b7c-226">Inoltre, impostare il `CancelButton` controllo s `CausesValidation` proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-226">In addition, set the `CancelButton` control s `CausesValidation` property to `false`.</span></span>

<span data-ttu-id="54b7c-227">Infine, è necessario aggiungere un controllo etichetta Web che consente di visualizzare i messaggi di stato per le due interfacce.</span><span class="sxs-lookup"><span data-stu-id="54b7c-227">Finally, we need to add a Label Web control that will display status messages for the two interfaces.</span></span> <span data-ttu-id="54b7c-228">Ad esempio, quando un utente aggiunge correttamente una nuova spedizione dei prodotti, si desidera ripristinare l'interfaccia di visualizzazione e visualizzare un messaggio di conferma.</span><span class="sxs-lookup"><span data-stu-id="54b7c-228">For example, when a user successfully adds a new shipment of products, we want to return to the display interface and display a confirmation message.</span></span> <span data-ttu-id="54b7c-229">Se, tuttavia, l'utente fornisce un prezzo per un nuovo prodotto, ma lascia disattivare il nome del prodotto, è necessario visualizzare un messaggio di avviso dopo il `ProductName` campo è obbligatorio.</span><span class="sxs-lookup"><span data-stu-id="54b7c-229">If, however, the user provides a price for a new product but leaves off the product name, we need to display a warning message since the `ProductName` field is required.</span></span> <span data-ttu-id="54b7c-230">Poiché è necessario il messaggio da visualizzare per entrambe le interfacce, è possibile inserirlo nella parte superiore della pagina di fuori di pannelli.</span><span class="sxs-lookup"><span data-stu-id="54b7c-230">Since we need this message to display for both interfaces, place it at the top of the page outside of the Panels.</span></span>

<span data-ttu-id="54b7c-231">Trascinare un controllo etichetta Web dalla casella degli strumenti nella parte superiore della pagina nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-231">Drag a Label Web control from the Toolbox to the top of the page in the Designer.</span></span> <span data-ttu-id="54b7c-232">Impostare il `ID` proprietà `StatusLabel`, deselezionare le il `Text` proprietà e impostare il `Visible` e `EnableViewState` proprietà `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-232">Set the `ID` property to `StatusLabel`, clear out the `Text` property, and set the `Visible` and `EnableViewState` properties to `false`.</span></span> <span data-ttu-id="54b7c-233">Come abbiamo visto nelle esercitazioni precedenti, l'impostazione di `EnableViewState` proprietà `false` consente di modificare i valori di proprietà etichetta s a livello di codice e farli automaticamente ripristinare i valori predefiniti con il postback successivi.</span><span class="sxs-lookup"><span data-stu-id="54b7c-233">As we have seen in previous tutorials, setting the `EnableViewState` property to `false` allows us to programmatically change the Label s property values and have them automatically revert back to their defaults on the subsequent postback.</span></span> <span data-ttu-id="54b7c-234">Questa operazione semplifica il codice per la visualizzazione di un messaggio di stato in risposta a un'operazione dell'utente che non viene più visualizzata sul postback successivi.</span><span class="sxs-lookup"><span data-stu-id="54b7c-234">This simplifies the code for showing a status message in response to some user action that disappears on the subsequent postback.</span></span> <span data-ttu-id="54b7c-235">Infine, impostare il `StatusLabel` controllo s `CssClass` proprietà avviso, ovvero il nome di una classe CSS definita in `Styles.css` che visualizza il testo in caratteri grandi, corsivo, grassetto e rosso.</span><span class="sxs-lookup"><span data-stu-id="54b7c-235">Finally, set the `StatusLabel` control s `CssClass` property to Warning, which is the name of a CSS class defined in `Styles.css` that displays text in a large, italic, bold, red font.</span></span>

<span data-ttu-id="54b7c-236">Figura 11 mostra la progettazione di Visual Studio dopo l'etichetta è stato aggiunta e configurata.</span><span class="sxs-lookup"><span data-stu-id="54b7c-236">Figure 11 shows the Visual Studio Designer after the Label has been added and configured.</span></span>


<span data-ttu-id="54b7c-237">[![Posizionare il controllo StatusLabel sopra i due controlli pannello](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-237">[![Place the StatusLabel Control Above the Two Panel Controls](batch-inserting-cs/_static/image32.png)](batch-inserting-cs/_static/image31.png)</span></span>

<span data-ttu-id="54b7c-238">**Figura 11**: posizione il `StatusLabel` controllo di sopra di due controlli pannello ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-238">**Figure 11**: Place the `StatusLabel` Control Above the Two Panel Controls ([Click to view full-size image](batch-inserting-cs/_static/image33.png))</span></span>


## <a name="step-3-switching-between-the-display-and-inserting-interfaces"></a><span data-ttu-id="54b7c-239">Passaggio 3: Il passaggio tra la visualizzazione e l'inserimento di interfacce</span><span class="sxs-lookup"><span data-stu-id="54b7c-239">Step 3: Switching Between the Display and Inserting Interfaces</span></span>

<span data-ttu-id="54b7c-240">A questo punto è stato completato il markup per la visualizzazione e l'inserimento di interfacce, ma è re rimasti con due attività:</span><span class="sxs-lookup"><span data-stu-id="54b7c-240">At this point we have completed the markup for our display and inserting interfaces, but we re still left with two tasks:</span></span>

- <span data-ttu-id="54b7c-241">Il passaggio tra la visualizzazione e l'inserimento di interfacce</span><span class="sxs-lookup"><span data-stu-id="54b7c-241">Switching between the display and inserting interfaces</span></span>
- <span data-ttu-id="54b7c-242">Aggiunta di prodotti nella spedizione al database</span><span class="sxs-lookup"><span data-stu-id="54b7c-242">Adding the products in the shipment to the database</span></span>

<span data-ttu-id="54b7c-243">Attualmente, l'interfaccia di visualizzazione è visibile, ma l'interfaccia di inserimento è nascosta.</span><span class="sxs-lookup"><span data-stu-id="54b7c-243">Currently, the display interface is visible but the inserting interface is hidden.</span></span> <span data-ttu-id="54b7c-244">In questo modo il `DisplayInterface` pannello s `Visible` è impostata su `true` (valore predefinito), mentre il `InsertingInterface` pannello s `Visible` è impostata su `false`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-244">This is because the `DisplayInterface` Panel s `Visible` property is set to `true` (the default value), while the `InsertingInterface` Panel s `Visible` property is set to `false`.</span></span> <span data-ttu-id="54b7c-245">Per passare tra le due interfacce, è sufficiente passare ogni controllo s `Visible` valore della proprietà.</span><span class="sxs-lookup"><span data-stu-id="54b7c-245">To switch between the two interfaces we simply need to toggle each control s `Visible` property value.</span></span>

<span data-ttu-id="54b7c-246">È necessario passare dall'interfaccia di visualizzazione per l'interfaccia di inserimento quando viene scelto il pulsante di spedizione del prodotto processo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-246">We want to move from the display interface to the inserting interface when the Process Product Shipment button is clicked.</span></span> <span data-ttu-id="54b7c-247">Pertanto, creare un gestore eventi per questo pulsante s `Click` evento che contiene il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="54b7c-247">Therefore, create an event handler for this Button s `Click` event that contains the following code:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample4.cs)]

<span data-ttu-id="54b7c-248">Questo codice nasconde semplicemente il `DisplayInterface` pannello e Mostra il `InsertingInterface` pannello.</span><span class="sxs-lookup"><span data-stu-id="54b7c-248">This code simply hides the `DisplayInterface` Panel and shows the `InsertingInterface` Panel.</span></span>

<span data-ttu-id="54b7c-249">Successivamente, è possibile creare gestori eventi per i prodotti aggiungere dai controlli di spedizione e pulsante Annulla nell'interfaccia di inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-249">Next, create event handlers for the Add Products from Shipment and Cancel Button controls in the inserting interface.</span></span> <span data-ttu-id="54b7c-250">Quando viene scelto uno di questi pulsanti, è necessario ripristinare l'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-250">When either of these Buttons is clicked, we need to revert back to the display interface.</span></span> <span data-ttu-id="54b7c-251">Creare `Click` gestori eventi per i controlli pulsante in modo che chiamano `ReturnToDisplayInterface`, un metodo che verrà aggiunta solo temporaneamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-251">Create `Click` event handlers for both Button controls so that they call `ReturnToDisplayInterface`, a method we will add momentarily.</span></span> <span data-ttu-id="54b7c-252">Oltre a nascondere la `InsertingInterface` pannello e visualizzare il `DisplayInterface` Pannello di `ReturnToDisplayInterface` metodo deve restituire i controlli Web allo stato di pre-modifica.</span><span class="sxs-lookup"><span data-stu-id="54b7c-252">In addition to hiding the `InsertingInterface` Panel and showing the `DisplayInterface` Panel, the `ReturnToDisplayInterface` method needs to return the Web controls to their pre-editing state.</span></span> <span data-ttu-id="54b7c-253">Ciò comporta l'impostazione di controlli DropDownList `SelectedIndex` proprietà su 0 e cancellare il `Text` proprietà dei controlli casella di testo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-253">This involves setting the DropDownLists `SelectedIndex` properties to 0 and clearing out the `Text` properties of the TextBox controls.</span></span>

> [!NOTE]
> <span data-ttu-id="54b7c-254">Si consideri cosa potrebbe accadere se si non riportare i controlli pre-modifica lo stato prima di restituire l'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-254">Consider what might happen if we didn t return the controls to their pre-editing state before returning to the display interface.</span></span> <span data-ttu-id="54b7c-255">Un utente può fare clic sul pulsante di spedizione del prodotto processo, immettere i prodotti dalla spedizione e quindi fare clic su Aggiungi prodotti da spedizione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-255">A user might click the Process Product Shipment button, enter the products from the shipment, and then click Add Products from Shipment.</span></span> <span data-ttu-id="54b7c-256">Questo aggiungere i prodotti e verrà restituito all'utente l'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-256">This would add the products and return the user to the display interface.</span></span> <span data-ttu-id="54b7c-257">A questo punto l'utente potrebbe voler aggiungere un'altra spedizione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-257">At this point the user might want to add another shipment.</span></span> <span data-ttu-id="54b7c-258">Fare clic sul pulsante di spedizione del prodotto processo che restituiscono l'interfaccia inserimento ma DropDownList su valori di casella di testo e le selezioni verrebbero ancora popolati con i valori precedenti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-258">Upon clicking the Process Product Shipment button they would return to the inserting interface but the DropDownList selections and TextBox values would still be populated with their previous values.</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample5.cs)]

<span data-ttu-id="54b7c-259">Entrambi `Click` gestori eventi è sufficiente chiamare il `ReturnToDisplayInterface` (metodo), anche se sarà restituiamo ai prodotti aggiungere da spedizione `Click` gestore dell'evento nel passaggio 4 e aggiungere il codice per salvare i prodotti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-259">Both `Click` event handlers simply call the `ReturnToDisplayInterface` method, although we'll return to the Add Products from Shipment `Click` event handler in Step 4 and add code to save the products.</span></span> <span data-ttu-id="54b7c-260">`ReturnToDisplayInterface` viene avviata restituendo il `Suppliers` e `Categories` controlli DropDownList per le prime opzioni.</span><span class="sxs-lookup"><span data-stu-id="54b7c-260">`ReturnToDisplayInterface` starts by returning the `Suppliers` and `Categories` DropDownLists to their first options.</span></span> <span data-ttu-id="54b7c-261">Le due costanti `firstControlID` e `lastControlID` contrassegnare l'inizio e fine utilizzati nei nomi di prodotto nome e il prezzo unitario nelle caselle di testo in cui l'inserimento di interfaccia e vengono utilizzati i limiti di valori di indice di controllo di `for` ciclo che imposta il `Text`proprietà dei controlli casella di testo nuovo in una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="54b7c-261">The two constants `firstControlID` and `lastControlID` mark the starting and ending control index values used in naming the product name and unit price TextBoxes in the inserting interface and are used in the bounds of the `for` loop that sets the `Text` properties of the TextBox controls back to an empty string.</span></span> <span data-ttu-id="54b7c-262">Infine, i pannelli `Visible` le proprietà vengono reimpostate in modo che l'interfaccia di inserimento è nascosta e l'interfaccia di visualizzazione illustrato.</span><span class="sxs-lookup"><span data-stu-id="54b7c-262">Finally, the Panels `Visible` properties are reset so that the inserting interface is hidden and the display interface shown.</span></span>

<span data-ttu-id="54b7c-263">È opportuno testare questa pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="54b7c-263">Take a moment to test out this page in a browser.</span></span> <span data-ttu-id="54b7c-264">Durante la prima visita la pagina verrà visualizzato l'interfaccia di visualizzazione come è stato illustrato nella figura 5.</span><span class="sxs-lookup"><span data-stu-id="54b7c-264">When first visiting the page you should see the display interface as was shown in Figure 5.</span></span> <span data-ttu-id="54b7c-265">Fare clic sul pulsante elabora spedizione del prodotto.</span><span class="sxs-lookup"><span data-stu-id="54b7c-265">Click the Process Product Shipment button.</span></span> <span data-ttu-id="54b7c-266">La pagina verrà postback e dovrebbe essere l'interfaccia inserimento come illustrato nella figura 12.</span><span class="sxs-lookup"><span data-stu-id="54b7c-266">The page will postback and you should now see the inserting interface as shown in Figure 12.</span></span> <span data-ttu-id="54b7c-267">Fare clic su entrambi i prodotti aggiungere pulsanti di spedizione o annullare nuovamente l'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-267">Clicking either the Add Products from Shipment or Cancel buttons returns you to the display interface.</span></span>

> [!NOTE]
> <span data-ttu-id="54b7c-268">Durante la visualizzazione dell'interfaccia di inserimento, è opportuno testare il CompareValidators sul prezzo unitario nelle caselle di testo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-268">While viewing the inserting interface, take a moment to test out the CompareValidators on the unit price TextBoxes.</span></span> <span data-ttu-id="54b7c-269">Verrà visualizzata una finestra di messaggio sul lato client di avviso quando si fa clic Aggiungi prodotti dal pulsante di spedizione con valori di valuta non valido o prezzi con un valore minore di zero.</span><span class="sxs-lookup"><span data-stu-id="54b7c-269">You should see a client-side messagebox warning when clicking the Add Products from Shipment button with invalid currency values or prices with a value less than zero.</span></span>


<span data-ttu-id="54b7c-270">[![L'interfaccia di inserimento viene visualizzato dopo aver fatto clic sul pulsante di spedizione del prodotto processo](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-270">[![The Inserting Interface is Displayed After Clicking the Process Product Shipment Button](batch-inserting-cs/_static/image35.png)](batch-inserting-cs/_static/image34.png)</span></span>

<span data-ttu-id="54b7c-271">**Figura 12**: l'interfaccia di inserimento viene visualizzato dopo aver fatto clic sul pulsante di spedizione del prodotto processo ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-271">**Figure 12**: The Inserting Interface is Displayed After Clicking the Process Product Shipment Button ([Click to view full-size image](batch-inserting-cs/_static/image36.png))</span></span>


## <a name="step-4-adding-the-products"></a><span data-ttu-id="54b7c-272">Passaggio 4: Aggiunta di prodotti</span><span class="sxs-lookup"><span data-stu-id="54b7c-272">Step 4: Adding the Products</span></span>

<span data-ttu-id="54b7c-273">All rimanente per questa esercitazione è possibile salvare i prodotti nel database in Aggiungi prodotti dal pulsante spedizione s `Click` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-273">All that remains for this tutorial is to save the products to the database in the Add Products from Shipment Button s `Click` event handler.</span></span> <span data-ttu-id="54b7c-274">Questa operazione può essere eseguita mediante la creazione di un `ProductsDataTable` e l'aggiunta di un `ProductsRow` istanza per ciascuno dei nomi di prodotto specificati.</span><span class="sxs-lookup"><span data-stu-id="54b7c-274">This can be accomplished by creating a `ProductsDataTable` and adding a `ProductsRow` instance for each of the product names supplied.</span></span> <span data-ttu-id="54b7c-275">Una volta questi `ProductsRow` sia stata aggiunta si effettua una chiamata al `ProductsBLL` classe s `UpdateWithTransaction` metodo passando la `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-275">Once these `ProductsRow` s have been added we will make a call to the `ProductsBLL` class s `UpdateWithTransaction` method passing in the `ProductsDataTable`.</span></span> <span data-ttu-id="54b7c-276">Tenere presente che il `UpdateWithTransaction` metodo, che è stato creato nel [di wrapping delle modifiche del Database all'interno di una transazione](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passa il `ProductsDataTable` per il `ProductsTableAdapter` s `UpdateWithTransaction` metodo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-276">Recall that the `UpdateWithTransaction` method, which was created back in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial, passes the `ProductsDataTable` to the `ProductsTableAdapter` s `UpdateWithTransaction` method.</span></span> <span data-ttu-id="54b7c-277">Da qui, viene avviata una transazione di ADO.NET e i problemi di TableAdatper un `INSERT` istruzione per il database per ogni aggiunta `ProductsRow` nel DataTable.</span><span class="sxs-lookup"><span data-stu-id="54b7c-277">From there, an ADO.NET transaction is started and the TableAdatper issues an `INSERT` statement to the database for each added `ProductsRow` in the DataTable.</span></span> <span data-ttu-id="54b7c-278">Presupponendo che tutti i prodotti vengono aggiunti senza errori, che viene eseguito il commit della transazione, in caso contrario viene eseguito il rollback.</span><span class="sxs-lookup"><span data-stu-id="54b7c-278">Assuming all products are added without error, the transaction is committed, otherwise it is rolled back.</span></span>

<span data-ttu-id="54b7c-279">Il codice per i prodotti aggiungere dal pulsante spedizione s `Click` gestore dell'evento deve anche eseguire operazioni di controllo degli errori.</span><span class="sxs-lookup"><span data-stu-id="54b7c-279">The code for the Add Products from Shipment Button s `Click` event handler also needs to perform a bit of error checking.</span></span> <span data-ttu-id="54b7c-280">Poiché non esistono alcun RequiredFieldValidators utilizzato nell'interfaccia di inserimento, un utente può immettere un prezzo per un prodotto omettendo il relativo nome.</span><span class="sxs-lookup"><span data-stu-id="54b7c-280">Since there are no RequiredFieldValidators used in the inserting interface, a user could enter a price for a product while omitting its name.</span></span> <span data-ttu-id="54b7c-281">Poiché il nome del prodotto s è richiesto, se tale condizione espande è necessario avvisare l'utente e non procedere con le operazioni di inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-281">Since the product s name is required, if such a condition unfolds we need to alert the user and not proceed with the inserts.</span></span> <span data-ttu-id="54b7c-282">L'intero `Click` codice del gestore eventi segue:</span><span class="sxs-lookup"><span data-stu-id="54b7c-282">The complete `Click` event handler code follows:</span></span>


[!code-csharp[Main](batch-inserting-cs/samples/sample6.cs)]

<span data-ttu-id="54b7c-283">Il gestore dell'evento inizia assicurando che il `Page.IsValid` proprietà restituisce un valore di `true`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-283">The event handler starts by ensuring that the `Page.IsValid` property returns a value of `true`.</span></span> <span data-ttu-id="54b7c-284">Se restituisce `false`, quindi che significa che uno o più di CompareValidators segnalano i dati non validi; in tal caso non si desidera tenta di inserire i prodotti immessi o si otterrà un'eccezione durante il tentativo di assegnare il prezzo unitario immesso dall'utente valore di `ProductsRow` s `UnitPrice` proprietà.</span><span class="sxs-lookup"><span data-stu-id="54b7c-284">If it returns `false`, then that means one or more of the CompareValidators are reporting invalid data; in such a case we do not want to attempt to insert the entered products or we'll end up with an exception when attempting to assign the user-entered unit price value to the `ProductsRow` s `UnitPrice` property.</span></span>

<span data-ttu-id="54b7c-285">Successivamente, un nuovo `ProductsDataTable` viene creata l'istanza (`products`).</span><span class="sxs-lookup"><span data-stu-id="54b7c-285">Next, a new `ProductsDataTable` instance is created (`products`).</span></span> <span data-ttu-id="54b7c-286">Oggetto `for` ciclo viene utilizzato per scorrere il nome e l'unità di prezzo del prodotto nelle caselle di testo e `Text` proprietà vengono lette in variabili locali `productName` e `unitPrice`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-286">A `for` loop is used to iterate through the product name and unit price TextBoxes and the `Text` properties are read into the local variables `productName` and `unitPrice`.</span></span> <span data-ttu-id="54b7c-287">Se l'utente ha immesso un valore per il prezzo unitario ma non per il nome del prodotto corrispondente, il `StatusLabel` consente di visualizzare il messaggio se si specifica un'unità di prezzo è inoltre necessario includere il nome del prodotto e il gestore dell'evento è stato terminato.</span><span class="sxs-lookup"><span data-stu-id="54b7c-287">If the user has entered a value for the unit price but not for the corresponding product name, the `StatusLabel` displays the message If you provide a unit price you must also include the name of the product and the event handler is exited.</span></span>

<span data-ttu-id="54b7c-288">Se è stato specificato un nome di prodotto, un nuovo `ProductsRow` istanza viene creata utilizzando il `ProductsDataTable` s `NewProductsRow` metodo.</span><span class="sxs-lookup"><span data-stu-id="54b7c-288">If a product name has been provided, a new `ProductsRow` instance is created using the `ProductsDataTable` s `NewProductsRow` method.</span></span> <span data-ttu-id="54b7c-289">Questa nuova `ProductsRow` istanza s `ProductName` proprietà è impostata per il prodotto corrente Nome casella di testo durante il `SupplierID` e `CategoryID` vengono assegnate le proprietà di `SelectedValue` le proprietà di controlli di DropDownList nell'intestazione di interfaccia s inserimento.</span><span class="sxs-lookup"><span data-stu-id="54b7c-289">This new `ProductsRow` instance s `ProductName` property is set to the current product name TextBox while the `SupplierID` and `CategoryID` properties are assigned to the `SelectedValue` properties of the DropDownLists in the inserting interface s header.</span></span> <span data-ttu-id="54b7c-290">Se viene immesso un valore per il prezzo del prodotto s, viene assegnato al `ProductsRow` istanza s `UnitPrice` proprietà; in caso contrario, la proprietà è a sinistra non assegnato, provocando un `NULL` valore per `UnitPrice` nel database.</span><span class="sxs-lookup"><span data-stu-id="54b7c-290">If the user entered a value for the product s price, it is assigned to the `ProductsRow` instance s `UnitPrice` property; otherwise, the property is left unassigned, which will result in a `NULL` value for `UnitPrice` in the database.</span></span> <span data-ttu-id="54b7c-291">Infine, il `Discontinued` e `UnitsOnOrder` proprietà assegnate ai valori hardcoded `false` e 0, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-291">Finally, the `Discontinued` and `UnitsOnOrder` properties are assigned to the hard-coded values `false` and 0, respectively.</span></span>

<span data-ttu-id="54b7c-292">Dopo che le proprietà sono state assegnate al `ProductsRow` aggiunto all'istanza di `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-292">After the properties have been assigned to the `ProductsRow` instance it is added to the `ProductsDataTable`.</span></span>

<span data-ttu-id="54b7c-293">Dopo aver completato il `for` ciclo, controlliamo se sono stati aggiunti tutti i prodotti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-293">At the completion of the `for` loop, we check whether any products have been added.</span></span> <span data-ttu-id="54b7c-294">L'utente può, dopo tutto, hai fatto clic Aggiungi prodotti da spedizione prima di immettere i nomi dei prodotti o i prezzi.</span><span class="sxs-lookup"><span data-stu-id="54b7c-294">The user may, after all, have clicked the Add Products from Shipment before entering any product names or prices.</span></span> <span data-ttu-id="54b7c-295">Se è presente almeno un prodotto di `ProductsDataTable`, `ProductsBLL` classe s `UpdateWithTransaction` metodo viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="54b7c-295">If there is at least one product in the `ProductsDataTable`, the `ProductsBLL` class s `UpdateWithTransaction` method is called.</span></span> <span data-ttu-id="54b7c-296">Successivamente, i dati vengano riassociati al `ProductsGrid` GridView in modo che i prodotti appena aggiunti verranno visualizzato nell'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-296">Next, the data is rebound to the `ProductsGrid` GridView so that the newly added products will appear in the display interface.</span></span> <span data-ttu-id="54b7c-297">Il `StatusLabel` viene aggiornato per visualizzare un messaggio di conferma e `ReturnToDisplayInterface` viene richiamato, nascondere l'interfaccia di inserimento e che mostra l'interfaccia di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-297">The `StatusLabel` is updated to display a confirmation message and the `ReturnToDisplayInterface` is invoked, hiding the inserting interface and showing the display interface.</span></span>

<span data-ttu-id="54b7c-298">Se non viene immesso alcun prodotti, l'interfaccia di inserimento è visualizzato ma il messaggio di che prodotti non sono stati aggiunti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-298">If no products were entered, the inserting interface remains displayed but the message No products were added.</span></span> <span data-ttu-id="54b7c-299">Immettere i nomi di prodotto e prezzo unitario minore nelle caselle di testo viene visualizzato.</span><span class="sxs-lookup"><span data-stu-id="54b7c-299">Please enter the product names and unit prices in the textboxes is displayed.</span></span>

<span data-ttu-id="54b7c-300">S figura 13, 14 e 15 Visualizza l'inserimento e visualizza le interfacce in azione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-300">Figure s 13, 14, and 15 show the inserting and display interfaces in action.</span></span> <span data-ttu-id="54b7c-301">Nella figura 13, l'utente ha immesso un valore di prezzo unitario senza un nome di prodotto corrispondente.</span><span class="sxs-lookup"><span data-stu-id="54b7c-301">In Figure 13, the user has entered a unit price value without a corresponding product name.</span></span> <span data-ttu-id="54b7c-302">Nella figura 14 mostra l'interfaccia di visualizzazione dopo tre nuovi prodotti sono stati aggiunti correttamente, mentre nella figura 15 vengono illustrati due dei prodotti appena aggiunti in GridView (il terzo è nella pagina precedente).</span><span class="sxs-lookup"><span data-stu-id="54b7c-302">Figure 14 shows the display interface after three new products have been added successfully, while Figure 15 shows two of the newly added products in the GridView (the third one is on the previous page).</span></span>


<span data-ttu-id="54b7c-303">[![Un nome di prodotto è richiesto quando immettendo un prezzo unitario](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-303">[![A Product Name is Required When Entering a Unit Price](batch-inserting-cs/_static/image38.png)](batch-inserting-cs/_static/image37.png)</span></span>

<span data-ttu-id="54b7c-304">**Figura 13**: nome del prodotto A è necessaria quando immettendo un prezzo unitario ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-304">**Figure 13**: A Product Name is Required When Entering a Unit Price ([Click to view full-size image](batch-inserting-cs/_static/image39.png))</span></span>


<span data-ttu-id="54b7c-305">[![Tre nuovi Veggies sono stati aggiunti per il fornitore Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-305">[![Three New Veggies Have Been Added for the Supplier Mayumi s](batch-inserting-cs/_static/image41.png)](batch-inserting-cs/_static/image40.png)</span></span>

<span data-ttu-id="54b7c-306">**Figura 14**: tre nuovi Veggies sono stati aggiunti per s Mayumi fornitore ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image42.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-306">**Figure 14**: Three New Veggies Have Been Added for the Supplier Mayumi s ([Click to view full-size image](batch-inserting-cs/_static/image42.png))</span></span>


<span data-ttu-id="54b7c-307">[![I nuovi prodotti sono reperibile nell'ultima pagina del controllo GridView.](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span><span class="sxs-lookup"><span data-stu-id="54b7c-307">[![The New Products Can Be Found in the Last Page of the GridView](batch-inserting-cs/_static/image44.png)](batch-inserting-cs/_static/image43.png)</span></span>

<span data-ttu-id="54b7c-308">**Figura 15**: il nuovo prodotti sono disponibili nell'ultima pagina di GridView ([fare clic per visualizzare l'immagine ingrandita](batch-inserting-cs/_static/image45.png))</span><span class="sxs-lookup"><span data-stu-id="54b7c-308">**Figure 15**: The New Products Can Be Found in the Last Page of the GridView ([Click to view full-size image](batch-inserting-cs/_static/image45.png))</span></span>


> [!NOTE]
> <span data-ttu-id="54b7c-309">Il batch di inserimento di logica utilizzata in questa esercitazione esegue il wrapping le operazioni di inserimento all'interno dell'ambito della transazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-309">The batch inserting logic used in this tutorial wraps the inserts within the scope of transaction.</span></span> <span data-ttu-id="54b7c-310">Per verificarlo, introdurre intenzionalmente un errore a livello di database.</span><span class="sxs-lookup"><span data-stu-id="54b7c-310">To verify this, purposefully introduce a database-level error.</span></span> <span data-ttu-id="54b7c-311">Ad esempio, invece di assegnare il nuovo `ProductsRow` istanza s `CategoryID` proprietà al valore selezionato nel `Categories` DropDownList, assegnare un valore come `i * 5`.</span><span class="sxs-lookup"><span data-stu-id="54b7c-311">For example, rather than assigning the new `ProductsRow` instance s `CategoryID` property to the selected value in the `Categories` DropDownList, assign it to a value like `i * 5`.</span></span> <span data-ttu-id="54b7c-312">Qui `i` è l'indicizzatore di ciclo e con valori compresi tra 1 e 5.</span><span class="sxs-lookup"><span data-stu-id="54b7c-312">Here `i` is the loop indexer and has values ranging from 1 to 5.</span></span> <span data-ttu-id="54b7c-313">Pertanto, quando aggiunta del prodotto prima di inserire due o più prodotti in batch avrà un valore valido `CategoryID` valore (5), ma i prodotti successive avranno `CategoryID` valori che non corrispondono a un massimo di `CategoryID` i valori di `Categories` tabella.</span><span class="sxs-lookup"><span data-stu-id="54b7c-313">Therefore, when adding two or more products in batch insert the first product will have a valid `CategoryID` value (5), but subsequent products will have `CategoryID` values that do not match up to `CategoryID` values in the `Categories` table.</span></span> <span data-ttu-id="54b7c-314">L'effetto finale è che, mentre il primo `INSERT` avrà esito positivo, le successive avranno esito negativo con una violazione di vincolo di chiave esterna.</span><span class="sxs-lookup"><span data-stu-id="54b7c-314">The net effect is that while the first `INSERT` will succeed, subsequent ones will fail with a foreign key constraint violation.</span></span> <span data-ttu-id="54b7c-315">Poiché l'inserimento batch è atomico, il primo `INSERT` sarà possibile eseguire il rollback, restituendo il database allo stato prima che il batch inserimento processo iniziato.</span><span class="sxs-lookup"><span data-stu-id="54b7c-315">Since the batch insert is atomic, the first `INSERT` will be rolled back, returning the database to its state before the batch insert process began.</span></span>


## <a name="summary"></a><span data-ttu-id="54b7c-316">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="54b7c-316">Summary</span></span>

<span data-ttu-id="54b7c-317">Su questa e le esercitazioni precedenti due interfacce che consentono l'aggiornamento, eliminazione, abbiamo creato e l'inserimento di batch di dati, ognuno dei quali usato il supporto delle transazioni è stato aggiunto a livello di accesso ai dati nel [di wrapping delle modifiche del Database all'interno di una transazione](wrapping-database-modifications-within-a-transaction-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="54b7c-317">Over this and the previous two tutorials we have created interfaces that allow for updating, deleting, and inserting batches of data, all of which used the transaction support we added to the Data Access Layer in the [Wrapping Database Modifications within a Transaction](wrapping-database-modifications-within-a-transaction-cs.md) tutorial.</span></span> <span data-ttu-id="54b7c-318">Per alcuni scenari, tali interfacce utente per l'elaborazione batch migliorare notevolmente l'efficienza degli utenti finali riducendo il numero di clic, i postback e commutazioni di contesto di tastiera per mouse, pur mantenendo l'integrità dei dati sottostanti.</span><span class="sxs-lookup"><span data-stu-id="54b7c-318">For certain scenarios, such batch processing user interfaces greatly improve end user efficiency by cutting down on the number of clicks, postbacks, and keyboard-to-mouse context switches, while also maintaining the integrity of the underlying data.</span></span>

<span data-ttu-id="54b7c-319">In questa esercitazione completa esaminare l'utilizzo dei dati in batch.</span><span class="sxs-lookup"><span data-stu-id="54b7c-319">This tutorial completes our look at working with batched data.</span></span> <span data-ttu-id="54b7c-320">Il set successivo di esercitazioni viene esaminata un'ampia gamma di scenari avanzati di livello di accesso ai dati, incluso l'utilizzo di stored procedure nei metodi TableAdapter s, configurazione delle impostazioni del livello di connessione e comando DAL, la crittografia delle stringhe di connessione e altro ancora!</span><span class="sxs-lookup"><span data-stu-id="54b7c-320">The next set of tutorials explores a variety of advanced Data Access Layer scenarios, including using stored procedures in the TableAdapter s methods, configuring connection- and command-level settings in the DAL, encrypting connection strings, and more!</span></span>

<span data-ttu-id="54b7c-321">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="54b7c-321">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="54b7c-322">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="54b7c-322">About the Author</span></span>

<span data-ttu-id="54b7c-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="54b7c-323">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="54b7c-324">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="54b7c-324">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="54b7c-325">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="54b7c-325">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="54b7c-326">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="54b7c-326">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="54b7c-327">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="54b7c-327">Special Thanks To</span></span>

<span data-ttu-id="54b7c-328">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="54b7c-328">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="54b7c-329">Portare i revisori per questa esercitazione sono stati Hilton Giesenow e S ren Jacob Lauritsen.</span><span class="sxs-lookup"><span data-stu-id="54b7c-329">Lead reviewers for this tutorial were Hilton Giesenow and S ren Jacob Lauritsen.</span></span> <span data-ttu-id="54b7c-330">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="54b7c-330">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="54b7c-331">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="54b7c-331">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="54b7c-332">[Precedente](batch-deleting-cs.md)
> [Successivo](wrapping-database-modifications-within-a-transaction-vb.md)</span><span class="sxs-lookup"><span data-stu-id="54b7c-332">[Previous](batch-deleting-cs.md)
[Next](wrapping-database-modifications-within-a-transaction-vb.md)</span></span>

---
uid: web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
title: Caricamento di file (VB) | Documenti Microsoft
author: rick-anderson
description: Informazioni su come consentire agli utenti di caricare file binari (ad esempio i documenti di Word o PDF) al sito Web in cui possono essere archiviati nel file system del server...
ms.author: aspnetcontent
manager: wpickett
ms.date: 03/27/2007
ms.topic: article
ms.assetid: f7c00fbd-652c-433d-8ed3-0e5168a4d4df
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/working-with-binary-files/uploading-files-vb
msc.type: authoredcontent
ms.openlocfilehash: fbc4aaf80ac7e0f960e140b492055fe35cd2b6ce
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/10/2018
---
<a name="uploading-files-vb"></a><span data-ttu-id="8f65f-103">Il caricamento di file (VB)</span><span class="sxs-lookup"><span data-stu-id="8f65f-103">Uploading Files (VB)</span></span>
====================
<span data-ttu-id="8f65f-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="8f65f-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="8f65f-105">[Scaricare App di esempio](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) o [Scarica il PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="8f65f-105">[Download Sample App](http://download.microsoft.com/download/4/a/7/4a7a3b18-d80e-4014-8e53-a6a2427f0d93/ASPNET_Data_Tutorial_54_VB.exe) or [Download PDF](uploading-files-vb/_static/datatutorial54vb1.pdf)</span></span>

> <span data-ttu-id="8f65f-106">Informazioni su come consentire agli utenti di caricare file binari (ad esempio i documenti di Word o PDF) al sito Web in cui possono essere archiviati nel file system del server o nel database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-106">Learn how to allow users to upload binary files (such as Word or PDF documents) to your Web site where they may be stored in either the server's file system or the database.</span></span>


## <a name="introduction"></a><span data-ttu-id="8f65f-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="8f65f-107">Introduction</span></span>

<span data-ttu-id="8f65f-108">Tutte le esercitazioni abbiamo esaminata finora ve lavorare esclusivamente con i dati di testo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-108">All of the tutorials we ve examined so far have worked exclusively with text data.</span></span> <span data-ttu-id="8f65f-109">Tuttavia, molte applicazioni dispongono di modelli di dati che acquisiscono testo e dati binari.</span><span class="sxs-lookup"><span data-stu-id="8f65f-109">However, many applications have data models that capture both text and binary data.</span></span> <span data-ttu-id="8f65f-110">Un sito di documenti per online potrebbe consentire agli utenti di caricare un'immagine da associare al proprio profilo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-110">An online dating site might allow users to upload a picture to associate with their profile.</span></span> <span data-ttu-id="8f65f-111">Un sito Web di selezione che consenta agli utenti di caricare i curriculum come un documento Microsoft Word o PDF.</span><span class="sxs-lookup"><span data-stu-id="8f65f-111">A recruiting website might let users upload their resume as a Microsoft Word or PDF document.</span></span>

<span data-ttu-id="8f65f-112">Utilizzo di dati binari aggiunge una nuova serie di sfide.</span><span class="sxs-lookup"><span data-stu-id="8f65f-112">Working with binary data adds a new set of challenges.</span></span> <span data-ttu-id="8f65f-113">È necessario decidere come dati binari vengano archiviati nell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-113">We must decide how the binary data is stored in the application.</span></span> <span data-ttu-id="8f65f-114">L'interfaccia utilizzata per l'inserimento di nuovi record deve essere aggiornata per consentire all'utente di caricare un file dal computer e per visualizzare o fornire un mezzo per il download di un record s i dati binari associati è necessario eseguire passaggi aggiuntivi.</span><span class="sxs-lookup"><span data-stu-id="8f65f-114">The interface used for inserting new records has to be updated to allow the user to upload a file from their computer and extra steps must be taken to display or provide a means for downloading a record s associated binary data.</span></span> <span data-ttu-id="8f65f-115">In questa esercitazione e i successivi tre si esamineranno come hurdle queste sfide.</span><span class="sxs-lookup"><span data-stu-id="8f65f-115">In this tutorial and the next three we'll explore how to hurdle these challenges.</span></span> <span data-ttu-id="8f65f-116">Al termine di queste esercitazioni si verrà compilata un'applicazione completamente funzionale che associa un'immagine e brochure PDF a ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="8f65f-116">At the end of these tutorials we'll have built a fully functional application that associates a picture and PDF brochure with each category.</span></span> <span data-ttu-id="8f65f-117">In questa esercitazione particolare viene esaminata diverse tecniche per l'archiviazione dei dati binari ed esplorare come permettere agli utenti di caricare un file dal computer e sono salvati nel file system s server web.</span><span class="sxs-lookup"><span data-stu-id="8f65f-117">In this particular tutorial we'll look at different techniques for storing binary data and explore how to enable users to upload a file from their computer and have it saved on the web server s file system.</span></span>

> [!NOTE]
> <span data-ttu-id="8f65f-118">Dati binari che fa parte di un modello di dati applicazione s sono talvolta detta un [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), l'acronimo di oggetto binario di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-118">Binary data that is part of an application s data model is sometimes referred to as a [BLOB](http://en.wikipedia.org/wiki/Binary_large_object), an acronym for Binary Large OBject.</span></span> <span data-ttu-id="8f65f-119">In queste esercitazioni ho scelto di utilizzare i dati binari di terminologia, sebbene il termine BLOB è sinonimo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-119">In these tutorials I have chosen to use the terminology binary data, although the term BLOB is synonymous.</span></span>


## <a name="step-1-creating-the-working-with-binary-data-web-pages"></a><span data-ttu-id="8f65f-120">Passaggio 1: Creazione di lavoro con le pagine Web di dati binari</span><span class="sxs-lookup"><span data-stu-id="8f65f-120">Step 1: Creating the Working with Binary Data Web Pages</span></span>

<span data-ttu-id="8f65f-121">Prima di iniziare a esplorare i problemi associati all'aggiunta del supporto per i dati binari, consentire s attentamente prima di creare le pagine ASP.NET nel progetto sito Web che è necessario per questa esercitazione e i successivi tre.</span><span class="sxs-lookup"><span data-stu-id="8f65f-121">Before we begin to explore the challenges associated with adding support for binary data, let s first take a moment to create the ASP.NET pages in our website project that we'll need for this tutorial and the next three.</span></span> <span data-ttu-id="8f65f-122">Per iniziare, aggiungere una nuova cartella denominata `BinaryData`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-122">Start by adding a new folder named `BinaryData`.</span></span> <span data-ttu-id="8f65f-123">Successivamente, aggiungere le seguenti pagine ASP.NET a quella cartella, assicurandosi di associare ogni pagina con il `Site.master` pagina master:</span><span class="sxs-lookup"><span data-stu-id="8f65f-123">Next, add the following ASP.NET pages to that folder, making sure to associate each page with the `Site.master` master page:</span></span>

- `Default.aspx`
- `FileUpload.aspx`
- `DisplayOrDownloadData.aspx`
- `UploadInDetailsView.aspx`
- `UpdatingAndDeleting.aspx`


![Aggiungere le pagine ASP.NET per le esercitazioni relative ai dati binari](uploading-files-vb/_static/image1.gif)

<span data-ttu-id="8f65f-125">**Figura 1**: aggiungere le pagine ASP.NET per le esercitazioni relative ai dati binari</span><span class="sxs-lookup"><span data-stu-id="8f65f-125">**Figure 1**: Add the ASP.NET Pages for the Binary Data-Related Tutorials</span></span>


<span data-ttu-id="8f65f-126">Come in altre cartelle, `Default.aspx` nel `BinaryData` cartella elencherà le esercitazioni nella relativa sezione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-126">Like in the other folders, `Default.aspx` in the `BinaryData` folder will list the tutorials in its section.</span></span> <span data-ttu-id="8f65f-127">Tenere presente che il `SectionLevelTutorialListing.ascx` controllo utente fornisce questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="8f65f-127">Recall that the `SectionLevelTutorialListing.ascx` User Control provides this functionality.</span></span> <span data-ttu-id="8f65f-128">Pertanto, aggiungere il controllo utente `Default.aspx` trascinandolo da Esplora soluzioni nella pagina di visualizzazione della struttura s.</span><span class="sxs-lookup"><span data-stu-id="8f65f-128">Therefore, add this User Control to `Default.aspx` by dragging it from the Solution Explorer onto the page s Design view.</span></span>


<span data-ttu-id="8f65f-129">[![Aggiungere il controllo utente SectionLevelTutorialListing.ascx Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-129">[![Add the SectionLevelTutorialListing.ascx User Control to Default.aspx](uploading-files-vb/_static/image2.gif)](uploading-files-vb/_static/image1.png)</span></span>

<span data-ttu-id="8f65f-130">**Figura 2**: aggiungere il `SectionLevelTutorialListing.ascx` controllo utente al `Default.aspx` ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-130">**Figure 2**: Add the `SectionLevelTutorialListing.ascx` User Control to `Default.aspx` ([Click to view full-size image](uploading-files-vb/_static/image2.png))</span></span>


<span data-ttu-id="8f65f-131">Infine, aggiungere tali pagine come voci per il `Web.sitemap` file.</span><span class="sxs-lookup"><span data-stu-id="8f65f-131">Lastly, add these pages as entries to the `Web.sitemap` file.</span></span> <span data-ttu-id="8f65f-132">In particolare, aggiungere il markup seguente dopo l'ottimizzazione GridView `<siteMapNode>`:</span><span class="sxs-lookup"><span data-stu-id="8f65f-132">Specifically, add the following markup after the Enhancing the GridView `<siteMapNode>`:</span></span>


[!code-xml[Main](uploading-files-vb/samples/sample1.xml)]

<span data-ttu-id="8f65f-133">Dopo aver aggiornato `Web.sitemap`, dedicare alcuni minuti per visualizzare il sito Web esercitazioni tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8f65f-133">After updating `Web.sitemap`, take a moment to view the tutorials website through a browser.</span></span> <span data-ttu-id="8f65f-134">Il menu a sinistra ora include gli elementi per l'utilizzo con le esercitazioni di dati binari.</span><span class="sxs-lookup"><span data-stu-id="8f65f-134">The menu on the left now includes items for the Working with Binary Data tutorials.</span></span>


![Mappa del sito include ora le voci per l'utilizzo con le esercitazioni di dati binari](uploading-files-vb/_static/image3.gif)

<span data-ttu-id="8f65f-136">**Figura 3**: mappa del sito include ora le voci per lavorare con i dati binari esercitazioni</span><span class="sxs-lookup"><span data-stu-id="8f65f-136">**Figure 3**: The Site Map Now Includes Entries for the Working with Binary Data Tutorials</span></span>


## <a name="step-2-deciding-where-to-store-the-binary-data"></a><span data-ttu-id="8f65f-137">Passaggio 2: Decidere dove archiviare i dati binari</span><span class="sxs-lookup"><span data-stu-id="8f65f-137">Step 2: Deciding Where to Store the Binary Data</span></span>

<span data-ttu-id="8f65f-138">Dati binari che sono associati al modello di dati applicazione s possono essere archiviati in una delle due posizioni: in un sistema file server s web con un riferimento al file archiviato nel database. o direttamente all'interno del database stesso (vedere la figura 4).</span><span class="sxs-lookup"><span data-stu-id="8f65f-138">Binary data that is associated with the application s data model can be stored in one of two places: on the web server s file system with a reference to the file stored in the database; or directly within the database itself (see Figure 4).</span></span> <span data-ttu-id="8f65f-139">Ogni approccio presenta un proprio set di vantaggi e svantaggi e merita una discussione più dettagliata.</span><span class="sxs-lookup"><span data-stu-id="8f65f-139">Each approach has its own set of pros and cons and merits a more detailed discussion.</span></span>


<span data-ttu-id="8f65f-140">[![Dati binari possono essere archiviati nel File System o direttamente nel Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-140">[![Binary Data Can Be Stored On the File System or Directly in the Database](uploading-files-vb/_static/image4.gif)](uploading-files-vb/_static/image3.png)</span></span>

<span data-ttu-id="8f65f-141">**Figura 4**: dati binari possono essere archiviati nel File System o direttamente nel Database ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-141">**Figure 4**: Binary Data Can Be Stored On the File System or Directly in the Database ([Click to view full-size image](uploading-files-vb/_static/image4.png))</span></span>


<span data-ttu-id="8f65f-142">Si supponga di voler estendere il database Northwind per associare un'immagine a ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="8f65f-142">Imagine that we wanted to extend the Northwind database to associate a picture with each product.</span></span> <span data-ttu-id="8f65f-143">Un'opzione, è possibile archiviare questi file di immagine nel file system s server web e registrare il percorso di `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="8f65f-143">One option would be to store these image files on the web server s file system and record the path in the `Products` table.</span></span> <span data-ttu-id="8f65f-144">Con questo approccio, d aggiungiamo un `ImagePath` colonna per il `Products` tabella di tipo `varchar(200)`, ad esempio.</span><span class="sxs-lookup"><span data-stu-id="8f65f-144">With this approach, we d add an `ImagePath` column to the `Products` table of type `varchar(200)`, perhaps.</span></span> <span data-ttu-id="8f65f-145">Quando un utente di caricare un'immagine per Chai, tale immagine è archiviata nel file system s server web in `~/Images/Tea.jpg`, dove `~` rappresenta il percorso fisico dell'applicazione s.</span><span class="sxs-lookup"><span data-stu-id="8f65f-145">When a user uploaded a picture for Chai, that picture might be stored on the web server s file system at `~/Images/Tea.jpg`, where `~` represents the application s physical path.</span></span> <span data-ttu-id="8f65f-146">Ovvero, se il sito web con radice nel percorso fisico `C:\Websites\Northwind\`, `~/Images/Tea.jpg` sarebbe equivalente al `C:\Websites\Northwind\Images\Tea.jpg`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-146">That is, if the web site is rooted at the physical path `C:\Websites\Northwind\`, `~/Images/Tea.jpg` would be equivalent to `C:\Websites\Northwind\Images\Tea.jpg`.</span></span> <span data-ttu-id="8f65f-147">Dopo aver caricato il file di immagine, d è aggiornare il record Chai nel `Products` tabella in modo che il relativo `ImagePath` colonna a cui fa riferimento il percorso della nuova immagine.</span><span class="sxs-lookup"><span data-stu-id="8f65f-147">After uploading the image file, we d update the Chai record in the `Products` table so that its `ImagePath` column referenced the path of the new image.</span></span> <span data-ttu-id="8f65f-148">È possibile usare `~/Images/Tea.jpg` o semplicemente `Tea.jpg` se si è deciso che sarebbero state posizionate tutte le immagini del prodotto in s applicazione `Images` cartella.</span><span class="sxs-lookup"><span data-stu-id="8f65f-148">We could use `~/Images/Tea.jpg` or just `Tea.jpg` if we decided that all product images would be placed in the application s `Images` folder.</span></span>

<span data-ttu-id="8f65f-149">I vantaggi principali di archiviare i dati binari nel file system sono:</span><span class="sxs-lookup"><span data-stu-id="8f65f-149">The main advantages of storing the binary data on the file system are:</span></span>

- <span data-ttu-id="8f65f-150">**Facilità di implementazione** come vedremo a breve, archiviare e recuperare dati binari archiviati direttamente all'interno del database richiede un po' più codice rispetto a quando l'utilizzo dei dati tramite il file system.</span><span class="sxs-lookup"><span data-stu-id="8f65f-150">**Ease of implementation** as we'll see shortly, storing and retrieving binary data stored directly within the database involves a bit more code than when working with data through the file system.</span></span> <span data-ttu-id="8f65f-151">Inoltre, affinché un utente di visualizzare o scaricare dati binari devono essere presentati con un URL a tali dati.</span><span class="sxs-lookup"><span data-stu-id="8f65f-151">Additionally, in order for a user to view or download binary data they must be presented with a URL to that data.</span></span> <span data-ttu-id="8f65f-152">Se i dati si trovano nel file system s server web, l'URL è semplice.</span><span class="sxs-lookup"><span data-stu-id="8f65f-152">If the data resides on the web server s file system, the URL is straightforward.</span></span> <span data-ttu-id="8f65f-153">Se i dati vengono archiviati nel database, tuttavia, una pagina web. deve essere creato che recupererà e restituire i dati dal database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-153">If the data is stored in the database, however, a web page needs to be created that will retrieve and return the data from the database.</span></span>
- <span data-ttu-id="8f65f-154">**Estendere l'accesso ai dati binari** potrebbero devono essere accessibili ad altri servizi o applicazioni, quelle che non è possibile estrarre i dati dal database i dati binari.</span><span class="sxs-lookup"><span data-stu-id="8f65f-154">**Wider access to the binary data** the binary data may need to be accessible to other services or applications, ones that cannot pull the data from the database.</span></span> <span data-ttu-id="8f65f-155">Ad esempio, le immagini associate a ogni prodotto inoltre potrebbe essere necessario rendere disponibili agli utenti tramite [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), nel qual caso d da archiviare i dati binari nel file system.</span><span class="sxs-lookup"><span data-stu-id="8f65f-155">For example, the images associated with each product might also need to be available to users through [FTP](http://en.wikipedia.org/wiki/File_Transfer_Protocol), in which case we d want to store the binary data on the file system.</span></span>
- <span data-ttu-id="8f65f-156">**Prestazioni** se i dati binari vengono archiviati nel file system, congestione richiesta e di rete tra il server di database e il server web sarà minore se i dati binari vengono archiviati direttamente all'interno del database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-156">**Performance** if the binary data is stored on the file system, the demand and network congestion between the database server and web server will be less than if the binary data is stored directly within the database.</span></span>

<span data-ttu-id="8f65f-157">Lo svantaggio principale di archiviare i dati binari nel file system è che separa i dati dal database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-157">The main disadvantage of storing binary data on the file system is that it decouples the data from the database.</span></span> <span data-ttu-id="8f65f-158">Se viene eliminato un record dal `Products` della tabella, i file associato nel file system s server web non viene eliminata automaticamente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-158">If a record is deleted from the `Products` table, the associated file on the web server s file system is not automatically deleted.</span></span> <span data-ttu-id="8f65f-159">È necessario scrivere codice aggiuntivo per eliminare il file o nel file system verrà accumularsi di file orfani, inutilizzati.</span><span class="sxs-lookup"><span data-stu-id="8f65f-159">We must write extra code to delete the file or the file system will become cluttered with unused, orphaned files.</span></span> <span data-ttu-id="8f65f-160">Inoltre, durante il backup del database, è necessario assicurarsi di eseguire il backup di dati binari associati nel file system, nonché.</span><span class="sxs-lookup"><span data-stu-id="8f65f-160">Furthermore, when backing up the database, we must make sure to make backups of the associated binary data on the file system, as well.</span></span> <span data-ttu-id="8f65f-161">Spostare il database in un altro sito o server comporta simile problematiche.</span><span class="sxs-lookup"><span data-stu-id="8f65f-161">Moving the database to another site or server poses similar challenges.</span></span>

<span data-ttu-id="8f65f-162">In alternativa, dati binari possono essere archiviati direttamente in un database di Microsoft SQL Server 2005 mediante la creazione di una colonna di tipo `varbinary`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-162">Alternatively, binary data can be stored directly in a Microsoft SQL Server 2005 database by creating a column of type `varbinary`.</span></span> <span data-ttu-id="8f65f-163">Come con altri tipi di dati di lunghezza variabile, è possibile specificare una lunghezza massima dei dati binari che possono essere contenuti in questa colonna.</span><span class="sxs-lookup"><span data-stu-id="8f65f-163">Like with other variable length data types, you can specify a maximum length of the binary data that can be held in this column.</span></span> <span data-ttu-id="8f65f-164">Ad esempio, da riservare al massimo 5.000 byte utilizzare `varbinary(5000)`; `varbinary(MAX)` consente per le dimensioni massime di archiviazione, circa 2 GB.</span><span class="sxs-lookup"><span data-stu-id="8f65f-164">For example, to reserve at most 5,000 bytes use `varbinary(5000)`; `varbinary(MAX)` allows for the maximum storage size, about 2 GB.</span></span>

<span data-ttu-id="8f65f-165">Il vantaggio principale di archiviazione di dati binari direttamente nel database è la stretta integrazione tra i dati binari e il record del database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-165">The main advantage of storing binary data directly in the database is the tight coupling between the binary data and the database record.</span></span> <span data-ttu-id="8f65f-166">Questo semplifica notevolmente l'attività di amministrazione di database, ad esempio backup o lo spostamento del database in un server o un sito diverso.</span><span class="sxs-lookup"><span data-stu-id="8f65f-166">This greatly simplifies database administration tasks, like backups or moving the database to a different site or server.</span></span> <span data-ttu-id="8f65f-167">Inoltre, un record automaticamente se si elimina i dati binari corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="8f65f-167">Also, deleting a record automatically deletes the corresponding binary data.</span></span> <span data-ttu-id="8f65f-168">Esistono inoltre altre meno evidenti vantaggi offerti dall'archiviazione i dati binari nel database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-168">There are also more subtle benefits of storing the binary data in the database.</span></span> <span data-ttu-id="8f65f-169">Vedere [archiviazione binario file direttamente nel Database utilizzando ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) per una discussione più dettagliata.</span><span class="sxs-lookup"><span data-stu-id="8f65f-169">See [Storing Binary Files Directly in the Database Using ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/120606-1.aspx) for a more in-depth discussion.</span></span>

> [!NOTE]
> <span data-ttu-id="8f65f-170">In Microsoft SQL Server 2000 e versioni precedenti, il `varbinary` del tipo di dati sono un limite massimo di 8.000 byte.</span><span class="sxs-lookup"><span data-stu-id="8f65f-170">In Microsoft SQL Server 2000 and earlier versions, the `varbinary` data type had a maximum limit of 8,000 bytes.</span></span> <span data-ttu-id="8f65f-171">Per archiviare fino a 2 GB di dati binari di [ `image` tipo di dati](https://msdn.microsoft.com/library/ms187993.aspx) deve essere utilizzato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-171">To store up to 2 GB of binary data the [`image` data type](https://msdn.microsoft.com/library/ms187993.aspx) needs to be used instead.</span></span> <span data-ttu-id="8f65f-172">Con l'aggiunta di `MAX` in SQL Server 2005, tuttavia, il `image` tipo di dati è stato deprecato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-172">With the addition of `MAX` in SQL Server 2005, however, the `image` data type has been deprecated.</span></span> <span data-ttu-id="8f65f-173">È s ancora supportata per la compatibilità, ma Microsoft ha annunciato che la `image` il tipo di dati verrà rimossa in una versione futura di SQL Server.</span><span class="sxs-lookup"><span data-stu-id="8f65f-173">It s still supported for backwards compatibility, but Microsoft has announced that the `image` data type will be removed in a future version of SQL Server.</span></span>


<span data-ttu-id="8f65f-174">Se si sta usando un modello di dati precedente venga visualizzato il `image` tipo di dati.</span><span class="sxs-lookup"><span data-stu-id="8f65f-174">If you are working with an older data model you may see the `image` data type.</span></span> <span data-ttu-id="8f65f-175">Il database Northwind s `Categories` tabella include un `Picture` colonna che può essere utilizzato per archiviare i dati binari di un file di immagine per la categoria.</span><span class="sxs-lookup"><span data-stu-id="8f65f-175">The Northwind database s `Categories` table has a `Picture` column that can be used to store the binary data of an image file for the category.</span></span> <span data-ttu-id="8f65f-176">Poiché il database Northwind ha radici in Microsoft Access e le versioni precedenti di SQL Server, questa colonna è di tipo `image`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-176">Since the Northwind database has its roots in Microsoft Access and earlier versions of SQL Server, this column is of type `image`.</span></span>

<span data-ttu-id="8f65f-177">Per questa esercitazione e i successivi tre, useremo entrambi gli approcci.</span><span class="sxs-lookup"><span data-stu-id="8f65f-177">For this tutorial and the next three, we'll use both approaches.</span></span> <span data-ttu-id="8f65f-178">Il `Categories` tabella dispone già di un `Picture` colonna per l'archiviazione del contenuto binario di un'immagine per la categoria.</span><span class="sxs-lookup"><span data-stu-id="8f65f-178">The `Categories` table already has a `Picture` column for storing the binary content of an image for the category.</span></span> <span data-ttu-id="8f65f-179">Verrà aggiunto una colonna aggiuntiva, `BrochurePath`, per archiviare il percorso di un file PDF nel file system che può essere usato per fornire una panoramica di qualità di stampa, elegante della categoria di web server s.</span><span class="sxs-lookup"><span data-stu-id="8f65f-179">We'll add an additional column, `BrochurePath`, to store a path to a PDF on the web server s file system that can be used to provide a print-quality, polished overview of the category.</span></span>

## <a name="step-3-adding-thebrochurepathcolumn-to-thecategoriestable"></a><span data-ttu-id="8f65f-180">Passaggio 3: Aggiunta di`BrochurePath`colonna per il`Categories`tabella</span><span class="sxs-lookup"><span data-stu-id="8f65f-180">Step 3: Adding the`BrochurePath`Column to the`Categories`Table</span></span>

<span data-ttu-id="8f65f-181">Attualmente la tabella Categories presenta solo quattro colonne: `CategoryID`, `CategoryName`, `Description`, e `Picture`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-181">Currently the Categories table has only four columns: `CategoryID`, `CategoryName`, `Description`, and `Picture`.</span></span> <span data-ttu-id="8f65f-182">Oltre a questi campi, è necessario aggiungere una nuova istanza che farà riferimento a brochure categoria s (se presente).</span><span class="sxs-lookup"><span data-stu-id="8f65f-182">In addition to these fields, we need to add a new one that will point to the category s brochure (if one exists).</span></span> <span data-ttu-id="8f65f-183">Per aggiungere questa colonna, è possibile tornare a Esplora Server, il drill-down nelle tabelle, fare clic su di `Categories` tabella e scegliere Apri definizione tabella (vedere Figura 5).</span><span class="sxs-lookup"><span data-stu-id="8f65f-183">To add this column, go to the Server Explorer, drill down into the Tables, right-click on the `Categories` table and choose Open Table Definition (see Figure 5).</span></span> <span data-ttu-id="8f65f-184">Se non è possibile visualizzare Esplora Server, viene visualizzata selezionando l'opzione di Esplora Server dal menu Visualizza o premere Ctrl + Alt + S.</span><span class="sxs-lookup"><span data-stu-id="8f65f-184">If you do not see the Server Explorer, bring it up by selecting the Server Explorer option from the View menu, or hit Ctrl+Alt+S.</span></span>

<span data-ttu-id="8f65f-185">Aggiungere un nuovo `varchar(200)` colonna per il `Categories` tabella denominata `BrochurePath` ed `NULL` s e fare clic sull'icona Salva (o premere Ctrl + S).</span><span class="sxs-lookup"><span data-stu-id="8f65f-185">Add a new `varchar(200)` column to the `Categories` table that is named `BrochurePath` and allows `NULL` s and click the Save icon (or hit Ctrl+S).</span></span>


<span data-ttu-id="8f65f-186">[![Aggiungere una colonna BrochurePath con la tabella Categories](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-186">[![Add a BrochurePath Column to the Categories Table](uploading-files-vb/_static/image5.gif)](uploading-files-vb/_static/image5.png)</span></span>

<span data-ttu-id="8f65f-187">**Figura 5**: aggiungere un `BrochurePath` colonna il `Categories` tabella ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-187">**Figure 5**: Add a `BrochurePath` Column to the `Categories` Table ([Click to view full-size image](uploading-files-vb/_static/image6.png))</span></span>


## <a name="step-4-updating-the-architecture-to-use-thepictureandbrochurepathcolumns"></a><span data-ttu-id="8f65f-188">Passaggio 4: Aggiornamento dell'architettura da usare il`Picture`e`BrochurePath`colonne</span><span class="sxs-lookup"><span data-stu-id="8f65f-188">Step 4: Updating the Architecture to Use the`Picture`and`BrochurePath`Columns</span></span>

<span data-ttu-id="8f65f-189">Il `CategoriesDataTable` nel livello accesso dati (DAL) sono attualmente disponibili quattro `DataColumn` definiti: `CategoryID`, `CategoryName`, `Description`, e `NumberOfProducts`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-189">The `CategoriesDataTable` in the Data Access Layer (DAL) currently has four `DataColumn` s defined: `CategoryID`, `CategoryName`, `Description`, and `NumberOfProducts`.</span></span> <span data-ttu-id="8f65f-190">Quando è stato progettato inizialmente questa DataTable nel [la creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-vb.md) esercitazione il `CategoriesDataTable` erano disponibili solo le prime tre colonne; il `NumberOfProducts` colonna è stato aggiunto nel [Master-Details mediante un puntato Elenco di record Master con un controllo DataList dettagli](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-190">When we originally designed this DataTable in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-vb.md) tutorial, the `CategoriesDataTable` only had the first three columns; the `NumberOfProducts` column was added in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial.</span></span>

<span data-ttu-id="8f65f-191">Come descritto in *la creazione di un livello di accesso ai dati*, DataTable nel DataSet tipizzato costituiscono gli oggetti business.</span><span class="sxs-lookup"><span data-stu-id="8f65f-191">As discussed in *Creating a Data Access Layer*, the DataTables in the Typed DataSet make up the business objects.</span></span> <span data-ttu-id="8f65f-192">Gli oggetti TableAdapter sono responsabili per la comunicazione con il database e agli oggetti business con i risultati della query.</span><span class="sxs-lookup"><span data-stu-id="8f65f-192">The TableAdapters are responsible for communicating with the database and populating the business objects with the query results.</span></span> <span data-ttu-id="8f65f-193">Il `CategoriesDataTable` è popolato dal `CategoriesTableAdapter`, che dispone di tre metodi di recupero di dati:</span><span class="sxs-lookup"><span data-stu-id="8f65f-193">The `CategoriesDataTable` is populated by the `CategoriesTableAdapter`, which has three data retrieval methods:</span></span>

- <span data-ttu-id="8f65f-194">`GetCategories()` esegue la query principale s TableAdapter e restituisce il `CategoryID`, `CategoryName`, e `Description` i campi di tutti i record di `Categories` tabella.</span><span class="sxs-lookup"><span data-stu-id="8f65f-194">`GetCategories()` executes the TableAdapter s main query and returns the `CategoryID`, `CategoryName`, and `Description` fields of all records in the `Categories` table.</span></span> <span data-ttu-id="8f65f-195">La query principale viene utilizzato per la generazione automatica `Insert` e `Update` metodi.</span><span class="sxs-lookup"><span data-stu-id="8f65f-195">The main query is what is used by the auto-generated `Insert` and `Update` methods.</span></span>
- <span data-ttu-id="8f65f-196">`GetCategoryByCategoryID(categoryID)` Restituisce il `CategoryID`, `CategoryName`, e `Description` i campi della categoria di cui `CategoryID` è uguale a *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="8f65f-196">`GetCategoryByCategoryID(categoryID)` returns the `CategoryID`, `CategoryName`, and `Description` fields of the category whose `CategoryID` equals *categoryID*.</span></span>
- <span data-ttu-id="8f65f-197">`GetCategoriesAndNumberOfProducts()` -Restituisce il `CategoryID`, `CategoryName`, e `Description` i campi per tutti i record di `Categories` tabella.</span><span class="sxs-lookup"><span data-stu-id="8f65f-197">`GetCategoriesAndNumberOfProducts()` - returns the `CategoryID`, `CategoryName`, and `Description` fields for all records in the `Categories` table.</span></span> <span data-ttu-id="8f65f-198">Utilizza inoltre una sottoquery per restituire il numero di prodotti associati a ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="8f65f-198">Also uses a subquery to return the number of products associated with each category.</span></span>

<span data-ttu-id="8f65f-199">Si noti che nessuna di queste query restituiscono il `Categories` tabella s `Picture` o `BrochurePath` colonne; e non il `CategoriesDataTable` fornire `DataColumn` s per questi campi.</span><span class="sxs-lookup"><span data-stu-id="8f65f-199">Notice that none of these queries return the `Categories` table s `Picture` or `BrochurePath` columns; nor does the `CategoriesDataTable` provide `DataColumn` s for these fields.</span></span> <span data-ttu-id="8f65f-200">Per poter funzionare con l'immagine e `BrochurePath` proprietà, è necessario prima aggiungerli al `CategoriesDataTable` e quindi aggiornare la `CategoriesTableAdapter` classe per restituire le colonne.</span><span class="sxs-lookup"><span data-stu-id="8f65f-200">In order to work with the Picture and `BrochurePath` properties, we need to first add them to the `CategoriesDataTable` and then update the `CategoriesTableAdapter` class to return these columns.</span></span>

## <a name="adding-thepictureandbrochurepathdatacolumn-s"></a><span data-ttu-id="8f65f-201">Aggiunta di`Picture`e`BrochurePath``DataColumn` s</span><span class="sxs-lookup"><span data-stu-id="8f65f-201">Adding the`Picture`and`BrochurePath``DataColumn` s</span></span>

<span data-ttu-id="8f65f-202">Per iniziare, aggiungere queste due colonne per la `CategoriesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-202">Start by adding these two columns to the `CategoriesDataTable`.</span></span> <span data-ttu-id="8f65f-203">Fare clic su di `CategoriesDataTable` intestazione s, selezionare Aggiungi dal menu di scelta rapida e quindi scegliere l'opzione di colonna.</span><span class="sxs-lookup"><span data-stu-id="8f65f-203">Right-click on the `CategoriesDataTable` s header, select Add from the context menu and then choose the Column option.</span></span> <span data-ttu-id="8f65f-204">Verrà creato un nuovo `DataColumn` nel DataTable denominata `Column1`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-204">This will create a new `DataColumn` in the DataTable named `Column1`.</span></span> <span data-ttu-id="8f65f-205">Rinominare questa colonna come `Picture`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-205">Rename this column to `Picture`.</span></span> <span data-ttu-id="8f65f-206">La finestra Proprietà impostare il `DataColumn` s `DataType` proprietà `System.Byte[]` (non è un'opzione nell'elenco a discesa, è necessario digitarla nella).</span><span class="sxs-lookup"><span data-stu-id="8f65f-206">From the Properties window, set the `DataColumn` s `DataType` property to `System.Byte[]` (this is not an option in the drop-down list; you need to type it in).</span></span>


<span data-ttu-id="8f65f-207">[![Creare un'immagine denominata DataColumn il cui tipo di dati è System. byte]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-207">[![Create a DataColumn Named Picture whose DataType is System.Byte[]](uploading-files-vb/_static/image6.gif)](uploading-files-vb/_static/image7.png)</span></span>

<span data-ttu-id="8f65f-208">**Figura 6**: creare un `DataColumn` Named `Picture` cui `DataType` è `System.Byte[]` ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-208">**Figure 6**: Create a `DataColumn` Named `Picture` whose `DataType` is `System.Byte[]` ([Click to view full-size image](uploading-files-vb/_static/image8.png))</span></span>


<span data-ttu-id="8f65f-209">Aggiungere un altro `DataColumn` nella DataTable, denominarla `BrochurePath` utilizzando il valore predefinito `DataType` valore (`System.String`).</span><span class="sxs-lookup"><span data-stu-id="8f65f-209">Add another `DataColumn` to the DataTable, naming it `BrochurePath` using the default `DataType` value (`System.String`).</span></span>

## <a name="returning-thepictureandbrochurepathvalues-from-the-tableadapter"></a><span data-ttu-id="8f65f-210">Restituzione di`Picture`e`BrochurePath`valori dal TableAdapter</span><span class="sxs-lookup"><span data-stu-id="8f65f-210">Returning the`Picture`and`BrochurePath`Values from the TableAdapter</span></span>

<span data-ttu-id="8f65f-211">Con queste due `DataColumn` aggiunta al `CategoriesDataTable`, è nuovamente pronto per l'aggiornamento di `CategoriesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-211">With these two `DataColumn` s added to the `CategoriesDataTable`, we re ready to update the `CategoriesTableAdapter`.</span></span> <span data-ttu-id="8f65f-212">È possibile avere entrambi questi valori di colonna restituiti nella query TableAdapter principale, ma in questo modo viene nuovamente i dati binari ogni volta il `GetCategories()` chiamata del metodo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-212">We could have both of these column values returned in the main TableAdapter query, but this would bring back the binary data every time the `GetCategories()` method was invoked.</span></span> <span data-ttu-id="8f65f-213">Aggiornare la query TableAdapter principale per riportare invece consentono s `BrochurePath` e creare un metodo di recupero di dati aggiuntivi che restituisce una particolare categoria s `Picture` colonna.</span><span class="sxs-lookup"><span data-stu-id="8f65f-213">Instead, let s update the main TableAdapter query to bring back `BrochurePath` and create an additional data retrieval method that returns a particular category s `Picture` column.</span></span>

<span data-ttu-id="8f65f-214">Per aggiornare la query TableAdapter principale, fare clic su di `CategoriesTableAdapter` intestazione s e scegliere l'opzione di configurazione dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="8f65f-214">To update the main TableAdapter query, right-click on the `CategoriesTableAdapter` s header and choose the Configure option from the context menu.</span></span> <span data-ttu-id="8f65f-215">Verrà visualizzata la configurazione guidata adattatore tabella cui è visualizzata in una serie di esercitazioni precedenti ve.</span><span class="sxs-lookup"><span data-stu-id="8f65f-215">This brings up the Table Adapter Configuration Wizard, which we ve seen in a number of past tutorials.</span></span> <span data-ttu-id="8f65f-216">Aggiornare la query per riportare il `BrochurePath` e fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="8f65f-216">Update the query to bring back the `BrochurePath` and click Finish.</span></span>


<span data-ttu-id="8f65f-217">[![Aggiornare l'elenco colonne nell'istruzione SELECT per restituire anche BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-217">[![Update the Column List in the SELECT Statement to Also Return BrochurePath](uploading-files-vb/_static/image7.gif)](uploading-files-vb/_static/image9.png)</span></span>

<span data-ttu-id="8f65f-218">**Figura 7**: aggiornare l'elenco colonne nel `SELECT` istruzione restituisca anche `BrochurePath` ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-218">**Figure 7**: Update the Column List in the `SELECT` Statement to Also Return `BrochurePath` ([Click to view full-size image](uploading-files-vb/_static/image10.png))</span></span>


<span data-ttu-id="8f65f-219">Quando si Usa istruzioni SQL ad hoc per l'oggetto TableAdapter, l'aggiornamento dell'elenco di colonne della query principale aggiorna l'elenco di colonne per tutte le `SELECT` metodi nell'oggetto TableAdapter di query.</span><span class="sxs-lookup"><span data-stu-id="8f65f-219">When using ad-hoc SQL statements for the TableAdapter, updating the column list in the main query updates the column list for all of the `SELECT` query methods in the TableAdapter.</span></span> <span data-ttu-id="8f65f-220">Ciò significa che il `GetCategoryByCategoryID(categoryID)` metodo è stato aggiornato per restituire il `BrochurePath` colonna, che potrebbe essere è voluto.</span><span class="sxs-lookup"><span data-stu-id="8f65f-220">That means the `GetCategoryByCategoryID(categoryID)` method has been updated to return the `BrochurePath` column, which might be what we intended.</span></span> <span data-ttu-id="8f65f-221">Tuttavia, anche aggiornato l'elenco colonne nel `GetCategoriesAndNumberOfProducts()` (metodo), rimuovere la sottoquery che restituisce il numero di prodotti per ogni categoria!</span><span class="sxs-lookup"><span data-stu-id="8f65f-221">However, it also updated the column list in the `GetCategoriesAndNumberOfProducts()` method, removing the subquery that returns the number of products for each category!</span></span> <span data-ttu-id="8f65f-222">Pertanto, è necessario aggiornare questo metodo s `SELECT` query.</span><span class="sxs-lookup"><span data-stu-id="8f65f-222">Therefore, we need to update this method s `SELECT` query.</span></span> <span data-ttu-id="8f65f-223">Fare clic su di `GetCategoriesAndNumberOfProducts()` (metodo), scegliere Configura e ripristinare il `SELECT` query al valore originale:</span><span class="sxs-lookup"><span data-stu-id="8f65f-223">Right-click on the `GetCategoriesAndNumberOfProducts()` method, choose Configure, and revert the `SELECT` query back to its original value:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample2.sql)]

<span data-ttu-id="8f65f-224">Successivamente, creare un nuovo metodo di TableAdapter che restituisce una particolare categoria s `Picture` valore della colonna.</span><span class="sxs-lookup"><span data-stu-id="8f65f-224">Next, create a new TableAdapter method that returns a particular category s `Picture` column value.</span></span> <span data-ttu-id="8f65f-225">Fare clic su di `CategoriesTableAdapter` intestazione s e scegliere l'opzione Aggiungi Query per avviare la configurazione guidata Query TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="8f65f-225">Right-click on the `CategoriesTableAdapter` s header and choose the Add Query option to launch the TableAdapter Query Configuration Wizard.</span></span> <span data-ttu-id="8f65f-226">Il primo passaggio della procedura guidata viene chiesto di specificare che se si desidera eseguire query sui dati utilizzando un'istruzione SQL ad hoc, una nuova stored procedure o una esistente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-226">The first step of this wizard asks us if we want to query data using an ad-hoc SQL statement, a new stored procedure, or an existing one.</span></span> <span data-ttu-id="8f65f-227">Selezionare Usa istruzioni SQL e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="8f65f-227">Select Use SQL statements and click Next.</span></span> <span data-ttu-id="8f65f-228">Poiché si restituisce una riga, scegliere l'istruzione SELECT che restituisce l'opzione di righe del secondo passaggio.</span><span class="sxs-lookup"><span data-stu-id="8f65f-228">Since we will be returning a row, choose the SELECT which returns rows option from the second step.</span></span>


<span data-ttu-id="8f65f-229">[![Selezionare l'Usa istruzioni SQL opzione](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-229">[![Select the Use SQL statements Option](uploading-files-vb/_static/image8.gif)](uploading-files-vb/_static/image11.png)</span></span>

<span data-ttu-id="8f65f-230">**Figura 8**: selezionare l'Usa istruzioni SQL opzione ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-230">**Figure 8**: Select the Use SQL statements Option ([Click to view full-size image](uploading-files-vb/_static/image12.png))</span></span>


<span data-ttu-id="8f65f-231">[![Poiché la Query restituirà un Record dalla tabella Categories, scegliere SELECT che restituisce righe](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-231">[![Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows](uploading-files-vb/_static/image9.gif)](uploading-files-vb/_static/image13.png)</span></span>

<span data-ttu-id="8f65f-232">**Figura 9**: poiché la Query restituirà un Record dalla tabella Categories, scegliere Seleziona che restituisce righe ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-232">**Figure 9**: Since the Query Will Return a Record from the Categories Table, Choose SELECT which returns rows ([Click to view full-size image](uploading-files-vb/_static/image14.png))</span></span>


<span data-ttu-id="8f65f-233">Nel terzo passaggio, immettere la seguente query SQL e fare clic su Avanti:</span><span class="sxs-lookup"><span data-stu-id="8f65f-233">In the third step, enter the following SQL query and click Next:</span></span>


[!code-sql[Main](uploading-files-vb/samples/sample3.sql)]

<span data-ttu-id="8f65f-234">L'ultimo passaggio consiste nello scegliere il nome per il nuovo metodo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-234">The last step is to choose the name for the new method.</span></span> <span data-ttu-id="8f65f-235">Utilizzare `FillCategoryWithBinaryDataByCategoryID` e `GetCategoryWithBinaryDataByCategoryID` per il riempimento del DataTable e restituire un oggetto DataTable modelli, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-235">Use `FillCategoryWithBinaryDataByCategoryID` and `GetCategoryWithBinaryDataByCategoryID` for the Fill a DataTable and Return a DataTable patterns, respectively.</span></span> <span data-ttu-id="8f65f-236">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="8f65f-236">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="8f65f-237">[![Scegliere i nomi per i metodi di s TableAdapter](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-237">[![Choose the Names for the TableAdapter s Methods](uploading-files-vb/_static/image10.gif)](uploading-files-vb/_static/image15.png)</span></span>

<span data-ttu-id="8f65f-238">**Figura 10**: scegliere i nomi per i metodi di TableAdapter ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-238">**Figure 10**: Choose the Names for the TableAdapter s Methods ([Click to view full-size image](uploading-files-vb/_static/image16.png))</span></span>


> [!NOTE]
> <span data-ttu-id="8f65f-239">Dopo aver completato la configurazione guidata Query di tabella Adapter venga visualizzato una finestra di dialogo che informa che il nuovo testo del comando restituisce i dati con uno schema diverso da quello della query principale.</span><span class="sxs-lookup"><span data-stu-id="8f65f-239">After completing the Table Adapter Query Configuration Wizard you may see a dialog box informing you that the new command text returns data with schema different from the schema of the main query.</span></span> <span data-ttu-id="8f65f-240">In breve, la procedura guidata è notare che la query principale di TableAdapter s `GetCategories()` restituisce uno schema diverso da quello appena creato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-240">In short, the wizard is noting that the TableAdapter s main query `GetCategories()` returns a different schema than the one we just created.</span></span> <span data-ttu-id="8f65f-241">Ma questo è ciò che si vuole, pertanto è possibile ignorare questo messaggio.</span><span class="sxs-lookup"><span data-stu-id="8f65f-241">But this is what we want, so you can disregard this message.</span></span>


<span data-ttu-id="8f65f-242">Inoltre, tenere presente che se si utilizzano istruzioni SQL ad hoc e utilizzare la procedura guidata per modificare query TableAdapter s principale in un momento successivo nel tempo, verrà modificato il `GetCategoryWithBinaryDataByCategoryID` metodo s `SELECT` elenco di colonne istruzione s per includere solo le colonne il query principale (ovvero, verrà rimosso il `Picture` colonna dalla query).</span><span class="sxs-lookup"><span data-stu-id="8f65f-242">Also, keep in mind that if you are using ad-hoc SQL statements and use the wizard to change the TableAdapter s main query at some later point in time, it will modify the `GetCategoryWithBinaryDataByCategoryID` method s `SELECT` statement s column list to include just those columns from the main query (that is, it will remove the `Picture` column from the query).</span></span> <span data-ttu-id="8f65f-243">È necessario aggiornare manualmente l'elenco di colonne per restituire il `Picture` colonne, analogamente a quanto avveniva con il `GetCategoriesAndNumberOfProducts()` metodo più indietro in questo passaggio.</span><span class="sxs-lookup"><span data-stu-id="8f65f-243">You will have to manually update the column list to return the `Picture` column, similar to what we did with the `GetCategoriesAndNumberOfProducts()` method earlier in this step.</span></span>

<span data-ttu-id="8f65f-244">Dopo aver aggiunto i due `DataColumn` s per il `CategoriesDataTable` e `GetCategoryWithBinaryDataByCategoryID` metodo il `CategoriesTableAdapter`, queste classi in Progettazione DataSet tipizzati dovrebbero essere simile alla schermata illustrata nella figura 11.</span><span class="sxs-lookup"><span data-stu-id="8f65f-244">After adding the two `DataColumn` s to the `CategoriesDataTable` and the `GetCategoryWithBinaryDataByCategoryID` method to the `CategoriesTableAdapter`, these classes in the Typed DataSet Designer should look like the screenshot in Figure 11.</span></span>


![La finestra di progettazione del set di dati include le nuove colonne (metodo)](uploading-files-vb/_static/image11.gif)

<span data-ttu-id="8f65f-246">**Figura 11**: la finestra di progettazione set di dati include le nuove colonne (metodo)</span><span class="sxs-lookup"><span data-stu-id="8f65f-246">**Figure 11**: The DataSet Designer Includes the New Columns and Method</span></span>


## <a name="updating-the-business-logic-layer-bll"></a><span data-ttu-id="8f65f-247">Aggiornare il livello di logica di Business (BLL)</span><span class="sxs-lookup"><span data-stu-id="8f65f-247">Updating the Business Logic Layer (BLL)</span></span>

<span data-ttu-id="8f65f-248">Con DAL aggiornato, è comunque per aumentare il livello Business (LOGIC) per includere un metodo per il nuovo `CategoriesTableAdapter` metodo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-248">With the DAL updated, all that remains is to augment the Business Logic Layer (BLL) to include a method for the new `CategoriesTableAdapter` method.</span></span> <span data-ttu-id="8f65f-249">Aggiungere il metodo seguente per la `CategoriesBLL` classe:</span><span class="sxs-lookup"><span data-stu-id="8f65f-249">Add the following method to the `CategoriesBLL` class:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample4.vb)]

## <a name="step-5-uploading-a-file-from-the-client-to-the-web-server"></a><span data-ttu-id="8f65f-250">Passaggio 5: Caricare un File dal Client al Server Web</span><span class="sxs-lookup"><span data-stu-id="8f65f-250">Step 5: Uploading a File From the Client to the Web Server</span></span>

<span data-ttu-id="8f65f-251">Quando si raccolgono dati binari, spesso questi dati viene forniti da un utente finale.</span><span class="sxs-lookup"><span data-stu-id="8f65f-251">When collecting binary data, oftentimes this data is supplied by an end user.</span></span> <span data-ttu-id="8f65f-252">Per acquisire queste informazioni, l'utente deve essere in grado di caricare un file dal proprio computer al server web.</span><span class="sxs-lookup"><span data-stu-id="8f65f-252">To capture this information, the user needs to be able to upload a file from their computer to the web server.</span></span> <span data-ttu-id="8f65f-253">I dati caricati devono quindi essere integrata con il modello di dati, che potrebbe impedire il salvataggio del file al file system s del server web e aggiunta di un percorso del file nel database o la scrittura del contenuto binario direttamente nel database.</span><span class="sxs-lookup"><span data-stu-id="8f65f-253">The uploaded data then needs to be integrated with the data model, which may mean saving the file to the web server s file system and adding a path to the file in the database, or writing the binary contents directly into the database.</span></span> <span data-ttu-id="8f65f-254">In questo passaggio verrà esaminato come consentire all'utente di caricare file dal proprio computer al server.</span><span class="sxs-lookup"><span data-stu-id="8f65f-254">In this step we'll look at how to allow a user to upload files from their computer to the server.</span></span> <span data-ttu-id="8f65f-255">Nella prossima esercitazione si verranno prese in esame l'integrazione del file caricato con modello di dati.</span><span class="sxs-lookup"><span data-stu-id="8f65f-255">In the next tutorial we'll turn our attention to integrating the uploaded file with data model.</span></span>

<span data-ttu-id="8f65f-256">ASP.NET 2.0 s nuovo [controllo Web FileUpload](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) fornisce un meccanismo per gli utenti di inviare un file dal proprio computer al server web.</span><span class="sxs-lookup"><span data-stu-id="8f65f-256">ASP.NET 2.0 s new [FileUpload Web control](https://msdn.microsoft.com/library/ms227677(VS.80).aspx) provides a mechanism for users to send a file from their computer to the web server.</span></span> <span data-ttu-id="8f65f-257">Esegue il rendering del controllo FileUpload come un `<input>` elemento il cui `type` attributo è impostato su file, nei browser visualizzato come una casella di testo con un pulsante Sfoglia.</span><span class="sxs-lookup"><span data-stu-id="8f65f-257">The FileUpload control renders as an `<input>` element whose `type` attribute is set to file, which browsers display as a textbox with a Browse button.</span></span> <span data-ttu-id="8f65f-258">Fare clic sul pulsante Sfoglia viene visualizzata una finestra di dialogo da cui l'utente può selezionare un file.</span><span class="sxs-lookup"><span data-stu-id="8f65f-258">Clicking the Browse button brings up a dialog box from which the user can select a file.</span></span> <span data-ttu-id="8f65f-259">Quando il form viene inviato nuovamente, il contenuto di file selezionato s viene inviato insieme il postback.</span><span class="sxs-lookup"><span data-stu-id="8f65f-259">When the form is posted back, the selected file s contents are sent along with the postback.</span></span> <span data-ttu-id="8f65f-260">Sul lato server, informazioni sul file caricato sono accessibile tramite la proprietà controllo FileUpload.</span><span class="sxs-lookup"><span data-stu-id="8f65f-260">On the server-side, information about the uploaded file is accessible through the FileUpload control s properties.</span></span>

<span data-ttu-id="8f65f-261">Per illustrare il caricamento di file, aprire il `FileUpload.aspx` nella pagina di `BinaryData` cartella, trascinare un controllo FileUpload dalla casella degli strumenti nella finestra di progettazione e impostare il controllo s `ID` proprietà `UploadTest`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-261">To demonstrate uploading files, open the `FileUpload.aspx` page in the `BinaryData` folder, drag a FileUpload control from the Toolbox onto the Designer, and set the control s `ID` property to `UploadTest`.</span></span> <span data-ttu-id="8f65f-262">Successivamente, aggiungere un'impostazione di controllo Web Button relativo `ID` e `Text` proprietà `UploadButton` e caricare il File selezionato, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-262">Next, add a Button Web control setting its `ID` and `Text` properties to `UploadButton` and Upload Selected File, respectively.</span></span> <span data-ttu-id="8f65f-263">Infine, inserire un controllo etichetta Web sotto il pulsante, cancellare il contenuto relativo `Text` proprietà e impostare il relativo `ID` proprietà `UploadDetails`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-263">Finally, place a Label Web control beneath the Button, clear out its `Text` property and set its `ID` property to `UploadDetails`.</span></span>


<span data-ttu-id="8f65f-264">[![Aggiungere un controllo FileUpload alla pagina ASP.NET](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-264">[![Add a FileUpload Control to the ASP.NET Page](uploading-files-vb/_static/image12.gif)](uploading-files-vb/_static/image17.png)</span></span>

<span data-ttu-id="8f65f-265">**Figura 12**: aggiungere un controllo FileUpload alla pagina ASP.NET ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-265">**Figure 12**: Add a FileUpload Control to the ASP.NET Page ([Click to view full-size image](uploading-files-vb/_static/image18.png))</span></span>


<span data-ttu-id="8f65f-266">Figura 13 Mostra questa pagina quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="8f65f-266">Figure 13 shows this page when viewed through a browser.</span></span> <span data-ttu-id="8f65f-267">Si noti che facendo clic sul pulsante Sfoglia viene visualizzata una finestra di dialogo di selezione di file, consentendo all'utente di selezionare un file dal computer.</span><span class="sxs-lookup"><span data-stu-id="8f65f-267">Note that clicking the Browse button brings up a file selection dialog box, allowing the user to pick a file from their computer.</span></span> <span data-ttu-id="8f65f-268">Dopo aver selezionato un file, fare clic sul pulsante Carica File selezionato provoca un postback che invia il contenuto binario s file selezionato al server web.</span><span class="sxs-lookup"><span data-stu-id="8f65f-268">Once a file has been selected, clicking the Upload Selected File button causes a postback that sends the selected file s binary content to the web server.</span></span>


<span data-ttu-id="8f65f-269">[![L'utente può selezionare un File da caricare dal proprio Computer al Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-269">[![The User Can Select a File to Upload from their Computer to the Server](uploading-files-vb/_static/image13.gif)](uploading-files-vb/_static/image19.png)</span></span>

<span data-ttu-id="8f65f-270">**Figura 13**: l'utente può selezionare un File da caricare dal proprio Computer al Server ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-270">**Figure 13**: The User Can Select a File to Upload from their Computer to the Server ([Click to view full-size image](uploading-files-vb/_static/image20.png))</span></span>


<span data-ttu-id="8f65f-271">Durante il postback, il file caricato può essere salvato nel file System o i dati binari possono essere gestiti direttamente tramite un flusso.</span><span class="sxs-lookup"><span data-stu-id="8f65f-271">On postback, the uploaded file can be saved to the file system or its binary data can be worked with directly through a Stream.</span></span> <span data-ttu-id="8f65f-272">Per questo esempio, consentire s di creare un `~/Brochures` cartella e salvare il file caricato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-272">For this example, let s create a `~/Brochures` folder and save the uploaded file there.</span></span> <span data-ttu-id="8f65f-273">Per iniziare, aggiungere il `Brochures` cartella per il sito come sottocartella della directory radice.</span><span class="sxs-lookup"><span data-stu-id="8f65f-273">Start by adding the `Brochures` folder to the site as a subfolder of the root directory.</span></span> <span data-ttu-id="8f65f-274">Successivamente, creare un gestore eventi per il `UploadButton` s `Click` eventi e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="8f65f-274">Next, create an event handler for the `UploadButton` s `Click` event and add the following code:</span></span>


[!code-vb[Main](uploading-files-vb/samples/sample5.vb)]

<span data-ttu-id="8f65f-275">Il controllo FileUpload fornisce una serie di proprietà per l'utilizzo con i dati caricati.</span><span class="sxs-lookup"><span data-stu-id="8f65f-275">The FileUpload control provides a variety of properties for working with the uploaded data.</span></span> <span data-ttu-id="8f65f-276">Ad esempio, il [ `HasFile` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indica se un file è stato caricato dall'utente, mentre il [ `FileBytes` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) fornisce l'accesso ai dati binari caricati come una matrice di byte.</span><span class="sxs-lookup"><span data-stu-id="8f65f-276">For instance, the [`HasFile` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.hasfile.aspx) indicates whether a file was uploaded by the user, while the [`FileBytes` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.fileupload.filebytes.aspx) provides access to the uploaded binary data as an array of bytes.</span></span> <span data-ttu-id="8f65f-277">Il `Click` gestore eventi viene avviato, verificare che sia stato caricato un file.</span><span class="sxs-lookup"><span data-stu-id="8f65f-277">The `Click` event handler starts by ensuring that a file has been uploaded.</span></span> <span data-ttu-id="8f65f-278">Se è stato caricato un file, l'etichetta Visualizza il nome del file caricato, la dimensione in byte e il relativo tipo di contenuto.</span><span class="sxs-lookup"><span data-stu-id="8f65f-278">If a file has been uploaded, the Label shows the name of the uploaded file, its size in bytes, and its content-type.</span></span>

> [!NOTE]
> <span data-ttu-id="8f65f-279">Per garantire che l'utente carica un file è possibile controllare il `HasFile` proprietà e visualizzare un avviso se si s `False`, oppure è possibile utilizzare il [controllo RequiredFieldValidator](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) invece.</span><span class="sxs-lookup"><span data-stu-id="8f65f-279">To ensure that the user uploads a file you can check the `HasFile` property and display a warning if it s `False`, or you may use the [RequiredFieldValidator control](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/validation/default.aspx) instead.</span></span>


<span data-ttu-id="8f65f-280">FileUpload s `SaveAs(filePath)` Salva il file caricato specificato *filePath*.</span><span class="sxs-lookup"><span data-stu-id="8f65f-280">The FileUpload s `SaveAs(filePath)` saves the uploaded file to the specified *filePath*.</span></span> <span data-ttu-id="8f65f-281">*filePath* deve essere un *percorso fisico* (`C:\Websites\Brochures\SomeFile.pdf`) anziché un *virtuale* *percorso* (`/Brochures/SomeFile.pdf`).</span><span class="sxs-lookup"><span data-stu-id="8f65f-281">*filePath* must be a *physical path* (`C:\Websites\Brochures\SomeFile.pdf`) rather than a *virtual* *path* (`/Brochures/SomeFile.pdf`).</span></span> <span data-ttu-id="8f65f-282">Il [ `Server.MapPath(virtPath)` metodo](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) accetta un percorso virtuale e restituisce il percorso fisico corrispondente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-282">The [`Server.MapPath(virtPath)` method](https://msdn.microsoft.com/library/system.web.httpserverutility.mappath.aspx) takes a virtual path and returns its corresponding physical path.</span></span> <span data-ttu-id="8f65f-283">In questo caso, il percorso virtuale è `~/Brochures/fileName`, dove *fileName* è il nome del file caricato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-283">Here, the virtual path is `~/Brochures/fileName`, where *fileName* is the name of the uploaded file.</span></span> <span data-ttu-id="8f65f-284">Vedere [utilizzando MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) per ulteriori informazioni su percorsi fisici e virtuali e l'uso `Server.MapPath`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-284">See [Using Server.MapPath](http://www.4guysfromrolla.com/webtech/121799-1.shtml) for more information on virtual and physical paths and using `Server.MapPath`.</span></span>

<span data-ttu-id="8f65f-285">Dopo aver completato il `Click` gestore eventi, è opportuno testare la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="8f65f-285">After completing the `Click` event handler, take a moment to test out the page in a browser.</span></span> <span data-ttu-id="8f65f-286">Fare clic sul pulsante Sfoglia e selezionare un file dal disco rigido e quindi fare clic sul pulsante Carica File selezionato.</span><span class="sxs-lookup"><span data-stu-id="8f65f-286">Click the Browse button and select a file from your hard drive and then click the Upload Selected File button.</span></span> <span data-ttu-id="8f65f-287">Il contenuto del file selezionato invierà il postback al server web, che verranno quindi visualizzate le informazioni sul file prima di salvarla per la `~/Brochures` cartella.</span><span class="sxs-lookup"><span data-stu-id="8f65f-287">The postback will send the contents of the selected file to the web server, which will then display information about the file before saving it to the `~/Brochures` folder.</span></span> <span data-ttu-id="8f65f-288">Dopo aver caricato il file, tornare a Visual Studio e fare clic sul pulsante di aggiornamento in Esplora soluzioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-288">After uploading the file, return to Visual Studio and click the Refresh button in the Solution Explorer.</span></span> <span data-ttu-id="8f65f-289">Si dovrebbe essere visualizzato il file che appena caricato nella cartella ~/Brochures.</span><span class="sxs-lookup"><span data-stu-id="8f65f-289">You should see the file you just uploaded in the ~/Brochures folder!</span></span>


<span data-ttu-id="8f65f-290">[![Una volta caricato il File EvolutionValley.jpg al Server Web](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="8f65f-290">[![The File EvolutionValley.jpg Has Been Uploaded to the Web Server](uploading-files-vb/_static/image14.gif)](uploading-files-vb/_static/image21.png)</span></span>

<span data-ttu-id="8f65f-291">**Figura 14**: il File `EvolutionValley.jpg` è stato caricato per il Server Web ([fare clic per visualizzare l'immagine ingrandita](uploading-files-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="8f65f-291">**Figure 14**: The File `EvolutionValley.jpg` Has Been Uploaded to the Web Server ([Click to view full-size image](uploading-files-vb/_static/image22.png))</span></span>


![EvolutionValley.jpg è stato salvato nella cartella ~/Brochures](uploading-files-vb/_static/image15.gif)

<span data-ttu-id="8f65f-293">**Figura 15**: `EvolutionValley.jpg` è stato salvato il `~/Brochures` cartella</span><span class="sxs-lookup"><span data-stu-id="8f65f-293">**Figure 15**: `EvolutionValley.jpg` Was Saved to the `~/Brochures` Folder</span></span>


## <a name="subtleties-with-saving-uploaded-files-to-the-file-system"></a><span data-ttu-id="8f65f-294">Sfumature con il salvataggio di file caricati nel File System</span><span class="sxs-lookup"><span data-stu-id="8f65f-294">Subtleties with Saving Uploaded Files to the File System</span></span>

<span data-ttu-id="8f65f-295">Esistono diverse sfumature che devono essere risolti durante il salvataggio di caricamento dei file nel file System di web server s.</span><span class="sxs-lookup"><span data-stu-id="8f65f-295">There are several subtleties that must be addressed when saving uploading files to the web server s file system.</span></span> <span data-ttu-id="8f65f-296">Innanzitutto, esiste il problema di sicurezza.</span><span class="sxs-lookup"><span data-stu-id="8f65f-296">First, there s the issue of security.</span></span> <span data-ttu-id="8f65f-297">Per salvare un file nel file System, il contesto di sicurezza in cui è in esecuzione la pagina ASP.NET deve disporre delle autorizzazioni di scrittura.</span><span class="sxs-lookup"><span data-stu-id="8f65f-297">To save a file to the file system, the security context under which the ASP.NET page is executing must have Write permissions.</span></span> <span data-ttu-id="8f65f-298">Il Server Web di sviluppo ASP.NET viene eseguito nel contesto dell'account utente corrente.</span><span class="sxs-lookup"><span data-stu-id="8f65f-298">The ASP.NET Development Web Server runs under the context of your current user account.</span></span> <span data-ttu-id="8f65f-299">Se si utilizza s Microsoft Internet Information Services (IIS) come server web, il contesto di sicurezza dipende dalla versione di IIS e la relativa configurazione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-299">If you are using Microsoft s Internet Information Services (IIS) as the web server, the security context depends on the version of IIS and its configuration.</span></span>

<span data-ttu-id="8f65f-300">Un'altra richiesta di salvataggio dei file nel file System si basa su denominazione dei file.</span><span class="sxs-lookup"><span data-stu-id="8f65f-300">Another challenge of saving files to the file system revolves around naming the files.</span></span> <span data-ttu-id="8f65f-301">Attualmente, la pagina Salva tutti i file caricati per la `~/Brochures` directory utilizzando lo stesso nome del file nel computer client s.</span><span class="sxs-lookup"><span data-stu-id="8f65f-301">Currently, our page saves all of the uploaded files to the `~/Brochures` directory using the same name as the file on the client s computer.</span></span> <span data-ttu-id="8f65f-302">Se l'utente carica una brochure con il nome `Brochure.pdf`, il file verrà salvato come `~/Brochure/Brochure.pdf`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-302">If User A uploads a brochure with the name `Brochure.pdf`, the file will be saved as `~/Brochure/Brochure.pdf`.</span></span> <span data-ttu-id="8f65f-303">Ma cosa accade se un intervallo di tempo successivo dell'utente B carica un file di brochure diversi che possono avere lo stesso nome (`Brochure.pdf`)?</span><span class="sxs-lookup"><span data-stu-id="8f65f-303">But what if sometime later User B uploads a different brochure file that happens to have the same filename (`Brochure.pdf`)?</span></span> <span data-ttu-id="8f65f-304">Con il codice è disponibile a questo punto, utente di un file s verrà sovrascritto con caricamento s utente B.</span><span class="sxs-lookup"><span data-stu-id="8f65f-304">With the code we have now, User A s file will be overwritten with User B s upload.</span></span>

<span data-ttu-id="8f65f-305">Esistono diverse tecniche per risolvere i conflitti di nome file.</span><span class="sxs-lookup"><span data-stu-id="8f65f-305">There are a number of techniques for resolving file name conflicts.</span></span> <span data-ttu-id="8f65f-306">È possibile non consentire il caricamento di un file se esiste già uno con lo stesso nome.</span><span class="sxs-lookup"><span data-stu-id="8f65f-306">One option is to prohibit uploading a file if there already exists one with the same name.</span></span> <span data-ttu-id="8f65f-307">Con questo approccio, quando l'utente B tenta di caricare un file denominato `Brochure.pdf`, il sistema non salvare i file e invece visualizzato un messaggio che informa dell'utente B per rinominare il file e riprovare.</span><span class="sxs-lookup"><span data-stu-id="8f65f-307">With this approach, when User B attempts to upload a file named `Brochure.pdf`, the system would not save their file and instead display a message informing User B to rename the file and try again.</span></span> <span data-ttu-id="8f65f-308">Un altro approccio consiste nel salvare il file utilizzando un nome file univoco, che può essere un [identificatore univoco globale (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) o il valore dal corrispondente colonne chiave primaria s record del database (supponendo che il caricamento è associato a un riga specifica nel modello di dati).</span><span class="sxs-lookup"><span data-stu-id="8f65f-308">Another approach is to save the file using a unique file name, which could be a [globally unique identifier (GUID)](http://en.wikipedia.org/wiki/Globally_Unique_Identifier) or the value from the corresponding database record s primary key column(s) (assuming that the upload is associated with a particular row in the data model).</span></span> <span data-ttu-id="8f65f-309">Nella prossima esercitazione verrà illustrato più dettagliatamente le opzioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-309">In the next tutorial we'll explore these options in more detail.</span></span>

## <a name="challenges-involved-with-very-large-amounts-of-binary-data"></a><span data-ttu-id="8f65f-310">Problemi relativi a grandi quantità di dati binari</span><span class="sxs-lookup"><span data-stu-id="8f65f-310">Challenges Involved with Very Large Amounts of Binary Data</span></span>

<span data-ttu-id="8f65f-311">Queste esercitazioni si presuppongono che i dati binari acquisiti siano adeguati nella dimensione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-311">These tutorials assume that the binary data captured is modest in size.</span></span> <span data-ttu-id="8f65f-312">Utilizzano grandi quantità di file di dati binari che sono diversi megabyte o maggiori implicazioni che esulano dall'ambito di queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-312">Working with very large amounts of binary data files that are several megabytes or larger introduces new challenges that are beyond the scope of these tutorials.</span></span> <span data-ttu-id="8f65f-313">Ad esempio, per impostazione predefinita ASP.NET rifiuterà caricamenti di più di 4 MB, anche se ciò può essere configurato tramite il [ `<httpRuntime>` elemento](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="8f65f-313">For example, by default ASP.NET will reject uploads of more than 4 MB, although this can be configured through the [`<httpRuntime>` element](https://msdn.microsoft.com/library/e1f13641.aspx) in `Web.config`.</span></span> <span data-ttu-id="8f65f-314">IIS impone delle limitazioni di dimensioni di caricamento file, troppo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-314">IIS imposes its own file upload size limitations, too.</span></span> <span data-ttu-id="8f65f-315">Vedere [dimensioni File di caricamento IIS](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) per ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-315">See [IIS Upload File Size](http://vandamme.typepad.com/development/2005/09/iis_upload_file.html) for more information.</span></span> <span data-ttu-id="8f65f-316">Inoltre, il tempo impiegato per caricare file di grandi dimensioni potrebbe superare il valore predefinito 110 secondi che rimarrà in attesa di una richiesta ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="8f65f-316">Furthermore, the time taken to upload large files might exceed the default 110 seconds ASP.NET will wait for a request.</span></span> <span data-ttu-id="8f65f-317">Sono disponibili anche i problemi di memoria e delle prestazioni che si verificano quando si lavora con file di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-317">There are also memory and performance issues that arise when working with large files.</span></span>

<span data-ttu-id="8f65f-318">Il controllo FileUpload risulta poco pratico per i caricamenti di file di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="8f65f-318">The FileUpload control is impractical for large file uploads.</span></span> <span data-ttu-id="8f65f-319">Come il contenuto del file s viene inviato al server, l'utente finale deve attendere pazientemente senza alcuna conferma che il caricamento è in corso.</span><span class="sxs-lookup"><span data-stu-id="8f65f-319">As the file s contents are being posted to the server, the end user must patiently wait without any confirmation that their upload is progressing.</span></span> <span data-ttu-id="8f65f-320">Questo non è così tanto un problema quando si lavora con i file più piccoli che possono essere caricati in pochi secondi, ma possono essere un problema quando si lavora con i file di dimensioni maggiori che potrebbero richiedere minuti da caricare.</span><span class="sxs-lookup"><span data-stu-id="8f65f-320">This is not so much an issue when dealing with smaller files that can be uploaded in a few seconds, but can be an issue when dealing with larger files that may take minutes to upload.</span></span> <span data-ttu-id="8f65f-321">Sono disponibili i controlli di caricamento che sono più adatti per la gestione di grandi dimensioni caricamenti un'ampia gamma di file di terze parti e molti di questi fornitori forniscono gli indicatori di stato e ActiveX carica i gestori da presentano un'esperienza utente più elegante.</span><span class="sxs-lookup"><span data-stu-id="8f65f-321">There are a variety of third-party file upload controls that are better suited for handling large uploads and many of these vendors provide progress indicators and ActiveX upload managers that present a much more polished user experience.</span></span>

<span data-ttu-id="8f65f-322">Se l'applicazione deve gestire i file di grandi dimensioni, è necessario esaminare i problemi e trovare soluzioni adatte alle proprie esigenze con attenzione.</span><span class="sxs-lookup"><span data-stu-id="8f65f-322">If your application needs to handle large files, you'll need to carefully investigate the challenges and find suitable solutions for your particular needs.</span></span>

## <a name="summary"></a><span data-ttu-id="8f65f-323">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="8f65f-323">Summary</span></span>

<span data-ttu-id="8f65f-324">Compilazione di un'applicazione che è necessario acquisire i dati binari introduce una serie di difficoltà.</span><span class="sxs-lookup"><span data-stu-id="8f65f-324">Building an application that needs to capture binary data introduces a number of challenges.</span></span> <span data-ttu-id="8f65f-325">In questa esercitazione, è esplorare le prime due: decidere dove archiviare i dati binari e consentendo all'utente di caricare il contenuto binario mediante una pagina web.</span><span class="sxs-lookup"><span data-stu-id="8f65f-325">In this tutorial we explored the first two: deciding where to store the binary data and allowing a user to upload binary content through a web page.</span></span> <span data-ttu-id="8f65f-326">Tramite le tre esercitazioni, vedremo come associare i dati caricati con un record nel database, nonché come visualizzare i dati binari insieme ai relativi campi di dati di testo.</span><span class="sxs-lookup"><span data-stu-id="8f65f-326">Over the next three tutorials, we'll see how to associate the uploaded data with a record in the database as well as how to display the binary data alongside its text data fields.</span></span>

<span data-ttu-id="8f65f-327">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="8f65f-327">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="8f65f-328">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="8f65f-328">Further Reading</span></span>

<span data-ttu-id="8f65f-329">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="8f65f-329">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="8f65f-330">Utilizzo di tipi di dati di valori di grandi dimensioni</span><span class="sxs-lookup"><span data-stu-id="8f65f-330">Using Large-Value Data Types</span></span>](https://msdn.microsoft.com/library/ms178158.aspx)
- [<span data-ttu-id="8f65f-331">Guida introduttiva di controllo fileUpload</span><span class="sxs-lookup"><span data-stu-id="8f65f-331">FileUpload Control QuickStarts</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/standard/fileupload.aspx)
- [<span data-ttu-id="8f65f-332">Controllo Server ASP.NET 2.0 FileUpload</span><span class="sxs-lookup"><span data-stu-id="8f65f-332">The ASP.NET 2.0 FileUpload Server Control</span></span>](http://www.wrox.com/WileyCDA/Section/id-292158.html)
- [<span data-ttu-id="8f65f-333">Il lato scuro di caricamenti di File</span><span class="sxs-lookup"><span data-stu-id="8f65f-333">The Dark Side of File Uploads</span></span>](http://www.aspnetresources.com/articles/dark_side_of_file_uploads.aspx)

## <a name="about-the-author"></a><span data-ttu-id="8f65f-334">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="8f65f-334">About the Author</span></span>

<span data-ttu-id="8f65f-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="8f65f-335">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="8f65f-336">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="8f65f-336">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="8f65f-337">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="8f65f-337">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="8f65f-338">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="8f65f-338">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="8f65f-339">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="8f65f-339">Special Thanks To</span></span>

<span data-ttu-id="8f65f-340">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="8f65f-340">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="8f65f-341">Lead revisori per questa esercitazione sono stati Teresa Murphy e Bernadette Leigh.</span><span class="sxs-lookup"><span data-stu-id="8f65f-341">Lead reviewers for this tutorial were Teresa Murphy and Bernadette Leigh.</span></span> <span data-ttu-id="8f65f-342">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="8f65f-342">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="8f65f-343">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="8f65f-343">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="8f65f-344">[Precedente](updating-and-deleting-existing-binary-data-cs.md)
> [Successivo](displaying-binary-data-in-the-data-web-controls-vb.md)</span><span class="sxs-lookup"><span data-stu-id="8f65f-344">[Previous](updating-and-deleting-existing-binary-data-cs.md)
[Next](displaying-binary-data-in-the-data-web-controls-vb.md)</span></span>

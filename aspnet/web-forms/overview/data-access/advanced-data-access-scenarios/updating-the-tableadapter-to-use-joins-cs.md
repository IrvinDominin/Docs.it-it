---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
title: L'aggiornamento dell'oggetto TableAdapter per usare join (c#) | Documenti Microsoft
author: rick-anderson
description: Quando si utilizza un database è comune per i dati della richiesta che viene distribuiti tra più tabelle. Per recuperare dati da due diverse tabelle è possibile utilizzare...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 675531a7-cb54-4dd6-89ac-2636e4c285a5
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/updating-the-tableadapter-to-use-joins-cs
msc.type: authoredcontent
ms.openlocfilehash: be74be8865b021be1f2e2d8181d2eb42cb74eb75
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="updating-the-tableadapter-to-use-joins-c"></a><span data-ttu-id="af38e-104">L'aggiornamento dell'oggetto TableAdapter per usare join (c#)</span><span class="sxs-lookup"><span data-stu-id="af38e-104">Updating the TableAdapter to Use JOINs (C#)</span></span>
====================
<span data-ttu-id="af38e-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="af38e-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="af38e-106">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) o [Scarica il PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="af38e-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_69_CS.zip) or [Download PDF](updating-the-tableadapter-to-use-joins-cs/_static/datatutorial69cs1.pdf)</span></span>

> <span data-ttu-id="af38e-107">Quando si utilizza un database è comune per i dati della richiesta che viene distribuiti tra più tabelle.</span><span class="sxs-lookup"><span data-stu-id="af38e-107">When working with a database it is common to request data that is spread across multiple tables.</span></span> <span data-ttu-id="af38e-108">Per recuperare dati da due tabelle diverse, è possibile utilizzare una sottoquery correlata o un'operazione di JOIN.</span><span class="sxs-lookup"><span data-stu-id="af38e-108">To retrieve data from two different tables we can use either a correlated subquery or a JOIN operation.</span></span> <span data-ttu-id="af38e-109">In questa esercitazione è confrontare sottoquery correlate e la sintassi JOIN prima di esaminare come creare un oggetto TableAdapter che include un JOIN nella query principale.</span><span class="sxs-lookup"><span data-stu-id="af38e-109">In this tutorial we compare correlated subqueries and the JOIN syntax before looking at how to create a TableAdapter that includes a JOIN in its main query.</span></span>


## <a name="introduction"></a><span data-ttu-id="af38e-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="af38e-110">Introduction</span></span>

<span data-ttu-id="af38e-111">Con i database relazionali i dati di che si è interessati durante l'utilizzo spesso viene distribuiti tra più tabelle.</span><span class="sxs-lookup"><span data-stu-id="af38e-111">With relational databases the data we are interested in working with is often spread across multiple tables.</span></span> <span data-ttu-id="af38e-112">Ad esempio, quando si visualizzano informazioni sui prodotti è probabilmente da elencare ogni categoria di prodotto s corrispondente e i nomi s fornitore.</span><span class="sxs-lookup"><span data-stu-id="af38e-112">For example, when displaying product information we likely want to list each product s corresponding category and supplier s names.</span></span> <span data-ttu-id="af38e-113">Il `Products` tabella include `CategoryID` e `SupplierID` valori, ma i nomi di categoria e il fornitore effettivi presenti il `Categories` e `Suppliers` tabelle, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="af38e-113">The `Products` table has `CategoryID` and `SupplierID` values, but the actual category and supplier names are in the `Categories` and `Suppliers` tables, respectively.</span></span>

<span data-ttu-id="af38e-114">Per recuperare informazioni da un altro, alla tabella correlata, è possibile utilizzare *sottoquery correlate* o `JOIN` *s*.</span><span class="sxs-lookup"><span data-stu-id="af38e-114">To retrieve information from another, related table, we can either use *correlated subqueries* or `JOIN`*s*.</span></span> <span data-ttu-id="af38e-115">Una sottoquery correlata è nidificato `SELECT` query che fa riferimento alle colonne nella query esterna.</span><span class="sxs-lookup"><span data-stu-id="af38e-115">A correlated subquery is a nested `SELECT` query that references columns in the outer query.</span></span> <span data-ttu-id="af38e-116">Ad esempio, nel [la creazione di un livello di accesso ai dati](../introduction/creating-a-data-access-layer-cs.md) è stata utilizzata due sottoquery correlate nell'esercitazione di `ProductsTableAdapter` query principale di s per restituire i nomi di categoria e il fornitore per ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="af38e-116">For example, in the [Creating a Data Access Layer](../introduction/creating-a-data-access-layer-cs.md) tutorial we used two correlated subqueries in the `ProductsTableAdapter` s main query to return the category and supplier names for each product.</span></span> <span data-ttu-id="af38e-117">Oggetto `JOIN` è un costrutto SQL che unisce le righe correlate da due tabelle diverse.</span><span class="sxs-lookup"><span data-stu-id="af38e-117">A `JOIN` is a SQL construct that merges related rows from two different tables.</span></span> <span data-ttu-id="af38e-118">È stato usato un `JOIN` nel [query su dati con il controllo SqlDataSource](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) esercitazione per visualizzare le informazioni di categoria insieme a ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="af38e-118">We used a `JOIN` in the [Querying Data with the SqlDataSource Control](../accessing-the-database-directly-from-an-aspnet-page/querying-data-with-the-sqldatasource-control-cs.md) tutorial to display category information alongside each product.</span></span>

<span data-ttu-id="af38e-119">Il motivo è stata astenuto dall'utilizzo di `JOIN` con gli oggetti TableAdapter è a causa delle limitazioni della procedura guidata s TableAdapter per generare automaticamente corrispondente `INSERT`, `UPDATE`, e `DELETE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="af38e-119">The reason we have abstained from using `JOIN` s with the TableAdapters is because of limitations in the TableAdapter s wizard to auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span> <span data-ttu-id="af38e-120">In particolare, se la query principale di TableAdapter s contiene qualsiasi `JOIN` s, TableAdapter non crea automaticamente le istruzioni SQL ad hoc o la stored procedure per il relativo `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà.</span><span class="sxs-lookup"><span data-stu-id="af38e-120">More specifically, if the TableAdapter s main query contains any `JOIN` s, the TableAdapter cannot auto-create the ad-hoc SQL statements or stored procedures for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span>

<span data-ttu-id="af38e-121">In questa esercitazione confronteremo brevemente e contrasto sottoquery correlate e `JOIN` s prima di esaminare come creare un oggetto TableAdapter che include `JOIN` s la query principale.</span><span class="sxs-lookup"><span data-stu-id="af38e-121">In this tutorial we will briefly compare and contrast correlated subqueries and `JOIN` s before exploring how to create a TableAdapter that includes `JOIN` s in its main query.</span></span>

## <a name="comparing-and-contrasting-correlated-subqueries-andjoin-s"></a><span data-ttu-id="af38e-122">Il confronto e contrasto sottoquery correlate e`JOIN` s</span><span class="sxs-lookup"><span data-stu-id="af38e-122">Comparing and Contrasting Correlated Subqueries and`JOIN` s</span></span>

<span data-ttu-id="af38e-123">Tenere presente che il `ProductsTableAdapter` creato nella prima esercitazione del `Northwind` set di dati utilizza sottoquery correlate per riportare ogni prodotto s categoria e il fornitore nome corrispondente.</span><span class="sxs-lookup"><span data-stu-id="af38e-123">Recall that the `ProductsTableAdapter` created in the first tutorial in the `Northwind` DataSet uses correlated subqueries to bring back each product s corresponding category and supplier name.</span></span> <span data-ttu-id="af38e-124">Il `ProductsTableAdapter` query principale s è illustrata di seguito.</span><span class="sxs-lookup"><span data-stu-id="af38e-124">The `ProductsTableAdapter` s main query is shown below.</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample1.sql)]

<span data-ttu-id="af38e-125">I due subquery - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` e `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` -sono `SELECT` query che restituiscono un singolo valore per ogni prodotto come una colonna aggiuntiva in esterna `SELECT` elenco colonne istruzione s.</span><span class="sxs-lookup"><span data-stu-id="af38e-125">The two correlated subqueries - `(SELECT CategoryName FROM Categories WHERE Categories.CategoryID = Products.CategoryID)` and `(SELECT CompanyName FROM Suppliers WHERE Suppliers.SupplierID = Products.SupplierID)` - are `SELECT` queries that return a single value per product as an additional column in the outer `SELECT` statement s column list.</span></span>

<span data-ttu-id="af38e-126">In alternativa, un `JOIN` può essere utilizzato per restituire ogni nome di un fornitore e la categoria di prodotto s.</span><span class="sxs-lookup"><span data-stu-id="af38e-126">Alternatively, a `JOIN` can be used to return each product s supplier and category name.</span></span> <span data-ttu-id="af38e-127">La query seguente restituisce lo stesso output di quello precedente, ma utilizza `JOIN` s al posto di sottoquery:</span><span class="sxs-lookup"><span data-stu-id="af38e-127">The following query returns the same output as the above one, but uses `JOIN` s in place of subqueries:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample2.sql)]

<span data-ttu-id="af38e-128">Oggetto `JOIN` unisce i record da una tabella con i record da un'altra tabella in base ad alcuni criteri specificati.</span><span class="sxs-lookup"><span data-stu-id="af38e-128">A `JOIN` merges the records from one table with records from another table based on some criteria.</span></span> <span data-ttu-id="af38e-129">Nella query precedente, ad esempio, il `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` indica a SQL Server per unire ogni record di prodotto con la categoria record il cui `CategoryID` valore corrisponda al prodotto s `CategoryID` valore.</span><span class="sxs-lookup"><span data-stu-id="af38e-129">In the above query, for example, the `LEFT JOIN Categories ON Categories.CategoryID = Products.CategoryID` instructs SQL Server to merge each product record with the category record whose `CategoryID` value matches the product s `CategoryID` value.</span></span> <span data-ttu-id="af38e-130">Risultati sottoposti a merge consentono di operare con i campi categoria corrispondente per ogni prodotto (ad esempio `CategoryName`).</span><span class="sxs-lookup"><span data-stu-id="af38e-130">The merged result allows us to work with the corresponding category fields for each product (such as `CategoryName`).</span></span>

> [!NOTE]
> <span data-ttu-id="af38e-131">`JOIN` s comunemente utilizzati per eseguire query sui dati dai database relazionali.</span><span class="sxs-lookup"><span data-stu-id="af38e-131">`JOIN` s are commonly used when querying data from relational databases.</span></span> <span data-ttu-id="af38e-132">Se si ha familiarità con il `JOIN` sintassi o necessità di rinfrescarti la memoria bit sul relativo utilizzo, d si consiglia di [esercitazione Join SQL](http://www.w3schools.com/sql/sql_join.asp) in [scuole W3](http://www.w3schools.com/).</span><span class="sxs-lookup"><span data-stu-id="af38e-132">If you are new to the `JOIN` syntax or need to brush up a bit on its usage, I d recommend the [SQL Join tutorial](http://www.w3schools.com/sql/sql_join.asp) at [W3 Schools](http://www.w3schools.com/).</span></span> <span data-ttu-id="af38e-133">Anche la pena di lettura sono i [ `JOIN` nozioni di base](https://msdn.microsoft.com/library/ms191517.aspx) e [principi fondamentali di sottoquery](https://msdn.microsoft.com/library/ms189575.aspx) sezioni del [documentazione Online di SQL](https://msdn.microsoft.com/library/ms130214.aspx).</span><span class="sxs-lookup"><span data-stu-id="af38e-133">Also worth reading are the [`JOIN` Fundamentals](https://msdn.microsoft.com/library/ms191517.aspx) and [Subquery Fundamentals](https://msdn.microsoft.com/library/ms189575.aspx) sections of the [SQL Books Online](https://msdn.microsoft.com/library/ms130214.aspx).</span></span>


<span data-ttu-id="af38e-134">Poiché `JOIN` s e sottoquery correlate possono essere utilizzate entrambe per recuperare i dati correlati da altre tabelle, molti sviluppatori restano eventuali graffi le intestazioni e chiedere l'approccio da utilizzare.</span><span class="sxs-lookup"><span data-stu-id="af38e-134">Since `JOIN` s and correlated subqueries can both be used to retrieve related data from other tables, many developers are left scratching their heads and wondering which approach to use.</span></span> <span data-ttu-id="af38e-135">Tutti i controbattono SQL si ve parlata per hanno affermato approssimativamente la stessa operazione, che t è importante inoltro come SQL Server genera i piani di esecuzione quasi identici.</span><span class="sxs-lookup"><span data-stu-id="af38e-135">All of the SQL gurus I ve talked to have said roughly the same thing, that it doesn t really matter performance-wise as SQL Server will produce roughly identical execution plans.</span></span> <span data-ttu-id="af38e-136">I consigli, sono quindi utilizzare la tecnica di utente e il team ha maggiore familiarità con.</span><span class="sxs-lookup"><span data-stu-id="af38e-136">Their advice, then, is to use the technique that you and your team are most comfortable with.</span></span> <span data-ttu-id="af38e-137">Opportuno notare che dopo d'imprimere questa raccomandazione questi esperti immediatamente express la preferenza di `JOIN` s sulle sottoquery correlate.</span><span class="sxs-lookup"><span data-stu-id="af38e-137">It merits noting that after imparting this advice these experts immediately express their preference of `JOIN` s over correlated subqueries.</span></span>

<span data-ttu-id="af38e-138">Quando si compila un livello di accesso ai dati utilizzando i dataset tipizzati, gli strumenti funzionano meglio durante l'utilizzo di sottoquery.</span><span class="sxs-lookup"><span data-stu-id="af38e-138">When building a Data Access Layer using Typed DataSets, the tools work better when using subqueries.</span></span> <span data-ttu-id="af38e-139">In particolare, la configurazione guidata TableAdapter s non genererà automaticamente corrispondente `INSERT`, `UPDATE`, e `DELETE` istruzioni se la query principale contiene i `JOIN` s, ma genererà automaticamente queste istruzioni quando correlato sottoquery vengono utilizzati.</span><span class="sxs-lookup"><span data-stu-id="af38e-139">In particular, the TableAdapter s wizard will not auto-generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements if the main query contains any `JOIN` s, but will auto-generate these statements when correlated subqueries are used.</span></span>

<span data-ttu-id="af38e-140">Per esplorare questo problema, creare un DataSet tipizzato temporaneo nel `~/App_Code/DAL` cartella.</span><span class="sxs-lookup"><span data-stu-id="af38e-140">To explore this shortcoming, create a temporary Typed DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="af38e-141">Durante la configurazione guidata TableAdapter, scegliere di utilizzare istruzioni SQL ad hoc e immettere la seguente `SELECT` query (vedere la figura 1):</span><span class="sxs-lookup"><span data-stu-id="af38e-141">During the TableAdapter Configuration wizard, choose to use ad-hoc SQL statements and enter the following `SELECT` query (see Figure 1):</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample3.sql)]


<span data-ttu-id="af38e-142">[![Immettere una Query principale che contiene join](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-142">[![Enter a Main Query that Contains JOINs](updating-the-tableadapter-to-use-joins-cs/_static/image2.png)](updating-the-tableadapter-to-use-joins-cs/_static/image1.png)</span></span>

<span data-ttu-id="af38e-143">**Figura 1**: immettere una Query principale contenente `JOIN` s ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-143">**Figure 1**: Enter a Main Query that Contains `JOIN` s ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image3.png))</span></span>


<span data-ttu-id="af38e-144">Per impostazione predefinita, il TableAdapter creerà automaticamente `INSERT`, `UPDATE`, e `DELETE` istruzioni in base alla query principale.</span><span class="sxs-lookup"><span data-stu-id="af38e-144">By default, the TableAdapter will automatically create `INSERT`, `UPDATE`, and `DELETE` statements based on the main query.</span></span> <span data-ttu-id="af38e-145">Se si fa clic sul pulsante Avanzate è possibile vedere che questa funzionalità è abilitata.</span><span class="sxs-lookup"><span data-stu-id="af38e-145">If you click the Advanced button you can see that this feature is enabled.</span></span> <span data-ttu-id="af38e-146">Nonostante questa impostazione, l'oggetto TableAdapter non sarà in grado di creare il `INSERT`, `UPDATE`, e `DELETE` istruzioni perché la query principale include un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="af38e-146">Despite this setting, the TableAdapter will not be able to create the `INSERT`, `UPDATE`, and `DELETE` statements because the main query contains a `JOIN`.</span></span>


![Immettere una Query principale che contiene join](updating-the-tableadapter-to-use-joins-cs/_static/image4.png)

<span data-ttu-id="af38e-148">**Figura 2**: immettere una Query principale che contiene `JOIN` s</span><span class="sxs-lookup"><span data-stu-id="af38e-148">**Figure 2**: Enter a Main Query that Contains `JOIN` s</span></span>


<span data-ttu-id="af38e-149">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="af38e-149">Click Finish to complete the wizard.</span></span> <span data-ttu-id="af38e-150">A questo punto la finestra di progettazione di s set di dati include un solo oggetto TableAdapter con un oggetto DataTable con colonne per ognuno dei campi restituiti nel `SELECT` elenco colonne query s.</span><span class="sxs-lookup"><span data-stu-id="af38e-150">At this point your DataSet s Designer will include a single TableAdapter with a DataTable with columns for each of the fields returned in the `SELECT` query s column list.</span></span> <span data-ttu-id="af38e-151">Ciò include la `CategoryName` e `SupplierName`, come illustrato nella figura 3.</span><span class="sxs-lookup"><span data-stu-id="af38e-151">This includes the `CategoryName` and `SupplierName`, as Figure 3 shows.</span></span>


![DataTable include una colonna per ogni campo restituito nell'elenco di colonne](updating-the-tableadapter-to-use-joins-cs/_static/image5.png)

<span data-ttu-id="af38e-153">**Figura 3**: DataTable include una colonna per ogni campo restituito nell'elenco delle colonne</span><span class="sxs-lookup"><span data-stu-id="af38e-153">**Figure 3**: The DataTable Includes a Column for Each Field Returned in the Column List</span></span>


<span data-ttu-id="af38e-154">Mentre il DataTable contiene le colonne appropriate, TableAdapter non dispone di valori per il relativo `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà.</span><span class="sxs-lookup"><span data-stu-id="af38e-154">While the DataTable has the appropriate columns, the TableAdapter lacks values for its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties.</span></span> <span data-ttu-id="af38e-155">A tale scopo, fare clic sul TableAdapter nella finestra di progettazione e quindi passare alla finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="af38e-155">To confirm this, click on the TableAdapter in the Designer and then go to the Properties window.</span></span> <span data-ttu-id="af38e-156">Vi si noterà che il `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà vengono impostate su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="af38e-156">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are set to (None) .</span></span>


<span data-ttu-id="af38e-157">[![La proprietà InsertCommand, UpdateCommand e proprietà DeleteCommand vengono impostate su (nessuno)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-157">[![The InsertCommand, UpdateCommand, and DeleteCommand Properties are Set to (None)](updating-the-tableadapter-to-use-joins-cs/_static/image7.png)](updating-the-tableadapter-to-use-joins-cs/_static/image6.png)</span></span>

<span data-ttu-id="af38e-158">**Figura 4**: il `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà vengono impostate su (nessuno) ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-158">**Figure 4**: The `InsertCommand`, `UpdateCommand`, and `DeleteCommand` Properties are Set to (None) ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image8.png))</span></span>


<span data-ttu-id="af38e-159">Per risolvere questo problema, è possibile specificare manualmente le istruzioni SQL e i parametri per il `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà mediante la finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="af38e-159">To work around this shortcoming, we can manually provide the SQL statements and parameters for the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties via the Properties window.</span></span> <span data-ttu-id="af38e-160">In alternativa, è stato possibile avviare configurando query TableAdapter s principale per *non* includere `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="af38e-160">Alternatively, we could start by configuring the TableAdapter s main query to *not* include any `JOIN` s.</span></span> <span data-ttu-id="af38e-161">In questo modo il `INSERT`, `UPDATE`, e `DELETE` istruzioni generati automaticamente per noi.</span><span class="sxs-lookup"><span data-stu-id="af38e-161">This will allow the `INSERT`, `UPDATE`, and `DELETE` statements to be auto-generated for us.</span></span> <span data-ttu-id="af38e-162">Dopo aver completato la procedura guidata, quindi è possibile aggiornare manualmente i TableAdapter `SelectCommand` dalla finestra delle proprietà in modo che includa il `JOIN` sintassi.</span><span class="sxs-lookup"><span data-stu-id="af38e-162">After completing the wizard, we could then manually update the TableAdapter s `SelectCommand` from the Properties window so that it includes the `JOIN` syntax.</span></span>

<span data-ttu-id="af38e-163">Quando viene utilizzato questo approccio, è molto efficace quando riconfigurare la procedura guidata generata automaticamente tramite query SQL ad hoc, perché ogni volta che la query principale di TableAdapter s `INSERT`, `UPDATE`, e `DELETE` vengono ricreate le istruzioni.</span><span class="sxs-lookup"><span data-stu-id="af38e-163">While this approach works, it is very brittle when using ad-hoc SQL queries because any time the TableAdapter s main query is re-configured through the wizard, the auto-generated `INSERT`, `UPDATE`, and `DELETE` statements are recreated.</span></span> <span data-ttu-id="af38e-164">Ciò significa che tutte le personalizzazioni in un secondo momento, sono stati apportati andrebbero perse se si pulsante destro del mouse sul TableAdapter, scelta Configura dal menu di scelta rapida e completata nuovamente la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="af38e-164">That means all of the customizations we later made would be lost if we right-clicked on the TableAdapter, chose Configure from the context menu, and completed the wizard again.</span></span>

<span data-ttu-id="af38e-165">Il vulnerabilità ai TableAdapter generate automaticamente `INSERT`, `UPDATE`, e `DELETE` istruzioni è Fortunatamente, limitato alle istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="af38e-165">The brittleness of the TableAdapter s auto-generated `INSERT`, `UPDATE`, and `DELETE` statements is, fortunately, limited to ad-hoc SQL statements.</span></span> <span data-ttu-id="af38e-166">Se l'oggetto TableAdapter utilizza stored procedure, è possibile personalizzare il `SelectCommand`, `InsertCommand`, `UpdateCommand`, o `DeleteCommand` stored procedure ed eseguire di nuovo la configurazione guidata TableAdapter senza temere che saranno le stored procedure modificato.</span><span class="sxs-lookup"><span data-stu-id="af38e-166">If your TableAdapter uses stored procedures, you can customize the `SelectCommand`, `InsertCommand`, `UpdateCommand`, or `DeleteCommand` stored procedures and re-run the TableAdapter Configuration wizard without having to fear that the stored procedures will be modified.</span></span>

<span data-ttu-id="af38e-167">Su quella successiva diversi passaggi, si creerà un oggetto TableAdapter che, inizialmente, Usa una query principale che omette qualsiasi `JOIN` s in modo che sia corrispondente insert, update e delete stored procedure verrà generato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="af38e-167">Over the next several steps we will create a TableAdapter that, initially, uses a main query that omits any `JOIN` s so that the corresponding insert, update, and delete stored procedures will be auto-generated.</span></span> <span data-ttu-id="af38e-168">Quindi si aggiornerà il `SelectCommand` così che utilizza un `JOIN` che restituisce le colonne aggiuntive da tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="af38e-168">We will then update the `SelectCommand` so that uses a `JOIN` that returns additional columns from related tables.</span></span> <span data-ttu-id="af38e-169">Infine, si verrà creare una classe di livello di logica di Business corrispondente e dimostrare l'utilizzo dell'oggetto TableAdapter in una pagina web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="af38e-169">Finally, we'll create a corresponding Business Logic Layer class and demonstrate using the TableAdapter in an ASP.NET web page.</span></span>

## <a name="step-1-creating-the-tableadapter-using-a-simplified-main-query"></a><span data-ttu-id="af38e-170">Passaggio 1: Creazione del TableAdapter utilizzando una Query principale semplificata</span><span class="sxs-lookup"><span data-stu-id="af38e-170">Step 1: Creating the TableAdapter Using a Simplified Main Query</span></span>

<span data-ttu-id="af38e-171">Per questa esercitazione si aggiungerà un oggetto TableAdapter e DataTable fortemente tipizzata per la `Employees` tabella il `NorthwindWithSprocs` set di dati.</span><span class="sxs-lookup"><span data-stu-id="af38e-171">For this tutorial we will add a TableAdapter and strongly-typed DataTable for the `Employees` table in the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="af38e-172">Il `Employees` tabella contiene un `ReportsTo` campo che specifica il `EmployeeID` della gestione dipendente s.</span><span class="sxs-lookup"><span data-stu-id="af38e-172">The `Employees` table contains a `ReportsTo` field that specified the `EmployeeID` of the employee s manager.</span></span> <span data-ttu-id="af38e-173">Ad esempio, i dipendenti Anne Dodsworth ha un `ReportTo` valore pari a 5, ovvero il `EmployeeID` di Steven Buchanan.</span><span class="sxs-lookup"><span data-stu-id="af38e-173">For example, employee Anne Dodsworth has a `ReportTo` value of 5, which is the `EmployeeID` of Steven Buchanan.</span></span> <span data-ttu-id="af38e-174">Di conseguenza, Anne segnala a Steven, responsabile.</span><span class="sxs-lookup"><span data-stu-id="af38e-174">Consequently, Anne reports to Steven, her manager.</span></span> <span data-ttu-id="af38e-175">Insieme a ogni dipendente s reporting `ReportsTo` valore, potrebbe essere inoltre necessario recuperare il nome del gestore.</span><span class="sxs-lookup"><span data-stu-id="af38e-175">Along with reporting each employee s `ReportsTo` value, we might also want to retrieve the name of their manager.</span></span> <span data-ttu-id="af38e-176">Questa può essere eseguita tramite un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="af38e-176">This can be accomplished using a `JOIN`.</span></span> <span data-ttu-id="af38e-177">Ma utilizzando un `JOIN` quando inizialmente creazione dell'oggetto TableAdapter impedendo la procedura guidata di generazione automatica dell'inserimento corrispondente, aggiornamento ed eliminazione di funzionalità.</span><span class="sxs-lookup"><span data-stu-id="af38e-177">But using a `JOIN` when initially creating the TableAdapter precludes the wizard from automatically generating the corresponding insert, update, and delete capabilities.</span></span> <span data-ttu-id="af38e-178">Pertanto, si inizierà creando un oggetto TableAdapter cui query principale non contiene alcuna `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="af38e-178">Therefore, we will start by creating a TableAdapter whose main query does not contain any `JOIN` s.</span></span> <span data-ttu-id="af38e-179">Quindi, nel passaggio 2, Microsoft aggiornerà la procedura principale query archiviate per recuperare il nome del gestore s tramite un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="af38e-179">Then, in Step 2, we will update the main query stored procedure to retrieve the manager s name via a `JOIN`.</span></span>

<span data-ttu-id="af38e-180">Aprire il `NorthwindWithSprocs` set di dati nel `~/App_Code/DAL` cartella.</span><span class="sxs-lookup"><span data-stu-id="af38e-180">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="af38e-181">Pulsante destro del mouse nella finestra di progettazione, selezionare l'opzione Aggiungi dal menu di scelta rapida e scegliere la voce di menu TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-181">Right-click on the Designer, select the Add option from the context menu, and pick the TableAdapter menu item.</span></span> <span data-ttu-id="af38e-182">Verrà avviata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-182">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="af38e-183">Come viene illustrata nella figura 5, hanno la procedura guidata Crea nuove stored procedure e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="af38e-183">As Figure 5 depicts, have the wizard create new stored procedures and click Next.</span></span> <span data-ttu-id="af38e-184">Per un aggiornamento per la creazione di nuove stored procedure dalla configurazione guidata TableAdapter s, consultare il [la creazione di nuove Stored procedure per gli oggetti TableAdapter s DataSet tipizzato](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="af38e-184">For a refresher on creating new stored procedures from the TableAdapter s wizard, consult the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>


<span data-ttu-id="af38e-185">[![Selezionare Crea nuove stored procedure. opzione](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-185">[![Select the Create new stored procedures Option](updating-the-tableadapter-to-use-joins-cs/_static/image10.png)](updating-the-tableadapter-to-use-joins-cs/_static/image9.png)</span></span>

<span data-ttu-id="af38e-186">**Figura 5**: selezionare Crea nuove stored procedure opzione ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-186">**Figure 5**: Select the Create new stored procedures Option ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image11.png))</span></span>


<span data-ttu-id="af38e-187">Utilizzare la seguente `SELECT` istruzione per la query principale di TableAdapter s:</span><span class="sxs-lookup"><span data-stu-id="af38e-187">Use the following `SELECT` statement for the TableAdapter s main query:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample4.sql)]

<span data-ttu-id="af38e-188">Poiché questa query non include alcun `JOIN` s, la configurazione guidata TableAdapter creerà automaticamente stored procedure con corrispondente `INSERT`, `UPDATE`, e `DELETE` istruzioni, nonché una stored procedure per l'esecuzione principale query.</span><span class="sxs-lookup"><span data-stu-id="af38e-188">Since this query does not include any `JOIN` s, the TableAdapter wizard will automatically create stored procedures with corresponding `INSERT`, `UPDATE`, and `DELETE` statements, as well as a stored procedure for executing the main query.</span></span>

<span data-ttu-id="af38e-189">Il passaggio seguente consente di denominare le procedure archiviati TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-189">The following step allows us to name the TableAdapter s stored procedures.</span></span> <span data-ttu-id="af38e-190">Utilizzare i nomi `Employees_Select`, `Employees_Insert`, `Employees_Update`, e `Employees_Delete`, come illustrato nella figura 6.</span><span class="sxs-lookup"><span data-stu-id="af38e-190">Use the names `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`, as shown in Figure 6.</span></span>


<span data-ttu-id="af38e-191">[![Nome del TableAdapter s Stored procedure](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-191">[![Name the TableAdapter s Stored Procedures](updating-the-tableadapter-to-use-joins-cs/_static/image13.png)](updating-the-tableadapter-to-use-joins-cs/_static/image12.png)</span></span>

<span data-ttu-id="af38e-192">**Figura 6**: nome di Stored procedure del TableAdapter s ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-192">**Figure 6**: Name the TableAdapter s Stored Procedures ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image14.png))</span></span>


<span data-ttu-id="af38e-193">Il passaggio finale viene richiesto di denominare metodi s dell'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-193">The final step prompts us to name the TableAdapter s methods.</span></span> <span data-ttu-id="af38e-194">Utilizzare `Fill` e `GetEmployees` come i nomi di metodo.</span><span class="sxs-lookup"><span data-stu-id="af38e-194">Use `Fill` and `GetEmployees` as the method names.</span></span> <span data-ttu-id="af38e-195">È inoltre necessario assicurarsi di lasciare Crea metodi per inviare aggiornamenti direttamente alla casella di controllo database (GenerateDBDirectMethods) selezionata.</span><span class="sxs-lookup"><span data-stu-id="af38e-195">Also be sure to leave the Create methods to send updates directly to the database (GenerateDBDirectMethods) checkbox checked.</span></span>


<span data-ttu-id="af38e-196">[![Nome il riempimento di metodi TableAdapter s e GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-196">[![Name the TableAdapter s Methods Fill and GetEmployees](updating-the-tableadapter-to-use-joins-cs/_static/image16.png)](updating-the-tableadapter-to-use-joins-cs/_static/image15.png)</span></span>

<span data-ttu-id="af38e-197">**Figura 7**: nome i metodi di TableAdapter `Fill` e `GetEmployees` ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-197">**Figure 7**: Name the TableAdapter s Methods `Fill` and `GetEmployees` ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image17.png))</span></span>


<span data-ttu-id="af38e-198">Dopo aver completato la procedura guidata, è opportuno esaminare le stored procedure nel database.</span><span class="sxs-lookup"><span data-stu-id="af38e-198">After completing the wizard, take a moment to examine the stored procedures in the database.</span></span> <span data-ttu-id="af38e-199">Dovrebbe essere quattro nuovi: `Employees_Select`, `Employees_Insert`, `Employees_Update`, e `Employees_Delete`.</span><span class="sxs-lookup"><span data-stu-id="af38e-199">You should see four new ones: `Employees_Select`, `Employees_Insert`, `Employees_Update`, and `Employees_Delete`.</span></span> <span data-ttu-id="af38e-200">Successivamente, esaminare il `EmployeesDataTable` e `EmployeesTableAdapter` appena creato.</span><span class="sxs-lookup"><span data-stu-id="af38e-200">Next, inspect the `EmployeesDataTable` and `EmployeesTableAdapter` just created.</span></span> <span data-ttu-id="af38e-201">DataTable contiene una colonna per ogni campo restituito dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="af38e-201">The DataTable contains a column for each field returned by the main query.</span></span> <span data-ttu-id="af38e-202">Fare clic sul TableAdapter e quindi passare alla finestra Proprietà.</span><span class="sxs-lookup"><span data-stu-id="af38e-202">Click on the TableAdapter and then go to the Properties window.</span></span> <span data-ttu-id="af38e-203">Vi si noterà che il `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà siano configurate correttamente per chiamare le stored procedure corrispondente.</span><span class="sxs-lookup"><span data-stu-id="af38e-203">There you will see that the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties are correctly configured to call the corresponding stored procedures.</span></span>


<span data-ttu-id="af38e-204">[![TableAdapter include Insert, Update e Delete funzionalità](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-204">[![The TableAdapter Includes Insert, Update, and Delete Capabilities](updating-the-tableadapter-to-use-joins-cs/_static/image19.png)](updating-the-tableadapter-to-use-joins-cs/_static/image18.png)</span></span>

<span data-ttu-id="af38e-205">**Figura 8**: TableAdapter include Insert, Update e le funzionalità di eliminazione ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-205">**Figure 8**: The TableAdapter Includes Insert, Update, and Delete Capabilities ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image20.png))</span></span>


<span data-ttu-id="af38e-206">Con l'inserimento, aggiornamento ed eliminazione di stored procedure create automaticamente e `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà configurata correttamente, si è pronti per personalizzare il `SelectCommand` s stored procedure per restituire ulteriori informazioni su ogni dipendente s responsabile.</span><span class="sxs-lookup"><span data-stu-id="af38e-206">With the insert, update, and delete stored procedures automatically created and the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties correctly configured, we are ready to customize the `SelectCommand` s stored procedure to return additional information about each employee s manager.</span></span> <span data-ttu-id="af38e-207">In particolare, è necessario aggiornare il `Employees_Select` stored procedure per utilizzare un `JOIN` e restituire il gestore s `FirstName` e `LastName` valori.</span><span class="sxs-lookup"><span data-stu-id="af38e-207">Specifically, we need to update the `Employees_Select` stored procedure to use a `JOIN` and return the manager s `FirstName` and `LastName` values.</span></span> <span data-ttu-id="af38e-208">Dopo aver aggiornata la stored procedure, è necessario aggiornare il DataTable in modo che includa tali colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="af38e-208">After the stored procedure has been updated, we will need to update the DataTable so that it includes these additional columns.</span></span> <span data-ttu-id="af38e-209">È possibile affrontare queste due attività nei passaggi 2 e 3.</span><span class="sxs-lookup"><span data-stu-id="af38e-209">We'll tackle these two tasks in Steps 2 and 3.</span></span>

## <a name="step-2-customizing-the-stored-procedure-to-include-ajoin"></a><span data-ttu-id="af38e-210">Passaggio 2: Personalizzare la Stored Procedure per includere un`JOIN`</span><span class="sxs-lookup"><span data-stu-id="af38e-210">Step 2: Customizing the Stored Procedure to Include a`JOIN`</span></span>

<span data-ttu-id="af38e-211">Iniziare da Esplora Server, il drill-down nella cartella Northwind database s Stored procedure e aprendo la `Employees_Select` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="af38e-211">Start by going to the Server Explorer, drilling down into the Northwind database s Stored Procedures folder, and opening the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="af38e-212">Se non viene visualizzata questa stored procedure, fare doppio clic sulla cartella Stored procedure e scegliere Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="af38e-212">If you do not see this stored procedure, right-click on the Stored Procedures folder and choose Refresh.</span></span> <span data-ttu-id="af38e-213">Aggiornare la stored procedure in modo che utilizzi un `LEFT JOIN` per restituire la gestione s innanzitutto e cognome:</span><span class="sxs-lookup"><span data-stu-id="af38e-213">Update the stored procedure so that it uses a `LEFT JOIN` to return the manager s first and last name:</span></span>


[!code-sql[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample5.sql)]

<span data-ttu-id="af38e-214">Dopo aver aggiornato il `SELECT` istruzione, salvare le modifiche dal menu File e scegliendo Salva `Employees_Select`.</span><span class="sxs-lookup"><span data-stu-id="af38e-214">After updating the `SELECT` statement, save the changes by going to the File menu and choosing Save `Employees_Select`.</span></span> <span data-ttu-id="af38e-215">In alternativa, è possibile fare clic sull'icona Salva nella barra degli strumenti o premere Ctrl + S.</span><span class="sxs-lookup"><span data-stu-id="af38e-215">Alternatively, you can click the Save icon in the toolbar or hit Ctrl+S.</span></span> <span data-ttu-id="af38e-216">Dopo aver salvato le modifiche, fare clic su di `Employees_Select` stored procedure in Esplora Server e scegliere Esegui.</span><span class="sxs-lookup"><span data-stu-id="af38e-216">After saving your changes, right-click on the `Employees_Select` stored procedure in the Server Explorer and choose Execute.</span></span> <span data-ttu-id="af38e-217">Verrà eseguito la stored procedure e visualizzare i risultati nella finestra di Output (vedere Figura 9).</span><span class="sxs-lookup"><span data-stu-id="af38e-217">This will run the stored procedure and show its results in the Output window (see Figure 9).</span></span>


<span data-ttu-id="af38e-218">[![I risultati di procedure archiviate vengono visualizzati nella finestra di Output](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-218">[![The Stored Procedures Results are Displayed in the Output Window](updating-the-tableadapter-to-use-joins-cs/_static/image22.png)](updating-the-tableadapter-to-use-joins-cs/_static/image21.png)</span></span>

<span data-ttu-id="af38e-219">**Figura 9**: la Stored procedure risultati vengono visualizzati nella finestra di Output ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-219">**Figure 9**: The Stored Procedures Results are Displayed in the Output Window ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image23.png))</span></span>


## <a name="step-3-updating-the-datatable-s-columns"></a><span data-ttu-id="af38e-220">Passaggio 3: Aggiornare le colonne s DataTable</span><span class="sxs-lookup"><span data-stu-id="af38e-220">Step 3: Updating the DataTable s Columns</span></span>

<span data-ttu-id="af38e-221">A questo punto, il `Employees_Select` stored procedure restituisce `ManagerFirstName` e `ManagerLastName` valori, ma la `EmployeesDataTable` manca queste colonne.</span><span class="sxs-lookup"><span data-stu-id="af38e-221">At this point, the `Employees_Select` stored procedure returns `ManagerFirstName` and `ManagerLastName` values, but the `EmployeesDataTable` is missing these columns.</span></span> <span data-ttu-id="af38e-222">È possibile aggiungere queste colonne mancante nella DataTable in uno dei due modi:</span><span class="sxs-lookup"><span data-stu-id="af38e-222">These missing columns can be added to the DataTable in one of two ways:</span></span>

- <span data-ttu-id="af38e-223">**Manualmente** - destro del mouse sul DataTable in Progettazione DataSet e scegliere dal menu Aggiungi colonna.</span><span class="sxs-lookup"><span data-stu-id="af38e-223">**Manually** - right-click on the DataTable in the DataSet Designer and, from the Add menu, choose Column.</span></span> <span data-ttu-id="af38e-224">Quindi, è possibile assegnare un nome di colonna e impostarne le proprietà di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="af38e-224">You can then name the column and set its properties accordingly.</span></span>
- <span data-ttu-id="af38e-225">**Automaticamente** -la configurazione guidata TableAdapter aggiornerà le colonne s DataTable per riflettere i campi restituiti dal `SelectCommand` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="af38e-225">**Automatically** - the TableAdapter Configuration wizard will update the DataTable s columns to reflect the fields returned by the `SelectCommand` stored procedure.</span></span> <span data-ttu-id="af38e-226">Quando si Usa istruzioni SQL ad hoc, la procedura guidata rimuoverà anche la `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà dopo il `SelectCommand` contiene ora un `JOIN`.</span><span class="sxs-lookup"><span data-stu-id="af38e-226">When using ad-hoc SQL statements, the wizard will also remove the `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties since the `SelectCommand` now contains a `JOIN`.</span></span> <span data-ttu-id="af38e-227">Ma quando si utilizzano stored procedure, queste proprietà comando rimangono intatte.</span><span class="sxs-lookup"><span data-stu-id="af38e-227">But when using stored procedures, these command properties remain intact.</span></span>

<span data-ttu-id="af38e-228">È stata esplorare aggiunta manuale di colonne DataTable in esercitazioni precedenti, tra cui [Master/dettaglio mediante un elenco puntato dei record Master con un controllo DataList dettagli](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) e [caricamento di file](../working-with-binary-files/uploading-files-cs.md), e verrà esaminare questo processo nuovamente in modo più dettagliato nell'esercitazione successiva.</span><span class="sxs-lookup"><span data-stu-id="af38e-228">We have explored manually adding DataTable columns in previous tutorials, including [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-cs.md) and [Uploading Files](../working-with-binary-files/uploading-files-cs.md), and we will look at this process again in more detail in our next tutorial.</span></span> <span data-ttu-id="af38e-229">Per questa esercitazione, tuttavia, consentono s, utilizzare l'approccio automatico tramite la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-229">For this tutorial, however, let s use the automatic approach via the TableAdapter Configuration wizard.</span></span>

<span data-ttu-id="af38e-230">Avviare facendo clic su di `EmployeesTableAdapter` e selezionando Configura dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="af38e-230">Start by right-clicking on the `EmployeesTableAdapter` and selecting Configure from the context menu.</span></span> <span data-ttu-id="af38e-231">Verrà visualizzata la configurazione guidata TableAdapter, che elenca le stored procedure utilizzate per la selezione, inserimento, aggiornamento e l'eliminazione, con i relativi valori restituiti e parametri (se presente).</span><span class="sxs-lookup"><span data-stu-id="af38e-231">This brings up the TableAdapter Configuration wizard, which lists the stored procedures used for selecting, inserting, updating, and deleting, along with their return values and parameters (if any).</span></span> <span data-ttu-id="af38e-232">Figura 10 è illustrata la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="af38e-232">Figure 10 shows this wizard.</span></span> <span data-ttu-id="af38e-233">Qui è possibile osservare che il `Employees_Select` stored procedure restituisce ora il `ManagerFirstName` e `ManagerLastName` campi.</span><span class="sxs-lookup"><span data-stu-id="af38e-233">Here we can see that the `Employees_Select` stored procedure now returns the `ManagerFirstName` and `ManagerLastName` fields.</span></span>


<span data-ttu-id="af38e-234">[![La procedura guidata Mostra elenco delle colonne aggiornate per il Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-234">[![The Wizard Shows the Updated Column List for the Employees_Select Stored Procedure](updating-the-tableadapter-to-use-joins-cs/_static/image25.png)](updating-the-tableadapter-to-use-joins-cs/_static/image24.png)</span></span>

<span data-ttu-id="af38e-235">**Figura 10**: la procedura guidata mostra l'elenco delle colonne aggiornate per il `Employees_Select` Stored Procedure ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-235">**Figure 10**: The Wizard Shows the Updated Column List for the `Employees_Select` Stored Procedure ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image26.png))</span></span>


<span data-ttu-id="af38e-236">Completare la procedura guidata, fare clic su Fine.</span><span class="sxs-lookup"><span data-stu-id="af38e-236">Complete the wizard by clicking Finish.</span></span> <span data-ttu-id="af38e-237">All'uscita alla finestra di progettazione set di dati, il `EmployeesDataTable` include due colonne aggiuntive: `ManagerFirstName` e `ManagerLastName`.</span><span class="sxs-lookup"><span data-stu-id="af38e-237">Upon returning to the DataSet Designer, the `EmployeesDataTable` includes two additional columns: `ManagerFirstName` and `ManagerLastName`.</span></span>


<span data-ttu-id="af38e-238">[![Della scheda Seleziona contiene due nuove colonne](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-238">[![The EmployeesDataTable Contains Two New Columns](updating-the-tableadapter-to-use-joins-cs/_static/image28.png)](updating-the-tableadapter-to-use-joins-cs/_static/image27.png)</span></span>

<span data-ttu-id="af38e-239">**Figura 11**: il `EmployeesDataTable` contiene due nuove colonne ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-239">**Figure 11**: The `EmployeesDataTable` Contains Two New Columns ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image29.png))</span></span>


<span data-ttu-id="af38e-240">Per illustrare che l'aggiornamento `Employees_Select` stored procedure è attivo e che l'inserimento, aggiornamento ed eliminazione delle funzionalità dell'oggetto TableAdapter funzionante, consente di creare una pagina web che consente agli utenti di visualizzare ed eliminare i dipendenti s.</span><span class="sxs-lookup"><span data-stu-id="af38e-240">To illustrate that the updated `Employees_Select` stored procedure is in effect and that the insert, update, and delete capabilities of the TableAdapter are still functional, let s create a web page that allows users to view and delete employees.</span></span> <span data-ttu-id="af38e-241">Prima di creare una pagina, tuttavia, è necessario innanzitutto creare una nuova classe nel livello di logica di Business per l'utilizzo con i dipendenti di `NorthwindWithSprocs` set di dati.</span><span class="sxs-lookup"><span data-stu-id="af38e-241">Before we create such a page, however, we need to first create a new class in the Business Logic Layer for working with employees from the `NorthwindWithSprocs` DataSet.</span></span> <span data-ttu-id="af38e-242">Nel passaggio 4, si creerà un `EmployeesBLLWithSprocs` classe.</span><span class="sxs-lookup"><span data-stu-id="af38e-242">In Step 4, we will create an `EmployeesBLLWithSprocs` class.</span></span> <span data-ttu-id="af38e-243">Nel passaggio 5 si utilizzerà questa classe da una pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="af38e-243">In Step 5, we will use this class from an ASP.NET page.</span></span>

## <a name="step-4-implementing-the-business-logic-layer"></a><span data-ttu-id="af38e-244">Passaggio 4: Implementare il livello di logica di Business</span><span class="sxs-lookup"><span data-stu-id="af38e-244">Step 4: Implementing the Business Logic Layer</span></span>

<span data-ttu-id="af38e-245">Creare un nuovo file di classe nel `~/App_Code/BLL` cartella denominata `EmployeesBLLWithSprocs.cs`.</span><span class="sxs-lookup"><span data-stu-id="af38e-245">Create a new class file in the `~/App_Code/BLL` folder named `EmployeesBLLWithSprocs.cs`.</span></span> <span data-ttu-id="af38e-246">Questa classe riproduce la semantica dell'oggetto esistente `EmployeesBLL` (classe), solo questa nuova uno fornisce un minor numero di metodi e utilizza il `NorthwindWithSprocs` set di dati (anziché il `Northwind` set di dati).</span><span class="sxs-lookup"><span data-stu-id="af38e-246">This class mimics the semantics of the existing `EmployeesBLL` class, only this new one provides fewer methods and uses the `NorthwindWithSprocs` DataSet (instead of the `Northwind` DataSet).</span></span> <span data-ttu-id="af38e-247">Aggiungere il codice seguente alla classe `EmployeesBLLWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="af38e-247">Add the following code to the `EmployeesBLLWithSprocs` class.</span></span>


[!code-csharp[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample6.cs)]

<span data-ttu-id="af38e-248">Il `EmployeesBLLWithSprocs` classe s `Adapter` proprietà restituisce un'istanza di `NorthwindWithSprocs` s set di dati `EmployeesTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="af38e-248">The `EmployeesBLLWithSprocs` class s `Adapter` property returns an instance of the `NorthwindWithSprocs` DataSet s `EmployeesTableAdapter`.</span></span> <span data-ttu-id="af38e-249">Viene utilizzato dalla classe s `GetEmployees` e `DeleteEmployee` metodi.</span><span class="sxs-lookup"><span data-stu-id="af38e-249">This is used by the class s `GetEmployees` and `DeleteEmployee` methods.</span></span> <span data-ttu-id="af38e-250">Il `GetEmployees` chiamate al metodo di `EmployeesTableAdapter` s corrispondente `GetEmployees` metodo che richiama la `Employees_Select` stored procedure e popola i risultati in un `EmployeeDataTable`.</span><span class="sxs-lookup"><span data-stu-id="af38e-250">The `GetEmployees` method calls the `EmployeesTableAdapter` s corresponding `GetEmployees` method, which invokes the `Employees_Select` stored procedure and populates its results in an `EmployeeDataTable`.</span></span> <span data-ttu-id="af38e-251">Il `DeleteEmployee` metodo chiama in modo analogo la `EmployeesTableAdapter` s `Delete` metodo che richiama la `Employees_Delete` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="af38e-251">The `DeleteEmployee` method similarly calls the `EmployeesTableAdapter` s `Delete` method, which invokes the `Employees_Delete` stored procedure.</span></span>

## <a name="step-5-working-with-the-data-in-the-presentation-layer"></a><span data-ttu-id="af38e-252">Passaggio 5: Utilizzo dei dati nel livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="af38e-252">Step 5: Working with the Data in the Presentation Layer</span></span>

<span data-ttu-id="af38e-253">Con la `EmployeesBLLWithSprocs` classe completo, è nuovamente pronto per funzionare con i dati dei dipendenti tramite una pagina ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="af38e-253">With the `EmployeesBLLWithSprocs` class complete, we re ready to work with employee data through an ASP.NET page.</span></span> <span data-ttu-id="af38e-254">Aprire il `JOINs.aspx` nella pagina di `AdvancedDAL` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, l'impostazione relativa `ID` proprietà `Employees`.</span><span class="sxs-lookup"><span data-stu-id="af38e-254">Open the `JOINs.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Employees`.</span></span> <span data-ttu-id="af38e-255">Successivamente, da GridView s smart tag, associare la griglia per un nuovo controllo ObjectDataSource denominato `EmployeesDataSource`.</span><span class="sxs-lookup"><span data-stu-id="af38e-255">Next, from the GridView s smart tag, bind the grid to a new ObjectDataSource control named `EmployeesDataSource`.</span></span>

<span data-ttu-id="af38e-256">Configurare ObjectDataSource per utilizzare il `EmployeesBLLWithSprocs` classe e, dalla scheda selezionare ed eliminare, assicurarsi che il `GetEmployees` e `DeleteEmployee` i metodi vengono selezionati dagli elenchi a discesa.</span><span class="sxs-lookup"><span data-stu-id="af38e-256">Configure the ObjectDataSource to use the `EmployeesBLLWithSprocs` class and, from the SELECT and DELETE tabs, ensure that the `GetEmployees` and `DeleteEmployee` methods are selected from the drop-down lists.</span></span> <span data-ttu-id="af38e-257">Fare clic su Fine per completare la configurazione di ObjectDataSource s.</span><span class="sxs-lookup"><span data-stu-id="af38e-257">Click Finish to complete the ObjectDataSource s configuration.</span></span>


<span data-ttu-id="af38e-258">[![Configurare ObjectDataSource per utilizzare la classe EmployeesBLLWithSprocs](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-258">[![Configure the ObjectDataSource to Use the EmployeesBLLWithSprocs Class](updating-the-tableadapter-to-use-joins-cs/_static/image31.png)](updating-the-tableadapter-to-use-joins-cs/_static/image30.png)</span></span>

<span data-ttu-id="af38e-259">**Figura 12**: configurare ObjectDataSource per usare il `EmployeesBLLWithSprocs` classe ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-259">**Figure 12**: Configure the ObjectDataSource to Use the `EmployeesBLLWithSprocs` Class ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image32.png))</span></span>


<span data-ttu-id="af38e-260">[![È possibile utilizzare ObjectDataSource le GetEmployees e i metodi di DeleteEmployee](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-260">[![Have the ObjectDataSource Use the GetEmployees and DeleteEmployee Methods](updating-the-tableadapter-to-use-joins-cs/_static/image34.png)](updating-the-tableadapter-to-use-joins-cs/_static/image33.png)</span></span>

<span data-ttu-id="af38e-261">**Figura 13**: è possibile utilizzare ObjectDataSource il `GetEmployees` e `DeleteEmployee` metodi ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-261">**Figure 13**: Have the ObjectDataSource Use the `GetEmployees` and `DeleteEmployee` Methods ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image35.png))</span></span>


<span data-ttu-id="af38e-262">Visual Studio aggiungerà un BoundField a GridView per ognuna del `EmployeesDataTable` colonne s.</span><span class="sxs-lookup"><span data-stu-id="af38e-262">Visual Studio will add a BoundField to the GridView for each of the `EmployeesDataTable` s columns.</span></span> <span data-ttu-id="af38e-263">Rimuovere tutti questi BoundField, ad eccezione di `Title`, `LastName`, `FirstName`, `ManagerFirstName`, e `ManagerLastName` e rinominare il `HeaderText` le proprietà per le ultime quattro BoundField Last Name, nome, nome Manager s, e Gestione s Cognome, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="af38e-263">Remove all of these BoundFields except for `Title`, `LastName`, `FirstName`, `ManagerFirstName`, and `ManagerLastName` and rename the `HeaderText` properties for the last four BoundFields to Last Name, First Name, Manager s First Name, and Manager s Last Name, respectively.</span></span>

<span data-ttu-id="af38e-264">Per consentire agli utenti di eliminare i dipendenti da questa pagina è necessario eseguire due operazioni.</span><span class="sxs-lookup"><span data-stu-id="af38e-264">To allow users to delete employees from this page we need to do two things.</span></span> <span data-ttu-id="af38e-265">In primo luogo, indicare GridView per fornire funzionalità di eliminazione selezionando l'opzione Abilita eliminazione dal suo smart tag.</span><span class="sxs-lookup"><span data-stu-id="af38e-265">First, instruct the GridView to provide deleting capabilities by checking the Enable Deleting option from its smart tag.</span></span> <span data-ttu-id="af38e-266">In secondo luogo, modificare il s ObjectDataSource `OldValuesParameterFormatString` dal valore impostata dalla procedura guidata ObjectDataSource (`original_{0}`) al valore predefinito (`{0}`).</span><span class="sxs-lookup"><span data-stu-id="af38e-266">Second, change the ObjectDataSource s `OldValuesParameterFormatString` property from the value set by the ObjectDataSource wizard (`original_{0}`) to its default value (`{0}`).</span></span> <span data-ttu-id="af38e-267">Dopo aver apportato queste modifiche, il markup dichiarativo s GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="af38e-267">After making these changes, your GridView and ObjectDataSource s declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](updating-the-tableadapter-to-use-joins-cs/samples/sample7.aspx)]

<span data-ttu-id="af38e-268">Il test della pagina, visitare il sito tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="af38e-268">Test out the page by visiting it through a browser.</span></span> <span data-ttu-id="af38e-269">Come mostrato nella figura 14, la pagina consente di visualizzare ogni dipendente e il suo nome s manager (presupponendo che dispongano di uno).</span><span class="sxs-lookup"><span data-stu-id="af38e-269">As Figure 14 shows, the page will list each employee and his or her manager s name (assuming they have one).</span></span>


<span data-ttu-id="af38e-270">[![Il JOIN nel Employees_Select Stored Procedure restituisce il nome del gestore s](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-270">[![The JOIN in the Employees_Select Stored Procedure Returns the Manager s Name](updating-the-tableadapter-to-use-joins-cs/_static/image37.png)](updating-the-tableadapter-to-use-joins-cs/_static/image36.png)</span></span>

<span data-ttu-id="af38e-271">**Figura 14**: il `JOIN` nel `Employees_Select` Stored Procedure restituisce il nome di gestore ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-271">**Figure 14**: The `JOIN` in the `Employees_Select` Stored Procedure Returns the Manager s Name ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image38.png))</span></span>


<span data-ttu-id="af38e-272">Fare clic sul pulsante Elimina viene avviato il flusso di lavoro l'eliminazione, culmina nell'esecuzione del `Employees_Delete` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="af38e-272">Clicking the Delete button starts the deleting workflow, which culminates in the execution of the `Employees_Delete` stored procedure.</span></span> <span data-ttu-id="af38e-273">Tuttavia, il tentativo `DELETE` istruzione nella stored procedure non riesce a causa di una violazione di vincolo di chiave esterna (vedere Figura 15).</span><span class="sxs-lookup"><span data-stu-id="af38e-273">However, the attempted `DELETE` statement in the stored procedure fails because of a foreign key constraint violation (see Figure 15).</span></span> <span data-ttu-id="af38e-274">In particolare, ogni dipendente ha uno o più record `Orders` tabella, causando l'eliminazione di esito negativo.</span><span class="sxs-lookup"><span data-stu-id="af38e-274">Specifically, each employee has one or more records in the `Orders` table, causing the delete to fail.</span></span>


<span data-ttu-id="af38e-275">[![L'eliminazione di un dipendente che ha restituito risultati ordini corrispondente in una violazione di vincolo di chiave esterna](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span><span class="sxs-lookup"><span data-stu-id="af38e-275">[![Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation](updating-the-tableadapter-to-use-joins-cs/_static/image40.png)](updating-the-tableadapter-to-use-joins-cs/_static/image39.png)</span></span>

<span data-ttu-id="af38e-276">**Figura 15**: l'eliminazione di un dipendente che ha restituito risultati ordini corrispondente in una violazione di vincolo di chiave esterna ([fare clic per visualizzare l'immagine ingrandita](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span><span class="sxs-lookup"><span data-stu-id="af38e-276">**Figure 15**: Deleting an Employee That has Corresponding Orders Results in a Foreign Key Constraint Violation ([Click to view full-size image](updating-the-tableadapter-to-use-joins-cs/_static/image41.png))</span></span>


<span data-ttu-id="af38e-277">Per consentire a un dipendente eliminato è stato possibile:</span><span class="sxs-lookup"><span data-stu-id="af38e-277">To allow an employee to be deleted you could:</span></span>

- <span data-ttu-id="af38e-278">Aggiornare il vincolo di chiave esterno per eliminazioni a catena</span><span class="sxs-lookup"><span data-stu-id="af38e-278">Update the foreign key constraint to cascade deletes,</span></span>
- <span data-ttu-id="af38e-279">Eliminare manualmente i record di `Orders` tabella per i dipendenti che si desidera eliminare, o</span><span class="sxs-lookup"><span data-stu-id="af38e-279">Manually delete the records from the `Orders` table for the employee(s) you want to delete, or</span></span>
- <span data-ttu-id="af38e-280">Aggiornamento di `Employees_Delete` stored procedure per eliminare i record correlati dal `Orders` tabella prima di eliminare il `Employees` record.</span><span class="sxs-lookup"><span data-stu-id="af38e-280">Update the `Employees_Delete` stored procedure to first delete the related records from the `Orders` table before deleting the `Employees` record.</span></span> <span data-ttu-id="af38e-281">Questa tecnica in descritto il [utilizzando Stored procedure esistenti per gli oggetti TableAdapter s DataSet tipizzato](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="af38e-281">We discussed this technique in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span>

<span data-ttu-id="af38e-282">Lasciare questo campo come esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="af38e-282">I leave this as an exercise for the reader.</span></span>

## <a name="summary"></a><span data-ttu-id="af38e-283">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="af38e-283">Summary</span></span>

<span data-ttu-id="af38e-284">Quando si lavora con i database relazionali, è comune per le query per estrarre i dati da più tabelle correlate.</span><span class="sxs-lookup"><span data-stu-id="af38e-284">When working with relational databases, it is common for queries to pull their data from multiple, related tables.</span></span> <span data-ttu-id="af38e-285">Sottoquery correlate e `JOIN` forniscono due tecniche diverse per l'accesso ai dati provenienti da tabelle correlate in una query.</span><span class="sxs-lookup"><span data-stu-id="af38e-285">Correlated subqueries and `JOIN` s provide two different techniques for accessing data from related tables in a query.</span></span> <span data-ttu-id="af38e-286">Nelle esercitazioni precedenti sono stati creati più di frequente utilizzano di sottoquery correlate in quanto il TableAdapter non è possibile generare automaticamente `INSERT`, `UPDATE`, e `DELETE` istruzioni per query che interessano `JOIN` s.</span><span class="sxs-lookup"><span data-stu-id="af38e-286">In previous tutorials we most commonly made use of correlated subqueries because the TableAdapter cannot auto-generate `INSERT`, `UPDATE`, and `DELETE` statements for queries involving `JOIN` s.</span></span> <span data-ttu-id="af38e-287">Questi valori possono essere immessi manualmente, quando si Usa istruzioni SQL ad hoc tutte le personalizzazioni verranno sovrascritte quando viene completata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-287">While these values can be provided manually, when using ad-hoc SQL statements any customizations will be overwritten when the TableAdapter Configuration wizard is completed.</span></span>

<span data-ttu-id="af38e-288">Fortunatamente, gli oggetti TableAdapter creati utilizzando le stored procedure non subiscono del stessa vulnerabilità come quelli creati utilizzando istruzioni SQL ad hoc.</span><span class="sxs-lookup"><span data-stu-id="af38e-288">Fortunately, TableAdapters created using stored procedures do not suffer from the same brittleness as those created using ad-hoc SQL statements.</span></span> <span data-ttu-id="af38e-289">Pertanto, è possibile creare un oggetto TableAdapter cui query principale Usa un `JOIN` quando si utilizzano stored procedure.</span><span class="sxs-lookup"><span data-stu-id="af38e-289">Therefore, it is feasible to create a TableAdapter whose main query uses a `JOIN` when using stored procedures.</span></span> <span data-ttu-id="af38e-290">In questa esercitazione è stato illustrato come creare questo tipo un TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="af38e-290">In this tutorial we saw how to create such a TableAdapter.</span></span> <span data-ttu-id="af38e-291">È stato avviato utilizzando un `JOIN`-minore `SELECT` query per la query principale di TableAdapter s in modo che il corrispondente insert, update e delete stored procedure sarà creato automaticamente.</span><span class="sxs-lookup"><span data-stu-id="af38e-291">We started by using a `JOIN`-less `SELECT` query for the TableAdapter s main query so that the corresponding insert, update, and delete stored procedures would be auto-created.</span></span> <span data-ttu-id="af38e-292">TableAdapter s iniziale completato la configurazione, è aumentata la `SelectCommand` stored procedure per utilizzare un `JOIN` ed eseguita nuovamente la configurazione guidata TableAdapter per aggiornare il `EmployeesDataTable` colonne s.</span><span class="sxs-lookup"><span data-stu-id="af38e-292">With the TableAdapter s initial configuration complete, we augmented the `SelectCommand` stored procedure to use a `JOIN` and re-ran the TableAdapter Configuration wizard to update the `EmployeesDataTable` s columns.</span></span>

<span data-ttu-id="af38e-293">Eseguire nuovamente la configurazione guidata TableAdapter automaticamente aggiornata il `EmployeesDataTable` colonne in modo da riflettere i campi di dati restituiti dal `Employees_Select` stored procedure di.</span><span class="sxs-lookup"><span data-stu-id="af38e-293">Re-running the TableAdapter Configuration wizard automatically updated the `EmployeesDataTable` columns to reflect the data fields returned by the `Employees_Select` stored procedure.</span></span> <span data-ttu-id="af38e-294">In alternativa, avremmo potuto aggiungere queste colonne manualmente nella DataTable.</span><span class="sxs-lookup"><span data-stu-id="af38e-294">Alternatively, we could have added these columns manually to the DataTable.</span></span> <span data-ttu-id="af38e-295">Nella prossima esercitazione verrà illustrato aggiunta manuale di colonne nella DataTable.</span><span class="sxs-lookup"><span data-stu-id="af38e-295">We will explore manually adding columns to the DataTable in the next tutorial.</span></span>

<span data-ttu-id="af38e-296">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="af38e-296">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="af38e-297">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="af38e-297">About the Author</span></span>

<span data-ttu-id="af38e-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="af38e-298">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="af38e-299">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="af38e-299">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="af38e-300">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="af38e-300">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="af38e-301">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="af38e-301">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="af38e-302">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="af38e-302">Special Thanks To</span></span>

<span data-ttu-id="af38e-303">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="af38e-303">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="af38e-304">Lead revisori per questa esercitazione sono stati Hilton Geisenow e David Suru Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="af38e-304">Lead reviewers for this tutorial were Hilton Geisenow, David Suru, and Teresa Murphy.</span></span> <span data-ttu-id="af38e-305">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="af38e-305">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="af38e-306">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="af38e-306">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="af38e-307">[Precedente](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
> [Successivo](adding-additional-datatable-columns-cs.md)</span><span class="sxs-lookup"><span data-stu-id="af38e-307">[Previous](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md)
[Next](adding-additional-datatable-columns-cs.md)</span></span>

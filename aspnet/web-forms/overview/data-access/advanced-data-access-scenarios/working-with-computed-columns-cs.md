---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
title: Utilizzo di colonne calcolate (c#) | Documenti Microsoft
author: rick-anderson
description: Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che in genere referen...
ms.author: aspnetcontent
manager: wpickett
ms.date: 08/03/2007
ms.topic: article
ms.assetid: 57459065-ed7c-4dfe-ac9c-54c093abc261
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/working-with-computed-columns-cs
msc.type: authoredcontent
ms.openlocfilehash: 7a67abd2a0c140c0503c07f764549a6d90ef7298
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30877226"
---
<a name="working-with-computed-columns-c"></a><span data-ttu-id="f7469-103">Utilizzo di colonne calcolate (c#)</span><span class="sxs-lookup"><span data-stu-id="f7469-103">Working with Computed Columns (C#)</span></span>
====================
<span data-ttu-id="f7469-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f7469-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f7469-105">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) o [Scarica il PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span><span class="sxs-lookup"><span data-stu-id="f7469-105">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_71_CS.zip) or [Download PDF](working-with-computed-columns-cs/_static/datatutorial71cs1.pdf)</span></span>

> <span data-ttu-id="f7469-106">Quando si crea una tabella di database, Microsoft SQL Server consente di definire una colonna calcolata il cui valore viene calcolato da un'espressione che fa riferimento in genere di altri valori nel record del database stesso.</span><span class="sxs-lookup"><span data-stu-id="f7469-106">When creating a database table, Microsoft SQL Server allows you to define a computed column whose value is calculated from an expression that usually references other values in the same database record.</span></span> <span data-ttu-id="f7469-107">Tali valori sono di sola lettura nel database di, che richiede alcune considerazioni speciali quando si lavora con gli oggetti TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-107">Such values are read-only at the database, which requires special considerations when working with TableAdapters.</span></span> <span data-ttu-id="f7469-108">In questa esercitazione è imparare a soddisfare le esigenze di derivanti dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-108">In this tutorial we learn how to meet the challenges posed by computed columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="f7469-109">Introduzione</span><span class="sxs-lookup"><span data-stu-id="f7469-109">Introduction</span></span>

<span data-ttu-id="f7469-110">Microsoft SQL Server consente di  *[le colonne calcolate](https://msdn.microsoft.com/library/ms191250.aspx)*, che sono colonne i cui valori sono calcolati da un'espressione che in genere fa riferimento ai valori di altre colonne nella stessa tabella.</span><span class="sxs-lookup"><span data-stu-id="f7469-110">Microsoft SQL Server allows for *[computed columns](https://msdn.microsoft.com/library/ms191250.aspx)*, which are columns whose values are calculated from an expression that usually references the values from other columns in the same table.</span></span> <span data-ttu-id="f7469-111">Ad esempio, un modello di dati di rilevamento di tempo potrebbe creare una tabella denominata `ServiceLog` con colonne incluse `ServicePerformed`, `EmployeeID`, `Rate`, e `Duration`, tra gli altri.</span><span class="sxs-lookup"><span data-stu-id="f7469-111">As an example, a time tracking data model might have a table named `ServiceLog` with columns including `ServicePerformed`, `EmployeeID`, `Rate`, and `Duration`, among others.</span></span> <span data-ttu-id="f7469-112">Mentre l'importo dovuto per ogni servizio elemento (la velocità di moltiplicato per la durata viene) può essere calcolato tramite una pagina web o un'altra interfaccia a livello di codice, potrebbe essere utile per includere una colonna di `ServiceLog` tabella denominata `AmountDue` che ha segnalato questo informazioni.</span><span class="sxs-lookup"><span data-stu-id="f7469-112">While the amount due per service item (being the rate multiplied by the duration) could be calculated through a web page or other programmatic interface, it might be handy to include a column in the `ServiceLog` table named `AmountDue` that reported this information.</span></span> <span data-ttu-id="f7469-113">Questa colonna può essere creata come una normale colonna, ma è necessario aggiornare in qualsiasi momento il `Rate` o `Duration` valori della colonna modificati.</span><span class="sxs-lookup"><span data-stu-id="f7469-113">This column could be created as a normal column, but it would need to be updated anytime the `Rate` or `Duration` column values changed.</span></span> <span data-ttu-id="f7469-114">Un approccio migliore, è possibile rendere il `AmountDue` una colonna calcolata con l'espressione di colonna `Rate * Duration`.</span><span class="sxs-lookup"><span data-stu-id="f7469-114">A better approach would be to make the `AmountDue` column a computed column using the expression `Rate * Duration`.</span></span> <span data-ttu-id="f7469-115">Questa operazione provocherebbe SQL Server calcolare automaticamente il `AmountDue` valore della colonna ogni volta che vi viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="f7469-115">Doing so would cause SQL Server to automatically calculate the `AmountDue` column value whenever it was referenced in a query.</span></span>

<span data-ttu-id="f7469-116">Poiché un valore della colonna calcolata s è determinato da un'espressione, tali colonne sono di sola lettura e pertanto non possono essere assegnati valori a essi in `INSERT` o `UPDATE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="f7469-116">Since a computed column s value is determined by an expression, such columns are read-only and therefore cannot have values assigned to them in `INSERT` or `UPDATE` statements.</span></span> <span data-ttu-id="f7469-117">Tuttavia, quando le colonne calcolate sono parte della query principale per un oggetto TableAdapter che utilizza istruzioni SQL ad hoc, vengono incluse automaticamente nel generata automaticamente `INSERT` e `UPDATE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="f7469-117">However, when computed columns are part of the main query for a TableAdapter that uses ad-hoc SQL statements, they are automatically included in the auto-generated `INSERT` and `UPDATE` statements.</span></span> <span data-ttu-id="f7469-118">Di conseguenza, i TableAdapter `INSERT` e `UPDATE` query e `InsertCommand` e `UpdateCommand` proprietà devono essere aggiornate per rimuovere i riferimenti a tutte le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-118">Consequently, the TableAdapter s `INSERT` and `UPDATE` queries and `InsertCommand` and `UpdateCommand` properties must be updated to remove references to any computed columns.</span></span>

<span data-ttu-id="f7469-119">Una sfida di utilizzo di colonne con un TableAdapter che utilizza istruzioni SQL ad hoc calcolate è che i TableAdapter `INSERT` e `UPDATE` le query vengono rigenerate automaticamente ogni volta che viene completata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-119">One challenge of using computed columns with a TableAdapter that uses ad-hoc SQL statements is that the TableAdapter s `INSERT` and `UPDATE` queries are automatically regenerated any time the TableAdapter Configuration wizard is completed.</span></span> <span data-ttu-id="f7469-120">Di conseguenza, le colonne calcolate rimosso manualmente dal `INSERT` e `UPDATE` query verrà visualizzato nuovamente se la procedura guidata viene rieseguita.</span><span class="sxs-lookup"><span data-stu-id="f7469-120">Therefore, the computed columns manually removed from the `INSERT` and `UPDATE` queries will reappear if the wizard is re-run.</span></span> <span data-ttu-id="f7469-121">Anche se gli oggetti TableAdapter che utilizzano stored procedure non è stata ridimensionata subire questa vulnerabilità, hanno i propri quirks che si risolverà nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="f7469-121">Although TableAdapters that use stored procedures don t suffer from this brittleness, they do have their own quirks that we will address in Step 3.</span></span>

<span data-ttu-id="f7469-122">In questa esercitazione si aggiungerà una colonna calcolata per il `Suppliers` tabella nel database Northwind e quindi creare un oggetto TableAdapter corrispondente per funzionare con questa tabella e la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-122">In this tutorial we will add a computed column to the `Suppliers` table in the Northwind database and then create a corresponding TableAdapter to work with this table and its computed column.</span></span> <span data-ttu-id="f7469-123">Si avranno il TableAdapter utilizzare stored procedure anziché istruzioni SQL ad hoc in modo che il nostro t personalizzazioni persi quando viene utilizzata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-123">We will have our TableAdapter use stored procedures instead of ad-hoc SQL statements so that our customizations aren t lost when the TableAdapter Configuration wizard is used.</span></span>

<span data-ttu-id="f7469-124">Let s iniziare!</span><span class="sxs-lookup"><span data-stu-id="f7469-124">Let s get started!</span></span>

## <a name="step-1-adding-a-computed-column-to-thesupplierstable"></a><span data-ttu-id="f7469-125">Passaggio 1: Aggiunta di una colonna calcolata per il`Suppliers`tabella</span><span class="sxs-lookup"><span data-stu-id="f7469-125">Step 1: Adding a Computed Column to the`Suppliers`Table</span></span>

<span data-ttu-id="f7469-126">Il database Northwind non dispone delle colonne calcolate, pertanto sarà necessario aggiungere una effettuata.</span><span class="sxs-lookup"><span data-stu-id="f7469-126">The Northwind database does not have any computed columns so we will need to add one ourselves.</span></span> <span data-ttu-id="f7469-127">Per questa esercitazione consente s aggiungere una colonna calcolata per il `Suppliers` tabella denominata `FullContactName` che restituisce il nome del contatto s, titolo e la società che lavorano per il seguente formato: `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="f7469-127">For this tutorial let s add a computed column to the `Suppliers` table called `FullContactName` that returns the contact s name, title, and the company they work for in the following format: `ContactName` (`ContactTitle`, `CompanyName`).</span></span> <span data-ttu-id="f7469-128">Questa calcolata colonna può essere utilizzata nei report nella visualizzazione di informazioni sui fornitori.</span><span class="sxs-lookup"><span data-stu-id="f7469-128">This computed column might be used in reports when displaying information about suppliers.</span></span>

<span data-ttu-id="f7469-129">Aprire il `Suppliers` definizione tabella facendo clic su di `Suppliers` tabella in Esplora Server e scegliendo Apri definizione tabella dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f7469-129">Start by opening the `Suppliers` table definition by right-clicking on the `Suppliers` table in the Server Explorer and choosing Open Table Definition from the context-menu.</span></span> <span data-ttu-id="f7469-130">Le colonne della tabella e le relative proprietà, ad esempio i tipi di dati, verrà visualizzata se consentono `NULL` s e così via.</span><span class="sxs-lookup"><span data-stu-id="f7469-130">This will display the columns of the table and their properties, such as their data type, whether they allow `NULL` s, and so forth.</span></span> <span data-ttu-id="f7469-131">Per aggiungere una colonna calcolata, avviare digitando il nome della colonna nella definizione della tabella.</span><span class="sxs-lookup"><span data-stu-id="f7469-131">To add a computed column, start by typing in the name of the column into the table definition.</span></span> <span data-ttu-id="f7469-132">Quindi, immettere l'espressione nella casella di testo (Formula) nella sezione specifica colonna calcolata nella finestra proprietà di colonna (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="f7469-132">Next, enter its expression into the (Formula) textbox under the Computed Column Specification section in the Column Properties window (see Figure 1).</span></span> <span data-ttu-id="f7469-133">Nome della colonna calcolata `FullContactName` e utilizzare l'espressione seguente:</span><span class="sxs-lookup"><span data-stu-id="f7469-133">Name the computed column `FullContactName` and use the following expression:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample1.sql)]

<span data-ttu-id="f7469-134">Si noti che le stringhe possono essere concatenate in SQL utilizzando il `+` operatore.</span><span class="sxs-lookup"><span data-stu-id="f7469-134">Note that strings can be concatenated in SQL using the `+` operator.</span></span> <span data-ttu-id="f7469-135">Il `CASE` istruzione può essere utilizzata come un'istruzione condizionale in un linguaggio di programmazione tradizionali.</span><span class="sxs-lookup"><span data-stu-id="f7469-135">The `CASE` statement can be used like a conditional in a traditional programming language.</span></span> <span data-ttu-id="f7469-136">Nell'espressione di `CASE` istruzione può essere letto come: se `ContactTitle` non `NULL` quindi output il `ContactTitle` valore concatenato con una virgola, in caso contrario emit nulla.</span><span class="sxs-lookup"><span data-stu-id="f7469-136">In the above expression the `CASE` statement can be read as: If `ContactTitle` is not `NULL` then output the `ContactTitle` value concatenated with a comma, otherwise emit nothing.</span></span> <span data-ttu-id="f7469-137">Per ulteriori informazioni sulle utilità del `CASE` istruzione, vedere [Power di SQL `CASE` istruzioni](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span><span class="sxs-lookup"><span data-stu-id="f7469-137">For more on the usefulness of the `CASE` statement, see [The Power of SQL `CASE` Statements](http://www.4guysfromrolla.com/webtech/102704-1.shtml).</span></span>

> [!NOTE]
> <span data-ttu-id="f7469-138">Anziché utilizzare un `CASE` istruzione qui avremmo potuto in alternativa utilizzare `ISNULL(ContactTitle, '')`.</span><span class="sxs-lookup"><span data-stu-id="f7469-138">Instead of using a `CASE` statement here, we could have alternatively used `ISNULL(ContactTitle, '')`.</span></span> <span data-ttu-id="f7469-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) Restituisce *checkExpression* se è diverso da NULL, in caso contrario restituirà *replacementValue*.</span><span class="sxs-lookup"><span data-stu-id="f7469-139">[`ISNULL(checkExpression, replacementValue)`](https://msdn.microsoft.com/library/ms184325.aspx) returns *checkExpression* if it is non-NULL, otherwise it returns *replacementValue*.</span></span> <span data-ttu-id="f7469-140">Durante uno `ISNULL` o `CASE` funzionerà in questo caso, vi sono più complessi scenari in cui la flessibilità del `CASE` istruzione non può corrispondere a `ISNULL`.</span><span class="sxs-lookup"><span data-stu-id="f7469-140">While either `ISNULL` or `CASE` will work in this instance, there are more intricate scenarios where the flexibility of the `CASE` statement cannot be matched by `ISNULL`.</span></span>


<span data-ttu-id="f7469-141">Dopo aver aggiunto la colonna calcolata la schermata dovrebbe essere simile all'immagine riportata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="f7469-141">After adding this computed column your screen should look like the screen shot in Figure 1.</span></span>


<span data-ttu-id="f7469-142">[![Aggiungere una colonna calcolata denominata FullContactName alla tabella Suppliers](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-142">[![Add a Computed Column Named FullContactName to the Suppliers Table](working-with-computed-columns-cs/_static/image2.png)](working-with-computed-columns-cs/_static/image1.png)</span></span>

<span data-ttu-id="f7469-143">**Figura 1**: aggiungere una colonna calcolata denominata `FullContactName` per il `Suppliers` tabella ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-143">**Figure 1**: Add a Computed Column Named `FullContactName` to the `Suppliers` Table ([Click to view full-size image](working-with-computed-columns-cs/_static/image3.png))</span></span>


<span data-ttu-id="f7469-144">Dopo aver creato la colonna calcolata e immettere la relativa espressione, salvare le modifiche alla tabella facendo clic sull'icona Salva nella barra degli strumenti, premendo Ctrl + S oppure dal menu File e scegliendo Salva `Suppliers`.</span><span class="sxs-lookup"><span data-stu-id="f7469-144">After naming the computed column and entering its expression, save the changes to the table by clicking the Save icon in the toolbar, by hitting Ctrl+S, or by going to the File menu and choosing Save `Suppliers`.</span></span>

<span data-ttu-id="f7469-145">Salvare la tabella è necessario aggiornare Esplora Server, inclusa la colonna appena aggiunto nel `Suppliers` elenco di colonne di tabella s.</span><span class="sxs-lookup"><span data-stu-id="f7469-145">Saving the table should refresh the Server Explorer, including the just-added column in the `Suppliers` table s column list.</span></span> <span data-ttu-id="f7469-146">Inoltre, l'espressione immessa nella casella di testo (Formula) regolerà automaticamente a un'espressione equivalente che rimuove gli spazi vuoti non necessari, racchiuso tra parentesi quadre i nomi di colonna (`[]`) e include le parentesi per mostrare in modo più esplicito l'ordine delle operazioni:</span><span class="sxs-lookup"><span data-stu-id="f7469-146">Furthermore, the expression entered into the (Formula) textbox will automatically adjust to an equivalent expression that strips unnecessary whitespace, surrounds column names with brackets (`[]`), and includes parentheses to more explicitly show the order of operations:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample2.sql)]

<span data-ttu-id="f7469-147">Per ulteriori informazioni su colonne calcolate in Microsoft SQL Server, consultare il [documentazione tecnica](https://msdn.microsoft.com/library/ms191250.aspx).</span><span class="sxs-lookup"><span data-stu-id="f7469-147">For more information on computed columns in Microsoft SQL Server, refer to the [technical documentation](https://msdn.microsoft.com/library/ms191250.aspx).</span></span> <span data-ttu-id="f7469-148">Vedere anche il [procedura: specificare le colonne calcolate](https://msdn.microsoft.com/library/ms188300.aspx) per una descrizione dettagliata della creazione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-148">Also check out the [How to: Specify Computed Columns](https://msdn.microsoft.com/library/ms188300.aspx) for a step-by-step walkthrough of creating computed columns.</span></span>

> [!NOTE]
> <span data-ttu-id="f7469-149">Per impostazione predefinita, le colonne calcolate non sono archiviate fisicamente nella tabella, ma sono invece ricalcolate ogni volta che vi viene fatto riferimento in una query.</span><span class="sxs-lookup"><span data-stu-id="f7469-149">By default, computed columns are not physically stored in the table but are instead recalculated each time they are referenced in a query.</span></span> <span data-ttu-id="f7469-150">Selezionando la casella di controllo è persistente, tuttavia, è possibile indicare di SQL Server per archiviare fisicamente la colonna calcolata nella tabella.</span><span class="sxs-lookup"><span data-stu-id="f7469-150">By checking the Is Persisted checkbox, however, you can instruct SQL Server to physically store the computed column in the table.</span></span> <span data-ttu-id="f7469-151">In questo modo consente di creare la colonna calcolata, che consente di migliorare le prestazioni delle query che utilizzano il valore di colonna calcolata in un indice loro `WHERE` clausole.</span><span class="sxs-lookup"><span data-stu-id="f7469-151">Doing so allows an index to be created on the computed column, which can improve the performance of queries that use the computed column value in their `WHERE` clauses.</span></span> <span data-ttu-id="f7469-152">Vedere [la creazione di indici per colonne calcolate](https://msdn.microsoft.com/library/ms189292.aspx) per ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="f7469-152">See [Creating Indexes on Computed Columns](https://msdn.microsoft.com/library/ms189292.aspx) for more information.</span></span>


## <a name="step-2-viewing-the-computed-column-s-values"></a><span data-ttu-id="f7469-153">Passaggio 2: Visualizzare i valori di colonna calcolata s</span><span class="sxs-lookup"><span data-stu-id="f7469-153">Step 2: Viewing the Computed Column s Values</span></span>

<span data-ttu-id="f7469-154">Prima di iniziare lavoro nel livello di accesso ai dati, s consentono di richiedere un minuto, per visualizzare il `FullContactName` valori.</span><span class="sxs-lookup"><span data-stu-id="f7469-154">Before we start work on the Data Access Layer, let s take a minute to view the `FullContactName` values.</span></span> <span data-ttu-id="f7469-155">Da Esplora Server, fare clic su di `Suppliers` nome tabella e scegliere Nuova Query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f7469-155">From the Server Explorer, right-click on the `Suppliers` table name and choose New Query from the context-menu.</span></span> <span data-ttu-id="f7469-156">Verrà visualizzata una finestra di Query che richiede di scegliere le tabelle da includere nella query.</span><span class="sxs-lookup"><span data-stu-id="f7469-156">This will bring up a Query window that prompts us to choose what tables to include in the query.</span></span> <span data-ttu-id="f7469-157">Aggiungere il `Suppliers` tabella e fare clic su Chiudi.</span><span class="sxs-lookup"><span data-stu-id="f7469-157">Add the `Suppliers` table and click Close.</span></span> <span data-ttu-id="f7469-158">Successivamente, controllare il `CompanyName`, `ContactName`, `ContactTitle`, e `FullContactName` colonne dalla tabella Suppliers.</span><span class="sxs-lookup"><span data-stu-id="f7469-158">Next, check the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` columns from the Suppliers table.</span></span> <span data-ttu-id="f7469-159">Infine, fare clic sull'icona di punto esclamativo rosso nella barra degli strumenti per eseguire la query e visualizzare i risultati.</span><span class="sxs-lookup"><span data-stu-id="f7469-159">Finally, click the red exclamation point icon in the Toolbar to execute the query and view the results.</span></span>

<span data-ttu-id="f7469-160">Come illustrato nella figura 2, i risultati includono `FullContactName`, quali gli elenchi di `CompanyName`, `ContactName`, e `ContactTitle` colonne utilizzando il formato ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span><span class="sxs-lookup"><span data-stu-id="f7469-160">As Figure 2 shows, the results include `FullContactName`, which lists the `CompanyName`, `ContactName`, and `ContactTitle` columns using the format ldquo;`ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="f7469-161">[![Il FullContactName utilizza ContactName formato (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-161">[![The FullContactName Uses the Format ContactName (ContactTitle, CompanyName)](working-with-computed-columns-cs/_static/image5.png)](working-with-computed-columns-cs/_static/image4.png)</span></span>

<span data-ttu-id="f7469-162">**Figura 2**: il `FullContactName` Usa il formato `ContactName` (`ContactTitle`, `CompanyName`) ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-162">**Figure 2**: The `FullContactName` Uses the Format `ContactName` (`ContactTitle`, `CompanyName`) ([Click to view full-size image](working-with-computed-columns-cs/_static/image6.png))</span></span>


## <a name="step-3-adding-thesupplierstableadapterto-the-data-access-layer"></a><span data-ttu-id="f7469-163">Passaggio 3: Aggiunta di`SuppliersTableAdapter`a livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="f7469-163">Step 3: Adding the`SuppliersTableAdapter`to the Data Access Layer</span></span>

<span data-ttu-id="f7469-164">Per utilizzare le informazioni del fornitore dell'applicazione è necessario innanzitutto creare un oggetto TableAdapter e DataTable nel nostro DAL.</span><span class="sxs-lookup"><span data-stu-id="f7469-164">In order to work with the supplier information in our application we need to first create a TableAdapter and DataTable in our DAL.</span></span> <span data-ttu-id="f7469-165">In teoria, questa verrebbe eseguita utilizzando gli stessi passaggi semplici esaminati nelle esercitazioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="f7469-165">Ideally, this would be accomplished using the same straightforward steps examined in earlier tutorials.</span></span> <span data-ttu-id="f7469-166">Tuttavia, lavorare con le colonne calcolate introduce alcuni rughe che meritano discussione.</span><span class="sxs-lookup"><span data-stu-id="f7469-166">However, working with computed columns introduces a few wrinkles that merit discussion.</span></span>

<span data-ttu-id="f7469-167">Se si utilizza un oggetto TableAdapter che utilizza istruzioni SQL ad hoc, è sufficiente includere la colonna calcolata nella query TableAdapter s principale tramite la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-167">If you are using a TableAdapter that uses ad-hoc SQL statements, you can simply include the computed column in the TableAdapter s main query via the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="f7469-168">Questa operazione, tuttavia, genererà automaticamente `INSERT` e `UPDATE` le istruzioni che includono la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-168">This, however, will auto-generate `INSERT` and `UPDATE` statements that include the computed column.</span></span> <span data-ttu-id="f7469-169">Se si tenta di eseguire uno di questi metodi, un `SqlException` con il messaggio, la colonna *ColumnName* non può essere modificato perché è una colonna calcolata o il risultato di un operatore UNION, verrà generato.</span><span class="sxs-lookup"><span data-stu-id="f7469-169">If you attempt to execute one of these methods, a `SqlException` with the message The column *ColumnName* cannot be modified because it is either a computed column or is the result of a UNION operator will be thrown.</span></span> <span data-ttu-id="f7469-170">Mentre il `INSERT` e `UPDATE` istruzione può essere modificata manualmente tramite i TableAdapter `InsertCommand` e `UpdateCommand` proprietà, queste personalizzazioni andranno perse ogni volta che la configurazione guidata TableAdapter viene rieseguita.</span><span class="sxs-lookup"><span data-stu-id="f7469-170">While the `INSERT` and `UPDATE` statement can be manually adjusted through the TableAdapter s `InsertCommand` and `UpdateCommand` properties, these customizations will be lost whenever the TableAdapter Configuration wizard is re-run.</span></span>

<span data-ttu-id="f7469-171">A causa della vulnerabilità degli oggetti TableAdapter che Usa istruzioni SQL ad hoc, è consigliabile che le stored procedure viene usata quando si utilizzano colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-171">Due to the brittleness of TableAdapters that use ad-hoc SQL statements, it is recommended that we use stored procedures when working with computed columns.</span></span> <span data-ttu-id="f7469-172">Se si utilizza stored procedure esistenti, semplicemente configurare il TableAdapter come descritto nel [utilizzando Stored procedure esistenti per gli oggetti TableAdapter s DataSet tipizzato](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="f7469-172">If you are using existing stored procedures, simply configure the TableAdapter as discussed in the [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-cs.md) tutorial.</span></span> <span data-ttu-id="f7469-173">Se si dispone, la configurazione guidata TableAdapter crea le stored procedure per l'utente, tuttavia, è importante inizialmente omettere le colonne calcolate dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="f7469-173">If you have the TableAdapter wizard create the stored procedures for you, however, it is important to initially omit any computed columns from the main query.</span></span> <span data-ttu-id="f7469-174">Se si include una colonna calcolata nella query principale, la configurazione guidata TableAdapter verrà informa, dopo il completamento, che non è possibile creare le stored procedure corrispondente.</span><span class="sxs-lookup"><span data-stu-id="f7469-174">If you include a computed column in the main query, the TableAdapter Configuration wizard will inform you, upon completion, that it cannot create the corresponding stored procedures.</span></span> <span data-ttu-id="f7469-175">In breve, è necessario configurare inizialmente il TableAdapter utilizzando una query principale senza colonna calcolata e quindi aggiornare manualmente la stored procedure corrispondente e ai TableAdapter `SelectCommand` per includere la colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-175">In short, we need to initially configure the TableAdapter using a computed column-free main query and then manually update the corresponding stored procedure and the TableAdapter s `SelectCommand` to include the computed column.</span></span> <span data-ttu-id="f7469-176">Questo approccio è simile a quella usata nel [l'aggiornamento dell'oggetto TableAdapter utilizzare](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* esercitazione.</span><span class="sxs-lookup"><span data-stu-id="f7469-176">This approach is similar to the one used in the [Updating the TableAdapter to Use](updating-the-tableadapter-to-use-joins-cs.md)`JOIN`*s* tutorial.</span></span>

<span data-ttu-id="f7469-177">Consente di s per questa esercitazione, aggiungere un nuovo TableAdapter e fare in modo creare automaticamente le stored procedure per noi.</span><span class="sxs-lookup"><span data-stu-id="f7469-177">For this tutorial, let s add a new TableAdapter and have it automatically create the stored procedures for us.</span></span> <span data-ttu-id="f7469-178">Di conseguenza, è necessario omettere inizialmente il `FullContactName` colonna calcolata dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="f7469-178">Consequently, we will need to initially omit the `FullContactName` computed column from the main query.</span></span>

<span data-ttu-id="f7469-179">Aprire il `NorthwindWithSprocs` set di dati nel `~/App_Code/DAL` cartella.</span><span class="sxs-lookup"><span data-stu-id="f7469-179">Start by opening the `NorthwindWithSprocs` DataSet in the `~/App_Code/DAL` folder.</span></span> <span data-ttu-id="f7469-180">Pulsante destro del mouse nella finestra di progettazione e scegliere il menu di scelta rapida aggiungere un nuovo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-180">Right-click in the Designer and, from the context-menu, choose to add a new TableAdapter.</span></span> <span data-ttu-id="f7469-181">Verrà avviata la configurazione guidata TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-181">This will launch the TableAdapter Configuration wizard.</span></span> <span data-ttu-id="f7469-182">Specificare il database per i dati di query (`NORTHWNDConnectionString` da `Web.config`) e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7469-182">Specify the database to query data from (`NORTHWNDConnectionString` from `Web.config`) and click Next.</span></span> <span data-ttu-id="f7469-183">Poiché non è stata ancora creata alcuna stored procedure per l'esecuzione di query o la modifica di `Suppliers` tabella, selezionare la creazione di nuove stored procedure opzione in modo che la procedura guidata verrà creati automaticamente e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7469-183">Since we have not yet created any stored procedures for querying or modifying the `Suppliers` table, select the Create new stored procedures option so that the wizard will create them for us and click Next.</span></span>


<span data-ttu-id="f7469-184">[![Scegliere Crea nuove stored procedure. opzione](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-184">[![Choose the Create new stored procedures Option](working-with-computed-columns-cs/_static/image8.png)](working-with-computed-columns-cs/_static/image7.png)</span></span>

<span data-ttu-id="f7469-185">**Figura 3**: scegliere Crea nuove stored procedure. opzione ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-185">**Figure 3**: Choose the Create new stored procedures Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image9.png))</span></span>


<span data-ttu-id="f7469-186">Il passaggio successivo ci richiesto per la query principale.</span><span class="sxs-lookup"><span data-stu-id="f7469-186">The subsequent step prompts us for the main query.</span></span> <span data-ttu-id="f7469-187">Immettere la query seguente, che restituisce il `SupplierID`, `CompanyName`, `ContactName`, e `ContactTitle` colonne per ogni fornitore.</span><span class="sxs-lookup"><span data-stu-id="f7469-187">Enter the following query, which returns the `SupplierID`, `CompanyName`, `ContactName`, and `ContactTitle` columns for each supplier.</span></span> <span data-ttu-id="f7469-188">Si noti che questa query intenzionalmente consente di omettere la colonna calcolata (`FullContactName`); verrà aggiornato per includere la colonna nel passaggio 4 la stored procedure corrispondente.</span><span class="sxs-lookup"><span data-stu-id="f7469-188">Note that this query purposefully omits the computed column (`FullContactName`); we will update the corresponding stored procedure to include this column in Step 4.</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample3.sql)]

<span data-ttu-id="f7469-189">Dopo aver immesso la query principale e facendo clic su Avanti, la procedura guidata consente di assegnare un nome di quattro stored procedure che verrà generato.</span><span class="sxs-lookup"><span data-stu-id="f7469-189">After entering the main query and clicking Next, the wizard allows us to name the four stored procedures it will generate.</span></span> <span data-ttu-id="f7469-190">Nome di queste stored procedure `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, e `Suppliers_Delete`, come illustrato nella figura 4.</span><span class="sxs-lookup"><span data-stu-id="f7469-190">Name these stored procedures `Suppliers_Select`, `Suppliers_Insert`, `Suppliers_Update`, and `Suppliers_Delete`, as Figure 4 illustrates.</span></span>


<span data-ttu-id="f7469-191">[![Personalizzare i nomi delle Stored procedure generata automaticamente](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-191">[![Customize the Names of the Auto-Generated Stored Procedures](working-with-computed-columns-cs/_static/image11.png)](working-with-computed-columns-cs/_static/image10.png)</span></span>

<span data-ttu-id="f7469-192">**Figura 4**: personalizzare i nomi delle Stored procedure del Auto-Generated ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-192">**Figure 4**: Customize the Names of the Auto-Generated Stored Procedures ([Click to view full-size image](working-with-computed-columns-cs/_static/image12.png))</span></span>


<span data-ttu-id="f7469-193">Il passaggio successivo della procedura guidata consente di denominare metodi s dell'oggetto TableAdapter e specificare i modelli utilizzati per accedere e aggiornare dati.</span><span class="sxs-lookup"><span data-stu-id="f7469-193">The next wizard step allows us to name the TableAdapter s methods and specify the patterns used to access and update data.</span></span> <span data-ttu-id="f7469-194">Lasciare tutti i tre caselle di controllo selezionate, ma non rinominare il `GetData` metodo `GetSuppliers`.</span><span class="sxs-lookup"><span data-stu-id="f7469-194">Leave all three checkboxes checked, but rename the `GetData` method to `GetSuppliers`.</span></span> <span data-ttu-id="f7469-195">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="f7469-195">Click Finish to complete the wizard.</span></span>


<span data-ttu-id="f7469-196">[![Rinominare il metodo GetData per GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-196">[![Rename the GetData Method to GetSuppliers](working-with-computed-columns-cs/_static/image14.png)](working-with-computed-columns-cs/_static/image13.png)</span></span>

<span data-ttu-id="f7469-197">**Figura 5**: rinominare il `GetData` metodo `GetSuppliers` ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-197">**Figure 5**: Rename the `GetData` Method to `GetSuppliers` ([Click to view full-size image](working-with-computed-columns-cs/_static/image15.png))</span></span>


<span data-ttu-id="f7469-198">Al momento di fare clic su Fine, la procedura guidata verrà creare quattro stored procedure e aggiungere il TableAdapter e DataTable corrispondente al set di dati tipizzato.</span><span class="sxs-lookup"><span data-stu-id="f7469-198">Upon clicking Finish, the wizard will create the four stored procedures and add the TableAdapter and corresponding DataTable to the Typed DataSet.</span></span>

## <a name="step-4-including-the-computed-column-in-the-tableadapter-s-main-query"></a><span data-ttu-id="f7469-199">Passaggio 4: Inclusa la colonna calcolata nella Query TableAdapter s principale</span><span class="sxs-lookup"><span data-stu-id="f7469-199">Step 4: Including the Computed Column in the TableAdapter s Main Query</span></span>

<span data-ttu-id="f7469-200">È ora necessario per l'aggiornamento dell'oggetto TableAdapter e DataTable creato nel passaggio 3 per includere il `FullContactName` colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-200">We now need to update the TableAdapter and DataTable created in Step 3 to include the `FullContactName` computed column.</span></span> <span data-ttu-id="f7469-201">Questa operazione comporta due passaggi:</span><span class="sxs-lookup"><span data-stu-id="f7469-201">This involves two steps:</span></span>

1. <span data-ttu-id="f7469-202">L'aggiornamento di `Suppliers_Select` stored procedure per restituire il `FullContactName` colonna calcolata, e</span><span class="sxs-lookup"><span data-stu-id="f7469-202">Updating the `Suppliers_Select` stored procedure to return the `FullContactName` computed column, and</span></span>
2. <span data-ttu-id="f7469-203">L'aggiornamento di DataTable per includere un corrispondente `FullContactName` colonna.</span><span class="sxs-lookup"><span data-stu-id="f7469-203">Updating the DataTable to include a corresponding `FullContactName` column.</span></span>

<span data-ttu-id="f7469-204">Avviare passando a Esplora Server e il drill-down nella cartella Stored procedure.</span><span class="sxs-lookup"><span data-stu-id="f7469-204">Start by navigating to the Server Explorer and drilling down into the Stored Procedures folder.</span></span> <span data-ttu-id="f7469-205">Aprire il `Suppliers_Select` stored procedure e aggiornamento di `SELECT` query per includere il `FullContactName` colonna calcolata:</span><span class="sxs-lookup"><span data-stu-id="f7469-205">Open the `Suppliers_Select` stored procedure and update the `SELECT` query to include the `FullContactName` computed column:</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample4.sql)]

<span data-ttu-id="f7469-206">Salvare le modifiche apportate alla stored procedure facendo clic sull'icona Salva nella barra degli strumenti, premendo Ctrl + S o scegliendo Salva `Suppliers_Select` opzione dal menu File.</span><span class="sxs-lookup"><span data-stu-id="f7469-206">Save the changes to the stored procedure by clicking the Save icon in the Toolbar, by hitting Ctrl+S, or by choosing the Save `Suppliers_Select` option from the File menu.</span></span>

<span data-ttu-id="f7469-207">Successivamente, tornare alla finestra di progettazione set di dati, fare clic su di `SuppliersTableAdapter`e scegliere Configura dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f7469-207">Next, return to the DataSet Designer, right-click on the `SuppliersTableAdapter`, and choose Configure from the context-menu.</span></span> <span data-ttu-id="f7469-208">Si noti che il `Suppliers_Select` colonna include ora il `FullContactName` nella propria raccolta di colonne di dati della colonna.</span><span class="sxs-lookup"><span data-stu-id="f7469-208">Note that the `Suppliers_Select` column now includes the `FullContactName` column in its Data Columns collection.</span></span>


<span data-ttu-id="f7469-209">[![Eseguire la configurazione guidata s TableAdapter per aggiornare le colonne s DataTable](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-209">[![Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns](working-with-computed-columns-cs/_static/image17.png)](working-with-computed-columns-cs/_static/image16.png)</span></span>

<span data-ttu-id="f7469-210">**Figura 6**: eseguire i TableAdapter configurazione guidata per aggiornare gli oggetti DataTable colonne ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-210">**Figure 6**: Run the TableAdapter s Configuration Wizard to Update the DataTable s Columns ([Click to view full-size image](working-with-computed-columns-cs/_static/image18.png))</span></span>


<span data-ttu-id="f7469-211">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="f7469-211">Click Finish to complete the wizard.</span></span> <span data-ttu-id="f7469-212">Verrà aggiunta automaticamente una colonna corrispondente per il `SuppliersDataTable`.</span><span class="sxs-lookup"><span data-stu-id="f7469-212">This will automatically add a corresponding column to the `SuppliersDataTable`.</span></span> <span data-ttu-id="f7469-213">La configurazione guidata TableAdapter è abbastanza per rilevare che il `FullContactName` colonna è una colonna calcolata e pertanto in sola lettura.</span><span class="sxs-lookup"><span data-stu-id="f7469-213">The TableAdapter wizard is smart enough to detect that the `FullContactName` column is a computed column and therefore read-only.</span></span> <span data-ttu-id="f7469-214">Di conseguenza, imposta la colonna s `ReadOnly` proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="f7469-214">Consequently, it sets the column s `ReadOnly` property to `true`.</span></span> <span data-ttu-id="f7469-215">Per verificare questa condizione, selezionare la colonna dal `SuppliersDataTable` e quindi passare alla finestra delle proprietà (vedere la figura 7).</span><span class="sxs-lookup"><span data-stu-id="f7469-215">To verify this, select the column from the `SuppliersDataTable` and then go to the Properties window (see Figure 7).</span></span> <span data-ttu-id="f7469-216">Si noti che il `FullContactName` colonna s `DataType` e `MaxLength` proprietà vengono inoltre impostate di conseguenza.</span><span class="sxs-lookup"><span data-stu-id="f7469-216">Note that the `FullContactName` column s `DataType` and `MaxLength` properties are also set accordingly.</span></span>


<span data-ttu-id="f7469-217">[![La colonna FullContactName è contrassegnata come sola lettura](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-217">[![The FullContactName Column is Marked as Read-Only](working-with-computed-columns-cs/_static/image20.png)](working-with-computed-columns-cs/_static/image19.png)</span></span>

<span data-ttu-id="f7469-218">**Figura 7**: il `FullContactName` colonna è contrassegnata come di sola lettura ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-218">**Figure 7**: The `FullContactName` Column is Marked as Read-Only ([Click to view full-size image](working-with-computed-columns-cs/_static/image21.png))</span></span>


## <a name="step-5-adding-agetsupplierbysupplieridmethod-to-the-tableadapter"></a><span data-ttu-id="f7469-219">Passaggio 5: Aggiunta di un`GetSupplierBySupplierID`metodo all'oggetto TableAdapter</span><span class="sxs-lookup"><span data-stu-id="f7469-219">Step 5: Adding a`GetSupplierBySupplierID`Method to the TableAdapter</span></span>

<span data-ttu-id="f7469-220">Per questa esercitazione si creerà una pagina ASP.NET che consente di visualizzare i fornitori in una griglia aggiornabile.</span><span class="sxs-lookup"><span data-stu-id="f7469-220">For this tutorial we will create an ASP.NET page that displays the suppliers in an updateable grid.</span></span> <span data-ttu-id="f7469-221">In oltre esercitazioni sono state aggiornate un singolo record di Business Logic Layer recuperando che un record specifico DAL come DataTable fortemente tipizzato, l'aggiornamento delle relative proprietà e quindi inviarlo DataTable aggiornato il postback al per propagare le modifiche il database.</span><span class="sxs-lookup"><span data-stu-id="f7469-221">In past tutorials we have updated a single record from the Business Logic Layer by retrieving that particular record from the DAL as a strongly-typed DataTable, updating its properties, and then sending the updated DataTable back to the DAL to propagate the changes to the database.</span></span> <span data-ttu-id="f7469-222">Per eseguire il primo passaggio, il recupero del record da aggiornare DAL - è necessario prima aggiungere un `GetSupplierBySupplierID(supplierID)` DAL metodo.</span><span class="sxs-lookup"><span data-stu-id="f7469-222">To accomplish this first step - retrieving the record being updated from the DAL - we need to first add a `GetSupplierBySupplierID(supplierID)` method to the DAL.</span></span>

<span data-ttu-id="f7469-223">Fare clic su di `SuppliersTableAdapter` nella struttura del set di dati e scegliere l'opzione Aggiungi Query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="f7469-223">Right-click on the `SuppliersTableAdapter` in the DataSet Design and choose the Add Query option from the context-menu.</span></span> <span data-ttu-id="f7469-224">Come è stato fatto nel passaggio 3, consentire alla procedura guidata genera una nuova stored procedure per noi selezionando l'opzione di creare nuove stored procedure (vedere la figura 3 per una schermata di questo passaggio della procedura guidata).</span><span class="sxs-lookup"><span data-stu-id="f7469-224">As we did in Step 3, let the wizard generate a new stored procedure for us by selecting the Create new stored procedure option (refer back to Figure 3 for a screenshot of this wizard step).</span></span> <span data-ttu-id="f7469-225">Poiché questo metodo restituirà un record con più colonne, indicano che si desidera utilizzare una query SQL che è un'istruzione SELECT che restituisce righe e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7469-225">Since this method will return a record with multiple columns, indicate that we want to use a SQL query that is a SELECT which returns rows and click Next.</span></span>


<span data-ttu-id="f7469-226">[![Scegliere l'istruzione SELECT che restituisce righe opzione](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-226">[![Choose the SELECT which returns rows Option](working-with-computed-columns-cs/_static/image23.png)](working-with-computed-columns-cs/_static/image22.png)</span></span>

<span data-ttu-id="f7469-227">**Figura 8**: scegliere l'istruzione SELECT che restituisce righe opzione ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-227">**Figure 8**: Choose the SELECT which returns rows Option ([Click to view full-size image](working-with-computed-columns-cs/_static/image24.png))</span></span>


<span data-ttu-id="f7469-228">Nel passaggio successivo richiesto us per la query da utilizzare per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f7469-228">The subsequent step prompts us for the query to use for this method.</span></span> <span data-ttu-id="f7469-229">Immettere le informazioni seguenti, che restituisce gli stessi campi di dati della query principale, ma per un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="f7469-229">Enter the following, which returns the same data fields as the main query but for a particular supplier.</span></span>


[!code-sql[Main](working-with-computed-columns-cs/samples/sample5.sql)]

<span data-ttu-id="f7469-230">Nella schermata successiva viene chiesto di specificare un nome di stored procedure che verrà generati automaticamente.</span><span class="sxs-lookup"><span data-stu-id="f7469-230">The next screen asks us to name the stored procedure that will be auto-generated.</span></span> <span data-ttu-id="f7469-231">Nome di questa stored procedure `Suppliers_SelectBySupplierID` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7469-231">Name this stored procedure `Suppliers_SelectBySupplierID` and click Next.</span></span>


<span data-ttu-id="f7469-232">[![Nome Suppliers_SelectBySupplierID la Stored Procedure](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-232">[![Name the Stored Procedure Suppliers_SelectBySupplierID](working-with-computed-columns-cs/_static/image26.png)](working-with-computed-columns-cs/_static/image25.png)</span></span>

<span data-ttu-id="f7469-233">**Figura 9**: nome della Stored Procedure `Suppliers_SelectBySupplierID` ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-233">**Figure 9**: Name the Stored Procedure `Suppliers_SelectBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image27.png))</span></span>


<span data-ttu-id="f7469-234">Infine, le richieste guidata us per i dati di accedere ai modelli e i nomi di metodo da utilizzare per l'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="f7469-234">Lastly, the wizard prompts us for the data access patterns and method names to use for the TableAdapter.</span></span> <span data-ttu-id="f7469-235">Lasciare le caselle di controllo sia selezionate, ma non rinominare il `FillBy` e `GetDataBy` metodi `FillBySupplierID` e `GetSupplierBySupplierID`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="f7469-235">Leave both checkboxes checked, but rename the `FillBy` and `GetDataBy` methods to `FillBySupplierID` and `GetSupplierBySupplierID`, respectively.</span></span>


<span data-ttu-id="f7469-236">[![Nome FillBySupplierID i metodi TableAdapter e GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-236">[![Name the TableAdapter Methods FillBySupplierID and GetSupplierBySupplierID](working-with-computed-columns-cs/_static/image29.png)](working-with-computed-columns-cs/_static/image28.png)</span></span>

<span data-ttu-id="f7469-237">**Figura 10**: nome i metodi TableAdapter `FillBySupplierID` e `GetSupplierBySupplierID` ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-237">**Figure 10**: Name the TableAdapter Methods `FillBySupplierID` and `GetSupplierBySupplierID` ([Click to view full-size image](working-with-computed-columns-cs/_static/image30.png))</span></span>


<span data-ttu-id="f7469-238">Fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="f7469-238">Click Finish to complete the wizard.</span></span>

## <a name="step-6-creating-the-business-logic-layer"></a><span data-ttu-id="f7469-239">Passaggio 6: La creazione del livello di logica di Business</span><span class="sxs-lookup"><span data-stu-id="f7469-239">Step 6: Creating the Business Logic Layer</span></span>

<span data-ttu-id="f7469-240">Prima di creare una pagina ASP.NET che usa la colonna calcolata creata nel passaggio 1, è innanzitutto necessario aggiungere i metodi corrispondenti nel BLL.</span><span class="sxs-lookup"><span data-stu-id="f7469-240">Before we create an ASP.NET page that uses the computed column created in Step 1, we first need to add the corresponding methods in the BLL.</span></span> <span data-ttu-id="f7469-241">La pagina ASP.NET, che verrà creata nel passaggio 7, consente agli utenti di visualizzare e modificare i fornitori.</span><span class="sxs-lookup"><span data-stu-id="f7469-241">Our ASP.NET page, which we will create in Step 7, will allow users to view and edit suppliers.</span></span> <span data-ttu-id="f7469-242">Pertanto, è necessario il livello Business LOGIC per fornire almeno un metodo per ottenere tutti i fornitori e un altro per l'aggiornamento di un particolare fornitore.</span><span class="sxs-lookup"><span data-stu-id="f7469-242">Therefore, we need our BLL to provide, at minimum, a method to get all of the suppliers and another to update a particular supplier.</span></span>

<span data-ttu-id="f7469-243">Creare un nuovo file di classe denominato `SuppliersBLLWithSprocs` nel `~/App_Code/BLL` cartella e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="f7469-243">Create a new class file named `SuppliersBLLWithSprocs` in the `~/App_Code/BLL` folder and add the following code:</span></span>


[!code-csharp[Main](working-with-computed-columns-cs/samples/sample6.cs)]

<span data-ttu-id="f7469-244">Come le altre classi BLL, `SuppliersBLLWithSprocs` ha un `protected` `Adapter` proprietà che restituisce un'istanza di `SuppliersTableAdapter` classe insieme a due `public` metodi: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="f7469-244">Like the other BLL classes, `SuppliersBLLWithSprocs` has a `protected` `Adapter` property that returns an instance of the `SuppliersTableAdapter` class along with two `public` methods: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="f7469-245">Il `GetSuppliers` metodo chiama e restituisce il `SuppliersDataTable` restituito dal corrispondente `GetSupplier` metodo nel livello di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="f7469-245">The `GetSuppliers` method calls and returns the `SuppliersDataTable` returned by the corresponding `GetSupplier` method in the Data Access Layer.</span></span> <span data-ttu-id="f7469-246">Il `UpdateSupplier` recupera le informazioni sull'aggiornamento tramite una chiamata a s DAL fornitore particolare `GetSupplierBySupplierID(supplierID)` metodo.</span><span class="sxs-lookup"><span data-stu-id="f7469-246">The `UpdateSupplier` method retrieves information about the particular supplier being updated via a call to the DAL s `GetSupplierBySupplierID(supplierID)` method.</span></span> <span data-ttu-id="f7469-247">Viene quindi aggiornato il `CategoryName`, `ContactName`, e `ContactTitle` proprietà ed esegue il commit di queste modifiche al database chiamando il livello di accesso ai dati di s `Update` metodo modificati passando `SuppliersRow` oggetto.</span><span class="sxs-lookup"><span data-stu-id="f7469-247">It then updates the `CategoryName`, `ContactName`, and `ContactTitle` properties and commits these changes to the database by calling the Data Access Layer s `Update` method, passing in the modified `SuppliersRow` object.</span></span>

> [!NOTE]
> <span data-ttu-id="f7469-248">Ad eccezione di `SupplierID` e `CompanyName`, consentono tutte le colonne nella tabella Suppliers `NULL` valori.</span><span class="sxs-lookup"><span data-stu-id="f7469-248">Except for `SupplierID` and `CompanyName`, all columns in the Suppliers table allow `NULL` values.</span></span> <span data-ttu-id="f7469-249">Pertanto, se passato `contactName` o `contactTitle` i parametri sono `null` è necessario impostare corrispondente `ContactName` e `ContactTitle` proprietà per un `NULL` database valore utilizzando il `SetContactNameNull` e `SetContactTitleNull`metodi, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="f7469-249">Therefore, if the passed-in `contactName` or `contactTitle` parameters are `null` we need to set the corresponding `ContactName` and `ContactTitle` properties to a `NULL` database value using the `SetContactNameNull` and `SetContactTitleNull` methods, respectively.</span></span>


## <a name="step-7-working-with-the-computed-column-from-the-presentation-layer"></a><span data-ttu-id="f7469-250">Passaggio 7: Utilizzo con la colonna calcolata dal livello di presentazione</span><span class="sxs-lookup"><span data-stu-id="f7469-250">Step 7: Working with the Computed Column from the Presentation Layer</span></span>

<span data-ttu-id="f7469-251">Con la colonna calcolata aggiunta a di `Suppliers` tabella e DAL e BLL aggiornati di conseguenza, è possibile compilare una pagina ASP.NET che funziona con il `FullContactName` colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-251">With the computed column added to the `Suppliers` table and the DAL and BLL updated accordingly, we are ready to build an ASP.NET page that works with the `FullContactName` computed column.</span></span> <span data-ttu-id="f7469-252">Aprire il `ComputedColumns.aspx` nella pagina di `AdvancedDAL` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="f7469-252">Start by opening the `ComputedColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="f7469-253">Impostare i dispositivi di GridView `ID` proprietà `Suppliers` e dal suo smart tag, associarlo a un nuovo oggetto ObjectDataSource denominato `SuppliersDataSource`.</span><span class="sxs-lookup"><span data-stu-id="f7469-253">Set the GridView s `ID` property to `Suppliers` and, from its smart tag, bind it to a new ObjectDataSource named `SuppliersDataSource`.</span></span> <span data-ttu-id="f7469-254">Configurare ObjectDataSource per utilizzare il `SuppliersBLLWithSprocs` classe è stato aggiunto il passaggio 6 e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="f7469-254">Configure the ObjectDataSource to use the `SuppliersBLLWithSprocs` class we added back in Step 6 and click Next.</span></span>


<span data-ttu-id="f7469-255">[![Configurare ObjectDataSource per utilizzare la classe SuppliersBLLWithSprocs](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-255">[![Configure the ObjectDataSource to Use the SuppliersBLLWithSprocs Class](working-with-computed-columns-cs/_static/image32.png)](working-with-computed-columns-cs/_static/image31.png)</span></span>

<span data-ttu-id="f7469-256">**Figura 11**: configurare ObjectDataSource per usare il `SuppliersBLLWithSprocs` classe ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-256">**Figure 11**: Configure the ObjectDataSource to Use the `SuppliersBLLWithSprocs` Class ([Click to view full-size image](working-with-computed-columns-cs/_static/image33.png))</span></span>


<span data-ttu-id="f7469-257">Sono disponibili solo due metodi definiti nel `SuppliersBLLWithSprocs` classe: `GetSuppliers` e `UpdateSupplier`.</span><span class="sxs-lookup"><span data-stu-id="f7469-257">There are only two methods defined in the `SuppliersBLLWithSprocs` class: `GetSuppliers` and `UpdateSupplier`.</span></span> <span data-ttu-id="f7469-258">Assicurarsi che questi due metodi sono specificati nella finestra selezione aggiornare schede, rispettivamente e fare clic su Fine per completare la configurazione di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f7469-258">Ensure that these two methods are specified in the SELECT and UPDATE tabs, respectively, and click Finish to complete the configuration of the ObjectDataSource.</span></span>

<span data-ttu-id="f7469-259">Dopo aver completato la configurazione guidata origine dati, Visual Studio aggiungerà un BoundField per ognuno dei campi di dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="f7469-259">Upon completion of the Data Source Configuration wizard, Visual Studio will add a BoundField for each of the data fields returned.</span></span> <span data-ttu-id="f7469-260">Rimuovere il `SupplierID` BoundField e modificare il `HeaderText` le proprietà del `CompanyName`, `ContactName`, `ContactTitle`, e `FullContactName` BoundField a società, Contact Name, titolo e nome completo di contatto, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="f7469-260">Remove the `SupplierID` BoundField and change the `HeaderText` properties of the `CompanyName`, `ContactName`, `ContactTitle`, and `FullContactName` BoundFields to Company, Contact Name, Title, and Full Contact Name, respectively.</span></span> <span data-ttu-id="f7469-261">Dalla smart tag, selezionare la casella di controllo Abilita modifica per attivare le funzionalità di modifica predefinite di GridView s.</span><span class="sxs-lookup"><span data-stu-id="f7469-261">From the smart tag, check the Enable Editing checkbox to turn on the GridView s built-in editing capabilities.</span></span>

<span data-ttu-id="f7469-262">Oltre ad aggiungere BoundField a GridView, completamento della creazione guidata origine dati comporta anche Visual Studio consente di impostare il s ObjectDataSource `OldValuesParameterFormatString` proprietà originale\_{0}.</span><span class="sxs-lookup"><span data-stu-id="f7469-262">In addition to adding BoundFields to the GridView, completion of the Data Source Wizard also causes Visual Studio to set the ObjectDataSource s `OldValuesParameterFormatString` property to original\_{0}.</span></span> <span data-ttu-id="f7469-263">Ripristinare questa impostazione il valore predefinito, {0}.</span><span class="sxs-lookup"><span data-stu-id="f7469-263">Revert this setting back to its default value, {0} .</span></span>

<span data-ttu-id="f7469-264">Dopo aver apportato queste modifiche a GridView e ObjectDataSource, il markup dichiarativo dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="f7469-264">After making these edits to the GridView and ObjectDataSource, their declarative markup should look similar to the following:</span></span>


[!code-aspx[Main](working-with-computed-columns-cs/samples/sample7.aspx)]

<span data-ttu-id="f7469-265">Successivamente, visitare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f7469-265">Next, visit this page through a browser.</span></span> <span data-ttu-id="f7469-266">Come mostrato nella figura 12, ogni fornitore è elencato in una griglia che include il `FullContactName` colonna, il cui valore è semplicemente la concatenazione delle altre tre colonne formattata come `ContactName` (`ContactTitle`, `CompanyName`).</span><span class="sxs-lookup"><span data-stu-id="f7469-266">As Figure 12 shows, each supplier is listed in a grid that includes the `FullContactName` column, whose value is simply the concatenation of the other three columns formatted as `ContactName` (`ContactTitle`, `CompanyName`) .</span></span>


<span data-ttu-id="f7469-267">[![Ogni fornitore è elencato nella griglia](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-267">[![Each Supplier is Listed in the Grid](working-with-computed-columns-cs/_static/image35.png)](working-with-computed-columns-cs/_static/image34.png)</span></span>

<span data-ttu-id="f7469-268">**Figura 12**: ogni fornitore è elencato nella griglia ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image36.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-268">**Figure 12**: Each Supplier is Listed in the Grid ([Click to view full-size image](working-with-computed-columns-cs/_static/image36.png))</span></span>


<span data-ttu-id="f7469-269">Fare clic sul pulsante Modifica per un particolare fornitore provoca un postback e che la riga è stato eseguito nel relativo tipo di modifica dell'interfaccia (vedere Figura 13).</span><span class="sxs-lookup"><span data-stu-id="f7469-269">Clicking the Edit button for a particular supplier causes a postback and has that row rendered in its editing interface (see Figure 13).</span></span> <span data-ttu-id="f7469-270">Le prime tre colonne di cui è stato eseguito il rendering in base all'impostazione predefinita la modifica di interfaccia: controllo di una casella di testo la cui `Text` proprietà è impostata sul valore del campo dati.</span><span class="sxs-lookup"><span data-stu-id="f7469-270">The first three columns render in their default editing interface - a TextBox control whose `Text` property is set to the value of the data field.</span></span> <span data-ttu-id="f7469-271">Il `FullContactName` colonna, tuttavia, rimane come testo.</span><span class="sxs-lookup"><span data-stu-id="f7469-271">The `FullContactName` column, however, remains as text.</span></span> <span data-ttu-id="f7469-272">Quando il BoundField sono stati aggiunti al controllo GridView. dopo aver completato la configurazione guidata origine dati, il `FullContactName` BoundField s `ReadOnly` è stata impostata su `true` perché corrispondente `FullContactName` colonna il `SuppliersDataTable` è il relativo `ReadOnly` proprietà impostata su `true`.</span><span class="sxs-lookup"><span data-stu-id="f7469-272">When the BoundFields were added to the GridView at the completion of the Data Source Configuration wizard, the `FullContactName` BoundField s `ReadOnly` property was set to `true` because the corresponding `FullContactName` column in the `SuppliersDataTable` has its `ReadOnly` property set to `true`.</span></span> <span data-ttu-id="f7469-273">Come indicato nel passaggio 4, il `FullContactName` s `ReadOnly` è stata impostata su `true` perché TableAdapter rilevato che la colonna è una colonna calcolata.</span><span class="sxs-lookup"><span data-stu-id="f7469-273">As noted in Step 4, the `FullContactName` s `ReadOnly` property was set to `true` because the TableAdapter detected that the column was a computed column.</span></span>


<span data-ttu-id="f7469-274">[![La colonna FullContactName non è modificabile](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span><span class="sxs-lookup"><span data-stu-id="f7469-274">[![The FullContactName Column is Not Editable](working-with-computed-columns-cs/_static/image38.png)](working-with-computed-columns-cs/_static/image37.png)</span></span>

<span data-ttu-id="f7469-275">**Figura 13**: il `FullContactName` colonna non è modificabile ([fare clic per visualizzare l'immagine ingrandita](working-with-computed-columns-cs/_static/image39.png))</span><span class="sxs-lookup"><span data-stu-id="f7469-275">**Figure 13**: The `FullContactName` Column is Not Editable ([Click to view full-size image](working-with-computed-columns-cs/_static/image39.png))</span></span>


<span data-ttu-id="f7469-276">Vado avanti e aggiornare il valore di uno o più colonne modificabili e fare clic su Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="f7469-276">Go ahead and update the value of one or more of the editable columns and click Update.</span></span> <span data-ttu-id="f7469-277">Si noti come `FullContactName` s valore viene aggiornato automaticamente per riflettere la modifica.</span><span class="sxs-lookup"><span data-stu-id="f7469-277">Note how the `FullContactName` s value is automatically updated to reflect the change.</span></span>

> [!NOTE]
> <span data-ttu-id="f7469-278">GridView utilizza attualmente BoundField per i campi modificabili, pertanto il valore predefinito di interfaccia di modifica.</span><span class="sxs-lookup"><span data-stu-id="f7469-278">The GridView currently uses BoundFields for the editable fields, resulting in the default editing interface.</span></span> <span data-ttu-id="f7469-279">Poiché il `CompanyName` campo è obbligatorio, deve essere convertito in un TemplateField che include un RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="f7469-279">Since the `CompanyName` field is required, it should be converted into a TemplateField that includes a RequiredFieldValidator.</span></span> <span data-ttu-id="f7469-280">Lasciare questo campo come esercizio per il lettore di interesse.</span><span class="sxs-lookup"><span data-stu-id="f7469-280">I leave this as an exercise for the interested reader.</span></span> <span data-ttu-id="f7469-281">Consultare la [aggiunta di controlli di convalida per la modifica e inserimento di interfacce](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) esercitazione per istruzioni dettagliate sulla conversione di un BoundField in un TemplateField e aggiunta di controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="f7469-281">Consult the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-cs.md) tutorial for step-by-step instructions on converting a BoundField to a TemplateField and adding validation controls.</span></span>


## <a name="summary"></a><span data-ttu-id="f7469-282">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="f7469-282">Summary</span></span>

<span data-ttu-id="f7469-283">Quando si definisce lo schema per una tabella, Microsoft SQL Server consente l'inclusione di colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-283">When defining the schema for a table, Microsoft SQL Server allows the inclusion of computed columns.</span></span> <span data-ttu-id="f7469-284">Si tratta di colonne i cui valori sono calcolati da un'espressione che in genere fa riferimento ai valori di altre colonne dello stesso record.</span><span class="sxs-lookup"><span data-stu-id="f7469-284">These are columns whose values are calculated from an expression that usually references the values from other columns in the same record.</span></span> <span data-ttu-id="f7469-285">Poiché i valori per le colonne calcolate sono basate su un'espressione, sono di sola lettura e non può essere assegnati un valore in un `INSERT` o `UPDATE` istruzione.</span><span class="sxs-lookup"><span data-stu-id="f7469-285">Since the values for computed columns are based on an expression, they are read-only and cannot be assigned a value in an `INSERT` or `UPDATE` statement.</span></span> <span data-ttu-id="f7469-286">Ciò implica problemi quando si utilizza una colonna calcolata nella query principale di un oggetto TableAdapter che tenta di generare automaticamente corrispondente `INSERT`, `UPDATE`, e `DELETE` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="f7469-286">This introduces challenges when using a computed column in the main query of a TableAdapter that tries to automatically generate corresponding `INSERT`, `UPDATE`, and `DELETE` statements.</span></span>

<span data-ttu-id="f7469-287">In questa esercitazione sono descritte le tecniche per aggirare i problemi derivanti dalle colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-287">In this tutorial we discussed techniques for circumventing the challenges posed by computed columns.</span></span> <span data-ttu-id="f7469-288">In particolare, le stored procedure viene usata nel nostro TableAdapter per superare il TableAdapter che Usa istruzioni SQL ad hoc inerenti la vulnerabilità.</span><span class="sxs-lookup"><span data-stu-id="f7469-288">In particular, we used stored procedures in our TableAdapter to overcome the brittleness inherent in TableAdapters that use ad-hoc SQL statements.</span></span> <span data-ttu-id="f7469-289">Per avere la configurazione guidata TableAdapter che crea nuove stored procedure, è importante che abbiamo la query principale inizialmente omettere le colonne calcolate perché la loro presenza impedisce la generazione le procedure di modifica archiviata dati.</span><span class="sxs-lookup"><span data-stu-id="f7469-289">When having the TableAdapter wizard create new stored procedures, it is important that we have the main query initially omit any computed columns because their presence prevents the data modification stored procedures from being generated.</span></span> <span data-ttu-id="f7469-290">Dopo aver configurato inizialmente TableAdapter, il relativo `SelectCommand` stored procedure può essere retooled per includere le colonne calcolate.</span><span class="sxs-lookup"><span data-stu-id="f7469-290">After the TableAdapter has been initially configured, its `SelectCommand` stored procedure can be retooled to include any computed columns.</span></span>

<span data-ttu-id="f7469-291">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="f7469-291">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="f7469-292">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="f7469-292">About the Author</span></span>

<span data-ttu-id="f7469-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="f7469-293">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f7469-294">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="f7469-294">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f7469-295">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="f7469-295">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="f7469-296">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="f7469-296">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="f7469-297">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="f7469-297">Special Thanks To</span></span>

<span data-ttu-id="f7469-298">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="f7469-298">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f7469-299">Lead revisori per questa esercitazione sono stati Geisenow Hilton e Teresa Murphy.</span><span class="sxs-lookup"><span data-stu-id="f7469-299">Lead reviewers for this tutorial were Hilton Geisenow and Teresa Murphy.</span></span> <span data-ttu-id="f7469-300">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="f7469-300">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f7469-301">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="f7469-301">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f7469-302">[Precedente](adding-additional-datatable-columns-cs.md)
> [Successivo](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span><span class="sxs-lookup"><span data-stu-id="f7469-302">[Previous](adding-additional-datatable-columns-cs.md)
[Next](configuring-the-data-access-layer-s-connection-and-command-level-settings-cs.md)</span></span>

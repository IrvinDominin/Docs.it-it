---
uid: web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
title: Aggiunta di colonne aggiuntive DataTable (VB) | Documenti Microsoft
author: rick-anderson
description: Quando si utilizza la configurazione guidata TableAdapter per creare un DataSet tipizzato, DataTable corrispondente contiene le colonne restituite dalla query sul database principale. Ma non esiste...
ms.author: aspnetcontent
manager: wpickett
ms.date: 07/18/2007
ms.topic: article
ms.assetid: 1e8e65f9-fe3e-4250-810b-c90227786bed
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/advanced-data-access-scenarios/adding-additional-datatable-columns-vb
msc.type: authoredcontent
ms.openlocfilehash: b51089057ad1e14901cb09589534d6e575261c3e
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="adding-additional-datatable-columns-vb"></a><span data-ttu-id="2a3fa-104">Aggiunta di colonne aggiuntive DataTable (VB)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-104">Adding Additional DataTable Columns (VB)</span></span>
====================
<span data-ttu-id="2a3fa-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="2a3fa-106">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) o [Scarica il PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_70_VB.zip) or [Download PDF](adding-additional-datatable-columns-vb/_static/datatutorial70vb1.pdf)</span></span>

> <span data-ttu-id="2a3fa-107">Quando si utilizza la configurazione guidata TableAdapter per creare un DataSet tipizzato, DataTable corrispondente contiene le colonne restituite dalla query sul database principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-107">When using the TableAdapter Wizard to create a Typed DataSet, the corresponding DataTable contains the columns returned by the main database query.</span></span> <span data-ttu-id="2a3fa-108">Ma esistono casi quando DataTable deve includere colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-108">But there are occasions when the DataTable needs to include additional columns.</span></span> <span data-ttu-id="2a3fa-109">In questa esercitazione viene illustrato perché le stored procedure sono consigliate quando abbiamo bisogno di altre colonne DataTable.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-109">In this tutorial we learn why stored procedures are recommended when we need additional DataTable columns.</span></span>


## <a name="introduction"></a><span data-ttu-id="2a3fa-110">Introduzione</span><span class="sxs-lookup"><span data-stu-id="2a3fa-110">Introduction</span></span>

<span data-ttu-id="2a3fa-111">Quando si aggiunge un oggetto TableAdapter a un DataSet tipizzato, lo schema s DataTable corrispondente è determinato dalla query principale s TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-111">When adding a TableAdapter to a Typed DataSet, the corresponding DataTable s schema is determined by the TableAdapter s main query.</span></span> <span data-ttu-id="2a3fa-112">Ad esempio, se la query principale restituisce i campi dati *A*, *B*, e *C*, DataTable disporrà di tre colonne corrispondente denominate *A*, *B*, e *C*. Oltre alle query principale, un oggetto TableAdapter può includere ulteriori query che restituiscono, ad esempio, un subset dei dati in base a un parametro.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-112">For example, if the main query returns data fields *A*, *B*, and *C*, the DataTable will have three corresponding columns named *A*, *B*, and *C*. In addition to its main query, a TableAdapter can include additional queries that return, perhaps, a subset of the data based on some parameter.</span></span> <span data-ttu-id="2a3fa-113">Ad esempio, oltre al `ProductsTableAdapter` query principale s, che restituisce informazioni su tutti i prodotti, contiene anche metodi, ad esempio `GetProductsByCategoryID(categoryID)` e `GetProductByProductID(productID)`, che restituisce informazioni di prodotto specifico in base a un parametro specificato.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-113">For instance, in addition to the `ProductsTableAdapter` s main query, which returns information about all products, it also contains methods like `GetProductsByCategoryID(categoryID)` and `GetProductByProductID(productID)`, which return specific product information based on a supplied parameter.</span></span>

<span data-ttu-id="2a3fa-114">Il modello che lo schema di DataTable s corrisponde alla query principale di TableAdapter s funziona anche se tutti i metodi TableAdapter s restituiscono lo stesso o campi di dati inferiore rispetto a quelle specificate nella query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-114">The model of having the DataTable s schema reflect the TableAdapter s main query works well if all of the TableAdapter s methods return the same or fewer data fields than those specified in the main query.</span></span> <span data-ttu-id="2a3fa-115">Se un metodo di TableAdapter deve restituire i campi dati aggiuntivi, è necessario espandere lo schema di DataTable s conseguenza.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-115">If a TableAdapter method needs to return additional data fields, then we should expand the DataTable s schema accordingly.</span></span> <span data-ttu-id="2a3fa-116">Nel [Master/dettaglio mediante un elenco puntato dei record Master con un controllo DataList dettagli](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) esercitazione è stato aggiunto un metodo per il `CategoriesTableAdapter` che ha restituito il `CategoryID`, `CategoryName`, e `Description` i campi dati definiti la query principale più `NumberOfProducts`, un campo di dati aggiuntivi che ha segnalato il numero di prodotti associati a ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-116">In the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that returned the `CategoryID`, `CategoryName`, and `Description` data fields defined in the main query plus `NumberOfProducts`, an additional data field that reported the number of products associated with each category.</span></span> <span data-ttu-id="2a3fa-117">Abbiamo aggiunto manualmente una nuova colonna per il `CategoriesDataTable` per acquisire il `NumberOfProducts` campo dati valore di questo nuovo metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-117">We manually added a new column to the `CategoriesDataTable` in order to capture the `NumberOfProducts` data field value from this new method.</span></span>

<span data-ttu-id="2a3fa-118">Come descritto nel [caricamento di file](../working-with-binary-files/uploading-files-vb.md) tutorial, grande attenzione degli oggetti TableAdapter Usa istruzioni SQL ad hoc che dispongono di metodi i cui campi dati non corrispondono esattamente la query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-118">As discussed in the [Uploading Files](../working-with-binary-files/uploading-files-vb.md) tutorial, great care must be taken with TableAdapters that use ad-hoc SQL statements and have methods whose data fields do not precisely match the main query.</span></span> <span data-ttu-id="2a3fa-119">Se la configurazione guidata TableAdapter viene rieseguita, verranno aggiornati tutti i metodi TableAdapter s in modo che i relativi elenco di campi di dati corrisponde alla query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-119">If the TableAdapter Configuration wizard is re-run, it will update all of the TableAdapter s methods so that their data field list matches the main query.</span></span> <span data-ttu-id="2a3fa-120">Di conseguenza, tutti i metodi con elenchi di colonne personalizzato verranno tornare all'elenco delle colonne della query principale s e non restituisce i dati previsti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-120">Consequently, any methods with customized column lists will revert to the main query s column list and not return the expected data.</span></span> <span data-ttu-id="2a3fa-121">Questo problema non si verifica quando si utilizzano stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-121">This issue does not arise when using stored procedures.</span></span>

<span data-ttu-id="2a3fa-122">In questa esercitazione verranno esaminati come estendere lo schema di s una DataTable per includere colonne aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-122">In this tutorial we will look at how to extend a DataTable s schema to include additional columns.</span></span> <span data-ttu-id="2a3fa-123">A causa della vulnerabilità del TableAdapter quando si Usa istruzioni SQL ad hoc, in questa esercitazione si utilizzerà le stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-123">Due to the brittleness of the TableAdapter when using ad-hoc SQL statements, in this tutorial we will use stored procedures.</span></span> <span data-ttu-id="2a3fa-124">Fare riferimento al [la creazione di nuove Stored procedure per gli oggetti TableAdapter s DataSet tipizzato](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) e [utilizzando Stored procedure esistenti per gli oggetti TableAdapter s DataSet tipizzato](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) esercitazioni per ulteriori informazioni su configurazione di un oggetto TableAdapter per l'utilizzo di stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-124">Refer to the [Creating New Stored Procedures for the Typed DataSet s TableAdapters](creating-new-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) and [Using Existing Stored Procedures for the Typed DataSet s TableAdapters](using-existing-stored-procedures-for-the-typed-dataset-s-tableadapters-vb.md) tutorials for more information on configuring a TableAdapter to use stored procedures.</span></span>

## <a name="step-1-adding-apricequartilecolumn-to-theproductsdatatable"></a><span data-ttu-id="2a3fa-125">Passaggio 1: Aggiunta di un`PriceQuartile`colonna per il`ProductsDataTable`</span><span class="sxs-lookup"><span data-stu-id="2a3fa-125">Step 1: Adding a`PriceQuartile`Column to the`ProductsDataTable`</span></span>

<span data-ttu-id="2a3fa-126">Nel *la creazione di nuove Stored procedure per gli oggetti TableAdapter s DataSet tipizzato* esercitazione è stato creato un set di dati tipizzato denominato `NorthwindWithSprocs`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-126">In the *Creating New Stored Procedures for the Typed DataSet s TableAdapters* tutorial we created a Typed DataSet named `NorthwindWithSprocs`.</span></span> <span data-ttu-id="2a3fa-127">Attualmente, questo set di dati contiene due DataTable: `ProductsDataTable` e `EmployeesDataTable`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-127">This DataSet currently contains two DataTables: `ProductsDataTable` and `EmployeesDataTable`.</span></span> <span data-ttu-id="2a3fa-128">Il `ProductsTableAdapter` ha tre metodi seguenti:</span><span class="sxs-lookup"><span data-stu-id="2a3fa-128">The `ProductsTableAdapter` has the following three methods:</span></span>

- <span data-ttu-id="2a3fa-129">`GetProducts` -la query principale, che restituisce tutti i record di `Products` tabella</span><span class="sxs-lookup"><span data-stu-id="2a3fa-129">`GetProducts` - the main query, which returns all records from the `Products` table</span></span>
- <span data-ttu-id="2a3fa-130">`GetProductsByCategoryID(categoryID)` -Restituisce tutti i prodotti con l'oggetto specificato *categoryID*.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-130">`GetProductsByCategoryID(categoryID)` - returns all products with the specified *categoryID*.</span></span>
- <span data-ttu-id="2a3fa-131">`GetProductByProductID(productID)` -Restituisce il prodotto specifico con l'oggetto specificato *productID*.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-131">`GetProductByProductID(productID)` - returns the particular product with the specified *productID*.</span></span>

<span data-ttu-id="2a3fa-132">La query principale e altri due metodi restituiscono lo stesso set di campi di dati, vale a dire tutte le colonne dal `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-132">The main query and the two additional methods all return the same set of data fields, namely all of the columns from the `Products` table.</span></span> <span data-ttu-id="2a3fa-133">Sono non disponibili le sottoquery correlate o `JOIN` s recupera i dati correlati di `Categories` o `Suppliers` tabelle.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-133">There are no correlated subqueries or `JOIN` s pulling related data from the `Categories` or `Suppliers` tables.</span></span> <span data-ttu-id="2a3fa-134">Pertanto, il `ProductsDataTable` include una colonna corrispondente per ciascun campo il `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-134">Therefore, the `ProductsDataTable` has a corresponding column for each field in the `Products` table.</span></span>

<span data-ttu-id="2a3fa-135">Per questa esercitazione, s consentono di aggiungere un metodo per il `ProductsTableAdapter` denominato `GetProductsWithPriceQuartile` che restituisce tutti i prodotti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-135">For this tutorial, let s add a method to the `ProductsTableAdapter` named `GetProductsWithPriceQuartile` that returns all of the products.</span></span> <span data-ttu-id="2a3fa-136">Oltre ai campi dati del prodotto standard, `GetProductsWithPriceQuartile` includerà anche un `PriceQuartile` campo dei dati che indica in quale quartile rientra il prezzo del prodotto s.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-136">In addition to the standard product data fields, `GetProductsWithPriceQuartile` will also include a `PriceQuartile` data field that indicates under which quartile the product s price falls.</span></span> <span data-ttu-id="2a3fa-137">Ad esempio, include i prodotti il cui prezzo presenti il maggior numero di risorse % 25 un `PriceQuartile` valore pari a 1, mentre quelli il cui prezzo è compreso nella parte inferiore 25% avrà un valore pari a 4.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-137">For example, those products whose prices are in the most expensive 25% will have a `PriceQuartile` value of 1, while those whose prices fall in the bottom 25% will have a value of 4.</span></span> <span data-ttu-id="2a3fa-138">Prima di preoccupazione creazione della stored procedure per restituire queste informazioni, tuttavia, è necessario aggiornare il `ProductsDataTable` per includere una colonna per contenere il `PriceQuartile` risultati quando la `GetProductsWithPriceQuartile` viene usato il metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-138">Before we worry about creating the stored procedure to return this information, however, we first need to update the `ProductsDataTable` to include a column to hold the `PriceQuartile` results when the `GetProductsWithPriceQuartile` method is used.</span></span>

<span data-ttu-id="2a3fa-139">Aprire il `NorthwindWithSprocs` set di dati e fare clic su di `ProductsDataTable`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-139">Open the `NorthwindWithSprocs` DataSet and right-click on the `ProductsDataTable`.</span></span> <span data-ttu-id="2a3fa-140">Scegliere Aggiungi dal menu di scelta rapida e scegliere la colonna.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-140">Choose Add from the context-menu and then pick Column.</span></span>


<span data-ttu-id="2a3fa-141">[![Aggiungere una nuova colonna per il ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-141">[![Add a New Column to the ProductsDataTable](adding-additional-datatable-columns-vb/_static/image2.png)](adding-additional-datatable-columns-vb/_static/image1.png)</span></span>

<span data-ttu-id="2a3fa-142">**Figura 1**: aggiungere una nuova colonna per il `ProductsDataTable` ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-142">**Figure 1**: Add a New Column to the `ProductsDataTable` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image3.png))</span></span>


<span data-ttu-id="2a3fa-143">Verrà aggiunta una nuova colonna alla tabella di dati denominato Column1 di tipo `System.String`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-143">This will add a new column to the DataTable named Column1 of type `System.String`.</span></span> <span data-ttu-id="2a3fa-144">È necessario aggiornare il nome della colonna s PriceQuartile e il relativo tipo di `System.Int32` dal momento che verrà utilizzato per contenere un numero compreso tra 1 e 4.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-144">We need to update this column s name to PriceQuartile and its type to `System.Int32` since it will be used to hold a number between 1 and 4.</span></span> <span data-ttu-id="2a3fa-145">Selezionare la colonna appena aggiunta il `ProductsDataTable` e, dalla finestra delle proprietà, impostare il `Name` proprietà PriceQuartile e `DataType` proprietà `System.Int32`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-145">Select the newly-added column in the `ProductsDataTable` and, from the Properties window, set the `Name` property to PriceQuartile and the `DataType` property to `System.Int32`.</span></span>


<span data-ttu-id="2a3fa-146">[![Impostare le proprietà di tipo di dati e il nome della nuova colonna s](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-146">[![Set the New Column s Name and DataType Properties](adding-additional-datatable-columns-vb/_static/image5.png)](adding-additional-datatable-columns-vb/_static/image4.png)</span></span>

<span data-ttu-id="2a3fa-147">**Figura 2**: impostare la nuova colonna s `Name` e `DataType` delle proprietà ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-147">**Figure 2**: Set the New Column s `Name` and `DataType` Properties ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image6.png))</span></span>


<span data-ttu-id="2a3fa-148">Come illustrato nella figura 2, sono disponibili proprietà aggiuntive che è possibile impostare, ad esempio se i valori nella colonna devono essere univoci, se la colonna è una colonna a incremento automatico, o meno database `NULL` sono consentiti valori e così via.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-148">As Figure 2 shows, there are additional properties that can be set, such as whether the values in the column must be unique, if the column is an auto-increment column, whether or not database `NULL` values are allowed, and so on.</span></span> <span data-ttu-id="2a3fa-149">Lasciare i valori impostati sui valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-149">Leave these values set to their defaults.</span></span>

## <a name="step-2-creating-thegetproductswithpricequartilemethod"></a><span data-ttu-id="2a3fa-150">Passaggio 2: Creazione di`GetProductsWithPriceQuartile`(metodo)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-150">Step 2: Creating the`GetProductsWithPriceQuartile`Method</span></span>

<span data-ttu-id="2a3fa-151">Ora che il `ProductsDataTable` è stato aggiornato per includere il `PriceQuartile` colonna, si è pronti a creare il `GetProductsWithPriceQuartile` metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-151">Now that the `ProductsDataTable` has been updated to include the `PriceQuartile` column, we are ready to create the `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="2a3fa-152">Avviare facendo clic sul TableAdapter e scegliendo Aggiungi Query dal menu di scelta rapida.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-152">Start by right-clicking on the TableAdapter and choosing Add Query from the context-menu.</span></span> <span data-ttu-id="2a3fa-153">Verrà visualizzata la configurazione guidata Query TableAdapter, che richiede ci come se si desidera utilizzare istruzioni SQL ad hoc o una stored procedure nuova o esistente.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-153">This brings up the TableAdapter Query Configuration wizard, which first prompts us as to whether we want to use ad-hoc SQL statements or a new or existing stored procedure.</span></span> <span data-ttu-id="2a3fa-154">Poiché è non è stata ridimensionata ancora di una stored procedure che restituisce i dati di quartile prezzo, permettere s consentire TableAdapter creare questa stored procedure per noi.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-154">Since we don t yet have a stored procedure that returns the price quartile data, let s allow the TableAdapter to create this stored procedure for us.</span></span> <span data-ttu-id="2a3fa-155">Selezionare l'opzione di creare nuove stored procedure e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-155">Select the Create new stored procedure option and click Next.</span></span>


<span data-ttu-id="2a3fa-156">[![Indicare la configurazione guidata TableAdapter per creare la Stored Procedure per ci](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-156">[![Instruct the TableAdapter Wizard to Create the Stored Procedure For Us](adding-additional-datatable-columns-vb/_static/image8.png)](adding-additional-datatable-columns-vb/_static/image7.png)</span></span>

<span data-ttu-id="2a3fa-157">**Figura 3**: indicare la configurazione guidata TableAdapter per creare la Stored Procedure per Stati Uniti ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-157">**Figure 3**: Instruct the TableAdapter Wizard to Create the Stored Procedure For Us ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image9.png))</span></span>


<span data-ttu-id="2a3fa-158">Nella schermata successiva, illustrata nella figura 4, la procedura guidata viene chiesto di specificare il tipo di query da aggiungere.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-158">In the subsequent screen, shown in Figure 4, the wizard asks us what type of query to add.</span></span> <span data-ttu-id="2a3fa-159">Poiché il `GetProductsWithPriceQuartile` metodo restituirà tutte le colonne e i record di `Products` tabella, selezionare l'istruzione SELECT che restituisce righe opzione e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-159">Since the `GetProductsWithPriceQuartile` method will return all columns and records from the `Products` table, select the SELECT which returns rows option and click Next.</span></span>


<span data-ttu-id="2a3fa-160">[![La Query sarà un'istruzione SELECT che restituisce più righe](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-160">[![Our Query will be a SELECT Statement that Returns Multiple Rows](adding-additional-datatable-columns-vb/_static/image11.png)](adding-additional-datatable-columns-vb/_static/image10.png)</span></span>

<span data-ttu-id="2a3fa-161">**Figura 4**: la nostra Query sarà un `SELECT` istruzione che restituisce più righe ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-161">**Figure 4**: Our Query will be a `SELECT` Statement that Returns Multiple Rows ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image12.png))</span></span>


<span data-ttu-id="2a3fa-162">Successivamente vengono richieste per il `SELECT` query.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-162">Next we are prompted for the `SELECT` query.</span></span> <span data-ttu-id="2a3fa-163">Nella procedura guidata, immettere la query seguente:</span><span class="sxs-lookup"><span data-stu-id="2a3fa-163">Enter the following query into the wizard:</span></span>


[!code-sql[Main](adding-additional-datatable-columns-vb/samples/sample1.sql)]

<span data-ttu-id="2a3fa-164">La query precedente utilizza SQL Server 2005 s nuovo [ `NTILE` funzione](https://msdn.microsoft.com/library/ms175126.aspx) per dividere i risultati in quattro gruppi in cui i gruppi sono determinati dal `UnitPrice` valori ordinati in ordine decrescente.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-164">The above query uses SQL Server 2005 s new [`NTILE` function](https://msdn.microsoft.com/library/ms175126.aspx) to divide the results into four groups where the groups are determined by the `UnitPrice` values sorted in descending order.</span></span>

<span data-ttu-id="2a3fa-165">Sfortunatamente, il generatore di Query non è in grado di analizzare il `OVER` (parola chiave) e verrà visualizzato un errore durante l'analisi di query sopra indicata.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-165">Unfortunately, the Query Builder does not know how to parse the `OVER` keyword and will display an error when parsing the above query.</span></span> <span data-ttu-id="2a3fa-166">Pertanto, è possibile immettere la query sopra indicata direttamente nella casella di testo della procedura guidata senza utilizzare il generatore delle Query.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-166">Therefore, enter the above query directly in the textbox in the wizard without using the Query Builder.</span></span>

> [!NOTE]
> <span data-ttu-id="2a3fa-167">Per ulteriori informazioni su NTILE e SQL Server 2005 s altre funzioni di rango, vedere [restituzione di risultati classificati con Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) e [sezione funzioni di rango](https://msdn.microsoft.com/library/ms189798.aspx) dal [SQL Documentazione Online di Server 2005](https://msdn.microsoft.com/library/ms189798.aspx).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-167">For more information on NTILE and SQL Server 2005 s other ranking functions, see [Returning Ranked Results with Microsoft SQL Server 2005](http://www.4guysfromrolla.com/webtech/010406-1.shtml) and the [Ranking Functions section](https://msdn.microsoft.com/library/ms189798.aspx) from the [SQL Server 2005 Books Online](https://msdn.microsoft.com/library/ms189798.aspx).</span></span>


<span data-ttu-id="2a3fa-168">Dopo aver immesso il `SELECT` query e fare clic su Avanti, la procedura guidata chiede di specificare un nome per la stored procedure verrà creato.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-168">After entering the `SELECT` query and clicking Next, the wizard asks us to provide a name for the stored procedure it will create.</span></span> <span data-ttu-id="2a3fa-169">Denominare la nuova stored procedure `Products_SelectWithPriceQuartile` e fare clic su Avanti.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-169">Name the new stored procedure `Products_SelectWithPriceQuartile` and click Next.</span></span>


<span data-ttu-id="2a3fa-170">[![Nome Products_SelectWithPriceQuartile la Stored Procedure](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-170">[![Name the Stored Procedure Products_SelectWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image14.png)](adding-additional-datatable-columns-vb/_static/image13.png)</span></span>

<span data-ttu-id="2a3fa-171">**Figura 5**: nome della Stored Procedure `Products_SelectWithPriceQuartile` ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-171">**Figure 5**: Name the Stored Procedure `Products_SelectWithPriceQuartile` ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image15.png))</span></span>


<span data-ttu-id="2a3fa-172">Infine, vengono richieste per denominare metodi dell'oggetto TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-172">Lastly, we are prompted to name the TableAdapter methods.</span></span> <span data-ttu-id="2a3fa-173">Lasciare entrambi il riempimento di un oggetto DataTable e restituire un DataTable caselle di controllo selezionata e il nome dei metodi `FillWithPriceQuartile` e `GetProductsWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-173">Leave both the Fill a DataTable and Return a DataTable checkboxes checked and name the methods `FillWithPriceQuartile` and `GetProductsWithPriceQuartile`.</span></span>


<span data-ttu-id="2a3fa-174">[![Metodi di nomi ai TableAdapter e fare clic su Fine](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-174">[![Name the TableAdapter s Methods and Click Finish](adding-additional-datatable-columns-vb/_static/image17.png)](adding-additional-datatable-columns-vb/_static/image16.png)</span></span>

<span data-ttu-id="2a3fa-175">**Figura 6**: nomi dei metodi s TableAdapter e fare clic su Fine ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-175">**Figure 6**: Name the TableAdapter s Methods and Click Finish ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image18.png))</span></span>


<span data-ttu-id="2a3fa-176">Con il `SELECT` query specificata e la stored procedure e i metodi TableAdapter denominati, fare clic su Fine per completare la procedura guidata.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-176">With the `SELECT` query specified and the stored procedure and TableAdapter methods named, click Finish to complete the wizard.</span></span> <span data-ttu-id="2a3fa-177">A questo punto è possibile che venga visualizzato un avviso o due dalla procedura guidata che informa che il `OVER` costrutto SQL o istruzione non è supportata.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-177">At this point you may get a warning or two from the wizard saying that The `OVER` SQL construct or statement is not supported.</span></span> <span data-ttu-id="2a3fa-178">È possono ignorare questi avvisi.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-178">These warnings can be ignored.</span></span>

<span data-ttu-id="2a3fa-179">Dopo aver completato la procedura guidata, è necessario includere il TableAdapter di `FillWithPriceQuartile` e `GetProductsWithPriceQuartile` metodi e il database deve includere una stored procedure denominata `Products_SelectWithPriceQuartile`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-179">After completing the wizard, the TableAdapter should include the `FillWithPriceQuartile` and `GetProductsWithPriceQuartile` methods and the database should include a stored procedure named `Products_SelectWithPriceQuartile`.</span></span> <span data-ttu-id="2a3fa-180">È opportuno verificare che l'oggetto TableAdapter effettivamente contenga questo nuovo metodo e che la stored procedure sia stato aggiunto correttamente al database.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-180">Take a moment to verify that the TableAdapter does indeed contain this new method and that the stored procedure has been correctly added to the database.</span></span> <span data-ttu-id="2a3fa-181">Quando il controllo del database, se non viene visualizzata la stored procedure try facendo clic sulla cartella Stored procedure e scegliere Aggiorna.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-181">When checking the database, if you do not see the stored procedure try right-clicking on the Stored Procedures folder and choosing Refresh.</span></span>


![Verificare che sia stato aggiunto un nuovo metodo all'oggetto TableAdapter](adding-additional-datatable-columns-vb/_static/image19.png)

<span data-ttu-id="2a3fa-183">**Figura 7**: verificare che sia stato aggiunto un nuovo metodo all'oggetto TableAdapter</span><span class="sxs-lookup"><span data-stu-id="2a3fa-183">**Figure 7**: Verify that a New Method Has Been Added to the TableAdapter</span></span>


<span data-ttu-id="2a3fa-184">[![Verificare che il Database contenga il Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-184">[![Ensure that the Database Contains the Products_SelectWithPriceQuartile Stored Procedure](adding-additional-datatable-columns-vb/_static/image21.png)](adding-additional-datatable-columns-vb/_static/image20.png)</span></span>

<span data-ttu-id="2a3fa-185">**Figura 8**: verificare che il Database contiene il `Products_SelectWithPriceQuartile` Stored Procedure ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image22.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-185">**Figure 8**: Ensure that the Database Contains the `Products_SelectWithPriceQuartile` Stored Procedure ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image22.png))</span></span>


> [!NOTE]
> <span data-ttu-id="2a3fa-186">Uno dei vantaggi dell'utilizzo di stored procedure anziché istruzioni SQL ad hoc è che a rieseguire la configurazione guidata TableAdapter non modificare gli elenchi di colonne della stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-186">One of the benefits of using stored procedures instead of ad-hoc SQL statements is that re-running the TableAdapter Configuration wizard will not modify the stored procedures column lists.</span></span> <span data-ttu-id="2a3fa-187">Verificare questa condizione facendo clic sul TableAdapter, scegliendo l'opzione di configurazione dal menu contestuale per avviare la procedura guidata e quindi fare clic su Fine per completare l'operazione.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-187">Verify this by right-clicking on the TableAdapter, choosing the Configure option from the context-menu to start the wizard, and then clicking Finish to complete it.</span></span> <span data-ttu-id="2a3fa-188">Successivamente, accedere al database e visualizzare il `Products_SelectWithPriceQuartile` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-188">Next, go to the database and view the `Products_SelectWithPriceQuartile` stored procedure.</span></span> <span data-ttu-id="2a3fa-189">Si noti che l'elenco di colonne non è stato modificato.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-189">Note that its column list has not been modified.</span></span> <span data-ttu-id="2a3fa-190">Avessimo è stata utilizza istruzioni SQL ad hoc, eseguire nuovamente la configurazione guidata TableAdapter verrà ripristinata questo elenco di colonne per corrispondere alle colonne elencate query principale, eliminando così l'istruzione NTILE dalla query utilizzata da query s il `GetProductsWithPriceQuartile` metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-190">Had we been using ad-hoc SQL statements, re-running the TableAdapter Configuration wizard would have reverted this query s column list to match the main query column list, thereby removing the NTILE statement from the query used by the `GetProductsWithPriceQuartile` method.</span></span>


<span data-ttu-id="2a3fa-191">Quando il livello di accesso ai dati di s `GetProductsWithPriceQuartile` metodo viene richiamato, viene eseguito il TableAdapter il `Products_SelectWithPriceQuartile` stored procedure e aggiunge una riga per il `ProductsDataTable` per ciascun record restituito.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-191">When the Data Access Layer s `GetProductsWithPriceQuartile` method is invoked, the TableAdapter executes the `Products_SelectWithPriceQuartile` stored procedure and adds a row to the `ProductsDataTable` for each returned record.</span></span> <span data-ttu-id="2a3fa-192">Mapping dei campi di dati restituiti dalla stored procedure per la `ProductsDataTable` colonne s.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-192">The data fields returned by the stored procedure are mapped to the `ProductsDataTable` s columns.</span></span> <span data-ttu-id="2a3fa-193">Poiché non esiste un `PriceQuartile` campo dei dati restituiti dalla stored procedure, viene assegnato il valore di `ProductsDataTable` s `PriceQuartile` colonna.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-193">Since there is a `PriceQuartile` data field returned from the stored procedure, its value is assigned to the `ProductsDataTable` s `PriceQuartile` column.</span></span>

<span data-ttu-id="2a3fa-194">Per i metodi TableAdapter le cui query non restituiscono un `PriceQuartile` campo di dati, il `PriceQuartile` valore della colonna s è il valore specificato dal relativo `DefaultValue` proprietà.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-194">For those TableAdapter methods whose queries do not return a `PriceQuartile` data field, the `PriceQuartile` column s value is the value specified by its `DefaultValue` property.</span></span> <span data-ttu-id="2a3fa-195">Come illustrato nella figura 2, questo valore è impostato su `DBNull`, il valore predefinito.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-195">As Figure 2 shows, this value is set to `DBNull`, the default.</span></span> <span data-ttu-id="2a3fa-196">Se si preferisce un valore predefinito diverso, impostare semplicemente il `DefaultValue` proprietà conseguenza.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-196">If you would prefer a different default value, simply set the `DefaultValue` property accordingly.</span></span> <span data-ttu-id="2a3fa-197">Assicurarsi che il `DefaultValue` valore è valido dato colonna s `DataType` (ad esempio, `System.Int32` per il `PriceQuartile` colonna).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-197">Just make sure that the `DefaultValue` value is valid given the column s `DataType` (i.e., `System.Int32` for the `PriceQuartile` column).</span></span>

<span data-ttu-id="2a3fa-198">A questo punto sono stati eseguiti i passaggi necessari per l'aggiunta di una colonna aggiuntiva a un oggetto DataTable.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-198">At this point we have performed the necessary steps for adding an additional column to a DataTable.</span></span> <span data-ttu-id="2a3fa-199">Per verificare che questa colonna aggiuntiva funzioni come previsto, consentire s di creare una pagina ASP.NET che consente di visualizzare ogni nome s del prodotto, prezzo e quartile prezzo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-199">To verify that this additional column works as expected, let s create an ASP.NET page that displays each product s name, price, and price quartile.</span></span> <span data-ttu-id="2a3fa-200">Prima di procedere è tuttavia, è innanzitutto necessario aggiornare il livello di logica di Business per includere un metodo che chiama verso il basso per i dispositivi DAL `GetProductsWithPriceQuartile` metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-200">Before we do that, though, we first need to update the Business Logic Layer to include a method that calls down to the DAL s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="2a3fa-201">Si aggiorna il livello Business LOGIC successivamente, nel passaggio 3 e quindi creare la pagina ASP.NET nel passaggio 4.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-201">We will update the BLL next, in Step 3, and then create the ASP.NET page in Step 4.</span></span>

## <a name="step-3-augmenting-the-business-logic-layer"></a><span data-ttu-id="2a3fa-202">Passaggio 3: Aumentare il livello di logica di Business</span><span class="sxs-lookup"><span data-stu-id="2a3fa-202">Step 3: Augmenting the Business Logic Layer</span></span>

<span data-ttu-id="2a3fa-203">Prima viene usato il nuovo `GetProductsWithPriceQuartile` metodo dal livello di presentazione, è innanzitutto necessario aggiungere un metodo corrispondente al livello Business Logic.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-203">Before we use the new `GetProductsWithPriceQuartile` method from the Presentation Layer, we should first add a corresponding method to the BLL.</span></span> <span data-ttu-id="2a3fa-204">Aprire il `ProductsBLLWithSprocs` file di classe e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="2a3fa-204">Open the `ProductsBLLWithSprocs` class file and add the following code:</span></span>


[!code-vb[Main](adding-additional-datatable-columns-vb/samples/sample2.vb)]

<span data-ttu-id="2a3fa-205">Come gli altri metodi di recupero di dati in `ProductsBLLWithSprocs`, `GetProductsWithPriceQuartile` metodo chiama semplicemente DAL corrispondente s `GetProductsWithPriceQuartile` (metodo) e restituisce i risultati.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-205">Like the other data retrieval methods in `ProductsBLLWithSprocs`, the `GetProductsWithPriceQuartile` method simply calls the DAL s corresponding `GetProductsWithPriceQuartile` method and returns its results.</span></span>

## <a name="step-4-displaying-the-price-quartile-information-in-an-aspnet-web-page"></a><span data-ttu-id="2a3fa-206">Passaggio 4: Visualizzare le informazioni di Quartile prezzo in una pagina Web ASP.NET</span><span class="sxs-lookup"><span data-stu-id="2a3fa-206">Step 4: Displaying the Price Quartile Information in an ASP.NET Web Page</span></span>

<span data-ttu-id="2a3fa-207">Con l'aggiunta di BLL completare è nuovamente pronto per creare una pagina ASP.NET che mostra il quartile prezzo per ogni prodotto.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-207">With the BLL addition complete we re ready to create an ASP.NET page that shows the price quartile for each product.</span></span> <span data-ttu-id="2a3fa-208">Aprire il `AddingColumns.aspx` nella pagina di `AdvancedDAL` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione, l'impostazione relativa `ID` proprietà `Products`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-208">Open the `AddingColumns.aspx` page in the `AdvancedDAL` folder and drag a GridView from the Toolbox onto the Designer, setting its `ID` property to `Products`.</span></span> <span data-ttu-id="2a3fa-209">Il GridView s smart tag, associarlo a un nuovo oggetto ObjectDataSource denominato `ProductsDataSource`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-209">From the GridView s smart tag, bind it to a new ObjectDataSource named `ProductsDataSource`.</span></span> <span data-ttu-id="2a3fa-210">Configurare ObjectDataSource per utilizzare il `ProductsBLLWithSprocs` classe s `GetProductsWithPriceQuartile` metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-210">Configure the ObjectDataSource to use the `ProductsBLLWithSprocs` class s `GetProductsWithPriceQuartile` method.</span></span> <span data-ttu-id="2a3fa-211">Poiché questa sarà una griglia di sola lettura, impostare gli elenchi a discesa nell'aggiornamento, inserimento ed eliminare le schede su (nessuno).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-211">Since this will be a read-only grid, set the drop-down lists in the UPDATE, INSERT, and DELETE tabs to (None) .</span></span>


<span data-ttu-id="2a3fa-212">[![Configurare ObjectDataSource per utilizzare la classe ProductsBLLWithSprocs](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-212">[![Configure the ObjectDataSource to Use the ProductsBLLWithSprocs Class](adding-additional-datatable-columns-vb/_static/image24.png)](adding-additional-datatable-columns-vb/_static/image23.png)</span></span>

<span data-ttu-id="2a3fa-213">**Figura 9**: configurare ObjectDataSource per usare il `ProductsBLLWithSprocs` classe ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image25.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-213">**Figure 9**: Configure the ObjectDataSource to Use the `ProductsBLLWithSprocs` Class ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image25.png))</span></span>


<span data-ttu-id="2a3fa-214">[![Recuperare le informazioni sul prodotto dal metodo GetProductsWithPriceQuartile](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-214">[![Retrieve Product Information from the GetProductsWithPriceQuartile Method](adding-additional-datatable-columns-vb/_static/image27.png)](adding-additional-datatable-columns-vb/_static/image26.png)</span></span>

<span data-ttu-id="2a3fa-215">**Figura 10**: recuperare informazioni sui prodotti dal `GetProductsWithPriceQuartile` metodo ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image28.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-215">**Figure 10**: Retrieve Product Information from the `GetProductsWithPriceQuartile` Method ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image28.png))</span></span>


<span data-ttu-id="2a3fa-216">Dopo aver completato la configurazione guidata origine dati, Visual Studio aggiungerà automaticamente un BoundField o CheckBoxField a GridView per ognuno dei campi di dati restituiti dal metodo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-216">After completing the Configure Data Source wizard, Visual Studio will automatically add a BoundField or CheckBoxField to the GridView for each of the data fields returned by the method.</span></span> <span data-ttu-id="2a3fa-217">Uno di questi campi di dati è `PriceQuartile`, ovvero la colonna è stato aggiunto al `ProductsDataTable` nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-217">One of these data fields is `PriceQuartile`, which is the column we added to the `ProductsDataTable` in Step 1.</span></span>

<span data-ttu-id="2a3fa-218">Modificare i campi s GridView, la rimozione di tutto tranne il `ProductName`, `UnitPrice`, e `PriceQuartile` BoundField.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-218">Edit the GridView s fields, removing all but the `ProductName`, `UnitPrice`, and `PriceQuartile` BoundFields.</span></span> <span data-ttu-id="2a3fa-219">Configurare il `UnitPrice` BoundField per formattare il valore come valuta e avere la `UnitPrice` e `PriceQuartile` BoundField e center allineato a destra, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-219">Configure the `UnitPrice` BoundField to format its value as a currency and have the `UnitPrice` and `PriceQuartile` BoundFields right- and center-aligned, respectively.</span></span> <span data-ttu-id="2a3fa-220">Infine, aggiornare restanti BoundField `HeaderText` le proprietà per prodotto, prezzo e prezzo Quartile, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-220">Finally, update the remaining BoundFields `HeaderText` properties to Product, Price, and Price Quartile, respectively.</span></span> <span data-ttu-id="2a3fa-221">Inoltre, controllare la casella di controllo Abilita ordinamento dallo smart tag GridView s.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-221">Also, check the Enable Sorting checkbox from the GridView s smart tag.</span></span>

<span data-ttu-id="2a3fa-222">Dopo queste modifiche, il markup dichiarativo s GridView e ObjectDataSource dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="2a3fa-222">After these modifications, the GridView and ObjectDataSource s declarative markup should look like the following:</span></span>


[!code-aspx[Main](adding-additional-datatable-columns-vb/samples/sample3.aspx)]

<span data-ttu-id="2a3fa-223">Figura 11 Mostra questa pagina quando visitato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-223">Figure 11 shows this page when visited through a browser.</span></span> <span data-ttu-id="2a3fa-224">Si noti che, inizialmente, i prodotti vengono ordinati in base i prezzi in ordine decrescente con ogni prodotto assegnato un appropriato `PriceQuartile` valore.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-224">Note that, initially, the products are ordered by their price in descending order with each product assigned an appropriate `PriceQuartile` value.</span></span> <span data-ttu-id="2a3fa-225">Naturalmente questi dati possono essere ordinati per altri criteri con il valore della colonna prezzo Quartile ancora che riflette la valutazione del prodotto s rispetto al prezzo (vedere Figura 12).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-225">Of course this data can be sorted by other criteria with the Price Quartile column value still reflecting the product s ranking with respect to price (see Figure 12).</span></span>


<span data-ttu-id="2a3fa-226">[![I prodotti vengono ordinati in base i prezzi](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-226">[![The Products are Ordered by their Prices](adding-additional-datatable-columns-vb/_static/image30.png)](adding-additional-datatable-columns-vb/_static/image29.png)</span></span>

<span data-ttu-id="2a3fa-227">**Figura 11**: il prodotti vengono ordinati in base i prezzi ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image31.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-227">**Figure 11**: The Products are Ordered by their Prices ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image31.png))</span></span>


<span data-ttu-id="2a3fa-228">[![I prodotti vengono ordinati con i relativi nomi](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-228">[![The Products are Ordered by their Names](adding-additional-datatable-columns-vb/_static/image33.png)](adding-additional-datatable-columns-vb/_static/image32.png)</span></span>

<span data-ttu-id="2a3fa-229">**Figura 12**: il prodotti vengono ordinati con i relativi nomi ([fare clic per visualizzare l'immagine ingrandita](adding-additional-datatable-columns-vb/_static/image34.png))</span><span class="sxs-lookup"><span data-stu-id="2a3fa-229">**Figure 12**: The Products are Ordered by their Names ([Click to view full-size image](adding-additional-datatable-columns-vb/_static/image34.png))</span></span>


> [!NOTE]
> <span data-ttu-id="2a3fa-230">Con poche righe di codice è stato possibile aumentare in modo che colore le righe di prodotto in base GridView loro `PriceQuartile` valore.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-230">With a few lines of code we could augment the GridView so that it colored the product rows based on their `PriceQuartile` value.</span></span> <span data-ttu-id="2a3fa-231">Si potrebbe essere il primo quartile una luce verde, quelli il secondo quartile un giallo chiaro, tali prodotti di colore e così via.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-231">We might color those products in the first quartile a light green, those in the second quartile a light yellow, and so forth.</span></span> <span data-ttu-id="2a3fa-232">Ti suggeriamo di dedicare alcuni minuti per aggiungere questa funzionalità.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-232">I encourage you to take a moment to add this functionality.</span></span> <span data-ttu-id="2a3fa-233">Se è necessario un aggiornamento sulla formattazione di un controllo GridView, consultare il [formattazione basato su dati personalizzati](../custom-formatting/custom-formatting-based-upon-data-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-233">If you need a refresher on formatting a GridView, consult the [Custom Formatting Based Upon Data](../custom-formatting/custom-formatting-based-upon-data-vb.md) tutorial.</span></span>


## <a name="an-alternative-approach---creating-another-tableadapter"></a><span data-ttu-id="2a3fa-234">Un approccio alternativo - creazione di un altro oggetto TableAdapter</span><span class="sxs-lookup"><span data-stu-id="2a3fa-234">An Alternative Approach - Creating Another TableAdapter</span></span>

<span data-ttu-id="2a3fa-235">Come abbiamo visto in questa esercitazione, aggiunta a un oggetto TableAdapter che restituisce i campi di dati diversi da quelli di un metodo dichiarato dalla query principale, è possibile aggiungere colonne corrispondenti nella DataTable.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-235">As we saw in this tutorial, when adding a method to a TableAdapter that returns data fields other than those spelled out by the main query, we can add corresponding columns to the DataTable.</span></span> <span data-ttu-id="2a3fa-236">Tale approccio, tuttavia, funziona bene solo se sono presenti un numero ridotto di metodi TableAdapter che restituiscono campi di dati diversi e i campi di dati alternativi non variano a seconda troppo dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-236">Such an approach, however, works well only if there are a small number of methods in the TableAdapter that return different data fields and if those alternate data fields do not vary too much from the main query.</span></span>

<span data-ttu-id="2a3fa-237">Invece di aggiungere colonne alla tabella di dati, è possibile aggiungere invece un altro oggetto TableAdapter al set di dati che contiene i metodi che restituiscono campi di dati diversi dal primo TableAdapter.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-237">Rather than adding columns to the DataTable, you can instead add another TableAdapter to the DataSet that contains the methods from the first TableAdapter that return different data fields.</span></span> <span data-ttu-id="2a3fa-238">Per questa esercitazione, anziché aggiungere il `PriceQuartile` colonna il `ProductsDataTable` (in cui viene utilizzato solo per il `GetProductsWithPriceQuartile` (metodo)), un TableAdapter aggiuntive avremmo potuto aggiungere al set di dati denominato `ProductsWithPriceQuartileTableAdapter` utilizzati il `Products_SelectWithPriceQuartile` archiviati procedure relative query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-238">For this tutorial, rather than add the `PriceQuartile` column to the `ProductsDataTable` (where it is only used by the `GetProductsWithPriceQuartile` method), we could have added an additional TableAdapter to the DataSet named `ProductsWithPriceQuartileTableAdapter` that used the `Products_SelectWithPriceQuartile` stored procedure as its main query.</span></span> <span data-ttu-id="2a3fa-239">Utilizzano le pagine ASP.NET che è necessario per ottenere informazioni sui prodotti con quartile il prezzo di `ProductsWithPriceQuartileTableAdapter`, mentre quelli che non è possibile continuare a utilizzare il `ProductsTableAdapter`.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-239">ASP.NET pages that needed to get product information with the price quartile would use the `ProductsWithPriceQuartileTableAdapter`, while those that did not could continue to use the `ProductsTableAdapter`.</span></span>

<span data-ttu-id="2a3fa-240">Aggiungendo un nuovo TableAdapter, DataTable rimangono untarnished e le relative colonne mirror con precisione i campi di dati restituiti da metodi TableAdapter s.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-240">By adding a new TableAdapter, the DataTables remain untarnished and their columns precisely mirror the data fields returned by their TableAdapter s methods.</span></span> <span data-ttu-id="2a3fa-241">Tuttavia, altri oggetti TableAdapter possono introdurre funzionalità e le attività ripetitive.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-241">However, additional TableAdapters can introduce repetitive tasks and functionality.</span></span> <span data-ttu-id="2a3fa-242">Ad esempio, se tali pagine ASP.NET che visualizzata il `PriceQuartile` colonna anche necessari per fornire l'inserimento, aggiornamento ed eliminazione, il supporto di `ProductsWithPriceQuartileTableAdapter` dovranno disporre relativo `InsertCommand`, `UpdateCommand`, e `DeleteCommand` proprietà correttamente configurato.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-242">For example, if those ASP.NET pages that displayed the `PriceQuartile` column also needed to provide insert, update, and delete support, the `ProductsWithPriceQuartileTableAdapter` would need to have its `InsertCommand`, `UpdateCommand`, and `DeleteCommand` properties properly configured.</span></span> <span data-ttu-id="2a3fa-243">Anche se queste proprietà sarebbero eseguire il mirroring di `ProductsTableAdapter` s, questa configurazione introduce un passaggio aggiuntivo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-243">While these properties would mirror the `ProductsTableAdapter` s, this configuration introduces an extra step.</span></span> <span data-ttu-id="2a3fa-244">Inoltre, sono disponibili ora due modi per aggiornare, eliminare o aggiungere un prodotto al database - tramite il `ProductsTableAdapter` e `ProductsWithPriceQuartileTableAdapter` classi.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-244">Moreover, there are now two ways to update, delete, or add a product to the database - through the `ProductsTableAdapter` and `ProductsWithPriceQuartileTableAdapter` classes.</span></span>

<span data-ttu-id="2a3fa-245">Il download per questa esercitazione include un `ProductsWithPriceQuartileTableAdapter` classe il `NorthwindWithSprocs` set di dati che illustra questo approccio alternativo.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-245">The download for this tutorial includes a `ProductsWithPriceQuartileTableAdapter` class in the `NorthwindWithSprocs` DataSet that illustrates this alternative approach.</span></span>

## <a name="summary"></a><span data-ttu-id="2a3fa-246">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="2a3fa-246">Summary</span></span>

<span data-ttu-id="2a3fa-247">Nella maggior parte degli scenari, tutti i metodi in un oggetto TableAdapter verrà restituito lo stesso set di campi di dati, ma sono disponibili quando per restituire un campo aggiuntivo potrebbe essere necessario un metodo particolare o due volte.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-247">In most scenarios, all of the methods in a TableAdapter will return the same set of data fields, but there are times when a particular method or two may need to return an additional field.</span></span> <span data-ttu-id="2a3fa-248">Ad esempio, nel [Master/dettaglio mediante un elenco puntato dei record Master con un controllo DataList dettagli](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) esercitazione è stato aggiunto un metodo per il `CategoriesTableAdapter` che, oltre ai campi di dati, query principale s restituiti un `NumberOfProducts` campo segnalato il numero di prodotti associati a ogni categoria.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-248">For example, in the [Master/Detail Using a Bulleted List of Master Records with a Details DataList](../filtering-scenarios-with-the-datalist-and-repeater/master-detail-using-a-bulleted-list-of-master-records-with-a-details-datalist-vb.md) tutorial we added a method to the `CategoriesTableAdapter` that, in addition to the main query s data fields, returned a `NumberOfProducts` field that reported the number of products associated with each category.</span></span> <span data-ttu-id="2a3fa-249">In questa esercitazione è stato esaminato l'aggiunta di un metodo di `ProductsTableAdapter` che ha restituito un `PriceQuartile` campo oltre ai campi di dati della query principale s.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-249">In this tutorial we looked at adding a method in the `ProductsTableAdapter` that returned a `PriceQuartile` field in addition to the main query s data fields.</span></span> <span data-ttu-id="2a3fa-250">Per acquisire dati aggiuntivi campi restituiti dai metodi TableAdapter s che è necessario aggiungere le colonne corrispondenti nella DataTable.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-250">To capture additional data fields returned by the TableAdapter s methods we need to add corresponding columns to the DataTable.</span></span>

<span data-ttu-id="2a3fa-251">Se si prevede di aggiungere manualmente le colonne nella DataTable, è consigliabile che l'oggetto TableAdapter utilizzare stored procedure.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-251">If you plan on manually adding columns to the DataTable, it is recommended that the TableAdapter use stored procedures.</span></span> <span data-ttu-id="2a3fa-252">Se l'oggetto TableAdapter utilizza istruzioni SQL ad hoc, ogni volta che la configurazione guidata TableAdapter viene eseguita tutti i metodi negli elenchi dei campi dati ripristino i campi di dati restituiti dalla query principale.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-252">If the TableAdapter uses ad-hoc SQL statements, any time the TableAdapter Configuration wizard is run all of the methods data field lists revert to the data fields returned by the main query.</span></span> <span data-ttu-id="2a3fa-253">Questo problema non si estende a stored procedure, motivo per cui essi sono consigliati e utilizzati in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-253">This problem does not extend to stored procedures, which is why they are recommended and were used in this tutorial.</span></span>

<span data-ttu-id="2a3fa-254">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="2a3fa-254">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="2a3fa-255">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="2a3fa-255">About the Author</span></span>

<span data-ttu-id="2a3fa-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-256">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="2a3fa-257">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-257">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="2a3fa-258">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-258">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="2a3fa-259">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="2a3fa-259">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="2a3fa-260">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="2a3fa-260">Special Thanks To</span></span>

<span data-ttu-id="2a3fa-261">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-261">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="2a3fa-262">Lead revisori per questa esercitazione sono stati Randy Schmidt, Goor Luisa, Bernadette Leigh e Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="2a3fa-262">Lead reviewers for this tutorial were Randy Schmidt, Jacky Goor, Bernadette Leigh, and Hilton Giesenow.</span></span> <span data-ttu-id="2a3fa-263">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="2a3fa-263">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="2a3fa-264">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-264">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="2a3fa-265">[Precedente](updating-the-tableadapter-to-use-joins-vb.md)
> [Successivo](working-with-computed-columns-vb.md)</span><span class="sxs-lookup"><span data-stu-id="2a3fa-265">[Previous](updating-the-tableadapter-to-use-joins-vb.md)
[Next](working-with-computed-columns-vb.md)</span></span>

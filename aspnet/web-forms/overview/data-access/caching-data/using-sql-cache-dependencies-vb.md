---
uid: web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
title: Utilizzando le dipendenze della Cache SQL (VB) | Documenti Microsoft
author: rick-anderson
description: La strategia di memorizzazione nella cache più semplice consiste nel consentire i dati memorizzati nella cache scada dopo un periodo di tempo specificato. Tuttavia, questo approccio semplice significa che i dati memorizzati nella cache di maintai...
ms.author: aspnetcontent
manager: wpickett
ms.date: 05/30/2007
ms.topic: article
ms.assetid: bd347d93-4251-4532-801c-a36f2dfa7f96
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/caching-data/using-sql-cache-dependencies-vb
msc.type: authoredcontent
ms.openlocfilehash: 452d856fe352ef2eb7dfcc3f3acd6aa5bcb5ae41
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30878373"
---
<a name="using-sql-cache-dependencies-vb"></a><span data-ttu-id="e9bb3-104">Utilizzando le dipendenze della Cache SQL (VB)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-104">Using SQL Cache Dependencies (VB)</span></span>
====================
<span data-ttu-id="e9bb3-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="e9bb3-106">[Scaricare codice](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) o [Scarica il PDF](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-106">[Download Code](http://download.microsoft.com/download/3/9/f/39f92b37-e92e-4ab3-909e-b4ef23d01aa3/ASPNET_Data_Tutorial_61_VB.zip) or [Download PDF](using-sql-cache-dependencies-vb/_static/datatutorial61vb1.pdf)</span></span>

> <span data-ttu-id="e9bb3-107">La strategia di memorizzazione nella cache più semplice consiste nel consentire i dati memorizzati nella cache scada dopo un periodo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-107">The simplest caching strategy is to allow cached data to expire after a specified period of time.</span></span> <span data-ttu-id="e9bb3-108">Ma questo approccio semplice significa che i dati memorizzati nella cache non gestisce nessuna associazione con l'origine dati sottostante, dando luogo a dati non aggiornati che viene mantenuti troppo lungo o corrente dei dati che sono scaduti troppo presto.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-108">But this simple approach means that the cached data maintains no association with its underlying data source, resulting in stale data that is held too long or current data that is expired too soon.</span></span> <span data-ttu-id="e9bb3-109">Un approccio migliore consiste nell'utilizzare la classe SqlCacheDependency in modo che i dati rimangono memorizzati nella cache fino a quando i dati sottostanti sono stati modificati nel database SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-109">A better approach is to use the SqlCacheDependency class so that data remains cached until its underlying data has been modified in the SQL database.</span></span> <span data-ttu-id="e9bb3-110">In questa esercitazione verrà illustrato.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-110">This tutorial shows you how.</span></span>


## <a name="introduction"></a><span data-ttu-id="e9bb3-111">Introduzione</span><span class="sxs-lookup"><span data-stu-id="e9bb3-111">Introduction</span></span>

<span data-ttu-id="e9bb3-112">Esaminate le tecniche di memorizzazione nella cache il [la memorizzazione nella cache di dati con ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) e [memorizzazione dei dati nell'architettura](caching-data-in-the-architecture-vb.md) esercitazioni consentono di rimuovere i dati dalla cache dopo un determinato una scadenza basati sull'ora periodo.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-112">The caching techniques examined in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) and [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorials used a time-based expiry to evict the data from the cache after a specified period.</span></span> <span data-ttu-id="e9bb3-113">Questo approccio è il modo più semplice per bilanciare il miglioramento delle prestazioni di memorizzazione nella cache con obsolescenza dei dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-113">This approach is the simplest way to balance the performance gains of caching against data staleness.</span></span> <span data-ttu-id="e9bb3-114">Selezionando una scadenza del tempo di *x* secondi, lo sviluppatore della pagina concedes per sfruttare i vantaggi delle prestazioni di memorizzazione nella cache solo per *x* secondi, ma è possibile posizionare semplice che suo dati non potranno mai essere non aggiornati più tempo rispetto a un massimo di *x* secondi.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-114">By selecting a time expiry of *x* seconds, a page developer concedes to enjoy the performance benefits of caching for only *x* seconds, but can rest easy that her data will never be stale longer than a maximum of *x* seconds.</span></span> <span data-ttu-id="e9bb3-115">Naturalmente, per i dati statici, *x* può essere esteso al ciclo di vita dell'applicazione web, come è stato esaminato nel [memorizzazione dei dati all'avvio dell'applicazione](caching-data-at-application-startup-vb.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-115">Of course, for static data, *x* can be extended to the lifetime of the web application, as was examined in the [Caching Data at Application Startup](caching-data-at-application-startup-vb.md) tutorial.</span></span>

<span data-ttu-id="e9bb3-116">Quando la memorizzazione nella cache dei dati del database, una scadenza basati sull'ora è spesso scelti per la facilità d'uso, ma spesso una soluzione insufficiente.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-116">When caching database data, a time-based expiry is often chosen for its ease of use but is frequently an inadequate solution.</span></span> <span data-ttu-id="e9bb3-117">In teoria, i dati del database resta memorizzato nella cache fino a quando i dati sottostanti sono stati modificati nel database. solo a questo punto verrà eliminata la cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-117">Ideally, the database data would remain cached until the underlying data has been modified in the database; only then would the cache be evicted.</span></span> <span data-ttu-id="e9bb3-118">Questo approccio consente di ottimizzare le prestazioni di memorizzazione nella cache e riduce al minimo la durata dei dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-118">This approach maximizes the performance benefits of caching and minimizes the duration of stale data.</span></span> <span data-ttu-id="e9bb3-119">Tuttavia, per poter sfruttare questi vantaggi sono deve essere un sistema che sa quando i dati del database sottostante sono stati modificati e rimuove gli elementi corrispondenti dalla cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-119">However, in order to enjoy these benefits there must be some system in place that knows when the underlying database data has been modified and evicts the corresponding items from the cache.</span></span> <span data-ttu-id="e9bb3-120">Prima di ASP.NET 2.0, gli sviluppatori di pagina sono responsabili dell'implementazione di questo sistema.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-120">Prior to ASP.NET 2.0, page developers were responsible for implementing this system.</span></span>

<span data-ttu-id="e9bb3-121">ASP.NET 2.0 fornisce un [ `SqlCacheDependency` classe](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) e l'infrastruttura necessaria per determinare quando è stata modificata nel database in modo che i corrispondenti elementi memorizzati nella cache può essere rimossa.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-121">ASP.NET 2.0 provides a [`SqlCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.sqlcachedependency.aspx) and the necessary infrastructure to determine when a change has occurred in the database so that the corresponding cached items can be evicted.</span></span> <span data-ttu-id="e9bb3-122">Sono disponibili due tecniche per determinare quando i dati sottostanti vengono modificati: notifica e il polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-122">There are two techniques for determining when the underlying data has changed: notification and polling.</span></span> <span data-ttu-id="e9bb3-123">Dopo che illustrano le differenze tra la notifica e polling, si creerà l'infrastruttura necessaria supportare il polling e quindi illustrato come usare il `SqlCacheDependency` scenari classe nella sintassi dichiarativa e a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-123">After discussing the differences between notification and polling, we'll create the infrastructure necessary to support polling and then explore how to use the `SqlCacheDependency` class in declarative and programmatically scenarios.</span></span>

## <a name="understanding-notification-and-polling"></a><span data-ttu-id="e9bb3-124">Il polling e informazioni sulle notifiche</span><span class="sxs-lookup"><span data-stu-id="e9bb3-124">Understanding Notification and Polling</span></span>

<span data-ttu-id="e9bb3-125">Sono disponibili due tecniche che possono essere utilizzate per determinare se i dati in un database sono stati modificati: notifica e il polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-125">There are two techniques that can be used to determine when the data in a database has been modified: notification and polling.</span></span> <span data-ttu-id="e9bb3-126">Con la notifica, il database dal runtime ASP.NET viene avvisato automaticamente se i risultati di una particolare query sono stati modificati dopo l'ultima esecuzione della query, a quel punto vengono rimossi gli elementi memorizzati associati alla query.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-126">With notification, the database automatically alerts the ASP.NET runtime when the results of a particular query have been changed since the query was last executed, at which point the cached items associated with the query are evicted.</span></span> <span data-ttu-id="e9bb3-127">Con il polling, il server di database mantiene informazioni quando particolari tabelle ultimo sono state aggiornate.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-127">With polling, the database server maintains information about when particular tables have last been updated.</span></span> <span data-ttu-id="e9bb3-128">Il runtime di ASP.NET esegue periodicamente il polling del database per controllare quali le tabelle sono state poiché sono stati immessi nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-128">The ASP.NET runtime periodically polls the database to check what tables have changed since they were entered into the cache.</span></span> <span data-ttu-id="e9bb3-129">Tali tabelle i cui dati sono stati modificati disporre gli elementi della cache associata rimossi.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-129">Those tables whose data has been modified have their associated cache items evicted.</span></span>

<span data-ttu-id="e9bb3-130">L'opzione di notifica richiede meno il programma di installazione di polling e più granulare poiché tiene traccia delle modifiche a livello di query anziché a livello di tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-130">The notification option requires less setup than polling and is more granular since it tracks changes at the query level rather than at the table level.</span></span> <span data-ttu-id="e9bb3-131">Purtroppo, le notifiche sono disponibili solo nelle edizioni complete di Microsoft SQL Server 2005 (ad esempio, le edizioni non Express).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-131">Unfortunately, notifications are only available in the full editions of Microsoft SQL Server 2005 (i.e., the non-Express editions).</span></span> <span data-ttu-id="e9bb3-132">Tuttavia, è possibile utilizzare l'opzione di polling per tutte le versioni di Microsoft SQL Server da 7.0 a 2005.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-132">However, the polling option can be used for all versions of Microsoft SQL Server from 7.0 to 2005.</span></span> <span data-ttu-id="e9bb3-133">Poiché tali esercitazioni vengono utilizzati l'edizione Express di SQL Server 2005, si concentra sulla configurazione e l'utilizzo dell'opzione di polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-133">Since these tutorials use the Express edition of SQL Server 2005, we will focus on setting up and using the polling option.</span></span> <span data-ttu-id="e9bb3-134">Alla fine di questa esercitazione per ulteriori risorse sulle funzionalità di notifica di SQL Server 2005 s, consultare la sezione ulteriormente la lettura.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-134">Consult the Further Reading section at the end of this tutorial for further resources on SQL Server 2005 s notification capabilities.</span></span>

<span data-ttu-id="e9bb3-135">Con il polling, il database deve essere configurato per includere una tabella denominata `AspNet_SqlCacheTablesForChangeNotification` con tre colonne: `tableName`, `notificationCreated`, e `changeId`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-135">With polling, the database must be configured to include a table named `AspNet_SqlCacheTablesForChangeNotification` that has three columns - `tableName`, `notificationCreated`, and `changeId`.</span></span> <span data-ttu-id="e9bb3-136">Questa tabella contiene una riga per ogni tabella che dispone di dati che potrebbe essere necessario utilizzare una dipendenza della cache SQL nell'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-136">This table contains a row for each table that has data that might need to be used in a SQL cache dependency in the web application.</span></span> <span data-ttu-id="e9bb3-137">Il `tableName` colonna specifica il nome della tabella durante `notificationCreated` indica la data e ora la riga è stata aggiunta alla tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-137">The `tableName` column specifies the name of the table while `notificationCreated` indicates the date and time the row was added to the table.</span></span> <span data-ttu-id="e9bb3-138">Il `changeId` colonna è di tipo `int` e ha un valore iniziale pari a 0.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-138">The `changeId` column is of type `int` and has an initial value of 0.</span></span> <span data-ttu-id="e9bb3-139">Il valore viene incrementato ad ogni modifica alla tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-139">Its value is incremented with each modification to the table.</span></span>

<span data-ttu-id="e9bb3-140">Oltre al `AspNet_SqlCacheTablesForChangeNotification` tabella, il database deve inoltre includere trigger definiti per le tabelle che possono essere visualizzati in una dipendenza della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-140">In addition to the `AspNet_SqlCacheTablesForChangeNotification` table, the database also needs to include triggers on each of the tables that may appear in a SQL cache dependency.</span></span> <span data-ttu-id="e9bb3-141">Questi trigger vengono eseguiti ogni volta che una riga viene inserita, aggiornata o eliminata e incrementare la tabella s `changeId` valore `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-141">These triggers are executed whenever a row is inserted, updated, or deleted and increment the table s `changeId` value in `AspNet_SqlCacheTablesForChangeNotification`.</span></span>

<span data-ttu-id="e9bb3-142">Il runtime di ASP.NET tiene traccia corrente `changeId` per una tabella quando la memorizzazione nella cache di dati mediante un `SqlCacheDependency` oggetto.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-142">The ASP.NET runtime tracks the current `changeId` for a table when caching data using a `SqlCacheDependency` object.</span></span> <span data-ttu-id="e9bb3-143">Il database viene periodicamente controllato e qualsiasi `SqlCacheDependency` oggetti la cui proprietà `changeId` è diverso dal valore nel database vengono eliminati dopo che un differisce `changeId` valore indica che si è verificata una modifica alla tabella perché è stato memorizzato nella cache i dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-143">The database is periodically checked and any `SqlCacheDependency` objects whose `changeId` differs from the value in the database are evicted since a differing `changeId` value indicates that there has been a change to the table since the data was cached.</span></span>

## <a name="step-1-exploring-theaspnetregsqlexecommand-line-program"></a><span data-ttu-id="e9bb3-144">Passaggio 1: Esplorazione di`aspnet_regsql.exe`programma della riga di comando</span><span class="sxs-lookup"><span data-stu-id="e9bb3-144">Step 1: Exploring the`aspnet_regsql.exe`Command Line Program</span></span>

<span data-ttu-id="e9bb3-145">Con l'approccio di polling, il database deve essere configurato per contenere l'infrastruttura descritto in precedenza: una tabella predefinita (`AspNet_SqlCacheTablesForChangeNotification`), un numero limitato di stored procedure e trigger definiti per le tabelle che possono essere utilizzate nelle dipendenze della cache SQL nel sito web applicazione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-145">With the polling approach the database must be setup to contain the infrastructure described above: a predefined table (`AspNet_SqlCacheTablesForChangeNotification`), a handful of stored procedures, and triggers on each of the tables that may be used in SQL cache dependencies in the web application.</span></span> <span data-ttu-id="e9bb3-146">Queste tabelle, stored procedure e trigger può essere creato tramite il programma della riga di comando `aspnet_regsql.exe`, che si trovano nel `$WINDOWS$\Microsoft.NET\Framework\version` cartella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-146">These tables, stored procedures, and triggers can be created through the command line program `aspnet_regsql.exe`, which is found in the `$WINDOWS$\Microsoft.NET\Framework\version` folder.</span></span> <span data-ttu-id="e9bb3-147">Per creare il `AspNet_SqlCacheTablesForChangeNotification` tabella e stored procedure associate, eseguire il comando seguente dalla riga di comando:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-147">To create the `AspNet_SqlCacheTablesForChangeNotification` table and associated stored procedures, run the following from the command line:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample1.cmd)]

> [!NOTE]
> <span data-ttu-id="e9bb3-148">Per eseguire questi comandi di accesso al database specificato deve essere il [ `db_securityadmin` ](https://msdn.microsoft.com/library/ms188685.aspx) e [ `db_ddladmin` ](https://msdn.microsoft.com/library/ms190667.aspx) ruoli.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-148">To execute these commands the specified database login must be in the [`db_securityadmin`](https://msdn.microsoft.com/library/ms188685.aspx) and [`db_ddladmin`](https://msdn.microsoft.com/library/ms190667.aspx) roles.</span></span> <span data-ttu-id="e9bb3-149">Per esaminare l'oggetto T-SQL inviate al database per il `aspnet_regsql.exe` programma della riga di comando, fare riferimento a [questo post di blog](http://scottonwriting.net/sowblog/posts/10709.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-149">To examine the T-SQL sent to the database by the `aspnet_regsql.exe` command line program, refer to [this blog entry](http://scottonwriting.net/sowblog/posts/10709.aspx).</span></span>


<span data-ttu-id="e9bb3-150">Ad esempio, per aggiungere l'infrastruttura per il polling a un database di Microsoft SQL Server denominato `pubs` in un server di database denominato `ScottsServer` utilizzando l'autenticazione di Windows, passare alla directory appropriata e, dalla riga di comando, immettere:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-150">For example, to add the infrastructure for polling to a Microsoft SQL Server database named `pubs` on a database server named `ScottsServer` using Windows Authentication, navigate to the appropriate directory and, from the command line, enter:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample2.cmd)]

<span data-ttu-id="e9bb3-151">Dopo aver aggiunto l'infrastruttura a livello di database, è necessario aggiungere i trigger per le tabelle che saranno utilizzate in dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-151">After the database-level infrastructure has been added, we need to add the triggers to those tables that will be used in SQL cache dependencies.</span></span> <span data-ttu-id="e9bb3-152">Utilizzare il `aspnet_regsql.exe` riga di comando nuovo del programma, ma specificare il nome di tabella utilizzando il `-t` passare e invece di usare il `-ed` passare utilizzare `-et`, come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-152">Use the `aspnet_regsql.exe` command line program again, but specify the table name using the `-t` switch and instead of using the `-ed` switch use `-et`, like so:</span></span>


[!code-html[Main](using-sql-cache-dependencies-vb/samples/sample3.html)]

<span data-ttu-id="e9bb3-153">Per aggiungere i trigger per il `authors` e `titles` tabelle nel `pubs` database `ScottsServer`, utilizzare:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-153">To add the triggers to the `authors` and `titles` tables on the `pubs` database on `ScottsServer`, use:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample4.cmd)]

<span data-ttu-id="e9bb3-154">Per questa esercitazione, aggiungere i trigger per il `Products`, `Categories`, e `Suppliers` tabelle.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-154">For this tutorial add the triggers to the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="e9bb3-155">Esamineremo la sintassi della riga di comando specifico nel passaggio 3.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-155">We'll look at the particular command line syntax in Step 3.</span></span>

## <a name="step-2-referencing-a-microsoft-sql-server-2005-express-edition-database-inappdata"></a><span data-ttu-id="e9bb3-156">Passaggio 2: Riferimento a un Database Microsoft SQL Server 2005 Express Edition in`App_Data`</span><span class="sxs-lookup"><span data-stu-id="e9bb3-156">Step 2: Referencing a Microsoft SQL Server 2005 Express Edition Database in`App_Data`</span></span>

<span data-ttu-id="e9bb3-157">Il `aspnet_regsql.exe` programma della riga di comando richiede il nome del database e server per aggiungere l'infrastruttura di polling necessarie.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-157">The `aspnet_regsql.exe` command line program requires the database and server name in order to add the necessary polling infrastructure.</span></span> <span data-ttu-id="e9bb3-158">Ma qual è il nome di database e server per un database Microsoft SQL Server 2005 Express in cui si trova il `App_Data` cartella?</span><span class="sxs-lookup"><span data-stu-id="e9bb3-158">But what is the database and server name for a Microsoft SQL Server 2005 Express database that resides in the `App_Data` folder?</span></span> <span data-ttu-id="e9bb3-159">Anziché dover individuare quali sono i nomi di database e server, si ve ha rilevato che l'approccio più semplice per collegare il database per il `localhost\SQLExpress` istanza del database e rinominare i dati utilizzando [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-159">Rather than having to discover what the database and server names are, I ve found that the simplest approach is to attach the database to the `localhost\SQLExpress` database instance and rename the data using [SQL Server Management Studio](https://msdn.microsoft.com/library/ms174173.aspx).</span></span> <span data-ttu-id="e9bb3-160">Se si dispone di una delle versioni complete di SQL Server 2005 installati nel computer, quindi probabile che abbiano già installati nel computer SQL Server Management Studio.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-160">If you have one of the full versions of SQL Server 2005 installed on your machine, then you likely already have SQL Server Management Studio installed on your computer.</span></span> <span data-ttu-id="e9bb3-161">Se si dispone solo di Web Developer Express edition, è possibile scaricare la versione gratuita [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-161">If you only have the Express edition, you can download the free [Microsoft SQL Server Management Studio Express Edition](https://www.microsoft.com/downloads/details.aspx?displaylang=en&amp;FamilyID=C243A5AE-4BD1-4E3D-94B8-5A0F62BF7796).</span></span>

<span data-ttu-id="e9bb3-162">Per iniziare, chiudere Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-162">Start by closing Visual Studio.</span></span> <span data-ttu-id="e9bb3-163">Quindi, aprire SQL Server Management Studio e scegliere di connettersi il `localhost\SQLExpress` server utilizzando l'autenticazione di Windows.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-163">Next, open SQL Server Management Studio and choose to connect to the `localhost\SQLExpress` server using Windows Authentication.</span></span>


![Collegare a localhost\SQLExpress Server](using-sql-cache-dependencies-vb/_static/image1.gif)

<span data-ttu-id="e9bb3-165">**Figura 1**: collegare il `localhost\SQLExpress` Server</span><span class="sxs-lookup"><span data-stu-id="e9bb3-165">**Figure 1**: Attach to the `localhost\SQLExpress` Server</span></span>


<span data-ttu-id="e9bb3-166">Dopo la connessione al server Management Studio verranno Mostra il server e contiene sottocartelle per il database, sicurezza e così via.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-166">After connecting to the server, Management Studio will show the server and have subfolders for the databases, security, and so forth.</span></span> <span data-ttu-id="e9bb3-167">Pulsante destro del mouse sulla cartella database e scegliere l'opzione di connessione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-167">Right-click on the Databases folder and choose the Attach option.</span></span> <span data-ttu-id="e9bb3-168">Verrà visualizzata la finestra di dialogo Collega database (vedere la figura 2).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-168">This will bring up the Attach Databases dialog box (see Figure 2).</span></span> <span data-ttu-id="e9bb3-169">Fare clic sul pulsante Aggiungi e selezionare il `NORTHWND.MDF` cartella del database nella raccolta di s di applicazione web `App_Data` cartella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-169">Click the Add button and select the `NORTHWND.MDF` database folder in your web application s `App_Data` folder.</span></span>


<span data-ttu-id="e9bb3-170">[![Collegare il NORTHWND. Database MDF dalla cartella App_Data](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-170">[![Attach the NORTHWND.MDF Database from the App_Data Folder](using-sql-cache-dependencies-vb/_static/image2.gif)](using-sql-cache-dependencies-vb/_static/image1.png)</span></span>

<span data-ttu-id="e9bb3-171">**Figura 2**: collegare il `NORTHWND.MDF` del Database del `App_Data` cartella ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image2.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-171">**Figure 2**: Attach the `NORTHWND.MDF` Database from the `App_Data` Folder ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image2.png))</span></span>


<span data-ttu-id="e9bb3-172">Il database verrà aggiunta nella cartella di database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-172">This will add the database to the Databases folder.</span></span> <span data-ttu-id="e9bb3-173">Il nome del database potrebbe essere il percorso completo del file di database o il percorso completo preceduto da un [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-173">The database name might be the full path to the database file or the full path prepended with a [GUID](http://en.wikipedia.org/wiki/Globally_Unique_Identifier).</span></span> <span data-ttu-id="e9bb3-174">Per evitare di dover digitare il nome lungo del database quando si utilizza aspnet\_regsql.exe strumento da riga di comando, rinominare il database a un nome più adatto al umane facendo clic sul database appena collegato e scegliendo Rinomina.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-174">To avoid having to type in this lengthy database name when using the aspnet\_regsql.exe command line tool, rename the database to a more human-friendly name by right-clicking on database just attached and choosing Rename.</span></span> <span data-ttu-id="e9bb3-175">I database ve rinominato DataTutorials.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-175">I ve renamed my database to DataTutorials .</span></span>


![Rinominare il Database collegato con un nome più adatto al personale](using-sql-cache-dependencies-vb/_static/image3.gif)

<span data-ttu-id="e9bb3-177">**Figura 3**: rinominare il Database collegato con un nome più adatti all'umane</span><span class="sxs-lookup"><span data-stu-id="e9bb3-177">**Figure 3**: Rename the Attached Database to a More Human-Friendly Name</span></span>


## <a name="step-3-adding-the-polling-infrastructure-to-the-northwind-database"></a><span data-ttu-id="e9bb3-178">Passaggio 3: Aggiunta dell'infrastruttura di Polling per il Database Northwind</span><span class="sxs-lookup"><span data-stu-id="e9bb3-178">Step 3: Adding the Polling Infrastructure to the Northwind Database</span></span>

<span data-ttu-id="e9bb3-179">Ora che è stata associata la `NORTHWND.MDF` del database del `App_Data` cartella, è nuovamente pronto per aggiungere l'infrastruttura di polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-179">Now that we have attached the `NORTHWND.MDF` database from the `App_Data` folder, we re ready to add the polling infrastructure.</span></span> <span data-ttu-id="e9bb3-180">Supponendo che il database è già rinominata DataTutorials, eseguire i seguenti quattro comandi:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-180">Assuming that you ve renamed the database to DataTutorials, run the following four commands:</span></span>


[!code-console[Main](using-sql-cache-dependencies-vb/samples/sample5.cmd)]

<span data-ttu-id="e9bb3-181">Dopo aver eseguito questi quattro comandi, fare doppio clic sul nome del database in Management Studio, passare al sottomenu attività e scegliere Disconnetti.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-181">After running these four commands, right-click on the database name in Management Studio, go to the Tasks submenu, and choose Detach.</span></span> <span data-ttu-id="e9bb3-182">Management Studio chiudere e riaprire Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-182">Then close Management Studio and reopen Visual Studio.</span></span>

<span data-ttu-id="e9bb3-183">Una volta è riaperto Visual Studio, esaminare i database tramite Esplora Server.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-183">Once Visual Studio has reopened, drill into the database through the Server Explorer.</span></span> <span data-ttu-id="e9bb3-184">Si noti la nuova tabella (`AspNet_SqlCacheTablesForChangeNotification`), la nuova stored procedure e trigger nel `Products`, `Categories`, e `Suppliers` tabelle.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-184">Note the new table (`AspNet_SqlCacheTablesForChangeNotification`), the new stored procedures, and the triggers on the `Products`, `Categories`, and `Suppliers` tables.</span></span>


![Il Database include ora l'infrastruttura necessaria Polling](using-sql-cache-dependencies-vb/_static/image4.gif)

<span data-ttu-id="e9bb3-186">**Figura 4**: il Database include ora l'infrastruttura necessaria Polling</span><span class="sxs-lookup"><span data-stu-id="e9bb3-186">**Figure 4**: The Database Now Includes the Necessary Polling Infrastructure</span></span>


## <a name="step-4-configuring-the-polling-service"></a><span data-ttu-id="e9bb3-187">Passaggio 4: Configurazione del servizio di Polling</span><span class="sxs-lookup"><span data-stu-id="e9bb3-187">Step 4: Configuring the Polling Service</span></span>

<span data-ttu-id="e9bb3-188">Dopo aver creato le tabelle necessarie, trigger e stored procedure nel database, il passaggio finale consiste nel configurare il servizio di polling, che viene eseguito tramite `Web.config` specificando i database da utilizzare e la frequenza di polling espresso in millisecondi.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-188">After creating the needed tables, triggers, and stored procedures in the database, the final step is to configure the polling service, which is done through `Web.config` by specifying the databases to use and the polling frequency in milliseconds.</span></span> <span data-ttu-id="e9bb3-189">Il markup seguente esegue il polling del database Northwind, una volta al secondo.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-189">The following markup polls the Northwind database once every second.</span></span>


[!code-xml[Main](using-sql-cache-dependencies-vb/samples/sample6.xml)]

<span data-ttu-id="e9bb3-190">Il `name` valore il `<add>` elemento (NorthwindDB) consente di associare un nome leggibile dall'utente con un determinato database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-190">The `name` value in the `<add>` element ( NorthwindDB ) associates a human-readable name with a particular database.</span></span> <span data-ttu-id="e9bb3-191">Quando si utilizzano le dipendenze della cache SQL, è necessario fare riferimento al nome del database definito qui e la tabella basata su dati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-191">When working with SQL cache dependencies, we'll need to refer to the database name defined here as well as the table that the cached data is based on.</span></span> <span data-ttu-id="e9bb3-192">Si vedrà come utilizzare la `SqlCacheDependency` classe da associare a livello di codice SQL le dipendenze della cache nella cache i dati nel passaggio 6.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-192">We'll see how to use the `SqlCacheDependency` class to programmatically associate SQL cache dependencies with cached data in Step 6.</span></span>

<span data-ttu-id="e9bb3-193">Una volta stabilita una dipendenza della cache SQL, il sistema di polling si connetterà ai database di cui è definiti nel `<databases>` elementi ogni `pollTime` millisecondi ed eseguire il `AspNet_SqlCachePollingStoredProcedure` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-193">Once a SQL cache dependency has been established, the polling system will connect to the databases defined in the `<databases>` elements every `pollTime` milliseconds and execute the `AspNet_SqlCachePollingStoredProcedure` stored procedure.</span></span> <span data-ttu-id="e9bb3-194">Eseguire il backup di questa stored procedure - è stato aggiunto nel passaggio 3 utilizzando il `aspnet_regsql.exe` strumento da riga di comando - restituisce il `tableName` e `changeId` i valori per ogni record `AspNet_SqlCacheTablesForChangeNotification`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-194">This stored procedure - which was added back in Step 3 using the `aspnet_regsql.exe` command line tool - returns the `tableName` and `changeId` values for each record in `AspNet_SqlCacheTablesForChangeNotification`.</span></span> <span data-ttu-id="e9bb3-195">Le dipendenze della cache SQL non aggiornate vengono rimossi dalla cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-195">Outdated SQL cache dependencies are evicted from the cache.</span></span>

<span data-ttu-id="e9bb3-196">Il `pollTime` impostazione introduce un compromesso tra prestazioni e obsolescenza dei dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-196">The `pollTime` setting introduces a tradeoff between performance and data staleness.</span></span> <span data-ttu-id="e9bb3-197">Una piccola `pollTime` valore aumenta il numero di richieste al database, ma più rapidamente rimuove i dati non aggiornati dalla cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-197">A small `pollTime` value increases the number of requests to the database, but more quickly evicts stale data from the cache.</span></span> <span data-ttu-id="e9bb3-198">Una maggiore `pollTime` valore riduce il numero di richieste al database, ma aumenta il ritardo tra quando i dati di back-end cambiano e quando vengono eliminati gli elementi correlati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-198">A larger `pollTime` value reduces the number of database requests, but increases the delay between when the backend data changes and when the related cache items are evicted.</span></span> <span data-ttu-id="e9bb3-199">Fortunatamente, la richiesta di database viene eseguita una stored procedure semplice che s restituzione solo poche righe di una tabella semplice e leggera.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-199">Fortunately, the database request is executing a simple stored procedure that s returning just a few rows from a simple, lightweight table.</span></span> <span data-ttu-id="e9bb3-200">Ma sperimentare diverse `pollTime` i valori per trovare un equilibrio perfetto tra database obsolescenza dei dati e di accesso per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-200">But do experiment with different `pollTime` values to find an ideal balance between database access and data staleness for your application.</span></span> <span data-ttu-id="e9bb3-201">Il più piccolo `pollTime` valore consentito è 500.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-201">The smallest `pollTime` value allowed is 500.</span></span>

> [!NOTE]
> <span data-ttu-id="e9bb3-202">Nell'esempio sopra riportato fornisce un singolo `pollTime` valore nel `<sqlCacheDependency>` elemento, ma è possibile specificare facoltativamente il `pollTime` valore il `<add>` elemento.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-202">The above example provides a single `pollTime` value in the `<sqlCacheDependency>` element, but you can optionally specify the `pollTime` value in the `<add>` element.</span></span> <span data-ttu-id="e9bb3-203">Ciò è utile se si dispone di più database specificati e si desidera personalizzare la frequenza di polling per ogni database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-203">This is useful if you have multiple databases specified and want to customize the polling frequency per database.</span></span>


## <a name="step-5-declaratively-working-with-sql-cache-dependencies"></a><span data-ttu-id="e9bb3-204">Passaggio 5: Utilizzo in modo dichiarativo le dipendenze della Cache SQL</span><span class="sxs-lookup"><span data-stu-id="e9bb3-204">Step 5: Declaratively Working with SQL Cache Dependencies</span></span>

<span data-ttu-id="e9bb3-205">In passaggi da 1 a 4 è stato illustrato come configurare l'infrastruttura del database necessari e configurare il sistema di polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-205">In Steps 1 through 4 we looked at how to setup the necessary database infrastructure and configure the polling system.</span></span> <span data-ttu-id="e9bb3-206">Con questa infrastruttura, possiamo ora aggiungere elementi alla cache di dati con una dipendenza della cache SQL associata utilizzando tecniche a livello di codice o dichiarative.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-206">With this infrastructure in place, we can now add items to the data cache with an associated SQL cache dependency using either programmatic or declarative techniques.</span></span> <span data-ttu-id="e9bb3-207">In questo passaggio verrà esaminato come utilizzare in modo dichiarativo con le dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-207">In this step we'll examine how to declaratively work with SQL cache dependencies.</span></span> <span data-ttu-id="e9bb3-208">Nel passaggio 6 verrà esaminato l'approccio a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-208">In Step 6 we'll look at the programmatic approach.</span></span>

<span data-ttu-id="e9bb3-209">Il [la memorizzazione nella cache di dati con ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) esercitazione esplorata le funzionalità di memorizzazione nella cache dichiarative di ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-209">The [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial explored the declarative caching capabilities of the ObjectDataSource.</span></span> <span data-ttu-id="e9bb3-210">Impostando semplicemente il `EnableCaching` proprietà `True` e `CacheDuration` proprietà per un intervallo di tempo, ObjectDataSource inserirà automaticamente nella cache i dati restituiti dal relativo oggetto sottostante per l'intervallo specificato.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-210">By simply setting the `EnableCaching` property to `True` and the `CacheDuration` property to some time interval, the ObjectDataSource will automatically cache the data returned from its underlying object for the specified interval.</span></span> <span data-ttu-id="e9bb3-211">ObjectDataSource è inoltre possibile utilizzare uno o più dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-211">The ObjectDataSource can also use one or more SQL cache dependencies.</span></span>

<span data-ttu-id="e9bb3-212">Per illustrare l'utilizzo in modo dichiarativo le dipendenze della cache SQL, aprire il `SqlCacheDependencies.aspx` nella pagina di `Caching` cartelle e trascinare un controllo GridView dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-212">To demonstrate using SQL cache dependencies declaratively, open the `SqlCacheDependencies.aspx` page in the `Caching` folder and drag a GridView from the Toolbox onto the Designer.</span></span> <span data-ttu-id="e9bb3-213">Impostare i dispositivi di GridView `ID` a `ProductsDeclarative` e dal suo smart tag scegliere da associare a un nuovo oggetto ObjectDataSource denominato `ProductsDataSourceDeclarative`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-213">Set the GridView s `ID` to `ProductsDeclarative` and, from its smart tag, choose to bind it to a new ObjectDataSource named `ProductsDataSourceDeclarative`.</span></span>


<span data-ttu-id="e9bb3-214">[![Creare un nuovo oggetto ObjectDataSource denominato ProductsDataSourceDeclarative](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-214">[![Create a New ObjectDataSource Named ProductsDataSourceDeclarative](using-sql-cache-dependencies-vb/_static/image5.gif)](using-sql-cache-dependencies-vb/_static/image3.png)</span></span>

<span data-ttu-id="e9bb3-215">**Figura 5**: creare un nuovo denominato ObjectDataSource `ProductsDataSourceDeclarative` ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image4.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-215">**Figure 5**: Create a New ObjectDataSource Named `ProductsDataSourceDeclarative` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image4.png))</span></span>


<span data-ttu-id="e9bb3-216">Configurare ObjectDataSource per utilizzare il `ProductsBLL` classe e impostare l'elenco a discesa nella scheda Seleziona per `GetProducts()`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-216">Configure the ObjectDataSource to use the `ProductsBLL` class and set the drop-down list in the SELECT tab to `GetProducts()`.</span></span> <span data-ttu-id="e9bb3-217">Nella scheda di aggiornamento, scegliere il `UpdateProduct` eseguire l'overload con tre parametri di input - `productName`, `unitPrice`, e `productID`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-217">In the UPDATE tab, choose the `UpdateProduct` overload with three input parameters - `productName`, `unitPrice`, and `productID`.</span></span> <span data-ttu-id="e9bb3-218">Impostare gli elenchi a discesa su (nessuno) nelle schede delle INSERT e DELETE.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-218">Set the drop-down lists to (None) in the INSERT and DELETE tabs.</span></span>


<span data-ttu-id="e9bb3-219">[![Utilizzare l'Overload UpdateProduct con tre parametri di Input](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-219">[![Use the UpdateProduct Overload with Three Input Parameters](using-sql-cache-dependencies-vb/_static/image6.gif)](using-sql-cache-dependencies-vb/_static/image5.png)</span></span>

<span data-ttu-id="e9bb3-220">**Figura 6**: usare l'Overload UpdateProduct con tre parametri di Input ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-220">**Figure 6**: Use the UpdateProduct Overload with Three Input Parameters ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image6.png))</span></span>


<span data-ttu-id="e9bb3-221">[![Impostazione dell'elenco di riepilogo a discesa da (nessuno) per l'INSERT e DELETE schede](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-221">[![Set the Drop-Down List to (None) for the INSERT and DELETE Tabs](using-sql-cache-dependencies-vb/_static/image7.gif)](using-sql-cache-dependencies-vb/_static/image7.png)</span></span>

<span data-ttu-id="e9bb3-222">**Figura 7**: impostare l'elenco a discesa su (nessuno) per di inserimento ed eliminazione schede ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image8.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-222">**Figure 7**: Set the Drop-Down List to (None) for the INSERT and DELETE Tabs ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image8.png))</span></span>


<span data-ttu-id="e9bb3-223">Dopo aver completato la configurazione guidata origine dati, Visual Studio creerà BoundField e CheckBoxFields in GridView per ognuno dei campi dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-223">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="e9bb3-224">Rimuovere tutti i campi ma `ProductName`, `CategoryName`, e `UnitPrice`e formattare questi campi in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-224">Remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="e9bb3-225">Dalla GridView s smart tag, selezionare le caselle di controllo Abilita Paging, abilitare ordinamento e abilitare la modifica.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-225">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="e9bb3-226">Visual Studio verrà impostato il s ObjectDataSource `OldValuesParameterFormatString` proprietà `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-226">Visual Studio will set the ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="e9bb3-227">Affinché la funzionalità di modifica GridView s per il corretto funzionamento, rimuovere la proprietà completamente dalla sintassi dichiarativa o impostarla di nuovo il valore predefinito `{0}`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-227">In order for the GridView s edit feature to work properly, either remove this property entirely from the declarative syntax or set it back to its default value, `{0}`.</span></span>

<span data-ttu-id="e9bb3-228">Infine, aggiungere un controllo etichetta Web di sopra del controllo GridView e impostare il relativo `ID` proprietà `ODSEvents` e il relativo `EnableViewState` proprietà `False`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-228">Finally, add a Label Web control above the GridView and set its `ID` property to `ODSEvents` and its `EnableViewState` property to `False`.</span></span> <span data-ttu-id="e9bb3-229">Dopo aver apportato queste modifiche, markup dichiarativo s pagina dovrebbe essere simile al seguente.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-229">After making these changes, your page s declarative markup should look similar to the following.</span></span> <span data-ttu-id="e9bb3-230">Si noti che se va eseguito un numero di personalizzazioni estetici ai campi GridView che non sono necessari per dimostrare la funzionalità di dipendenza della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-230">Note that I ve made a number of aesthetic customizations to the GridView fields that are not necessary to demonstrate the SQL cache dependency functionality.</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample7.aspx)]

<span data-ttu-id="e9bb3-231">Successivamente, creare un gestore eventi per ObjectDataSource s `Selecting` eventi e nell'aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-231">Next, create an event handler for the ObjectDataSource s `Selecting` event and in it add the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample8.vb)]

<span data-ttu-id="e9bb3-232">Tenere presente che i dispositivi ObjectDataSource `Selecting` evento viene generato solo quando si recuperano dati dal relativo oggetto sottostante.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-232">Recall that the ObjectDataSource s `Selecting` event fires only when retrieving data from its underlying object.</span></span> <span data-ttu-id="e9bb3-233">Se ObjectDataSource accede ai dati dalla cache, non viene generato questo evento.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-233">If the ObjectDataSource accesses the data from its own cache, this event is not fired.</span></span>

<span data-ttu-id="e9bb3-234">A questo punto, visitare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-234">Now, visit this page through a browser.</span></span> <span data-ttu-id="e9bb3-235">Poiché è ve ancora per implementare qualsiasi la memorizzazione nella cache, ogni volta che si pagina, ordinare o modificare la griglia della pagina deve essere visualizzato il testo, l'evento Selecting generato, come mostrato nella figura 8.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-235">Since we ve yet to implement any caching, each time you page, sort, or edit the grid the page should display the text, �Selecting event fired, as Figure 8 shows.</span></span>


<span data-ttu-id="e9bb3-236">[![S ObjectDataSource evento Selecting viene generato ogni volta che il controllo GridView viene eseguito il paging, modificare, o Sorted](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-236">[![The ObjectDataSource s Selecting Event Fires Each Time the GridView is Paged, Edited, or Sorted](using-sql-cache-dependencies-vb/_static/image8.gif)](using-sql-cache-dependencies-vb/_static/image9.png)</span></span>

<span data-ttu-id="e9bb3-237">**Figura 8**: il ObjectDataSource s `Selecting` evento viene attivato ogni ora GridView viene eseguito il paging, modificato o Sorted ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image10.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-237">**Figure 8**: The ObjectDataSource s `Selecting` Event Fires Each Time the GridView is Paged, Edited, or Sorted ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image10.png))</span></span>


<span data-ttu-id="e9bb3-238">Come illustrato nel [la memorizzazione nella cache di dati con ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) esercitazione, impostare il `EnableCaching` proprietà `True` provoca ObjectDataSource memorizzare nella cache i dati per la durata specificata dal relativo `CacheDuration` proprietà.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-238">As we saw in the [Caching Data with the ObjectDataSource](caching-data-with-the-objectdatasource-vb.md) tutorial, setting the `EnableCaching` property to `True` causes the ObjectDataSource to cache its data for the duration specified by its `CacheDuration` property.</span></span> <span data-ttu-id="e9bb3-239">ObjectDataSource ha anche un [ `SqlCacheDependency` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), che aggiunge uno o più dipendenze della cache SQL per i dati memorizzati nella cache usando il modello:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-239">The ObjectDataSource also has a [`SqlCacheDependency` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.objectdatasource.sqlcachedependency.aspx), which adds one or more SQL cache dependencies to the cached data using the pattern:</span></span>


[!code-css[Main](using-sql-cache-dependencies-vb/samples/sample9.css)]

<span data-ttu-id="e9bb3-240">Dove *databaseName* è il nome del database come specificato nella `name` attributo del `<add>` elemento `Web.config`, e *tableName* è il nome della tabella di database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-240">Where *databaseName* is the name of the database as specified in the `name` attribute of the `<add>` element in `Web.config`, and *tableName* is the name of the database table.</span></span> <span data-ttu-id="e9bb3-241">Ad esempio, per creare un ObjectDataSource che memorizza nella cache di dati per un periodo illimitato basata su una dipendenza della cache SQL in s Northwind `Products` tabella, impostare il s ObjectDataSource `EnableCaching` proprietà `True` e il relativo `SqlCacheDependency` proprietà NorthwindDB:Products.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-241">For example, to create an ObjectDataSource that caches data indefinitely based on a SQL cache dependency against the Northwind s `Products` table, set the ObjectDataSource s `EnableCaching` property to `True` and its `SqlCacheDependency` property to NorthwindDB:Products .</span></span>

> [!NOTE]
> <span data-ttu-id="e9bb3-242">È possibile utilizzare una dipendenza della cache SQL *e* una scadenza basati sul tempo impostando `EnableCaching` a `True`, `CacheDuration` per l'intervallo di tempo e `SqlCacheDependency` per i nomi di database e tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-242">You can use a SQL cache dependency *and* a time-based expiry by setting `EnableCaching` to `True`, `CacheDuration` to the time interval, and `SqlCacheDependency` to the database and table name(s).</span></span> <span data-ttu-id="e9bb3-243">ObjectDataSource rimuoverà i dati quando viene raggiunta la scadenza basati sul tempo o quando il sistema di polling indica che i dati del database sottostante è cambiato, a seconda del valore si verifica per prima.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-243">The ObjectDataSource will evict its data when the time-based expiry is reached or when the polling system notes that the underlying database data has changed, whichever happens first.</span></span>


<span data-ttu-id="e9bb3-244">GridView in `SqlCacheDependencies.aspx` Visualizza i dati di due tabelle - `Products` e `Categories` (prodotto s `CategoryName` campo viene recuperato tramite un `JOIN` su `Categories`).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-244">The GridView in `SqlCacheDependencies.aspx` displays data from two tables - `Products` and `Categories` (the product s `CategoryName` field is retrieved via a `JOIN` on `Categories`).</span></span> <span data-ttu-id="e9bb3-245">Pertanto, si desidera specificare le dipendenze della cache di due SQL: NorthwindDB:Products; NorthwindDB:Categories.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-245">Therefore, we want to specify two SQL cache dependencies: NorthwindDB:Products;NorthwindDB:Categories .</span></span>


<span data-ttu-id="e9bb3-246">[![Configurare ObjectDataSource per supportare la memorizzazione nella cache usando le dipendenze della Cache SQL sui prodotti e le categorie](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-246">[![Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on Products and Categories](using-sql-cache-dependencies-vb/_static/image9.gif)](using-sql-cache-dependencies-vb/_static/image11.png)</span></span>

<span data-ttu-id="e9bb3-247">**Figura 9**: configurare ObjectDataSource a supporto di memorizzazione nella cache con dipendenze della Cache SQL nel `Products` e `Categories` ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-247">**Figure 9**: Configure the ObjectDataSource to Support Caching Using SQL Cache Dependencies on `Products` and `Categories` ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image12.png))</span></span>


<span data-ttu-id="e9bb3-248">Dopo aver configurato il ObjectDataSource per supportare la memorizzazione nella cache, rivedere la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-248">After configuring the ObjectDataSource to support caching, revisit the page through a browser.</span></span> <span data-ttu-id="e9bb3-249">L'evento di selezione di testo generato nuovamente, dovrebbe essere visualizzato nella prima visita pagina, ma non verrà più visualizzato quando il paging, l'ordinamento o fare clic sul pulsante di modifica o annullamento.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-249">Again, the text �Selecting event fired should appear on the first page visit, but should go away when paging, sorting, or clicking the Edit or Cancel buttons.</span></span> <span data-ttu-id="e9bb3-250">Infatti, dopo che i dati vengono caricati nella cache ObjectDataSource s, rimane presente finché non il `Products` o `Categories` tabelle vengono modificate o i dati vengono aggiornati tramite il controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-250">This is because after the data is loaded into the ObjectDataSource s cache, it remains there until the `Products` or `Categories` tables are modified or the data is updated through the GridView.</span></span>

<span data-ttu-id="e9bb3-251">Dopo lo scorrimento della griglia e notare l'assenza dell'evento Selecting generato testo, aprire una nuova finestra del browser e passare all'Esercitazione nozioni di base in modalità di modifica, inserimento ed eliminazione di sezione (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-251">After paging through the grid and noting the lack of the �Selecting event fired text, open a new browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="e9bb3-252">Aggiornare il nome o il prezzo di un prodotto.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-252">Update the name or price of a product.</span></span> <span data-ttu-id="e9bb3-253">Quindi, alla prima finestra del browser, visualizzare una pagina diversa dei dati, ordinare la griglia o fare clic su un pulsante Modifica riga s.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-253">Then, from to the first browser window, view a different page of data, sort the grid, or click a row s Edit button.</span></span> <span data-ttu-id="e9bb3-254">Questa volta, l'evento Selecting generato deve si ripresenta, come il database sottostante dei dati è stata modificata (vedere Figura 10).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-254">This time, the �Selecting event fired should reappear, as the underlying database data has been modified (see Figure 10).</span></span> <span data-ttu-id="e9bb3-255">Se non viene visualizzato il testo, attendere qualche minuto e riprovare.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-255">If the text does not appear, wait a few moments and try again.</span></span> <span data-ttu-id="e9bb3-256">Tenere presente che il servizio di polling è il controllo per le modifiche di `Products` tabella ogni `pollTime` millisecondi, pertanto si verifica un ritardo tra quando i dati sottostanti vengono aggiornati e quando viene eliminati i dati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-256">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>


<span data-ttu-id="e9bb3-257">[![Modifica la tabella Products rimuove i dati memorizzati nella cache del prodotto](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-257">[![Modifying the Products Table Evicts the Cached Product Data](using-sql-cache-dependencies-vb/_static/image10.gif)](using-sql-cache-dependencies-vb/_static/image13.png)</span></span>

<span data-ttu-id="e9bb3-258">**Figura 10**: la modifica della tabella Products rimuove i dati di prodotto memorizzati nella cache ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image14.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-258">**Figure 10**: Modifying the Products Table Evicts the Cached Product Data ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image14.png))</span></span>


## <a name="step-6-programmatically-working-with-thesqlcachedependencyclass"></a><span data-ttu-id="e9bb3-259">Passaggio 6: Utilizzo a livello di codice con la`SqlCacheDependency`classe</span><span class="sxs-lookup"><span data-stu-id="e9bb3-259">Step 6: Programmatically Working with the`SqlCacheDependency`Class</span></span>

<span data-ttu-id="e9bb3-260">Il [memorizzazione dei dati nell'architettura](caching-data-in-the-architecture-vb.md) esercitazione esaminato i vantaggi dell'utilizzo di un livello separato di memorizzazione nella cache dell'architettura della differenza che consente di connettere la memorizzazione nella cache con ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-260">The [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial looked at the benefits of using a separate Caching Layer in the architecture as opposed to tightly coupling the caching with the ObjectDataSource.</span></span> <span data-ttu-id="e9bb3-261">In tale esercitazione è stato creato un `ProductsCL` classe per illustrare l'utilizzo a livello di codice con la cache dei dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-261">In that tutorial we created a `ProductsCL` class to demonstrate programmatically working with the data cache.</span></span> <span data-ttu-id="e9bb3-262">Per utilizzare le dipendenze della cache SQL nel livello di memorizzazione nella cache, utilizzare la `SqlCacheDependency` classe.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-262">To utilize SQL cache dependencies in the Caching Layer, use the `SqlCacheDependency` class.</span></span>

<span data-ttu-id="e9bb3-263">Con il sistema di polling, un `SqlCacheDependency` oggetto deve essere associato a una particolare coppia di database e tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-263">With the polling system, a `SqlCacheDependency` object must be associated with a particular database and table pair.</span></span> <span data-ttu-id="e9bb3-264">Il codice seguente, ad esempio, crea un `SqlCacheDependency` oggetto basato sul database Northwind s `Products` tabella:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-264">The following code, for example, creates a `SqlCacheDependency` object based on the Northwind database s `Products` table:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample10.vb)]

<span data-ttu-id="e9bb3-265">I due parametri di input con il `SqlCacheDependency` costruttore s sono i nomi di database e tabella, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-265">The two input parameters to the `SqlCacheDependency` s constructor are the database and table names, respectively.</span></span> <span data-ttu-id="e9bb3-266">Come con i dispositivi ObjectDataSource `SqlCacheDependency` proprietà, il nome del database utilizzato è identico al valore specificato nel `name` attributo del `<add>` elemento `Web.config`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-266">Like with the ObjectDataSource s `SqlCacheDependency` property, the database name used is the same as the value specified in the `name` attribute of the `<add>` element in `Web.config`.</span></span> <span data-ttu-id="e9bb3-267">Il nome della tabella è il nome effettivo della tabella di database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-267">The table name is the actual name of the database table.</span></span>

<span data-ttu-id="e9bb3-268">Per associare un `SqlCacheDependency` con un elemento aggiunto alla cache dei dati, utilizzare uno del `Insert` overload del metodo che accetta una dipendenza.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-268">To associate a `SqlCacheDependency` with an item added to the data cache, use one of the `Insert` method overloads that accepts a dependency.</span></span> <span data-ttu-id="e9bb3-269">Il codice seguente aggiunge *valore* nella cache di dati per una durata di tempo indefinita, ma associa a un `SqlCacheDependency` sul `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-269">The following code adds *value* to the data cache for an indefinite duration, but associates it with a `SqlCacheDependency` on the `Products` table.</span></span> <span data-ttu-id="e9bb3-270">In breve, *valore* rimane nella cache fino a quando non viene eliminato a causa dei vincoli di memoria o perché il sistema di polling ha rilevato che il `Products` tabella è stata modificata poiché è stato memorizzato nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-270">In short, *value* will remain in the cache until it is evicted due to memory constraints or because the polling system has detected that the `Products` table has changed since it was cached.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample11.vb)]

<span data-ttu-id="e9bb3-271">I dispositivi di memorizzazione nella cache di livello `ProductsCL` classe attualmente memorizza nella cache dati dal `Products` tabella con una scadenza basati sul tempo di 60 secondi.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-271">The Caching Layer s `ProductsCL` class currently caches data from the `Products` table using a time-based expiry of 60 seconds.</span></span> <span data-ttu-id="e9bb3-272">Consente di aggiornare questa classe in modo che utilizzi invece le dipendenze della cache SQL s.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-272">Let s update this class so that it uses SQL cache dependencies instead.</span></span> <span data-ttu-id="e9bb3-273">Il `ProductsCL` classe s `AddCacheItem` metodo, che è responsabile dell'aggiunta dei dati nella cache, attualmente contiene il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-273">The `ProductsCL` class s `AddCacheItem` method, which is responsible for adding the data to the cache, currently contains the following code:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample12.vb)]

<span data-ttu-id="e9bb3-274">Aggiornare il codice per utilizzare un `SqlCacheDependency` oggetto anziché il `MasterCacheKeyArray` della dipendenza dalla cache:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-274">Update this code to use a `SqlCacheDependency` object instead of the `MasterCacheKeyArray` cache dependency:</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample13.vb)]

<span data-ttu-id="e9bb3-275">Per testare questa funzionalità, aggiungere un controllo GridView alla pagina sotto esistente `ProductsDeclarative` GridView.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-275">To test this functionality, add a GridView to the page beneath the existing `ProductsDeclarative` GridView.</span></span> <span data-ttu-id="e9bb3-276">Impostare questo nuovo s GridView `ID` a `ProductsProgrammatic` e, tramite il relativo smart tag, associarlo a un nuovo oggetto ObjectDataSource denominato `ProductsDataSourceProgrammatic`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-276">Set this new GridView s `ID` to `ProductsProgrammatic` and, through its smart tag, bind it to a new ObjectDataSource named `ProductsDataSourceProgrammatic`.</span></span> <span data-ttu-id="e9bb3-277">Configurare ObjectDataSource per utilizzare il `ProductsCL` (classe), l'impostazione di elenchi a discesa selezionare e le schede di aggiornamento per `GetProducts` e `UpdateProduct`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-277">Configure the ObjectDataSource to use the `ProductsCL` class, setting the drop-down lists in the SELECT and UPDATE tabs to `GetProducts` and `UpdateProduct`, respectively.</span></span>


<span data-ttu-id="e9bb3-278">[![Configurare ObjectDataSource per utilizzare la classe ProductsCL](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-278">[![Configure the ObjectDataSource to Use the ProductsCL Class](using-sql-cache-dependencies-vb/_static/image11.gif)](using-sql-cache-dependencies-vb/_static/image15.png)</span></span>

<span data-ttu-id="e9bb3-279">**Figura 11**: configurare ObjectDataSource per usare il `ProductsCL` classe ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image16.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-279">**Figure 11**: Configure the ObjectDataSource to Use the `ProductsCL` Class ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image16.png))</span></span>


<span data-ttu-id="e9bb3-280">[![Selezionare il metodo GetProducts dall'elenco a discesa s scegliere scheda](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-280">[![Select the GetProducts Method from the SELECT Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image12.gif)](using-sql-cache-dependencies-vb/_static/image17.png)</span></span>

<span data-ttu-id="e9bb3-281">**Figura 12**: selezionare il `GetProducts` metodo da s scheda selezionare nell'elenco ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-281">**Figure 12**: Select the `GetProducts` Method from the SELECT Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image18.png))</span></span>


<span data-ttu-id="e9bb3-282">[![Selezionare il metodo UpdateProduct dall'elenco a discesa aggiornamento scheda s](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-282">[![Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List](using-sql-cache-dependencies-vb/_static/image13.gif)](using-sql-cache-dependencies-vb/_static/image19.png)</span></span>

<span data-ttu-id="e9bb3-283">**Figura 13**: scegliere il metodo UpdateProduct da s aggiornamento scheda elenco a discesa ([fare clic per visualizzare l'immagine ingrandita](using-sql-cache-dependencies-vb/_static/image20.png))</span><span class="sxs-lookup"><span data-stu-id="e9bb3-283">**Figure 13**: Choose the UpdateProduct Method from the UPDATE Tab s Drop-Down List ([Click to view full-size image](using-sql-cache-dependencies-vb/_static/image20.png))</span></span>


<span data-ttu-id="e9bb3-284">Dopo aver completato la configurazione guidata origine dati, Visual Studio creerà BoundField e CheckBoxFields in GridView per ognuno dei campi dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-284">After completing the Configure Data Source wizard, Visual Studio will create BoundFields and CheckBoxFields in the GridView for each of the data fields.</span></span> <span data-ttu-id="e9bb3-285">Ad esempio con il primo GridView aggiunti in questa pagina, rimuovere tutti i campi ma `ProductName`, `CategoryName`, e `UnitPrice`e formattare questi campi in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-285">Like with the first GridView added to this page, remove all fields but `ProductName`, `CategoryName`, and `UnitPrice`, and format these fields as you see fit.</span></span> <span data-ttu-id="e9bb3-286">Dalla GridView s smart tag, selezionare le caselle di controllo Abilita Paging, abilitare ordinamento e abilitare la modifica.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-286">From the GridView s smart tag, check the Enable Paging, Enable Sorting, and Enable Editing checkboxes.</span></span> <span data-ttu-id="e9bb3-287">Come con la `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio verrà impostato il `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` proprietà `original_{0}`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-287">As with the `ProductsDataSourceDeclarative` ObjectDataSource, Visual Studio will set the `ProductsDataSourceProgrammatic` ObjectDataSource s `OldValuesParameterFormatString` property to `original_{0}`.</span></span> <span data-ttu-id="e9bb3-288">Affinché la funzionalità di modifica GridView s per il corretto funzionamento, impostare questa proprietà eseguire `{0}` (o rimuovere l'assegnazione di proprietà con la sintassi dichiarativa completamente).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-288">In order for the GridView s edit feature to work properly, set this property back to `{0}` (or remove the property assignment from the declarative syntax altogether).</span></span>

<span data-ttu-id="e9bb3-289">Dopo aver completato queste attività, il markup dichiarativo GridView e ObjectDataSource risulta dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-289">After completing these tasks, the resulting GridView and ObjectDataSource declarative markup should look like the following:</span></span>


[!code-aspx[Main](using-sql-cache-dependencies-vb/samples/sample14.aspx)]

<span data-ttu-id="e9bb3-290">Per testare il codice SQL dipendenza della cache nel livello di memorizzazione nella cache imposta un punto di interruzione nel `ProductCL` classe s `AddCacheItem` metodo e quindi avvia il debug.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-290">To test the SQL cache dependency in the Caching Layer set a breakpoint in the `ProductCL` class s `AddCacheItem` method and then start debugging.</span></span> <span data-ttu-id="e9bb3-291">Quando si visita prima `SqlCacheDependencies.aspx`, il punto di interruzione verrà raggiunto come dati sono richiesto per la prima volta e inseriti nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-291">When you first visit `SqlCacheDependencies.aspx`, the breakpoint should be hit as the data is requested for the first time and placed into the cache.</span></span> <span data-ttu-id="e9bb3-292">Successivamente, spostare in un'altra pagina in GridView o ordinare una delle colonne.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-292">Next, move to another page in the GridView or sort one of the columns.</span></span> <span data-ttu-id="e9bb3-293">In questo modo, il controllo GridView rieseguire una query dei dati, ma devono trovare i dati nella cache dopo il `Products` tabella di database non è stata modificata.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-293">This causes the GridView to requery its data, but the data should be found in the cache since the `Products` database table has not been modified.</span></span> <span data-ttu-id="e9bb3-294">Se i dati più volte non viene trovati nella cache, assicurarsi che nel computer sia disponibile memoria sufficiente e ripetere l'operazione.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-294">If the data is repeatedly not found in the cache, make sure there is sufficient memory available on your computer and try again.</span></span>

<span data-ttu-id="e9bb3-295">Dopo aver paging alcune pagine di GridView, aprire una seconda finestra del browser e passare all'Esercitazione nozioni di base in modalità di modifica, inserimento ed eliminazione di sezione (`~/EditInsertDelete/Basics.aspx`).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-295">After paging through a few pages of the GridView, open a second browser window and navigate to the Basics tutorial in the Editing, Inserting, and Deleting section (`~/EditInsertDelete/Basics.aspx`).</span></span> <span data-ttu-id="e9bb3-296">Aggiornare un record dalla tabella Products e quindi, dalla finestra del browser prima di visualizzare una nuova pagina oppure fare clic su una delle intestazioni di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-296">Update a record from the Products table and then, from the first browser window, view a new page or click on one of the sorting headers.</span></span>

<span data-ttu-id="e9bb3-297">In questo scenario verrà visualizzato uno dei due elementi: un punto di interruzione verrà raggiunto, che indica che i dati memorizzati nella cache è stati eliminati a causa della modifica nel database. In alternativa, il punto di interruzione non verrà raggiunto, il che significa che `SqlCacheDependencies.aspx` è ora in dati non aggiornati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-297">In this scenario you will see one of two things: either the breakpoint will be hit, indicating that the cached data was evicted due to the change in the database; or, the breakpoint will not be hit, meaning that `SqlCacheDependencies.aspx` is now showing stale data.</span></span> <span data-ttu-id="e9bb3-298">Se non è stato raggiunto il punto di interruzione, è probabile perché il servizio di polling non ancora generato dalla modifica dei dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-298">If the breakpoint is not hit, it is likely because the polling service has not yet fired since the data was changed.</span></span> <span data-ttu-id="e9bb3-299">Tenere presente che il servizio di polling è il controllo per le modifiche di `Products` tabella ogni `pollTime` millisecondi, pertanto si verifica un ritardo tra quando i dati sottostanti vengono aggiornati e quando viene eliminati i dati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-299">Remember that the polling service is checking for changes to the `Products` table every `pollTime` milliseconds, so there is a delay between when the underlying data is updated and when the cached data is evicted.</span></span>

> [!NOTE]
> <span data-ttu-id="e9bb3-300">Questo ritardo è più probabile che venga visualizzato quando si modifica uno dei prodotti tramite GridView in `SqlCacheDependencies.aspx`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-300">This delay is more likely to appear when editing one of the products through the GridView in `SqlCacheDependencies.aspx`.</span></span> <span data-ttu-id="e9bb3-301">Nel [memorizzazione dei dati nell'architettura](caching-data-in-the-architecture-vb.md) esercitazione è stato aggiunto il `MasterCacheKeyArray` della dipendenza per garantire che i dati da modificare tramite dalla cache di `ProductsCL` classe s `UpdateProduct` metodo è stato rimosso dalla cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-301">In the [Caching Data in the Architecture](caching-data-in-the-architecture-vb.md) tutorial we added the `MasterCacheKeyArray` cache dependency to ensure that the data being edited through the `ProductsCL` class s `UpdateProduct` method was evicted from the cache.</span></span> <span data-ttu-id="e9bb3-302">Tuttavia, pertanto abbiamo sostituito questa dipendenza della cache quando si modifica il `AddCacheItem` metodo più indietro in questo passaggio e pertanto il `ProductsCL` classe continuerà a visualizzare i dati memorizzati nella cache fino a quando il sistema di polling note per la modifica di `Products` tabella.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-302">However, we replaced this cache dependency when modifying the `AddCacheItem` method earlier in this step and therefore the `ProductsCL` class will continue to show the cached data until the polling system notes the change to the `Products` table.</span></span> <span data-ttu-id="e9bb3-303">Vedremo come ripristinare il `MasterCacheKeyArray` dipendenza nel passaggio 7 di memorizzare nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-303">We'll see how to reintroduce the `MasterCacheKeyArray` cache dependency in Step 7.</span></span>


## <a name="step-7-associating-multiple-dependencies-with-a-cached-item"></a><span data-ttu-id="e9bb3-304">Passaggio 7: Associazione di più dipendenze con un elemento memorizzato nella cache</span><span class="sxs-lookup"><span data-stu-id="e9bb3-304">Step 7: Associating Multiple Dependencies with a Cached Item</span></span>

<span data-ttu-id="e9bb3-305">Tenere presente che il `MasterCacheKeyArray` dipendenza della cache viene utilizzata per garantire che *tutti* dati relativi al prodotto viene rimossa dalla cache quando viene aggiornato un elemento associato all'interno di esso.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-305">Recall that the `MasterCacheKeyArray` cache dependency is used to ensure that *all* product-related data is evicted from the cache when any single item associated within it is updated.</span></span> <span data-ttu-id="e9bb3-306">Ad esempio, il `GetProductsByCategoryID(categoryID)` metodo cache `ProductsDataTables` istanze per ogni univoco *categoryID* valore.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-306">For example, the `GetProductsByCategoryID(categoryID)` method caches `ProductsDataTables` instances for each unique *categoryID* value.</span></span> <span data-ttu-id="e9bb3-307">Se uno di questi oggetti viene rimosso, il `MasterCacheKeyArray` dipendenza della cache garantisce che gli altri vengono rimossi.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-307">If one of these objects is evicted, the `MasterCacheKeyArray` cache dependency ensures that the others are also removed.</span></span> <span data-ttu-id="e9bb3-308">Senza questa dipendenza della cache, quando vengono modificati i dati memorizzati nella cache esiste la possibilità che altri dati memorizzati nella cache del prodotto potrebbero non essere aggiornati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-308">Without this cache dependency, when the cached data is modified the possibility exists that other cached product data may be out of date.</span></span> <span data-ttu-id="e9bb3-309">Di conseguenza, è importante mantenere è s il `MasterCacheKeyArray` della dipendenza dalla cache, quando si utilizzano le dipendenze della cache SQL.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-309">Consequently, it s important that we maintain the `MasterCacheKeyArray` cache dependency when using SQL cache dependencies.</span></span> <span data-ttu-id="e9bb3-310">Tuttavia, i dati nella cache s `Insert` metodo consente solo per un oggetto di dipendenza.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-310">However, the data cache s `Insert` method only allows for a single dependency object.</span></span>

<span data-ttu-id="e9bb3-311">Inoltre, quando si lavora con le dipendenze della cache SQL è possibile che sia necessario associare più tabelle di database come dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-311">Furthermore, when working with SQL cache dependencies we may need to associate multiple database tables as dependencies.</span></span> <span data-ttu-id="e9bb3-312">Ad esempio, il `ProductsDataTable` nella cache il `ProductsCL` classe contiene i nomi di categoria e il fornitore per ogni prodotto, ma la `AddCacheItem` metodo utilizza solo una dipendenza su `Products`.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-312">For example, the `ProductsDataTable` cached in the `ProductsCL` class contains the category and supplier names for each product, but the `AddCacheItem` method only uses a dependency on `Products`.</span></span> <span data-ttu-id="e9bb3-313">In questo caso, se l'utente aggiorna il nome di una categoria o il fornitore, i dati memorizzati nella cache del prodotto rimarrà nella cache e non essere aggiornata.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-313">In this situation, if the user updates the name of a category or supplier, the cached product data will remain in the cache and be out of date.</span></span> <span data-ttu-id="e9bb3-314">Pertanto, con cui si desidera che i dati memorizzati nella cache del prodotto dipende non solo il `Products` tabella, ma nel `Categories` e `Suppliers` nonché tabelle.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-314">Therefore, we want to make the cached product data dependent on not only the `Products` table, but on the `Categories` and `Suppliers` tables as well.</span></span>

<span data-ttu-id="e9bb3-315">Il [ `AggregateCacheDependency` classe](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) fornisce un mezzo per l'associazione di più dipendenze con un elemento della cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-315">The [`AggregateCacheDependency` class](https://msdn.microsoft.com/library/system.web.caching.aggregatecachedependency.aspx) provides a means for associating multiple dependencies with a cache item.</span></span> <span data-ttu-id="e9bb3-316">Iniziare creando un `AggregateCacheDependency` istanza.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-316">Start by creating an `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="e9bb3-317">Successivamente, aggiungere il set di dipendenze mediante il `AggregateCacheDependency` s `Add` metodo.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-317">Next, add the set of dependencies using the `AggregateCacheDependency` s `Add` method.</span></span> <span data-ttu-id="e9bb3-318">Quando si inserisce l'elemento nella cache di dati in seguito, passare il `AggregateCacheDependency` istanza.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-318">When inserting the item into the data cache thereafter, pass in the `AggregateCacheDependency` instance.</span></span> <span data-ttu-id="e9bb3-319">Quando *qualsiasi* del `AggregateCacheDependency` istanza s dipendenze vengono modificate, l'elemento memorizzato nella cache verrà eliminato.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-319">When *any* of the `AggregateCacheDependency` instance s dependencies change, the cached item will be evicted.</span></span>

<span data-ttu-id="e9bb3-320">Di seguito è riportato il codice aggiornato per il `ProductsCL` classe s `AddCacheItem` metodo.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-320">The following shows the updated code for the `ProductsCL` class s `AddCacheItem` method.</span></span> <span data-ttu-id="e9bb3-321">Il metodo crea il `MasterCacheKeyArray` cache dipendenza insieme a `SqlCacheDependency` gli oggetti per il `Products`, `Categories`, e `Suppliers` tabelle.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-321">The method creates the `MasterCacheKeyArray` cache dependency along with `SqlCacheDependency` objects for the `Products`, `Categories`, and `Suppliers` tables.</span></span> <span data-ttu-id="e9bb3-322">Queste sono combinate tutte in un unico `AggregateCacheDependency` oggetto denominato `aggregateDependencies`, che viene quindi passato il `Insert` metodo.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-322">These are all combined into one `AggregateCacheDependency` object named `aggregateDependencies`, which is then passed into the `Insert` method.</span></span>


[!code-vb[Main](using-sql-cache-dependencies-vb/samples/sample15.vb)]

<span data-ttu-id="e9bb3-323">Testare il nuovo codice di uscita. Viene visualizzata la `Products`, `Categories`, o `Suppliers` tabelle causano il rimozione dei dati memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-323">Test this new code out. Now changes to the `Products`, `Categories`, or `Suppliers` tables cause the cached data to be evicted.</span></span> <span data-ttu-id="e9bb3-324">Inoltre, il `ProductsCL` classe s `UpdateProduct` metodo, che viene chiamato durante la modifica di un prodotto tramite il controllo GridView, rimuove il `MasterCacheKeyArray` della dipendenza, provocando memorizzato nella cache dalla cache `ProductsDataTable` da rimuovere e i dati da recuperare nuovamente al successivo richiesta.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-324">Moreover, the `ProductsCL` class s `UpdateProduct` method, which is called when editing a product through the GridView, evicts the `MasterCacheKeyArray` cache dependency, which causes the cached `ProductsDataTable` to be evicted and the data to be re-retrieved on the next request.</span></span>

> [!NOTE]
> <span data-ttu-id="e9bb3-325">Dipendenze della cache SQL utilizzabili con [la memorizzazione nella cache di output](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-325">SQL cache dependencies can also be used with [output caching](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/caching/output.aspx).</span></span> <span data-ttu-id="e9bb3-326">Per una dimostrazione di questa funzionalità, vedere: [con cache di Output ASP.NET con SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-326">For a demonstration of this functionality, see: [Using ASP.NET Output Caching with SQL Server](https://msdn.microsoft.com/library/e3w8402y(VS.80).aspx).</span></span>


## <a name="summary"></a><span data-ttu-id="e9bb3-327">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="e9bb3-327">Summary</span></span>

<span data-ttu-id="e9bb3-328">Quando la memorizzazione nella cache dei dati del database, i dati in teoria rimangono nella cache fino a quando non viene modificata nel database.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-328">When caching database data, the data will ideally remain in the cache until it is modified in the database.</span></span> <span data-ttu-id="e9bb3-329">Con ASP.NET 2.0, le dipendenze della cache SQL possono essere create e utilizzate in scenari dichiarativi sia a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-329">With ASP.NET 2.0, SQL cache dependencies can be created and used in both declarative and programmatic scenarios.</span></span> <span data-ttu-id="e9bb3-330">Uno dei problemi con questo approccio è scoprire quando sono stati modificati i dati.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-330">One of the challenges with this approach is in discovering when the data has been modified.</span></span> <span data-ttu-id="e9bb3-331">Le versioni complete di Microsoft SQL Server 2005 forniscono le funzionalità di notifica che possono inviare un avviso un'applicazione quando viene modificato un risultato della query.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-331">The full versions of Microsoft SQL Server 2005 provide notification capabilities that can alert an application when a query result has changed.</span></span> <span data-ttu-id="e9bb3-332">Per la Express Edition di SQL Server 2005 e versioni precedenti di SQL Server, è invece necessario utilizzare un sistema di polling.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-332">For the Express Edition of SQL Server 2005 and older versions of SQL Server, a polling system must be used instead.</span></span> <span data-ttu-id="e9bb3-333">Configurazione dell'infrastruttura necessarie polling Fortunatamente, è piuttosto semplice.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-333">Fortunately, setting up the necessary polling infrastructure is fairly straightforward.</span></span>

<span data-ttu-id="e9bb3-334">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="e9bb3-334">Happy Programming!</span></span>

## <a name="further-reading"></a><span data-ttu-id="e9bb3-335">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="e9bb3-335">Further Reading</span></span>

<span data-ttu-id="e9bb3-336">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="e9bb3-336">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="e9bb3-337">Utilizzando le notifiche delle Query in Microsoft SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="e9bb3-337">Using Query Notifications in Microsoft SQL Server 2005</span></span>](https://msdn.microsoft.com/library/ms175110.aspx)
- [<span data-ttu-id="e9bb3-338">Creazione di una notifica di Query</span><span class="sxs-lookup"><span data-stu-id="e9bb3-338">Creating a Query Notification</span></span>](https://msdn.microsoft.com/library/ms188669.aspx)
- <span data-ttu-id="e9bb3-339">[La memorizzazione nella cache di ASP.NET con il `SqlCacheDependency` (classe)](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-339">[Caching in ASP.NET with the `SqlCacheDependency` Class](https://msdn.microsoft.com/library/ms178604(VS.80).aspx)</span></span>
- <span data-ttu-id="e9bb3-340">[Strumento di registrazione di ASP.NET SQL Server (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-340">[ASP.NET SQL Server Registration Tool (`aspnet_regsql.exe`)](https://msdn.microsoft.com/library/ms229862(vs.80).aspx)</span></span>
- [<span data-ttu-id="e9bb3-341">Panoramica di `SqlCacheDependency`</span><span class="sxs-lookup"><span data-stu-id="e9bb3-341">Overview of `SqlCacheDependency`</span></span>](http://www.aspnetresources.com/blog/sql_cache_depedency_overview.aspx)

## <a name="about-the-author"></a><span data-ttu-id="e9bb3-342">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="e9bb3-342">About the Author</span></span>

<span data-ttu-id="e9bb3-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-343">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="e9bb3-344">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-344">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="e9bb3-345">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-345">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="e9bb3-346">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="e9bb3-346">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="e9bb3-347">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="e9bb3-347">Special Thanks To</span></span>

<span data-ttu-id="e9bb3-348">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-348">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="e9bb3-349">Lead revisori per questa esercitazione sono stati Marko Rangel Teresa Murphy e Hilton Giesenow.</span><span class="sxs-lookup"><span data-stu-id="e9bb3-349">Lead reviewers for this tutorial were Marko Rangel, Teresa Murphy, and Hilton Giesenow.</span></span> <span data-ttu-id="e9bb3-350">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="e9bb3-350">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="e9bb3-351">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="e9bb3-351">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> [<span data-ttu-id="e9bb3-352">Precedente</span><span class="sxs-lookup"><span data-stu-id="e9bb3-352">Previous</span></span>](caching-data-at-application-startup-vb.md)

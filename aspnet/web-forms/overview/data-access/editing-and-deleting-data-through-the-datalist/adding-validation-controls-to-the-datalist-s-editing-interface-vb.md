---
uid: web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
title: Aggiunta di controlli di convalida a DataList di modifica della interfaccia (VB) | Documenti Microsoft
author: rick-anderson
description: In questa esercitazione si vedrà quanto sia facile aggiungere i controlli di convalida EditItemTemplate del controllo DataList per fornire un int. utente di modifica più infallibile...
ms.author: aspnetcontent
manager: wpickett
ms.date: 10/30/2006
ms.topic: article
ms.assetid: 6b073fc6-524d-453d-be7c-0c30986de391
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/data-access/editing-and-deleting-data-through-the-datalist/adding-validation-controls-to-the-datalist-s-editing-interface-vb
msc.type: authoredcontent
ms.openlocfilehash: 46ff0b18c1ea24dd73c9e3034c1b5e53f2e6d0c2
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="adding-validation-controls-to-the-datalists-editing-interface-vb"></a><span data-ttu-id="20a5b-103">Aggiunta di controlli di convalida per l'interfaccia di modifica del controllo DataList (VB)</span><span class="sxs-lookup"><span data-stu-id="20a5b-103">Adding Validation Controls to the DataList's Editing Interface (VB)</span></span>
====================
<span data-ttu-id="20a5b-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="20a5b-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="20a5b-105">[Scaricare App di esempio](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) o [Scarica il PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span><span class="sxs-lookup"><span data-stu-id="20a5b-105">[Download Sample App](http://download.microsoft.com/download/9/c/1/9c1d03ee-29ba-4d58-aa1a-f201dcc822ea/ASPNET_Data_Tutorial_39_VB.exe) or [Download PDF](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/datatutorial39vb1.pdf)</span></span>

> <span data-ttu-id="20a5b-106">In questa esercitazione verranno esaminati quanto sia facile aggiungere i controlli di convalida EditItemTemplate del controllo DataList per fornire un'interfaccia utente di modifica più infallibile.</span><span class="sxs-lookup"><span data-stu-id="20a5b-106">In this tutorial we'll see how easy it is to add validation controls to the DataList's EditItemTemplate in order to provide a more foolproof editing user interface.</span></span>


## <a name="introduction"></a><span data-ttu-id="20a5b-107">Introduzione</span><span class="sxs-lookup"><span data-stu-id="20a5b-107">Introduction</span></span>

<span data-ttu-id="20a5b-108">In DataList modifica finora esercitazioni, la modifica delle interfacce di DataList non includono alcuna convalida dell'input utente attiva anche se l'input utente non valido, ad esempio un nome di prodotto mancanti o i risultati di prezzo negativo di un'eccezione.</span><span class="sxs-lookup"><span data-stu-id="20a5b-108">In the DataList editing tutorials thus far, the DataLists editing interfaces have not included any proactive user input validation even though invalid user input such as a missing product name or negative price results in an exception.</span></span> <span data-ttu-id="20a5b-109">Nel [esercitazione precedente](handling-bll-and-dal-level-exceptions-vb.md) abbiamo esaminato come aggiungere codice per il controllo DataList s di gestione delle eccezioni `UpdateCommand` gestore eventi per rilevare e normalmente visualizzare informazioni su tutte le eccezioni che sono stati generati.</span><span class="sxs-lookup"><span data-stu-id="20a5b-109">In the [preceding tutorial](handling-bll-and-dal-level-exceptions-vb.md) we examined how to add exception handling code to the DataList s `UpdateCommand` event handler in order to catch and gracefully display information about any exceptions that were raised.</span></span> <span data-ttu-id="20a5b-110">Idealmente, l'interfaccia di modifica include tuttavia i controlli di convalida per impedire un utente di immettere in primo luogo tali dati non validi.</span><span class="sxs-lookup"><span data-stu-id="20a5b-110">Ideally, however, the editing interface would include validation controls to prevent a user from entering such invalid data in the first place.</span></span>

<span data-ttu-id="20a5b-111">In questa esercitazione si vedrà quanto sia facile aggiungere i controlli di convalida a DataList s `EditItemTemplate` per fornire un'interfaccia utente di modifica più infallibile.</span><span class="sxs-lookup"><span data-stu-id="20a5b-111">In this tutorial we'll see how easy it is to add validation controls to the DataList s `EditItemTemplate` in order to provide a more foolproof editing user interface.</span></span> <span data-ttu-id="20a5b-112">In particolare, in questa esercitazione accetta nell'esempio viene creato nell'esercitazione precedente e aggiunge l'interfaccia di modifica per includere la convalida appropriata.</span><span class="sxs-lookup"><span data-stu-id="20a5b-112">Specifically, this tutorial takes the example created in the preceding tutorial and augments the editing interface to include appropriate validation.</span></span>

## <a name="step-1-replicating-the-example-fromhandling-bll--and-dal-level-exceptionshandling-bll-and-dal-level-exceptions-vbmd"></a><span data-ttu-id="20a5b-113">Passaggio 1: La replica di esempio dal[la gestione delle eccezioni BLL e DAL livello](handling-bll-and-dal-level-exceptions-vb.md)</span><span class="sxs-lookup"><span data-stu-id="20a5b-113">Step 1: Replicating the Example from[Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md)</span></span>

<span data-ttu-id="20a5b-114">Nel [BLL - gestione e le eccezioni di livello DAL](handling-bll-and-dal-level-exceptions-vb.md) esercitazione è stata creata una pagina elencati i nomi e i prezzi dei prodotti in un controllo DataList due colonne, modificabile.</span><span class="sxs-lookup"><span data-stu-id="20a5b-114">In the [Handling BLL- and DAL-Level Exceptions](handling-bll-and-dal-level-exceptions-vb.md) tutorial we created a page that listed the names and prices of the products in a two-column, editable DataList.</span></span> <span data-ttu-id="20a5b-115">L'obiettivo di questa esercitazione è per aumentare l'interfaccia di modifica s DataList per includere i controlli di convalida.</span><span class="sxs-lookup"><span data-stu-id="20a5b-115">Our goal for this tutorial is to augment the DataList s editing interface to include validation controls.</span></span> <span data-ttu-id="20a5b-116">In particolare, la logica di convalida sarà:</span><span class="sxs-lookup"><span data-stu-id="20a5b-116">In particular, our validation logic will:</span></span>

- <span data-ttu-id="20a5b-117">Che è necessario specificare il nome del prodotto s</span><span class="sxs-lookup"><span data-stu-id="20a5b-117">Require that the product s name be provided</span></span>
- <span data-ttu-id="20a5b-118">Verificare che il valore immesso per il prezzo è un formato di valuta validi</span><span class="sxs-lookup"><span data-stu-id="20a5b-118">Ensure that the value entered for the price is a valid currency format</span></span>
- <span data-ttu-id="20a5b-119">Assicurarsi che il valore immesso per il prezzo è maggiore o uguale a zero, a partire da un valore negativo `UnitPrice` valore non è valido</span><span class="sxs-lookup"><span data-stu-id="20a5b-119">Ensure that the value entered for the price is greater than or equal to zero, since a negative `UnitPrice` value is illegal</span></span>

<span data-ttu-id="20a5b-120">Prima di poter esaminare in modo da integrare l'esempio precedente per includere la convalida, è innanzitutto necessario replicare l'esempio dal `ErrorHandling.aspx` nella pagina di `EditDeleteDataList` cartella alla pagina per questa esercitazione, `UIValidation.aspx`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-120">Before we can look at augmenting the previous example to include validation, we first need to replicate the example from the `ErrorHandling.aspx` page in the `EditDeleteDataList` folder to the page for this tutorial, `UIValidation.aspx`.</span></span> <span data-ttu-id="20a5b-121">A tale scopo è necessario copiare sia la `ErrorHandling.aspx` pagina dichiarativo s e il relativo codice sorgente.</span><span class="sxs-lookup"><span data-stu-id="20a5b-121">To achieve this we need to copy over both the `ErrorHandling.aspx` page s declarative markup and its source code.</span></span> <span data-ttu-id="20a5b-122">Copiare innanzitutto il markup dichiarativo eseguendo i passaggi seguenti:</span><span class="sxs-lookup"><span data-stu-id="20a5b-122">First copy over the declarative markup by performing the following steps:</span></span>

1. <span data-ttu-id="20a5b-123">Aprire il `ErrorHandling.aspx` pagina in Visual Studio</span><span class="sxs-lookup"><span data-stu-id="20a5b-123">Open the `ErrorHandling.aspx` page in Visual Studio</span></span>
2. <span data-ttu-id="20a5b-124">Passare alla pagina s dichiarativo (fare clic sul pulsante nella parte inferiore della pagina di origine)</span><span class="sxs-lookup"><span data-stu-id="20a5b-124">Go to the page s declarative markup (click on the Source button at the bottom of the page)</span></span>
3. <span data-ttu-id="20a5b-125">Copiare il testo all'interno di `<asp:Content>` e `</asp:Content>` tag (righe 3 e 32), come illustrato nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="20a5b-125">Copy the text within the `<asp:Content>` and `</asp:Content>` tags (lines 3 through 32), as shown in Figure 1.</span></span>


<span data-ttu-id="20a5b-126">[![Copiare il testo all'interno del &lt;asp: Content&gt; controllo](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-126">[![Copy the Text Within the &lt;asp:Content&gt; Control](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image2.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image1.png)</span></span>

<span data-ttu-id="20a5b-127">**Figura 2**: copiare il testo all'interno del `<asp:Content>` controllo ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-127">**Figure 2**: Copy the Text Within the `<asp:Content>` Control ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image3.png))</span></span>


1. <span data-ttu-id="20a5b-128">Aprire il `UIValidation.aspx` pagina</span><span class="sxs-lookup"><span data-stu-id="20a5b-128">Open the `UIValidation.aspx` page</span></span>
2. <span data-ttu-id="20a5b-129">Passare al codice dichiarativo pagina s</span><span class="sxs-lookup"><span data-stu-id="20a5b-129">Go to the page s declarative markup</span></span>
3. <span data-ttu-id="20a5b-130">Incollare il testo all'interno di `<asp:Content>` controllo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-130">Paste the text within the `<asp:Content>` control.</span></span>

<span data-ttu-id="20a5b-131">Per copiare il codice sorgente, aprire il `ErrorHandling.aspx.vb` pagina e copiare solo il testo *all'interno di* la `EditDeleteDataList_ErrorHandling` classe.</span><span class="sxs-lookup"><span data-stu-id="20a5b-131">To copy over the source code, open the `ErrorHandling.aspx.vb` page and copy just the text *within* the `EditDeleteDataList_ErrorHandling` class.</span></span> <span data-ttu-id="20a5b-132">Copiare i tre gestori eventi (`Products_EditCommand`, `Products_CancelCommand`, e `Products_UpdateCommand`) insieme al `DisplayExceptionDetails` (metodo), ma non **non** copiare la dichiarazione di classe o `using` istruzioni.</span><span class="sxs-lookup"><span data-stu-id="20a5b-132">Copy the three event handlers (`Products_EditCommand`, `Products_CancelCommand`, and `Products_UpdateCommand`) along with the `DisplayExceptionDetails` method, but do **not** copy the class declaration or `using` statements.</span></span> <span data-ttu-id="20a5b-133">Incollare il testo copiato *all'interno di* il `EditDeleteDataList_UIValidation` classe `UIValidation.aspx.vb`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-133">Paste the copied text *within* the `EditDeleteDataList_UIValidation` class in `UIValidation.aspx.vb`.</span></span>

<span data-ttu-id="20a5b-134">Dopo avere spostato il contenuto e il codice da `ErrorHandling.aspx` a `UIValidation.aspx`, dedicare alcuni minuti per testare le pagine in un browser.</span><span class="sxs-lookup"><span data-stu-id="20a5b-134">After moving over the content and code from `ErrorHandling.aspx` to `UIValidation.aspx`, take a moment to test out the pages in a browser.</span></span> <span data-ttu-id="20a5b-135">Vedere lo stesso output e che si verifichi la stessa funzionalità in ognuna di queste due pagine (vedere la figura 2).</span><span class="sxs-lookup"><span data-stu-id="20a5b-135">You should see the same output and experience the same functionality in each of these two pages (see Figure 2).</span></span>


<span data-ttu-id="20a5b-136">[![La pagina UIValidation.aspx riproduce la funzionalità in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-136">[![The UIValidation.aspx Page Mimics the Functionality in ErrorHandling.aspx](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image5.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image4.png)</span></span>

<span data-ttu-id="20a5b-137">**Figura 2**: il `UIValidation.aspx` pagina riproduce la funzionalità in `ErrorHandling.aspx` ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-137">**Figure 2**: The `UIValidation.aspx` Page Mimics the Functionality in `ErrorHandling.aspx` ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image6.png))</span></span>


## <a name="step-2-adding-the-validation-controls-to-the-datalist-s-edititemtemplate"></a><span data-ttu-id="20a5b-138">Passaggio 2: Aggiunta di controlli di convalida a EditItemTemplate s DataList</span><span class="sxs-lookup"><span data-stu-id="20a5b-138">Step 2: Adding the Validation Controls to the DataList s EditItemTemplate</span></span>

<span data-ttu-id="20a5b-139">Quando si crea il form di immissione dati, è importante che gli utenti immettere tutti i campi obbligatori e che tutti gli input forniti sono valori validi, formattato correttamente.</span><span class="sxs-lookup"><span data-stu-id="20a5b-139">When constructing data entry forms, it is important that users enter any required fields and that all their provided inputs are legal, properly-formatted values.</span></span> <span data-ttu-id="20a5b-140">Per garantire che un input s utente sono validi, ASP.NET fornisce cinque i controlli di convalida incorporate che sono progettati per convalidare il valore di un singolo controllo Web di input:</span><span class="sxs-lookup"><span data-stu-id="20a5b-140">To help ensure that a user s inputs are valid, ASP.NET provides five built-in validation controls that are designed to validate the value of a single input Web control:</span></span>

- <span data-ttu-id="20a5b-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) assicura che è stato fornito un valore</span><span class="sxs-lookup"><span data-stu-id="20a5b-141">[RequiredFieldValidator](https://msdn.microsoft.com/library/5hbw267h(VS.80).aspx) ensures that a value has been provided</span></span>
- <span data-ttu-id="20a5b-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) convalida un valore rispetto a un altro valore di controllo Web o un valore costante o assicura che il formato del valore s sia valido per un tipo di dati specificato</span><span class="sxs-lookup"><span data-stu-id="20a5b-142">[CompareValidator](https://msdn.microsoft.com/library/db330ayw(VS.80).aspx) validates a value against another Web control value or a constant value, or ensures that the value s format is legal for a specified data type</span></span>
- <span data-ttu-id="20a5b-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) assicura che un valore sia all'interno di un intervallo di valori</span><span class="sxs-lookup"><span data-stu-id="20a5b-143">[RangeValidator](https://msdn.microsoft.com/library/f70d09xt.aspx) ensures that a value is within a range of values</span></span>
- <span data-ttu-id="20a5b-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) convalida un valore rispetto a un [espressioni regolari](http://en.wikipedia.org/wiki/Regular_expression)</span><span class="sxs-lookup"><span data-stu-id="20a5b-144">[RegularExpressionValidator](https://msdn.microsoft.com/library/eahwtc9e.aspx) validates a value against a [regular expression](http://en.wikipedia.org/wiki/Regular_expression)</span></span>
- <span data-ttu-id="20a5b-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) convalida un valore rispetto a un metodo personalizzato definito dall'utente</span><span class="sxs-lookup"><span data-stu-id="20a5b-145">[CustomValidator](https://msdn.microsoft.com/library/9eee01cx(VS.80).aspx) validates a value against a custom, user-defined method</span></span>

<span data-ttu-id="20a5b-146">Per ulteriori informazioni su questi cinque controlli si riferiscono nuovamente al [aggiunta di controlli di convalida per la modifica e inserimento di interfacce](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) esercitazione o check-out di [sezione relativa ai controlli di convalida](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) del [Esercitazioni delle Guide rapide ASP.NET](https://quickstarts.asp.net).</span><span class="sxs-lookup"><span data-stu-id="20a5b-146">For more information on these five controls refer back to the [Adding Validation Controls to the Editing and Inserting Interfaces](../editing-inserting-and-deleting-data/adding-validation-controls-to-the-editing-and-inserting-interfaces-vb.md) tutorial or check out the [Validation Controls section](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/ctrlref/validation/default.aspx) of the [ASP.NET Quickstart Tutorials](https://quickstarts.asp.net).</span></span>

<span data-ttu-id="20a5b-147">Per questa esercitazione è necessario utilizzare RequiredFieldValidator per garantire che è stato fornito un valore per il nome del prodotto e un controllo CompareValidator per assicurarsi che il prezzo immesso con un valore maggiore o uguale a 0 e verrà presentato in un formato di valuta validi.</span><span class="sxs-lookup"><span data-stu-id="20a5b-147">For our tutorial we'll need to use a RequiredFieldValidator to ensure that a value for the product name has been supplied and a CompareValidator to ensure that the entered price has a value greater than or equal to 0 and is presented in a valid currency format.</span></span>

> [!NOTE]
> <span data-ttu-id="20a5b-148">Mentre ASP.NET 1. x era questi stessi controlli di convalida di cinque, ASP.NET 2.0 ha aggiunto una serie di miglioramenti, principale due script sul lato client da supportare per browser oltre a Internet Explorer e la possibilità di controlli di convalida di partizione in una pagina in gruppi di convalida.</span><span class="sxs-lookup"><span data-stu-id="20a5b-148">While ASP.NET 1.x had these same five validation controls, ASP.NET 2.0 has added a number of improvements, the main two being client-side script support for browsers in addition to Internet Explorer and the ability to partition validation controls on a page into validation groups.</span></span> <span data-ttu-id="20a5b-149">Per ulteriori informazioni sulle nuove funzionalità di controllo di convalida in 2.0, fare riferimento a [Sezionando i controlli di convalida in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a5b-149">For more information on the new validation control features in 2.0, refer to [Dissecting the Validation Controls in ASP.NET 2.0](http://aspnet.4guysfromrolla.com/articles/112305-1.aspx).</span></span>


<span data-ttu-id="20a5b-150">Consente di iniziare, aggiungere i controlli di convalida necessari per DataList s s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-150">Let s start by adding the necessary validation controls to the DataList s `EditItemTemplate`.</span></span> <span data-ttu-id="20a5b-151">Questa attività può essere eseguita tramite la finestra di progettazione facendo clic sul collegamento Modifica modelli dal tag smart s DataList o tramite la sintassi dichiarativa.</span><span class="sxs-lookup"><span data-stu-id="20a5b-151">This task can be performed through the Designer by clicking on the Edit Templates link from the DataList s smart tag, or through the declarative syntax.</span></span> <span data-ttu-id="20a5b-152">Consentire il passaggio s tramite il processo utilizzando l'opzione di modifica modelli dalla visualizzazione progettazione.</span><span class="sxs-lookup"><span data-stu-id="20a5b-152">Let s step through the process using the Edit Templates option from the Design view.</span></span> <span data-ttu-id="20a5b-153">Dopo aver scelto di modificare DataList s `EditItemTemplate`, aggiungere un controllo RequiredFieldValidator trascinandolo dalla casella degli strumenti all'interfaccia di modifica del modello, posizionarlo dopo il `ProductName` casella di testo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-153">After choosing to edit the DataList s `EditItemTemplate`, add a RequiredFieldValidator by dragging it from the Toolbox into the template editing interface, placing it after the `ProductName` TextBox.</span></span>


<span data-ttu-id="20a5b-154">[![Aggiungere un controllo RequiredFieldValidator EditItemTemplate dopo la casella di testo ProductName](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-154">[![Add a RequiredFieldValidator to the EditItemTemplate After the ProductName TextBox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image8.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image7.png)</span></span>

<span data-ttu-id="20a5b-155">**Figura 3**: aggiungere un controllo RequiredFieldValidator per il `EditItemTemplate After` il `ProductName` casella di testo ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-155">**Figure 3**: Add a RequiredFieldValidator to the `EditItemTemplate After` the `ProductName` TextBox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image9.png))</span></span>


<span data-ttu-id="20a5b-156">Tutti i controlli di convalida di lavoro tramite la convalida dell'input di un singolo controllo Web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="20a5b-156">All validation controls work by validating the input of a single ASP.NET Web control.</span></span> <span data-ttu-id="20a5b-157">Pertanto, è necessario indicare che è stato appena aggiunto RequiredFieldValidator deve convalidare il `ProductName` TextBox; questa operazione viene eseguita impostando il controllo di convalida s [ `ControlToValidate` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) per il `ID` di il controllo Web appropriato (`ProductName`, in questa istanza).</span><span class="sxs-lookup"><span data-stu-id="20a5b-157">Therefore, we need to indicate that the RequiredFieldValidator we just added should validate against the `ProductName` TextBox; this is done by setting the validation control s [`ControlToValidate` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.controltovalidate(VS.80).aspx) to the `ID` of the appropriate Web control (`ProductName`, in this instance).</span></span> <span data-ttu-id="20a5b-158">Successivamente, impostare il [ `ErrorMessage` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) per specificare il nome del prodotto s e [ `Text` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) a \*.</span><span class="sxs-lookup"><span data-stu-id="20a5b-158">Next, set the [`ErrorMessage` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.errormessage(VS.80).aspx) to You must provide the product s name and the [`Text` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basevalidator.text(VS.80).aspx) to \*.</span></span> <span data-ttu-id="20a5b-159">Il `Text` valore della proprietà, se fornito, è il testo visualizzato dal controllo di convalida se la convalida non riesce.</span><span class="sxs-lookup"><span data-stu-id="20a5b-159">The `Text` property value, if provided, is the text that is displayed by the validation control if the validation fails.</span></span> <span data-ttu-id="20a5b-160">Il `ErrorMessage` valore della proprietà, è necessario, viene utilizzato il controllo ValidationSummary; se il `Text` valore della proprietà viene omessa, il `ErrorMessage` valore della proprietà viene visualizzato dal controllo di convalida un input non valido.</span><span class="sxs-lookup"><span data-stu-id="20a5b-160">The `ErrorMessage` property value, which is required, is used by the ValidationSummary control; if the `Text` property value is omitted, the `ErrorMessage` property value is displayed by the validation control on invalid input.</span></span>

<span data-ttu-id="20a5b-161">Dopo l'impostazione di queste tre proprietà di RequiredFieldValidator la schermata dovrebbe essere simile alla figura 4.</span><span class="sxs-lookup"><span data-stu-id="20a5b-161">After setting these three properties of the RequiredFieldValidator, your screen should look similar to Figure 4.</span></span>


<span data-ttu-id="20a5b-162">[![Impostare le proprietà di testo, un messaggio di errore e un RequiredFieldValidator s ControlToValidate](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-162">[![Set the RequiredFieldValidator s ControlToValidate, ErrorMessage, and Text Properties](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image11.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image10.png)</span></span>

<span data-ttu-id="20a5b-163">**Figura 4**: impostare s RequiredFieldValidator `ControlToValidate`, `ErrorMessage`, e `Text` delle proprietà ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-163">**Figure 4**: Set the RequiredFieldValidator s `ControlToValidate`, `ErrorMessage`, and `Text` Properties ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image12.png))</span></span>


<span data-ttu-id="20a5b-164">Con RequiredFieldValidator aggiunti il `EditItemTemplate`tutti che rimane consiste nell'aggiungere la convalida necessaria per il prezzo del prodotto s casella di testo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-164">With the RequiredFieldValidator added to the `EditItemTemplate`, all that remains is to add the necessary validation for the product s price TextBox.</span></span> <span data-ttu-id="20a5b-165">Poiché il `UnitPrice` è facoltativa quando si modifica un record, non abbiamo non è necessario aggiungere un controllo RequiredFieldValidator.</span><span class="sxs-lookup"><span data-stu-id="20a5b-165">Since the `UnitPrice` is optional when editing a record, we don t need to add a RequiredFieldValidator.</span></span> <span data-ttu-id="20a5b-166">Tuttavia, è necessario aggiungere un controllo CompareValidator per assicurarsi che il `UnitPrice`, se fornito, viene correttamente formattati come valuta ed è maggiore o uguale a 0.</span><span class="sxs-lookup"><span data-stu-id="20a5b-166">We do, however, need to add a CompareValidator to ensure that the `UnitPrice`, if supplied, is properly formatted as a currency and is greater than or equal to 0.</span></span>

<span data-ttu-id="20a5b-167">Aggiungere il controllo CompareValidator nel `EditItemTemplate` e impostare il relativo `ControlToValidate` proprietà `UnitPrice`, le `ErrorMessage` proprietà per il prezzo deve essere maggiore o uguale a zero e non può includere il simbolo di valuta e il relativo `Text` proprietà \*.</span><span class="sxs-lookup"><span data-stu-id="20a5b-167">Add the CompareValidator into the `EditItemTemplate` and set its `ControlToValidate` property to `UnitPrice`, its `ErrorMessage` property to The price must be greater than or equal to zero and cannot include the currency symbol, and its `Text` property to \*.</span></span> <span data-ttu-id="20a5b-168">Per indicare che il `UnitPrice` valore deve essere maggiore o uguale a 0, impostare il s CompareValidator [ `Operator` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) a `GreaterThanEqual`, l'oggetto [ `ValueToCompare` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) su 0, e il relativo [ `Type` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) a `Currency`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-168">To indicate that the `UnitPrice` value must be greater than or equal to 0, set the CompareValidator s [`Operator` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.operator(VS.80).aspx) to `GreaterThanEqual`, its [`ValueToCompare` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.comparevalidator.valuetocompare(VS.80).aspx) to 0, and its [`Type` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.basecomparevalidator.type.aspx) to `Currency`.</span></span>

<span data-ttu-id="20a5b-169">Dopo l'aggiunta di questi due controlli di convalida, DataList s `EditItemTemplate` la sintassi dichiarativa s dovrebbe essere simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="20a5b-169">After adding these two validation controls, the DataList s `EditItemTemplate` s declarative syntax should look similar to the following:</span></span>


[!code-aspx[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample1.aspx)]

<span data-ttu-id="20a5b-170">Dopo aver apportato queste modifiche, aprire la pagina in un browser.</span><span class="sxs-lookup"><span data-stu-id="20a5b-170">After making these changes, open the page in a browser.</span></span> <span data-ttu-id="20a5b-171">Se si tenta di omettere il nome o immettere un valore del prezzo non valido durante la modifica di un prodotto, viene visualizzato un asterisco accanto la casella di testo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-171">If you attempt to omit the name or enter an invalid price value when editing a product, an asterisk appears next to the textbox.</span></span> <span data-ttu-id="20a5b-172">Come illustrato nella figura 5, che include il simbolo di valuta, ad esempio $19,95 un valore del prezzo è considerato non valido.</span><span class="sxs-lookup"><span data-stu-id="20a5b-172">As Figure 5 shows, a price value that includes the currency symbol such as $19.95 is considered invalid.</span></span> <span data-ttu-id="20a5b-173">S CompareValidator `Currency` `Type` consente di separatori di cifre (ad esempio virgole o punti, a seconda delle impostazioni cultura) e un segno iniziale o meno, ma *non* consentire un simbolo di valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-173">The CompareValidator s `Currency` `Type` allows for digit separators (such as commas or periods, depending on the culture settings) and a leading plus or minus sign, but does *not* permit a currency symbol.</span></span> <span data-ttu-id="20a5b-174">Questo comportamento potrebbe perplex gli utenti quando esegue il rendering attualmente l'interfaccia per la modifica di `UnitPrice` utilizzando il formato di valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-174">This behavior may perplex users as the editing interface currently renders the `UnitPrice` using the currency format.</span></span>


<span data-ttu-id="20a5b-175">[![Viene visualizzato un asterisco accanto alle caselle di testo con Input non valido](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-175">[![An Asterisk Appears Next to the Textboxes with Invalid Input](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image14.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image13.png)</span></span>

<span data-ttu-id="20a5b-176">**Figura 5**: un asterisco viene visualizzato Avanti per caselle di testo con Input non valido ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-176">**Figure 5**: An Asterisk Appears Next to the Textboxes with Invalid Input ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image15.png))</span></span>


<span data-ttu-id="20a5b-177">Durante la convalida funziona come-è, l'utente deve rimuovere manualmente il simbolo di valuta, quando si modifica un record, che non è accettabile.</span><span class="sxs-lookup"><span data-stu-id="20a5b-177">While the validation works as-is, the user has to manually remove the currency symbol when editing a record, which is not acceptable.</span></span> <span data-ttu-id="20a5b-178">Inoltre, se vi sono validi gli input in cui la modifica dell'interfaccia né l'aggiornamento né Annulla pulsanti, quando selezionato, verrà richiamato un postback.</span><span class="sxs-lookup"><span data-stu-id="20a5b-178">Moreover, if there are invalid inputs in the editing interface neither the Update nor Cancel buttons, when clicked, will invoke a postback.</span></span> <span data-ttu-id="20a5b-179">In teoria, il pulsante Annulla restituirebbe DataList allo stato di pre-modifica indipendentemente dalla validità degli input utente s.</span><span class="sxs-lookup"><span data-stu-id="20a5b-179">Ideally, the Cancel button would return the DataList to its pre-editing state regardless of the validity of the user s inputs.</span></span> <span data-ttu-id="20a5b-180">Inoltre, è necessario verificare che i dati della pagina s siano validi prima di aggiornare le informazioni sul prodotto in DataList s `UpdateCommand` gestore eventi, come i controlli di convalida logica sul lato client può essere ignorata da parte degli utenti che usano browser si supporta JavaScript o avranno il supporto è disabilitato.</span><span class="sxs-lookup"><span data-stu-id="20a5b-180">Also, we need to ensure that the page s data is valid before updating the product information in the DataList s `UpdateCommand` event handler, as the validation controls client-side logic can be bypassed by users whose browsers either don t support JavaScript or have its support disabled.</span></span>

## <a name="removing-the-currency-symbol-from-the-edititemtemplate-s-unitprice-textbox"></a><span data-ttu-id="20a5b-181">Rimuovere il simbolo di valuta dalla casella di testo UnitPrice s EditItemTemplate</span><span class="sxs-lookup"><span data-stu-id="20a5b-181">Removing the Currency Symbol from the EditItemTemplate s UnitPrice TextBox</span></span>

<span data-ttu-id="20a5b-182">Quando si utilizza il s CompareValidator `Currency``Type`, l'input da convalidare non deve includere i simboli di valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-182">When using the CompareValidator s `Currency``Type`, the input being validated must not include any currency symbols.</span></span> <span data-ttu-id="20a5b-183">La presenza di tali simboli determina CompareValidator contrassegnare l'input come non valida.</span><span class="sxs-lookup"><span data-stu-id="20a5b-183">The presence of such symbols causes the CompareValidator to mark the input as invalid.</span></span> <span data-ttu-id="20a5b-184">Tuttavia, l'interfaccia di modifica attualmente include un simbolo di valuta nel `UnitPrice` casella di testo, vale a dire l'utente deve rimuovere il simbolo di valuta in modo esplicito prima di salvare le modifiche.</span><span class="sxs-lookup"><span data-stu-id="20a5b-184">However, our editing interface currently includes a currency symbol in the `UnitPrice` TextBox, meaning the user must explicitly remove the currency symbol before saving their changes.</span></span> <span data-ttu-id="20a5b-185">Per risolvere questo problema sono disponibili tre opzioni:</span><span class="sxs-lookup"><span data-stu-id="20a5b-185">To remedy this we have three options:</span></span>

1. <span data-ttu-id="20a5b-186">Configurare il `EditItemTemplate` in modo che il `UnitPrice` valore casella di testo non è formattato come valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-186">Configure the `EditItemTemplate` so that the `UnitPrice` TextBox value is not formatted as a currency.</span></span>
2. <span data-ttu-id="20a5b-187">Consente all'utente di immettere un simbolo di valuta rimuovendo il CompareValidator e sostituirlo con un RegularExpressionValidator che verifica la presenza di un valore di valuta formattato correttamente.</span><span class="sxs-lookup"><span data-stu-id="20a5b-187">Allow the user to enter a currency symbol by removing the CompareValidator and replacing it with a RegularExpressionValidator that checks for a properly formatted currency value.</span></span> <span data-ttu-id="20a5b-188">La richiesta di verifica qui è che l'espressione regolare per convalidare un valore di valuta non è semplice come quello di CompareValidator e richiede la scrittura di codice se si desidera incorporare impostazioni cultura.</span><span class="sxs-lookup"><span data-stu-id="20a5b-188">The challenge here is that the regular expression to validate a currency value is not as straightforward as the CompareValidator and would require writing code if we wanted to incorporate culture settings.</span></span>
3. <span data-ttu-id="20a5b-189">Rimuovere completamente il controllo di convalida e si basano sulla logica di convalida sul lato server personalizzato in GridView s `RowUpdating` gestore dell'evento.</span><span class="sxs-lookup"><span data-stu-id="20a5b-189">Remove the validation control altogether and rely on custom server-side validation logic in the GridView s `RowUpdating` event handler.</span></span>

<span data-ttu-id="20a5b-190">Consente di accedere con l'opzione 1 per questa esercitazione s.</span><span class="sxs-lookup"><span data-stu-id="20a5b-190">Let s go with option 1 for this tutorial.</span></span> <span data-ttu-id="20a5b-191">Attualmente il `UnitPrice` è formattato come un valore di valuta a causa dell'espressione di associazione dati per la casella di testo nel `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-191">Currently the `UnitPrice` is formatted as a currency value due to the databinding expression for the TextBox in the `EditItemTemplate`: `<%# Eval("UnitPrice", "{0:c}") %>`.</span></span> <span data-ttu-id="20a5b-192">Modifica il `Eval` istruzione `Eval("UnitPrice", "{0:n2}")`, che formatta il risultato sotto forma di numero con due cifre di precisione.</span><span class="sxs-lookup"><span data-stu-id="20a5b-192">Change the `Eval` statement to `Eval("UnitPrice", "{0:n2}")`, which formats the result as a number with two digits of precision.</span></span> <span data-ttu-id="20a5b-193">Ciò è possibile direttamente tramite la sintassi dichiarativa o facendo clic sul collegamento Modifica DataBindings dal `UnitPrice` casella di testo in DataList s `EditItemTemplate`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-193">This can be done directly through the declarative syntax or by clicking on the Edit DataBindings link from the `UnitPrice` TextBox in the DataList s `EditItemTemplate`.</span></span>

<span data-ttu-id="20a5b-194">Con questa modifica, il prezzo formattato nell'interfaccia di modifica include una virgola come separatore di gruppo e un punto come separatore decimale, ma esclude il simbolo di valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-194">With this change, the formatted price in the editing interface includes commas as the group separator and a period as the decimal separator, but leaves off the currency symbol.</span></span>

> [!NOTE]
> <span data-ttu-id="20a5b-195">Quando si rimuove il formato valuta dall'interfaccia modificabile, utile inserire il simbolo di valuta il testo all'esterno di casella di testo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-195">When removing the currency format from the editable interface, I find it helpful to put the currency symbol as text outside the TextBox.</span></span> <span data-ttu-id="20a5b-196">Funge da un suggerimento all'utente che non è necessario fornire il simbolo di valuta.</span><span class="sxs-lookup"><span data-stu-id="20a5b-196">This serves as a hint to the user that they do not need to provide the currency symbol.</span></span>


## <a name="fixing-the-cancel-button"></a><span data-ttu-id="20a5b-197">Correggere il pulsante Annulla</span><span class="sxs-lookup"><span data-stu-id="20a5b-197">Fixing the Cancel Button</span></span>

<span data-ttu-id="20a5b-198">Per impostazione predefinita, i controlli di convalida Web emit JavaScript per eseguire la convalida sul lato client.</span><span class="sxs-lookup"><span data-stu-id="20a5b-198">By default, the validation Web controls emit JavaScript to perform validation on the client-side.</span></span> <span data-ttu-id="20a5b-199">Quando si seleziona un pulsante, LinkButton o ImageButton, i controlli di convalida nella pagina vengono controllati sul lato client prima che si verifichi il postback.</span><span class="sxs-lookup"><span data-stu-id="20a5b-199">When a Button, LinkButton, or ImageButton is clicked, the validation controls on the page are checked on the client-side before the postback occurs.</span></span> <span data-ttu-id="20a5b-200">Nel caso i dati non validi, viene annullato il postback.</span><span class="sxs-lookup"><span data-stu-id="20a5b-200">If there is any invalid data, the postback is cancelled.</span></span> <span data-ttu-id="20a5b-201">Per alcuni pulsanti, tuttavia, la validità dei dati potrebbe essere irrilevante; In tal caso, visto il postback annullato a causa di dati non validi è noioso.</span><span class="sxs-lookup"><span data-stu-id="20a5b-201">For certain Buttons, though, the validity of the data might be immaterial; in such a case, having the postback cancelled due to invalid data is a nuisance.</span></span>

<span data-ttu-id="20a5b-202">Il pulsante Annulla è un esempio.</span><span class="sxs-lookup"><span data-stu-id="20a5b-202">The Cancel button is such an example.</span></span> <span data-ttu-id="20a5b-203">Si supponga che un utente immette i dati non validi, ad esempio omettere il nome del prodotto s e quindi decide t desidera salvare il prodotto dopo che tutti e preme il pulsante Annulla.</span><span class="sxs-lookup"><span data-stu-id="20a5b-203">Imagine that a user enters invalid data, such as omitting the product s name, and then decides she doesn t want to save the product after all and hits the Cancel button.</span></span> <span data-ttu-id="20a5b-204">Attualmente, il pulsante Annulla attiva i controlli di convalida della pagina, i report che il nome del prodotto è manca e impedire il postback.</span><span class="sxs-lookup"><span data-stu-id="20a5b-204">Currently, the Cancel button triggers the validation controls on the page, which report that the product name is missing and prevent the postback.</span></span> <span data-ttu-id="20a5b-205">L'utente deve digitare del testo nel `ProductName` casella di testo solo per annullare il processo di modifica.</span><span class="sxs-lookup"><span data-stu-id="20a5b-205">Our user has to type some text into the `ProductName` TextBox just to cancel out of the editing process.</span></span>

<span data-ttu-id="20a5b-206">Per fortuna, il pulsante, LinkButton e ImageButton dispongono di un [ `CausesValidation` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) che può indicare se facendo clic sul pulsante deve avviare la logica di convalida (per impostazione predefinita `True`).</span><span class="sxs-lookup"><span data-stu-id="20a5b-206">Fortunately, the Button, LinkButton, and ImageButton have a [`CausesValidation` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.button.causesvalidation.aspx) that can indicate whether or not clicking the Button should initiate the validation logic (defaults to `True`).</span></span> <span data-ttu-id="20a5b-207">Impostare i dispositivi del pulsante Annulla `CausesValidation` proprietà `False`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-207">Set the Cancel Button s `CausesValidation` property to `False`.</span></span>

## <a name="ensuring-the-inputs-are-valid-in-the-updatecommand-event-handler"></a><span data-ttu-id="20a5b-208">Verificare gli input sono validi nel gestore eventi UpdateCommand</span><span class="sxs-lookup"><span data-stu-id="20a5b-208">Ensuring the Inputs are Valid in the UpdateCommand Event Handler</span></span>

<span data-ttu-id="20a5b-209">A causa di script sul lato client generato per i controlli di convalida, se un utente immette un input non valido i controlli di convalida annullare qualsiasi postback iniziati dal pulsante, LinkButton o ImageButton controlli la cui `CausesValidation` sono proprietà `True` (la Per impostazione predefinita).</span><span class="sxs-lookup"><span data-stu-id="20a5b-209">Due to the client-side script emitted by the validation controls, if a user enters invalid input the validation controls cancel any postbacks initiated by Button, LinkButton, or ImageButton controls whose `CausesValidation` properties are `True` (the default).</span></span> <span data-ttu-id="20a5b-210">Tuttavia, se un utente visita un browser antiquato oppure a uno cui supporto JavaScript è stato disabilitato, i controlli di convalida sul lato client non verranno eseguita.</span><span class="sxs-lookup"><span data-stu-id="20a5b-210">However, if a user is visiting with an antiquated browser or one whose JavaScript support has been disabled, the client-side validation checks will not execute.</span></span>

<span data-ttu-id="20a5b-211">Tutti i controlli di convalida ASP.NET ripetere la logica di convalida subito dopo il postback e segnalare la validità complessiva degli input pagina s tramite il [ `Page.IsValid` proprietà](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span><span class="sxs-lookup"><span data-stu-id="20a5b-211">All of the ASP.NET validation controls repeat their validation logic immediately upon postback and report the overall validity of the page s inputs via the [`Page.IsValid` property](https://msdn.microsoft.com/library/system.web.ui.page.isvalid.aspx).</span></span> <span data-ttu-id="20a5b-212">Tuttavia, il flusso di pagina non è interrotta o arrestato in qualsiasi modalità in base al valore di `Page.IsValid`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-212">However, the page flow is not interrupted or stopped in any way based on the value of `Page.IsValid`.</span></span> <span data-ttu-id="20a5b-213">Gli sviluppatori, ha la responsabilità per garantire che il `Page.IsValid` proprietà ha un valore `True` prima di procedere con il codice che presuppone valido i dati di input.</span><span class="sxs-lookup"><span data-stu-id="20a5b-213">As developers, it is our responsibility to ensure that the `Page.IsValid` property has a value of `True` before proceeding with code that assumes valid input data.</span></span>

<span data-ttu-id="20a5b-214">Se un utente dispone di JavaScript disabilitato, visita la pagina, modifica di un prodotto, immette un valore del prezzo di troppi costose e fa clic sul pulsante di aggiornamento, la convalida lato client verrà ignorata e verrà insorgere un postback.</span><span class="sxs-lookup"><span data-stu-id="20a5b-214">If a user has JavaScript disabled, visits our page, edits a product, enters a price value of Too expensive, and clicks the Update button, the client-side validation will be bypassed and a postback will ensue.</span></span> <span data-ttu-id="20a5b-215">Durante il postback, ASP.NET pagina s `UpdateCommand` gestore eventi viene eseguito e viene generata un'eccezione durante il tentativo di analizzare troppo costoso un `Decimal`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-215">On postback, the ASP.NET page s `UpdateCommand` event handler executes and an exception is raised when attempting to parse Too expensive to a `Decimal`.</span></span> <span data-ttu-id="20a5b-216">Poiché è disponibile la gestione delle eccezioni, tale eccezione verrà gestita correttamente, ma è possibile impedire che i dati non validi che slittano tramite in primo luogo da solo procedere con il `UpdateCommand` gestore dell'evento se `Page.IsValid` ha un valore di `True`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-216">Since we have exception handling, such an exception will be handled gracefully, but we could prevent the invalid data from slipping through in the first place by only proceeding with the `UpdateCommand` event handler if `Page.IsValid` has a value of `True`.</span></span>

<span data-ttu-id="20a5b-217">Aggiungere il codice seguente all'inizio del `UpdateCommand` gestore dell'evento, immediatamente prima di `Try` blocco:</span><span class="sxs-lookup"><span data-stu-id="20a5b-217">Add the following code to the start of the `UpdateCommand` event handler, immediately before the `Try` block:</span></span>


[!code-vb[Main](adding-validation-controls-to-the-datalist-s-editing-interface-vb/samples/sample2.vb)]

<span data-ttu-id="20a5b-218">Con l'aggiunta, il prodotto tenterà di essere aggiornata solo se i dati inviati sono validi.</span><span class="sxs-lookup"><span data-stu-id="20a5b-218">With this addition, the product will attempt to be updated only if the submitted data is valid.</span></span> <span data-ttu-id="20a5b-219">La maggior parte degli utenti ha vinto t essere in grado di eseguire il postback di dati non valido a causa di script lato client controlli di convalida, ma gli utenti che usano browser si supporta JavaScript o che dispongono di JavaScript supportano disabilitato, possono ignorare i controlli sul lato client e inviare dati non validi.</span><span class="sxs-lookup"><span data-stu-id="20a5b-219">Most users won t be able to postback invalid data due to the validation controls client-side scripts, but users whose browsers don t support JavaScript or that have JavaScript support disabled, can bypass the client-side checks and submit invalid data.</span></span>

> [!NOTE]
> <span data-ttu-id="20a5b-220">Il lettore attenti ricorderà che quando l'aggiornamento dei dati in GridView, ci non è necessario verificare in modo esplicito il `Page.IsValid` proprietà la classe code-behind pagina s.</span><span class="sxs-lookup"><span data-stu-id="20a5b-220">The astute reader will recall that when updating data with the GridView, we didn t need to explicitly check the `Page.IsValid` property in our page s code-behind class.</span></span> <span data-ttu-id="20a5b-221">In questo modo il controllo GridView consulta il `Page.IsValid` proprietà per noi e solo prosegue con l'aggiornamento solo se viene restituito un valore di `True`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-221">This is because the GridView consults the `Page.IsValid` property for us and only proceeds with the update only if it returns a value of `True`.</span></span>


## <a name="step-3-summarizing-data-entry-problems"></a><span data-ttu-id="20a5b-222">Passaggio 3: Riepilogo dei problemi nell'immissione dati</span><span class="sxs-lookup"><span data-stu-id="20a5b-222">Step 3: Summarizing Data Entry Problems</span></span>

<span data-ttu-id="20a5b-223">Oltre ai controlli di convalida di cinque, ASP.NET include il [controllo ValidationSummary](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), che consente di visualizzare il `ErrorMessage` s tali controlli di convalida rilevati dati non validi.</span><span class="sxs-lookup"><span data-stu-id="20a5b-223">In addition to the five validation controls, ASP.NET includes the [ValidationSummary control](https://msdn.microsoft.com/library/f9h59855(VS.80).aspx), which displays the `ErrorMessage` s of those validation controls that detected invalid data.</span></span> <span data-ttu-id="20a5b-224">Questo riepilogo dati possono essere visualizzati come testo nella pagina web o tramite una finestra di messaggio modale, sul lato client.</span><span class="sxs-lookup"><span data-stu-id="20a5b-224">This summary data can be displayed as text on the web page or through a modal, client-side messagebox.</span></span> <span data-ttu-id="20a5b-225">Consente di migliorare in questa esercitazione per includere il riepilogo di eventuali problemi di convalida sul lato client messagebox s.</span><span class="sxs-lookup"><span data-stu-id="20a5b-225">Let s enhance this tutorial to include a client-side messagebox summarizing any validation problems.</span></span>

<span data-ttu-id="20a5b-226">A tale scopo, trascinare un controllo ValidationSummary dalla casella degli strumenti nella finestra di progettazione.</span><span class="sxs-lookup"><span data-stu-id="20a5b-226">To accomplish this, drag a ValidationSummary control from the Toolbox onto the Designer.</span></span> <span data-ttu-id="20a5b-227">Il percorso di t ValidationSummary controllo è importante, poiché è re prevede di configurare in modo da visualizzare solo il riepilogo come un messagebox.</span><span class="sxs-lookup"><span data-stu-id="20a5b-227">The location of the ValidationSummary control doesn t really matter, since we re going to configure it to only display the summary as a messagebox.</span></span> <span data-ttu-id="20a5b-228">Dopo aver aggiunto il controllo, impostare il relativo [ `ShowSummary` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) a `False` e il relativo [ `ShowMessageBox` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) a `True`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-228">After adding the control, set its [`ShowSummary` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showsummary(VS.80).aspx) to `False` and its [`ShowMessageBox` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.validationsummary.showmessagebox(VS.80).aspx) to `True`.</span></span> <span data-ttu-id="20a5b-229">Con l'aggiunta, eventuali errori di convalida sono riepilogati in una finestra di messaggio sul lato client (vedere Figura 6).</span><span class="sxs-lookup"><span data-stu-id="20a5b-229">With this addition, any validation errors are summarized in a client-side messagebox (see Figure 6).</span></span>


<span data-ttu-id="20a5b-230">[![Gli errori di convalida sono riepilogati in Messagebox lato Client](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="20a5b-230">[![The Validation Errors are Summarized in a Client-Side Messagebox](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image17.png)](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image16.png)</span></span>

<span data-ttu-id="20a5b-231">**Figura 6**: di errori di convalida sono riepilogati in Messagebox lato Client ([fare clic per visualizzare l'immagine ingrandita](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="20a5b-231">**Figure 6**: The Validation Errors are Summarized in a Client-Side Messagebox ([Click to view full-size image](adding-validation-controls-to-the-datalist-s-editing-interface-vb/_static/image18.png))</span></span>


## <a name="summary"></a><span data-ttu-id="20a5b-232">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="20a5b-232">Summary</span></span>

<span data-ttu-id="20a5b-233">In questa esercitazione è stato illustrato come ridurre la probabilità di eccezioni utilizzando i controlli di convalida per verificare in modo proattivo che l'input degli utenti validi prima di tentare di utilizzarli nel flusso di lavoro di aggiornamento.</span><span class="sxs-lookup"><span data-stu-id="20a5b-233">In this tutorial we saw how to reduce the likelihood of exceptions by using validation controls to proactively ensure that our users inputs are valid before attempting to use them in the updating workflow.</span></span> <span data-ttu-id="20a5b-234">ASP.NET fornisce cinque controlli Web di convalida che sono progettati per controllare un determinato Web controllano input s e segnalano la validità dell'input s.</span><span class="sxs-lookup"><span data-stu-id="20a5b-234">ASP.NET provides five validation Web controls that are designed to inspect a particular Web control s input and report back on the input s validity.</span></span> <span data-ttu-id="20a5b-235">In questa esercitazione è possibile usare due di questi cinque controlli RequiredFieldValidator e il controllo CompareValidator per assicurarsi che sia stato specificato il nome del prodotto s e che il prezzo ha un formato di valuta con un valore maggiore o uguale a zero.</span><span class="sxs-lookup"><span data-stu-id="20a5b-235">In this tutorial we used two of those five controls the RequiredFieldValidator and the CompareValidator to ensure that the product s name was supplied and that the price had a currency format with a value greater than or equal to zero.</span></span>

<span data-ttu-id="20a5b-236">Aggiunta di controlli di convalida al s DataList modifica interfaccia è semplice come trascinarli nella `EditItemTemplate` dalla casella degli strumenti e l'impostazione di un numero limitato di proprietà.</span><span class="sxs-lookup"><span data-stu-id="20a5b-236">Adding validation controls to the DataList s editing interface is as simple as dragging them onto the `EditItemTemplate` from the Toolbox and setting a handful of properties.</span></span> <span data-ttu-id="20a5b-237">Per impostazione predefinita, i controlli di convalida generano automaticamente script di convalida lato client. Oltre a fornire la convalida sul lato server durante il postback, archiviando il risultato cumulativo nel `Page.IsValid` proprietà.</span><span class="sxs-lookup"><span data-stu-id="20a5b-237">By default, the validation controls automatically emit client-side validation script; they also provide server-side validation on postback, storing the cumulative result in the `Page.IsValid` property.</span></span> <span data-ttu-id="20a5b-238">Per ignorare la convalida lato client quando si seleziona un pulsante, LinkButton o ImageButton, impostare il pulsante s `CausesValidation` proprietà `False`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-238">To bypass the client-side validation when a Button, LinkButton, or ImageButton is clicked, set the button s `CausesValidation` property to `False`.</span></span> <span data-ttu-id="20a5b-239">Inoltre, prima di eseguire qualsiasi attività con i dati inviati durante il postback, verificare che il `Page.IsValid` restituisce proprietà `True`.</span><span class="sxs-lookup"><span data-stu-id="20a5b-239">Also, before performing any tasks with the data submitted on postback, ensure that the `Page.IsValid` property returns `True`.</span></span>

<span data-ttu-id="20a5b-240">Tutti i DataList modifica esercitazioni si ve esaminata finora sono stati molto semplice interfacce modificare una casella di testo per il nome del prodotto s e un altro per il prezzo.</span><span class="sxs-lookup"><span data-stu-id="20a5b-240">All of the DataList editing tutorials we ve examined so far have had very simple editing interfaces a TextBox for the product s name and another for the price.</span></span> <span data-ttu-id="20a5b-241">L'interfaccia di modifica, tuttavia, può contenere una combinazione di diversi controlli Web, ad esempio controlli DropDownList, calendari, pulsanti di opzione, caselle di controllo e così via.</span><span class="sxs-lookup"><span data-stu-id="20a5b-241">The editing interface, however, can contain a mix of different Web controls, such as DropDownLists, Calendars, RadioButtons, CheckBoxes, and so on.</span></span> <span data-ttu-id="20a5b-242">Nell'esercitazione successiva verrà esaminato la creazione di un'interfaccia che utilizza un'ampia gamma di controlli Web.</span><span class="sxs-lookup"><span data-stu-id="20a5b-242">In our next tutorial we'll look at building an interface that uses a variety of Web controls.</span></span>

<span data-ttu-id="20a5b-243">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="20a5b-243">Happy Programming!</span></span>

## <a name="about-the-author"></a><span data-ttu-id="20a5b-244">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="20a5b-244">About the Author</span></span>

<span data-ttu-id="20a5b-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), l'autore di sette libri e fondatore di [4GuysFromRolla](http://www.4guysfromrolla.com), ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="20a5b-245">[Scott Mitchell](http://www.4guysfromrolla.com/ScottMitchell.shtml), author of seven ASP/ASP.NET books and founder of [4GuysFromRolla.com](http://www.4guysfromrolla.com), has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="20a5b-246">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="20a5b-246">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="20a5b-247">Il suo ultimo libro è [ *SAM insegna manualmente ASP.NET 2.0 nelle 24 ore*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span><span class="sxs-lookup"><span data-stu-id="20a5b-247">His latest book is [*Sams Teach Yourself ASP.NET 2.0 in 24 Hours*](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco).</span></span> <span data-ttu-id="20a5b-248">Egli può essere raggiunto al [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) o sul suo blog, cui è reperibile in [ http://ScottOnWriting.NET ](http://ScottOnWriting.NET).</span><span class="sxs-lookup"><span data-stu-id="20a5b-248">He can be reached at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com) or via his blog, which can be found at [http://ScottOnWriting.NET](http://ScottOnWriting.NET).</span></span>

## <a name="special-thanks-to"></a><span data-ttu-id="20a5b-249">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="20a5b-249">Special Thanks To</span></span>

<span data-ttu-id="20a5b-250">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="20a5b-250">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="20a5b-251">Lead revisori per questa esercitazione sono stati Dennis Patterson Ken Pespisa e Liz Shulok.</span><span class="sxs-lookup"><span data-stu-id="20a5b-251">Lead reviewers for this tutorial were Dennis Patterson, Ken Pespisa, and Liz Shulok.</span></span> <span data-ttu-id="20a5b-252">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="20a5b-252">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="20a5b-253">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span><span class="sxs-lookup"><span data-stu-id="20a5b-253">If so, drop me a line at [mitchell@4GuysFromRolla.com.](mailto:mitchell@4GuysFromRolla.com)</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="20a5b-254">[Precedente](handling-bll-and-dal-level-exceptions-vb.md)
> [Successivo](customizing-the-datalist-s-editing-interface-vb.md)</span><span class="sxs-lookup"><span data-stu-id="20a5b-254">[Previous](handling-bll-and-dal-level-exceptions-vb.md)
[Next](customizing-the-datalist-s-editing-interface-vb.md)</span></span>

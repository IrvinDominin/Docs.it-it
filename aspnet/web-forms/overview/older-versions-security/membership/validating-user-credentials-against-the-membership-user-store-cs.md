---
uid: web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
title: Convalida le credenziali utente nell'archivio utente di appartenenza (c#) | Documenti Microsoft
author: rick-anderson
description: In questa esercitazione verrà esaminato convalidare le credenziali dell'utente, un archivio utente di appartenenza utilizzando sia a livello di codice indica che il controllo di accesso...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/18/2008
ms.topic: article
ms.assetid: 61aa4e08-aa81-4aeb-8ebe-19ba7a65e04c
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/membership/validating-user-credentials-against-the-membership-user-store-cs
msc.type: authoredcontent
ms.openlocfilehash: 484a0f16265ee2d887ee08f6ae7ada47047f1f04
ms.sourcegitcommit: 6784510cfb589308c3875ccb5113eb31031766b4
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 06/08/2018
ms.locfileid: "30891806"
---
<a name="validating-user-credentials-against-the-membership-user-store-c"></a><span data-ttu-id="a5cd3-103">Convalida le credenziali utente nell'archivio utente di appartenenza (c#)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-103">Validating User Credentials Against the Membership User Store (C#)</span></span>
====================
<span data-ttu-id="a5cd3-104">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-104">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="a5cd3-105">[Scaricare codice](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) o [Scarica il PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-105">[Download Code](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/ASPNET_Security_Tutorial_06_CS.zip) or [Download PDF](http://download.microsoft.com/download/3/f/5/3f5a8605-c526-4b34-b3fd-a34167117633/aspnet_tutorial06_LoggingIn_cs.pdf)</span></span>

> <span data-ttu-id="a5cd3-106">In questa esercitazione verrà esaminato convalidare le credenziali dell'utente, un archivio utente di appartenenza utilizzando sia a livello di codice indica che il controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-106">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="a5cd3-107">Verranno inoltre esaminati come personalizzare l'aspetto e il comportamento del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-107">We will also look at how to customize the login control's appearance and behavior.</span></span>


## <a name="introduction"></a><span data-ttu-id="a5cd3-108">Introduzione</span><span class="sxs-lookup"><span data-stu-id="a5cd3-108">Introduction</span></span>

<span data-ttu-id="a5cd3-109">Nel <a id="Tutorial05"> </a> [esercitazione precedente](creating-user-accounts-cs.md) abbiamo esaminato come creare un nuovo account utente nel framework di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-109">In the <a id="Tutorial05"></a>[preceding tutorial](creating-user-accounts-cs.md) we looked at how to create a new user account in the Membership framework.</span></span> <span data-ttu-id="a5cd3-110">Abbiamo esaminato prima a livello di codice la creazione di account utente tramite il `Membership` della classe `CreateUser` (metodo) e quindi esaminato tramite il controllo CreateUserWizard Web.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-110">We first looked at programmatically creating user accounts via the `Membership` class's `CreateUser` method, and then examined using the CreateUserWizard Web control.</span></span> <span data-ttu-id="a5cd3-111">Tuttavia, la pagina di accesso convalida attualmente le credenziali specificate con un elenco hardcoded di coppie di nome utente e password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-111">However, the login page currently validates the supplied credentials against a hard-coded list of username and password pairs.</span></span> <span data-ttu-id="a5cd3-112">È necessario aggiornare la logica della pagina di accesso in modo che convalida le credenziali utente archivio di appartenenza framework.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-112">We need to update the login page's logic so that it validates credentials against the Membership framework's user store.</span></span>

<span data-ttu-id="a5cd3-113">Molto simile alla creazione di account utente, le credenziali possono essere convalidate a livello di programmazione o in modo dichiarativo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-113">Much like with creating user accounts, credentials can be validated programmatically or declaratively.</span></span> <span data-ttu-id="a5cd3-114">L'API di appartenenza include un metodo di convalida a livello di codice le credenziali dell'utente nell'archivio utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-114">The Membership API includes a method for programmatically validating a user's credentials against the user store.</span></span> <span data-ttu-id="a5cd3-115">E ASP.NET viene fornito con il controllo di accesso Web, che esegue il rendering di caselle di testo per il nome utente e password e un pulsante per l'accesso un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-115">And ASP.NET ships with the Login Web control, which renders a user interface with textboxes for the username and password and a button to log in.</span></span>

<span data-ttu-id="a5cd3-116">In questa esercitazione verrà esaminato convalidare le credenziali dell'utente, un archivio utente di appartenenza utilizzando sia a livello di codice indica che il controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-116">In this tutorial we will examine how to validate a user's credentials against the Membership user store using both programmatic means and the Login control.</span></span> <span data-ttu-id="a5cd3-117">Verranno inoltre esaminati come personalizzare l'aspetto e il comportamento del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-117">We will also look at how to customize the login control's appearance and behavior.</span></span> <span data-ttu-id="a5cd3-118">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="a5cd3-118">Let's get started!</span></span>

## <a name="step-1-validating-credentials-against-the-membership-user-store"></a><span data-ttu-id="a5cd3-119">Passaggio 1: Convalida le credenziali nell'archivio utente di appartenenza</span><span class="sxs-lookup"><span data-stu-id="a5cd3-119">Step 1: Validating Credentials Against the Membership User Store</span></span>

<span data-ttu-id="a5cd3-120">Per i siti web che utilizzano l'autenticazione basata su form, un utente accede al sito Web, visitare una pagina di accesso e immettere le proprie credenziali.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-120">For web sites that use forms authentication, a user logs on to the website by visiting a login page and entering their credentials.</span></span> <span data-ttu-id="a5cd3-121">Queste credenziali vengono quindi confrontate con l'archivio dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-121">These credentials are then compared against the user store.</span></span> <span data-ttu-id="a5cd3-122">Se sono validi, l'utente viene concesso un ticket di autenticazione form, ovvero un token di sicurezza che indica l'identità e l'autenticità del visitatore.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-122">If they are valid, then the user is granted a forms authentication ticket, which is a security token that indicates the identity and authenticity of the visitor.</span></span>

<span data-ttu-id="a5cd3-123">Per convalidare un utente con il framework di appartenenza, utilizzare il `Membership` della classe [ `ValidateUser` metodo](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-123">To validate a user against the Membership framework, use the `Membership` class's [`ValidateUser` method](https://msdn.microsoft.com/library/system.web.security.membership.validateuser.aspx).</span></span> <span data-ttu-id="a5cd3-124">Il `ValidateUser` metodo accetta due parametri di input - *`username`* e *`password`* - e restituisce un valore booleano che indica se le credenziali sono valide.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-124">The `ValidateUser` method takes in two input parameters - *`username`* and *`password`* - and returns a Boolean value indicating whether the credentials were valid.</span></span> <span data-ttu-id="a5cd3-125">Come con la `CreateUser` metodo sono state esaminate nell'esercitazione precedente, il `ValidateUser` metodo delega la convalida effettiva al provider di appartenenze configurato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-125">Like with the `CreateUser` method we examined in the previous tutorial, the `ValidateUser` method delegates the actual validation to the configured Membership provider.</span></span>

<span data-ttu-id="a5cd3-126">Il `SqlMembershipProvider` convalida le credenziali fornite per ottenere la password dell'utente specificato tramite il `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-126">The `SqlMembershipProvider` validates the supplied credentials by obtaining the specified user's password via the `aspnet_Membership_GetPasswordWithFormat` stored procedure.</span></span> <span data-ttu-id="a5cd3-127">Tenere presente che il `SqlMembershipProvider` archivia le password degli utenti usando uno dei tre formati: clear, crittografato o con hash.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-127">Recall that the `SqlMembershipProvider` stores users' passwords using one of three formats: clear, encrypted, or hashed.</span></span> <span data-ttu-id="a5cd3-128">Il `aspnet_Membership_GetPasswordWithFormat` stored procedure restituisce la password nel relativo formato non elaborato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-128">The `aspnet_Membership_GetPasswordWithFormat` stored procedure returns the password in its raw format.</span></span> <span data-ttu-id="a5cd3-129">Per le password crittografate o con hash, il `SqlMembershipProvider` trasforma il *`password`* valore passato il `ValidateUser` metodo nel relativo equivalente crittografati o eseguito l'hashing dello stato e quindi lo confronta con ciò che è stato restituito dal database.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-129">For encrypted or hashed passwords, the `SqlMembershipProvider` transforms the *`password`* value passed into the `ValidateUser` method into its equivalent encrypted or hashed state and then compares it with what was returned from the database.</span></span> <span data-ttu-id="a5cd3-130">Se la password memorizzata nel database corrisponde alla password formattata immessa dall'utente, le credenziali sono valide.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-130">If the password stored in the database matches the formatted password entered by the user, the credentials are valid.</span></span>

<span data-ttu-id="a5cd3-131">Consente di aggiornare la pagina di accesso (~ /`Login.aspx`) in modo che la convalida delle credenziali fornite nell'archivio utente di appartenenza framework.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-131">Let's update our login page (~/`Login.aspx`) so that it validates the supplied credentials against the Membership framework user store.</span></span> <span data-ttu-id="a5cd3-132">È stata creata la pagina di accesso nel <a id="Tutorial02"> </a> [ *una panoramica dell'autenticazione basata su form* ](../introduction/an-overview-of-forms-authentication-cs.md) esercitazione, la creazione di un'interfaccia con due caselle di testo per il nome utente e password, un Memorizzazione dei dati, casella di controllo e un pulsante di accesso (vedere la figura 1).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-132">We created this login page back in the <a id="Tutorial02"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, creating an interface with two TextBoxes for the username and password, a Remember Me checkbox, and a Login button (see Figure 1).</span></span> <span data-ttu-id="a5cd3-133">Il codice di convalida le credenziali immesse in un elenco hardcoded di coppie di nome utente e password (Scott/password, Jisun/password e Sam/password).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-133">The code validates the entered credentials against a hard-coded list of username and password pairs (Scott/password, Jisun/password, and Sam/password).</span></span> <span data-ttu-id="a5cd3-134">Nel <a id="Tutorial03"> </a> [ *configurazione dell'autenticazione form e argomenti avanzati* ](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) esercitazione sono aggiornati di codice della pagina di accesso per archiviare informazioni aggiuntive nei moduli ticket di autenticazione `UserData` proprietà.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-134">In the <a id="Tutorial03"></a>[*Forms Authentication Configuration and Advanced Topics*](../introduction/forms-authentication-configuration-and-advanced-topics-cs.md) tutorial we updated the login page's code to store additional information in the forms authentication ticket's `UserData` property.</span></span>


<span data-ttu-id="a5cd3-135">[![Interfaccia di pagina di accesso include due caselle di testo, un CheckBoxList e un pulsante](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-135">[![The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button](validating-user-credentials-against-the-membership-user-store-cs/_static/image2.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image1.png)</span></span>

<span data-ttu-id="a5cd3-136">**Figura 1**: interfaccia include due caselle di testo della pagina account di accesso, un CheckBoxList e un pulsante ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-136">**Figure 1**: The Login Page's Interface Includes Two TextBoxes, a CheckBoxList, and a Button  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image3.png))</span></span>


<span data-ttu-id="a5cd3-137">Interfaccia utente della pagina di accesso può rimangono invariato, ma è necessario sostituire il pulsante di accesso `Click` gestore dell'evento con il codice che convalida l'utente nell'archivio utente di appartenenza framework.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-137">The login page's user interface can remain unchanged, but we need to replace the Login button's `Click` event handler with code that validates the user against the Membership framework user store.</span></span> <span data-ttu-id="a5cd3-138">Aggiornare il gestore dell'evento in modo che il codice viene visualizzato come segue:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-138">Update the event handler so that its code appears as follows:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample1.cs)]

<span data-ttu-id="a5cd3-139">Questo codice è molto semplice.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-139">This code is remarkably simple.</span></span> <span data-ttu-id="a5cd3-140">Viene avviata chiamando il `Membership.ValidateUser` , passando il nome utente fornito e la password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-140">We start by calling the `Membership.ValidateUser` method, passing in the supplied username and password.</span></span> <span data-ttu-id="a5cd3-141">Se tale metodo restituisce true, l'utente è connesso al sito tramite il `FormsAuthentication` metodo RedirectFromLoginPage della classe.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-141">If that method returns true, then the user is signed into the site via the `FormsAuthentication` class's RedirectFromLoginPage method.</span></span> <span data-ttu-id="a5cd3-142">(Come descritto nel <a id="Tutorial2"> </a> [ *una panoramica dell'autenticazione basata su form* ](../introduction/an-overview-of-forms-authentication-cs.md) esercitazione il `FormsAuthentication.RedirectFromLoginPage` crea le forme di ticket di autenticazione e reindirizza l'utente alla pagina appropriata.) Se le credenziali sono valide, tuttavia, il `InvalidCredentialsMessage` etichetta viene visualizzata, per informare l'utente che il nome utente o la password non è corretta.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-142">(As we discussed in the <a id="Tutorial2"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial, the `FormsAuthentication.RedirectFromLoginPage` creates the forms authentication ticket and then redirects the user to the appropriate page.) If the credentials are invalid, however, the `InvalidCredentialsMessage` Label is displayed, informing the user that their username or password was incorrect.</span></span>

<span data-ttu-id="a5cd3-143">Questo è tutto qui!</span><span class="sxs-lookup"><span data-stu-id="a5cd3-143">That's all there is to it!</span></span>

<span data-ttu-id="a5cd3-144">Per verificare che la pagina di accesso funziona come previsto, tentare di eseguire l'accesso con uno degli account utente creato nell'esercitazione precedente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-144">To test that the login page works as expected, attempt to login with one of the user accounts you created in the preceding tutorial.</span></span> <span data-ttu-id="a5cd3-145">In alternativa, se non è ancora stato creato un account, vado avanti e crearne uno dal `~/Membership/CreatingUserAccounts.aspx` pagina.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-145">Or, if you have not yet created an account, go ahead and create one from the `~/Membership/CreatingUserAccounts.aspx` page.</span></span>

> [!NOTE]
> <span data-ttu-id="a5cd3-146">Quando l'utente immette le proprie credenziali e invia il form di pagina di accesso, le credenziali, inclusa la password, vengono trasmessi tramite Internet al server web in *testo normale*.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-146">When the user enters her credentials and submits the login page form, the credentials, including her password, are transmitted over the Internet to the web server in *plain text*.</span></span> <span data-ttu-id="a5cd3-147">Ciò significa che un pirata informatico lo sniffing del traffico di rete è possibile visualizzare il nome utente e password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-147">That means any hacker sniffing the network traffic can see the username and password.</span></span> <span data-ttu-id="a5cd3-148">Per evitare questo problema, è essenziale per crittografare il traffico di rete tramite [livelli SSL (Secure Socket)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-148">To prevent this, it is essential to encrypt the network traffic by using [Secure Socket Layers (SSL)](http://en.wikipedia.org/wiki/Secure_Sockets_Layer).</span></span> <span data-ttu-id="a5cd3-149">Ciò garantisce che le credenziali (così come markup HTML della pagina intera) vengono crittografati dal momento in cui che lasciano il browser finché vengono ricevuti dal server web.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-149">This will ensure that the credentials (as well as the entire page's HTML markup) are encrypted from the moment they leave the browser until they are received by the web server.</span></span>


### <a name="how-the-membership-framework-handles-invalid-login-attempts"></a><span data-ttu-id="a5cd3-150">Come il Framework di appartenenza gestisce i tentativi di accesso non valido</span><span class="sxs-lookup"><span data-stu-id="a5cd3-150">How the Membership Framework Handles Invalid Login Attempts</span></span>

<span data-ttu-id="a5cd3-151">Quando un visitatore raggiunge la pagina di accesso e invia le proprie credenziali, il browser invia una richiesta HTTP alla pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-151">When a visitor reaches the login page and submits their credentials, their browser makes an HTTP request to the login page.</span></span> <span data-ttu-id="a5cd3-152">Se le credenziali siano valide, la risposta HTTP include il ticket di autenticazione in un cookie.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-152">If the credentials are valid, the HTTP response includes the authentication ticket in a cookie.</span></span> <span data-ttu-id="a5cd3-153">Pertanto, un pirata informatico tentando di introdursi nel sito è stato possibile creare un programma che si reputano invia richieste HTTP alla pagina di accesso con un nome utente valido e una probabilità la password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-153">Therefore, a hacker attempting to break into your site could create a program that exhaustively sends HTTP requests to the login page with a valid username and a guess at the password.</span></span> <span data-ttu-id="a5cd3-154">Se l'ipotesi di password sono corretta, la pagina di accesso verrà restituito il cookie di ticket di autenticazione, a quel punto il programma riconosce che è stumbled su una coppia di nome utente/password valida.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-154">If the password guess is correct, the login page will return the authentication ticket cookie, at which point the program knows it has stumbled upon a valid username/password pair.</span></span> <span data-ttu-id="a5cd3-155">Tramite attacchi di forza bruta, tale programma potrebbe essere in grado di suo password di un utente, soprattutto se la password è debole.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-155">Through brute force, such a program might be able to stumble upon a user's password, especially if the password is weak.</span></span>

<span data-ttu-id="a5cd3-156">Per evitare tali attacchi di forza bruta, il framework di appartenenza per bloccare un utente se sono presenti un certo numero di tentativi di accesso non riuscito entro un determinato periodo di tempo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-156">To prevent such brute force attacks, the Membership framework locks out a user if there are a certain number of unsuccessful login attempts within a certain period of time.</span></span> <span data-ttu-id="a5cd3-157">I parametri esatti possono essere configurati tramite le impostazioni della configurazione dei provider di appartenenza due seguenti:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-157">The exact parameters are configurable through the following two Membership provider configuration settings:</span></span>

- <span data-ttu-id="a5cd3-158">`maxInvalidPasswordAttempts` -Specifica il numero di password non valida tentativi consentiti per l'utente entro il periodo di tempo prima che l'account è bloccato. Il valore predefinito è 5.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-158">`maxInvalidPasswordAttempts` - specifies how many invalid password attempts are allowed for the user within the time period before the account is locked out. The default value is 5.</span></span>
- <span data-ttu-id="a5cd3-159">`passwordAttemptWindow` -indica il periodo di tempo in minuti durante i quali il numero specificato di tentativi di accesso non validi causerà l'account vengano bloccati. Il valore predefinito è 10.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-159">`passwordAttemptWindow` - indicates the time period in minutes during which the specified number of invalid login attempts will cause the account to be locked out. The default value is 10.</span></span>

<span data-ttu-id="a5cd3-160">Se un utente è stato bloccato, Lei non può accedere fino a quando non viene sbloccato dall'amministratore il proprio account.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-160">If a user has been locked out, she cannot login until an administrator unlocks her account.</span></span> <span data-ttu-id="a5cd3-161">Quando un utente viene bloccato, il `ValidateUser` metodo verrà *sempre* restituire `false`, anche se vengono fornite credenziali valide.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-161">When a user is locked out, the `ValidateUser` method will *always* return `false`, even if valid credentials are supplied.</span></span> <span data-ttu-id="a5cd3-162">Durante questo comportamento riduce la probabilità che un pirata informatico verrà interrotte nel sito tramite i metodi di attacchi di forza bruta, possono finire blocca un utente valido semplicemente ha dimenticato la password o accidentalmente con il tasto BLOC MAIUSC attivo o ha un giorno digitazione errato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-162">While this behavior lessens the likelihood that a hacker will break into your site through brute force methods, it can end up locking out a valid user who has simply forgotten her password or accidentally has the Caps Lock on or is having a bad typing day.</span></span>

<span data-ttu-id="a5cd3-163">Purtroppo, non è Nessuno strumento predefinito per lo sblocco di un account utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-163">Unfortunately, there is no built-in tool for unlocking a user account.</span></span> <span data-ttu-id="a5cd3-164">Per sbloccare un account, è possibile modificare il database direttamente - modificare il `IsLockedOut` campo il `aspnet_Membership` tabella per l'account utente appropriati - o crearne una basata sul web interfaccia che elenca gli account selezionata con le opzioni per sbloccarli.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-164">In order to unlock an account, you can modify the database directly - change the `IsLockedOut` field in the `aspnet_Membership` table for the appropriate user account - or create a web-based interface that lists locked out accounts with options to unlock them.</span></span> <span data-ttu-id="a5cd3-165">Creazione di interfacce amministrativa per il completamento delle attività comuni di correlate ai ruoli e account utente in un'esercitazione in futura verrà esaminato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-165">We will examine creating administrative interfaces for accomplishing common user account- and role-related tasks in a future tutorial.</span></span>

> [!NOTE]
> <span data-ttu-id="a5cd3-166">Uno svantaggio di `ValidateUser` metodo è che quando le credenziali fornite non sono validi, non fornisce alcun spiegazione perché.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-166">One downside of the `ValidateUser` method is that when the supplied credentials are invalid, it does not provide any explanation as to why.</span></span> <span data-ttu-id="a5cd3-167">Le credenziali possono essere non valide perché non esiste alcuna corrispondenza coppia di nome utente/password nell'archivio dell'utente, o perché l'utente non è ancora stato approvato o perché l'utente è stato bloccato. Nel passaggio 4 vedremo come visualizzare un messaggio più dettagliato per l'utente quando il tentativo di accesso ha esito negativo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-167">The credentials may be invalid because there is no matching username/password pair in the user store, or because the user has not yet been approved, or because the user has been locked out. In Step 4 we will see how to show a more detailed message to the user when their login attempt fails.</span></span>


## <a name="step-2-collecting-credentials-through-the-login-web-control"></a><span data-ttu-id="a5cd3-168">Passaggio 2: Raccogliere le credenziali tramite il controllo di accesso Web</span><span class="sxs-lookup"><span data-stu-id="a5cd3-168">Step 2: Collecting Credentials through the Login Web Control</span></span>

<span data-ttu-id="a5cd3-169">Il [controllo di accesso Web](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) esegue il rendering di molto simile a quello creato in un'interfaccia utente predefinita di <a id="SKM5"> </a> [ *una panoramica dell'autenticazione basata su form* ](../introduction/an-overview-of-forms-authentication-cs.md) esercitazione.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-169">The [Login Web control](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx) renders a default user interface very similar to the one we created back in the <a id="SKM5"></a>[*An Overview of Forms Authentication*](../introduction/an-overview-of-forms-authentication-cs.md) tutorial.</span></span> <span data-ttu-id="a5cd3-170">Utilizzo del controllo di accesso ci consente di risparmiare il lavoro di dover creare l'interfaccia per raccogliere le credenziali di s visitatore.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-170">Using the Login control saves us the work of having to create the interface to collect the visitor�s credentials.</span></span> <span data-ttu-id="a5cd3-171">Inoltre, il controllo di accesso automaticamente accede l'utente (presumendo che le credenziali presentate siano valide), in tal modo salvataggio ci di dover scrivere alcun codice.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-171">Moreover, the Login control automatically signs in the user (assuming the submitted credentials are valid), thereby saving us from having to write any code.</span></span>

<span data-ttu-id="a5cd3-172">Consente di aggiornare `Login.aspx`, sostituendo l'interfaccia creato manualmente e con un controllo di accesso di codice.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-172">Let's update `Login.aspx`, replacing the manually created interface and code with a Login control.</span></span> <span data-ttu-id="a5cd3-173">Avviare rimuovendo il markup esistente e di codice `Login.aspx`.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-173">Start by removing the existing markup and code in `Login.aspx`.</span></span> <span data-ttu-id="a5cd3-174">È possibile eliminarlo definitive oppure semplicemente impostarlo come commento. Per impostare come commento markup dichiarativo, racchiuderlo tra il `<%--` e `--%>` delimitatori.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-174">You may delete it outright, or simply comment it out. To comment out declarative markup, surround it with the `<%--` and `--%>` delimiters.</span></span> <span data-ttu-id="a5cd3-175">È possibile immettere manualmente questi delimitatori o, come illustrato nella figura 2, è possibile selezionare il testo da impostare come commento e quindi fare clic sul commento l'icona di righe selezionate nella barra degli strumenti.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-175">You can enter these delimiters manually, or, as Figure 2 shows, you may select the text to comment out and then click the Comment out the selected lines icon in the Toolbar.</span></span> <span data-ttu-id="a5cd3-176">Analogamente, è possibile utilizzare l'icona di righe selezionate come commento per impostare come commento il codice selezionato nella classe code-behind.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-176">Similarly, you can use the Comment out the selected lines icon to comment out the selected code in the code-behind class.</span></span>


<span data-ttu-id="a5cd3-177">[![Commentare il Markup dichiarativo esistente e il codice sorgente in Login. aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-177">[![Comment Out the Existing Declarative Markup and Source Code in Login.aspx](validating-user-credentials-against-the-membership-user-store-cs/_static/image5.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image4.png)</span></span>

<span data-ttu-id="a5cd3-178">**Figura 2**: commento Out the esistente Markup dichiarativo e codice sorgente `Login.aspx` ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-178">**Figure 2**: Comment Out the Existing Declarative Markup and Source Code in `Login.aspx` ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image6.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a5cd3-179">Il commento l'icona di righe selezionate non è disponibile quando si visualizza il markup dichiarativo in Visual Studio 2005.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-179">The Comment out the selected lines icon is not available when viewing the declarative markup in Visual Studio 2005.</span></span> <span data-ttu-id="a5cd3-180">Se non si utilizza Visual Studio 2008, è necessario aggiungere manualmente il `<%--` e `--%>` delimitatori.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-180">If you are not using Visual Studio 2008 you will need to manually add the `<%--` and `--%>` delimiters.</span></span>


<span data-ttu-id="a5cd3-181">Quindi, trascinare un controllo di accesso dalla casella degli strumenti sulla pagina e impostare il relativo `ID` proprietà `myLogin`.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-181">Next, drag a Login control from the Toolbox on to the page and set its `ID` property to `myLogin`.</span></span> <span data-ttu-id="a5cd3-182">A questo punto la schermata dovrebbe essere simile alla figura 3.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-182">At this point your screen should look similar to Figure 3.</span></span> <span data-ttu-id="a5cd3-183">Si noti che l'interfaccia predefinita del controllo di accesso include i controlli casella di testo per il nome utente e password, un memorizza dati successivo casella di controllo e un pulsante nel Log.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-183">Note that the Login control's default interface includes TextBox controls for the username and password, a Remember me next time CheckBox, and a Log In Button.</span></span> <span data-ttu-id="a5cd3-184">Sono inoltre disponibili `RequiredFieldValidator` controlli per le due caselle di testo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-184">There are also `RequiredFieldValidator` controls for the two TextBoxes.</span></span>


<span data-ttu-id="a5cd3-185">[![Aggiungere un controllo di accesso alla pagina](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-185">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image8.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image7.png)</span></span>

<span data-ttu-id="a5cd3-186">**Figura 3**: aggiungere un controllo di accesso alla pagina ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-186">**Figure 3**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image9.png))</span></span>


<span data-ttu-id="a5cd3-187">E abbiamo finito!</span><span class="sxs-lookup"><span data-stu-id="a5cd3-187">And we're done!</span></span> <span data-ttu-id="a5cd3-188">Quando si fa clic sul pulsante Accedi del controllo di accesso, si verificherà un postback e il controllo di accesso chiamerà il `Membership.ValidateUser` , passando il nome utente immesso e la password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-188">When the Login control's Log In button is clicked, a postback will occur and the Login control will call the `Membership.ValidateUser` method, passing in the entered username and password.</span></span> <span data-ttu-id="a5cd3-189">Se le credenziali sono valide, il controllo di accesso viene visualizzato un apposito messaggio.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-189">If the credentials are invalid, the Login control displays a message stating such.</span></span> <span data-ttu-id="a5cd3-190">Se, tuttavia, le credenziali sono valide, il controllo di accesso crea le forme di ticket di autenticazione e l'utente viene reindirizzato alla pagina appropriata.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-190">If, however, the credentials are valid, then the Login control creates the forms authentication ticket and redirects the user to the appropriate page.</span></span>

<span data-ttu-id="a5cd3-191">Il controllo di accesso utilizza quattro fattori per determinare la pagina appropriata per reindirizzare l'utente a su un account di accesso ha esito positivo:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-191">The Login control uses four factors to determine the appropriate page to redirect the user to upon a successful login:</span></span>

- <span data-ttu-id="a5cd3-192">Indica se il controllo di accesso è nella pagina di accesso come definito dal `loginUrl` impostazione nella configurazione dell'autenticazione form; valore predefinito di questa impostazione è `Login.aspx`</span><span class="sxs-lookup"><span data-stu-id="a5cd3-192">Whether the Login control is on the login page as defined by `loginUrl` setting in the forms authentication configuration; this setting's default value is `Login.aspx`</span></span>
- <span data-ttu-id="a5cd3-193">La presenza di un `ReturnUrl` parametro querystring</span><span class="sxs-lookup"><span data-stu-id="a5cd3-193">The presence of a `ReturnUrl` querystring parameter</span></span>
- <span data-ttu-id="a5cd3-194">Il valore del controllo dell'account di accesso [ `DestinationUrl` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-194">The value of the Login control's [`DestinationUrl` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.destinationpageurl.aspx)</span></span>
- <span data-ttu-id="a5cd3-195">Il `defaultUrl` valore specificato nei form di impostazioni di configurazione di autenticazione; valore predefinito di questa impostazione è `Default.aspx`</span><span class="sxs-lookup"><span data-stu-id="a5cd3-195">The `defaultUrl` value specified in the forms authentication configuration settings; this setting's default value is `Default.aspx`</span></span>

<span data-ttu-id="a5cd3-196">Figura 4 illustra come il controllo di accesso utilizza questi quattro parametri per giungere a decisione pagina appropriata.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-196">Figure 4 depicts the how the Login control uses these four parameters to arrive at its appropriate page decision.</span></span>


<span data-ttu-id="a5cd3-197">[![Aggiungere un controllo di accesso alla pagina](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-197">[![Add a Login Control to the Page](validating-user-credentials-against-the-membership-user-store-cs/_static/image11.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image10.png)</span></span>

<span data-ttu-id="a5cd3-198">**Figura 4**: aggiungere un controllo di accesso alla pagina ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-198">**Figure 4**: Add a Login Control to the Page  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image12.png))</span></span>


<span data-ttu-id="a5cd3-199">È opportuno testare il controllo di accesso per visitare il sito tramite un browser e accedere come un utente esistente nel framework di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-199">Take a moment to test out the Login control by visiting the site through a browser and logging in as an existing user in the Membership framework.</span></span>

<span data-ttu-id="a5cd3-200">Interfaccia viene eseguito il rendering del controllo di accesso è configurabile.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-200">The Login control's rendered interface is highly configurable.</span></span> <span data-ttu-id="a5cd3-201">Esistono una serie di proprietà che determinano l'aspetto; Inoltre, il controllo di accesso può essere convertito in un modello per un controllo preciso il layout di elementi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-201">There are a number of properties that influence its appearance; what's more, the Login control can be converted into a template for precise control over the layout the user interface elements.</span></span> <span data-ttu-id="a5cd3-202">Nella parte restante di questo passaggio viene illustrato come personalizzare l'aspetto e il layout.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-202">The remainder of this step examines how to customize the appearance and layout.</span></span>

### <a name="customizing-the-login-controls-appearance"></a><span data-ttu-id="a5cd3-203">Personalizzazione dell'aspetto del controllo di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-203">Customizing the Login Control's Appearance</span></span>

<span data-ttu-id="a5cd3-204">Impostazioni predefinite delle proprietà del controllo di accesso il rendering di un'interfaccia utente con un titolo (Log), i controlli casella di testo e l'etichetta per gli input dell'utente e password, un memorizza dati la volta successiva in casella di controllo e un pulsante Accedi.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-204">The Login control's default property settings render a user interface with a title ( Log In ), TextBox and Label controls for the username and password inputs, a Remember me next time CheckBox, and a Log In button.</span></span> <span data-ttu-id="a5cd3-205">Gli aspetti di questi elementi sono tutti configurabili tramite numerose proprietà del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-205">The appearances of these elements are all configurable through the Login control's numerous properties.</span></span> <span data-ttu-id="a5cd3-206">Inoltre, è possono inserire elementi dell'interfaccia utente aggiuntive, ad esempio un collegamento a una pagina per creare un nuovo account utente - impostando una proprietà o due.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-206">Furthermore, additional user interface elements - such as a link to a page to create a new user account - can be added by setting a property or two.</span></span>

<span data-ttu-id="a5cd3-207">Richiederà qualche minuto per abbellire l'aspetto del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-207">Let's spend a few moments to gussy up the appearance of our Login control.</span></span> <span data-ttu-id="a5cd3-208">Poiché il `Login.aspx` pagina già presente del testo nella parte superiore della pagina di accesso, il titolo del controllo di accesso è superfluo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-208">Since the `Login.aspx` page already has text at the top of the page that says Login, the Login control's title is superfluous.</span></span> <span data-ttu-id="a5cd3-209">Pertanto, cancellare il [ `TitleText` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) valore allo scopo di rimuovere il titolo del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-209">Therefore, clear out the [`TitleText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.titletext.aspx) value in order to remove the Login control's title.</span></span>

<span data-ttu-id="a5cd3-210">Il nome utente: e la Password: etichette a sinistra dei due controlli casella di testo possono essere personalizzate tramite la [ `UserNameLabelText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) e [ `PasswordLabelText` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-210">The User Name: and Password: Labels to the left of the two TextBox controls can be customized through the [`UserNameLabelText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.usernamelabeltext.aspx) and [`PasswordLabelText` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordlabeltext.aspx), respectively.</span></span> <span data-ttu-id="a5cd3-211">Modificare il nome utente: etichetta di leggere il nome utente:.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-211">Let's change the User Name: Label to read Username:.</span></span> <span data-ttu-id="a5cd3-212">Gli stili di etichetta e casella di testo possono essere configurati tramite la [ `LabelStyle` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) e [ `TextBoxStyle` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-212">The Label and TextBox styles are configurable through the [`LabelStyle`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.labelstyle.aspx) and [`TextBoxStyle` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textboxstyle.aspx), respectively.</span></span>

<span data-ttu-id="a5cd3-213">Il memorizza dati per la proprietà Text del successiva ora casella di controllo può essere impostato tramite il controllo di accesso [ `RememberMeText property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), e all'impostazione predefinita è archiviato lo stato è configurabile tramite il [ `RememberMeSet property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (che valore predefinito è False).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-213">The Remember me next time CheckBox's Text property can be set through the Login control's [`RememberMeText property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermetext.aspx), and its default checked state is configurable through the [`RememberMeSet property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.remembermeset.aspx) (which defaults to False).</span></span> <span data-ttu-id="a5cd3-214">Per impostare il `RememberMeSet` proprietà su True in modo che memorizza dati la volta successiva in casella di controllo verrà controllato dall'impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-214">Go ahead and set the `RememberMeSet` property to True so that the Remember me next time CheckBox will be checked by default.</span></span>

<span data-ttu-id="a5cd3-215">Il controllo di accesso sono disponibili due proprietà per regolare il layout dei controlli dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-215">The Login control offers two properties for adjusting the layout of its user interface controls.</span></span> <span data-ttu-id="a5cd3-216">Il [ `TextLayout property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indica se il nome utente: e la Password: vengono visualizzate le etichette a sinistra della loro corrispondente nelle caselle di testo (impostazione predefinita) o di sopra di essi.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-216">The [`TextLayout property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.textlayout.aspx) indicates whether the Username: and Password: Labels appear to the left of their corresponding TextBoxes (the default), or above them.</span></span> <span data-ttu-id="a5cd3-217">Il [ `Orientation property` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indica se gli input di nome utente e password sono situati in verticale (uno sopra l'altro) o in orizzontale.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-217">The [`Orientation property`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.orientation.aspx) indicates whether the username and password inputs are situated vertically (one above the other) or horizontally.</span></span> <span data-ttu-id="a5cd3-218">Ora di lasciare queste due proprietà impostate sui valori predefiniti, ma si consiglia di provare a impostare queste due proprietà in base ai valori non predefiniti per visualizzare l'effetto risulta.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-218">I am going to leave these two properties set to their defaults, but I encourage you to try setting these two properties to their non-default values to see the resulting effect.</span></span>

> [!NOTE]
> <span data-ttu-id="a5cd3-219">Nella sezione successiva, la configurazione di Layout del controllo di accesso, verranno esaminati l'utilizzo di modelli per definire il layout preciso di elementi dell'interfaccia utente del controllo di Layout.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-219">In the next section, Configuring the Login Control's Layout, we will look at using templates to define the precise layout of the Layout control's user interface elements.</span></span>


<span data-ttu-id="a5cd3-220">Riepilogo impostazioni delle proprietà del controllo di accesso mediante l'impostazione di [ `CreateUserText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) e [ `CreateUserUrl` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) a non ancora registrato?</span><span class="sxs-lookup"><span data-stu-id="a5cd3-220">Wrap up the Login control's property settings by setting the [`CreateUserText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createusertext.aspx) and [`CreateUserUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.createuserurl.aspx) to Not registered yet?</span></span> <span data-ttu-id="a5cd3-221">Creare un account.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-221">Create an account!</span></span> <span data-ttu-id="a5cd3-222">e `~/Membership/CreatingUserAccounts.aspx`, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-222">and `~/Membership/CreatingUserAccounts.aspx`, respectively.</span></span> <span data-ttu-id="a5cd3-223">Consente di aggiungere un collegamento ipertestuale all'interfaccia del controllo di accesso che punta alla pagina creata nel <a id="SKM6"> </a> [esercitazione precedente](creating-user-accounts-cs.md).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-223">This adds a hyperlink to the Login control's interface pointing to the page we created in the <a id="SKM6"></a>[preceding tutorial](creating-user-accounts-cs.md).</span></span> <span data-ttu-id="a5cd3-224">Il controllo di accesso [ `HelpPageText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) e [ `HelpPageUrl` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) e [ `PasswordRecoveryText` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) e [ `PasswordRecoveryUrl` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) funzionano nello stesso modo, il rendering di collegamenti a una pagina della Guida in linea e una pagina di recupero della password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-224">The Login control's [`HelpPageText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppagetext.aspx) and [`HelpPageUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.helppageurl.aspx) and [`PasswordRecoveryText`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoverytext.aspx) and [`PasswordRecoveryUrl` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.passwordrecoveryurl.aspx) work in the same manner, rendering links to a help page and a password recovery page.</span></span>

<span data-ttu-id="a5cd3-225">Dopo aver apportato queste modifiche delle proprietà, markup dichiarativo e l'aspetto del controllo di accesso dovrebbe essere simile a quanto illustrato nella figura 5.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-225">After making these property changes, your Login control's declarative markup and appearance should look similar to that shown in Figure 5.</span></span>


<span data-ttu-id="a5cd3-226">[![I valori delle proprietà del controllo dell'account di accesso determinano l'aspetto](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-226">[![The Login Control's Properties' Values Dictate Its Appearance](validating-user-credentials-against-the-membership-user-store-cs/_static/image14.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image13.png)</span></span>

<span data-ttu-id="a5cd3-227">**Figura 5**: valori determinano suo aspetto le proprietà del controllo di accesso di ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-227">**Figure 5**: The Login Control's Properties' Values Dictate Its Appearance  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image15.png))</span></span>


### <a name="configuring-the-login-controls-layout"></a><span data-ttu-id="a5cd3-228">Configurazione di Layout del controllo di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-228">Configuring the Login Control's Layout</span></span>

<span data-ttu-id="a5cd3-229">L'account di accesso Web predefinito interfaccia utente di controllo è disposto dall'interfaccia in un elemento HTML `<table>`.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-229">The Login Web control's default user interface lays out the interface in an HTML `<table>`.</span></span> <span data-ttu-id="a5cd3-230">Ma cosa accade se è necessario un maggiore controllo sull'output del rendering?</span><span class="sxs-lookup"><span data-stu-id="a5cd3-230">But what if we need finer control over the rendered output?</span></span> <span data-ttu-id="a5cd3-231">Forse si desidera sostituire il `<table>` con una serie di `<div>` tag.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-231">Maybe we want to replace the `<table>` with a series of `<div>` tags.</span></span> <span data-ttu-id="a5cd3-232">O se l'applicazione richiede ulteriori credenziali per l'autenticazione?</span><span class="sxs-lookup"><span data-stu-id="a5cd3-232">Or what if our application requires additional credentials for authentication?</span></span> <span data-ttu-id="a5cd3-233">Molti siti Web finanziari, ad esempio, richiedere agli utenti di specificare non solo un nome utente e password, ma anche un numero di identificazione personale (PIN) o altre informazioni di identificazione.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-233">Many financial websites, for instance, require users to supply not only a username and password, but also a Personal Identification Number (PIN), or other identifying information.</span></span> <span data-ttu-id="a5cd3-234">L'elemento potrebbero essere i motivi, è possibile convertire il controllo di accesso in un modello, da cui è possibile definire in modo esplicito il markup dichiarativo dell'interfaccia.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-234">Whatever the reasons may be, it is possible to convert the Login control into a template, from which we can explicitly define the interface's declarative markup.</span></span>

<span data-ttu-id="a5cd3-235">È necessario eseguire due operazioni per aggiornare il controllo di accesso per raccogliere ulteriori credenziali:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-235">We need to do two things in order to update the Login control to collect additional credentials:</span></span>

1. <span data-ttu-id="a5cd3-236">Aggiornare l'interfaccia del controllo di accesso per includere i controlli Web per raccogliere le credenziali aggiuntive.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-236">Update the Login control's interface to include Web control(s) to collect the additional credentials.</span></span>
2. <span data-ttu-id="a5cd3-237">Eseguire l'override della logica di autenticazione interna del controllo di accesso in modo che un utente è autenticato solo se il nome utente e la password è valido e le proprie credenziali aggiuntive sono valide, troppo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-237">Override the Login control's internal authentication logic so that a user is only authenticated if their username and password is valid and their additional credentials are valid, too.</span></span>

<span data-ttu-id="a5cd3-238">Per eseguire la prima attività, è necessario convertire il controllo di accesso in un modello e aggiungere i controlli Web necessari.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-238">To accomplish the first task, we need to convert the Login control into a template and add the necessary Web controls.</span></span> <span data-ttu-id="a5cd3-239">Come per la seconda attività, la logica di autenticazione del controllo di accesso può essere sostituita da creare un gestore eventi per il controllo [ `Authenticate` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-239">As for the second task, the Login control's authentication logic can be superseded by creating an event handler for the control's [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span>

<span data-ttu-id="a5cd3-240">Si aggiorna il controllo di accesso in modo che richiede agli utenti il nome utente, password e l'indirizzo di posta elettronica solo autentica l'utente se l'indirizzo di posta elettronica fornito corrisponde l'indirizzo di posta elettronica nel file.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-240">Let's update the Login control so that it prompts users for their username, password, and email address and only authenticates the user if the email address supplied matches their email address on file.</span></span> <span data-ttu-id="a5cd3-241">È innanzitutto necessario convertire l'interfaccia del controllo di accesso a un modello.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-241">We first need to convert the Login control's interface to a template.</span></span> <span data-ttu-id="a5cd3-242">Smart Tag del controllo di accesso, scegliere la funzione Convert per l'opzione del modello.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-242">From the Login control's Smart Tag, choose the Convert to template option.</span></span>


<span data-ttu-id="a5cd3-243">[![Convertire il controllo di accesso a un modello](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-243">[![Convert the Login Control to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image17.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image16.png)</span></span>

<span data-ttu-id="a5cd3-244">**Figura 6**: convertire un modello di controllo di accesso ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-244">**Figure 6**: Convert the Login Control to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image18.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a5cd3-245">Per ripristinare il controllo di accesso con la versione pre-templata, fare clic sul collegamento di reimpostazione da Smart Tag del controllo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-245">To revert the Login control to its pre-template version, click the Reset link from the control's Smart Tag.</span></span>


<span data-ttu-id="a5cd3-246">Conversione del controllo di accesso a un modello aggiunge un `LayoutTemplate` al markup dichiarativo del controllo con gli elementi HTML e controlli Web di definizione dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-246">Converting the Login control to a template adds a `LayoutTemplate` to the control's declarative markup with HTML elements and Web controls defining the user interface.</span></span> <span data-ttu-id="a5cd3-247">Come illustrato nella figura 7, conversione il controllo in un modello consente di rimuovere un numero di proprietà dalla finestra delle proprietà, ad esempio `TitleText`, `CreateUserUrl`e così via, in quanto questi valori vengono ignorati quando si utilizza un modello.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-247">As Figure 7 shows, converting the control to a template removes a number of properties from the Properties window, such as `TitleText`, `CreateUserUrl`, and so forth, since these property values are ignored when using a template.</span></span>


<span data-ttu-id="a5cd3-248">[![Le proprietà di un numero inferiore sono che disponibili quando il controllo di accesso viene convertito in un modello](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-248">[![Fewer Properties are Available When the Login Control is Converted to a Template](validating-user-credentials-against-the-membership-user-store-cs/_static/image20.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image19.png)</span></span>

<span data-ttu-id="a5cd3-249">**Figura 7**: le proprietà di un numero inferiore sono disponibili quando il controllo di accesso viene convertito in un modello ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-249">**Figure 7**: Fewer Properties are Available When the Login Control is Converted to a Template  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image21.png))</span></span>


<span data-ttu-id="a5cd3-250">Il markup HTML nel `LayoutTemplate` può essere modificato in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-250">The HTML markup in the `LayoutTemplate` may be modified as needed.</span></span> <span data-ttu-id="a5cd3-251">Analogamente, è possibile aggiungere nuovi controlli Web per il modello.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-251">Likewise, feel free to add any new Web controls to the template.</span></span> <span data-ttu-id="a5cd3-252">Tuttavia, è importante tale account di accesso core Web controlli rimangono nel modello e mantenere assegnato loro `ID` valori.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-252">However, it is important that Login control's core Web controls remain in the template and keep their assigned `ID` values.</span></span> <span data-ttu-id="a5cd3-253">In particolare, non rimuovere o rinominare il `UserName` o `Password` nelle caselle di testo, il `RememberMe` casella di controllo, il `LoginButton` pulsante, il `FailureText` etichetta, o `RequiredFieldValidator` controlli.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-253">In particular, do not remove or rename the `UserName` or `Password` TextBoxes, the `RememberMe` CheckBox, the `LoginButton` Button, the `FailureText` Label, or the `RequiredFieldValidator` controls.</span></span>

<span data-ttu-id="a5cd3-254">Per raccogliere l'indirizzo di posta elettronica del visitatore, è necessario aggiungere una casella di testo per il modello.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-254">To collect the visitor's email address, we need to add a TextBox to the template.</span></span> <span data-ttu-id="a5cd3-255">Aggiungere il seguente markup dichiarativo tra la riga della tabella (`<tr>`) che contiene il `Password` casella di testo e la riga della tabella che contiene memorizza dati accanto tempo casella di controllo:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-255">Add the following declarative markup between the table row (`<tr>`) that contains the `Password` TextBox and the table row that holds the Remember me next time CheckBox:</span></span>

[!code-aspx[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample2.aspx)]

<span data-ttu-id="a5cd3-256">Dopo aver aggiunto il `Email` casella di testo, visitare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-256">After adding the `Email` TextBox, visit the page through a browser.</span></span> <span data-ttu-id="a5cd3-257">Come illustrato nella figura 8, interfaccia utente del controllo di accesso include ora una terza casella di testo.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-257">As Figure 8 shows, the Login control's user interface now includes a third textbox.</span></span>


<span data-ttu-id="a5cd3-258">[![Il controllo di accesso include ora una casella di testo per l'indirizzo di posta elettronica dell'utente](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-258">[![The Login Control Now Includes a Textbox for the User's Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image23.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image22.png)</span></span>

<span data-ttu-id="a5cd3-259">**Figura 8**: ora controllo di accesso include una casella di testo per l'indirizzo di posta elettronica dell'utente ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-259">**Figure 8**: The Login Control Now Includes a Textbox for the User's Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image24.png))</span></span>


<span data-ttu-id="a5cd3-260">A questo punto, il controllo di accesso utilizza ancora la `Membership.ValidateUser` metodo per convalidare le credenziali fornite.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-260">At this point, the Login control is still using the `Membership.ValidateUser` method to validate the supplied credentials.</span></span> <span data-ttu-id="a5cd3-261">Di conseguenza, il valore immesso nella `Email` casella di testo non incide sul se l'utente può accedere.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-261">Correspondingly, the value entered into the `Email` TextBox has no bearing on whether the user can log in.</span></span> <span data-ttu-id="a5cd3-262">Nel passaggio 3 verranno esaminati come eseguire l'override di logica di autenticazione del controllo di accesso in modo che le credenziali vengono considerate valide solo se il nome utente e la password siano validi e l'indirizzo di posta elettronica specificato corrisponde all'indirizzo di posta elettronica nel file.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-262">In Step 3 we will look at how to override the Login control's authentication logic so that the credentials are only considered valid if the username and password are valid and the supplied email address matches up with the email address on file.</span></span>

## <a name="step-3-modifying-the-login-controls-authentication-logic"></a><span data-ttu-id="a5cd3-263">Passaggio 3: Modificare la logica di autenticazione del controllo di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-263">Step 3: Modifying the Login Control's Authentication Logic</span></span>

<span data-ttu-id="a5cd3-264">Quando un visitatore del proprio credenziali e fa clic che sul pulsante Accedi, un postback viene utilizzata e l'account di accesso controllo attraversa il flusso di lavoro di autenticazione.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-264">When a visitor supplies her credentials and clicks the Log In button, a postback ensues and the Login control progresses through its authentication workflow.</span></span> <span data-ttu-id="a5cd3-265">Avvia il flusso di lavoro mediante la generazione di [ `LoggingIn` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-265">The workflow starts by raising the [`LoggingIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggingin.aspx).</span></span> <span data-ttu-id="a5cd3-266">I gestori di eventi associati a questo evento possono annullare il log in operazione impostando il `e.Cancel` proprietà `true`.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-266">Any event handlers associated with this event may cancel the log in operation by setting the `e.Cancel` property to `true`.</span></span>

<span data-ttu-id="a5cd3-267">Se il log attivo non viene annullato, il flusso di lavoro che passa attraverso la visualizzazione di [ `Authenticate` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-267">If the log in operation is not cancelled, the workflow progresses by raising the [`Authenticate` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.authenticate.aspx).</span></span> <span data-ttu-id="a5cd3-268">Se è presente un gestore eventi per il `Authenticate` evento, è responsabile di determinare se le credenziali fornite sono valide o non.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-268">If there is an event handler for the `Authenticate` event, then it is responsible for determining whether the supplied credentials are valid or not.</span></span> <span data-ttu-id="a5cd3-269">Se non viene specificato alcun gestore di evento, il controllo di accesso utilizza il `Membership.ValidateUser` metodo per determinare la validità delle credenziali.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-269">If no event handler is specified, the Login control uses the `Membership.ValidateUser` method to determine the validity of the credentials.</span></span>

<span data-ttu-id="a5cd3-270">Se le credenziali fornite sono valide, quindi viene creato il ticket di autenticazione form, il [ `LoggedIn` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) viene generato e l'utente viene reindirizzato alla pagina appropriata.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-270">If the supplied credentials are valid, then the forms authentication ticket is created, the [`LoggedIn` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loggedin.aspx) is raised, and the user is redirected to the appropriate page.</span></span> <span data-ttu-id="a5cd3-271">Se, tuttavia, le credenziali sono considerate non validi, quindi il [ `LoginError` evento](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) viene generato e viene visualizzato un messaggio che informa l'utente che le credenziali non sono valide.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-271">If, however, the credentials are deemed invalid, then the [`LoginError` event](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.loginerror.aspx) is raised and a message is displayed informing the user that their credentials were invalid.</span></span> <span data-ttu-id="a5cd3-272">Per impostazione predefinita, in caso di errore dell'account di accesso controllo semplicemente imposta relativo `FailureText` etichetta proprietà Text del controllo a un messaggio di errore (tentativo di accesso non è riuscito.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-272">By default, on failure the Login control simply sets its `FailureText` Label control's Text property to a failure message ( Your login attempt was not successful.</span></span> <span data-ttu-id="a5cd3-273">Riprova in seguito).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-273">Please try again ).</span></span> <span data-ttu-id="a5cd3-274">Tuttavia, se il controllo di accesso [ `FailureAction` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) è impostato su `RedirectToLoginPage`, quindi i problemi di controllo di accesso un `Response.Redirect` alla pagina di accesso aggiungendo il parametro querystring `loginfailure=1` (che fa sì che l'account di accesso viene visualizzato il messaggio di errore).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-274">However, if the Login control's [`FailureAction` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failureaction.aspx) is set to `RedirectToLoginPage`, then the Login control issues a `Response.Redirect` to the login page appending the querystring parameter `loginfailure=1` (which causes the Login control to display the failure message).</span></span>

<span data-ttu-id="a5cd3-275">Figura 9 offre un diagramma di flusso del flusso di lavoro autenticazione.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-275">Figure 9 offers a flow chart of the authentication workflow.</span></span>


<span data-ttu-id="a5cd3-276">[![Flusso di lavoro autenticazione del controllo dell'account di accesso](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-276">[![The Login Control's Authentication Workflow](validating-user-credentials-against-the-membership-user-store-cs/_static/image26.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image25.png)</span></span>

<span data-ttu-id="a5cd3-277">**Figura 9**: flusso di lavoro del controllo di accesso di autenticazione ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-277">**Figure 9**: The Login Control's Authentication Workflow  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image27.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a5cd3-278">Sapere quando si utilizza il `FailureAction`del `RedirectToLogin` pagina opzione, si consideri lo scenario seguente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-278">If you are wondering when you would use the `FailureAction`'s `RedirectToLogin` page option, consider the following scenario.</span></span> <span data-ttu-id="a5cd3-279">Ora il nostro `Site.master` pagina master è attualmente il testo, Hello, stranger visualizzato nella colonna sinistra quando visitato da un utente anonimo, ma si supponga di voler sostituire il testo con un controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-279">Right now our `Site.master` master page currently has the text, Hello, stranger displayed in the left column when visited by an anonymous user, but imagine that we wanted to replace that text with a Login control.</span></span> <span data-ttu-id="a5cd3-280">In questo modo un utente anonimo accedere da qualsiasi pagina del sito, anziché dover direttamente, visitare la pagina di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-280">This would allow an anonymous user to log in from any page on the site, instead of requiring them to visit the login page directly.</span></span> <span data-ttu-id="a5cd3-281">Tuttavia, se un utente non è in grado di accedere mediante il controllo di accesso di rendering della pagina master, può rivelarsi utile per reindirizza alla pagina di accesso (`Login.aspx`) poiché tale pagina è probabile che include istruzioni aggiuntive, i collegamenti e altre informazioni della Guida, ad esempio i collegamenti per creare un nuovo account o recuperare una password persa - che non sono stati aggiunti alla pagina master.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-281">However, if a user was unable to log in via the Login control rendered by the master page, it might make sense to redirect them to the login page (`Login.aspx`) because that page likely includes additional instructions, links, and other help - such as links to create a new account or retrieve a lost password - that were not added to the master page.</span></span>


### <a name="creating-theauthenticateevent-handler"></a><span data-ttu-id="a5cd3-282">Creazione di`Authenticate`gestore dell'evento</span><span class="sxs-lookup"><span data-stu-id="a5cd3-282">Creating the`Authenticate`Event Handler</span></span>

<span data-ttu-id="a5cd3-283">Per inserire la logica di autenticazione personalizzata, è necessario creare un gestore eventi per il controllo di accesso `Authenticate` evento.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-283">In order to plug in our custom authentication logic, we need to create an event handler for the Login control's `Authenticate` event.</span></span> <span data-ttu-id="a5cd3-284">Creazione di un gestore eventi per il `Authenticate` evento genererà la definizione del gestore di evento seguente:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-284">Creating an event handler for the `Authenticate` event will generate the following event handler definition:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample3.cs)]

<span data-ttu-id="a5cd3-285">Come si può notare, la `Authenticate` gestore eventi viene passato un oggetto di tipo [ `AuthenticateEventArgs` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) come il secondo parametro di input.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-285">As you can see, the `Authenticate` event handler is passed an object of type [`AuthenticateEventArgs`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.authenticateeventargs.aspx) as its second input parameter.</span></span> <span data-ttu-id="a5cd3-286">Il `AuthenticateEventArgs` classe contiene una proprietà booleana denominata `Authenticated` che viene utilizzata per specificare se le credenziali fornite sono valide.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-286">The `AuthenticateEventArgs` class contains a Boolean property named `Authenticated` that is used to specify whether the supplied credentials are valid.</span></span> <span data-ttu-id="a5cd3-287">L'attività, è quindi scrivere qui il codice che determina se le credenziali fornite sono valide o non e per impostare il `e.Authenticate` proprietà conseguenza.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-287">Our task, then, is to write code here that determines whether the supplied credentials are valid or not, and to set the `e.Authenticate` property accordingly.</span></span>

### <a name="determining-and-validating-the-supplied-credentials"></a><span data-ttu-id="a5cd3-288">Determinare e convalida le credenziali fornite</span><span class="sxs-lookup"><span data-stu-id="a5cd3-288">Determining and Validating the Supplied Credentials</span></span>

<span data-ttu-id="a5cd3-289">Utilizzare il controllo di accesso [ `UserName` ](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) e [ `Password` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) per determinare le credenziali di nome utente e password immesse dall'utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-289">Use the Login control's [`UserName`](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.username.aspx) and [`Password` properties](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.password.aspx) to determine the username and password credentials entered by the user.</span></span> <span data-ttu-id="a5cd3-290">Per determinare i valori immessi in tutti i controlli Web aggiuntivi (ad esempio il `Email` TextBox abbiamo aggiunto nel passaggio precedente), utilizzare *`LoginControlID`* `.FindControl`("*`controlID`*") per ottenere un livello di codice fa riferimento al controllo Web nel modello il cui `ID` proprietà è uguale a *`controlID`*.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-290">In order to determine the values entered into any additional Web controls (such as the `Email` TextBox we added in the previous step), use *`LoginControlID`*`.FindControl`("*`controlID`*") to obtain a programmatic reference to the Web control in the template whose `ID` property is equal to *`controlID`*.</span></span> <span data-ttu-id="a5cd3-291">Ad esempio, per ottenere un riferimento di `Email` casella di testo, utilizzare il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-291">For example, to get a reference to the `Email` TextBox, use the following code:</span></span>

`TextBox EmailTextBox = myLogin.FindControl("Email") as TextBox;`

<span data-ttu-id="a5cd3-292">Per convalidare le credenziali dell'utente è necessario eseguire due operazioni:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-292">In order to validate the user's credentials we need to do two things:</span></span>

1. <span data-ttu-id="a5cd3-293">Verificare che il nome utente specificato e la password siano validi</span><span class="sxs-lookup"><span data-stu-id="a5cd3-293">Ensure that the provided username and password are valid</span></span>
2. <span data-ttu-id="a5cd3-294">Verificare che l'indirizzo di posta elettronica immesso corrisponda l'indirizzo di posta elettronica sul file per l'utente tenta l'accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-294">Ensure that email address entered matches the email address on file for the user attempting to log in</span></span>

<span data-ttu-id="a5cd3-295">Per eseguire il primo controllo, è possibile utilizzare il `Membership.ValidateUser` metodo come illustrato nel passaggio 1.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-295">To accomplish the first check we can simply use the `Membership.ValidateUser` method like we saw in Step 1.</span></span> <span data-ttu-id="a5cd3-296">Per il secondo controllo, è necessario determinare l'indirizzo di posta elettronica dell'utente in modo che è possibile confrontarlo con l'indirizzo di posta elettronica inseriti nel controllo TextBox.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-296">For the second check, we need to determine the user's email address so that we can compare it to the email address they entered into the TextBox control.</span></span> <span data-ttu-id="a5cd3-297">Per ottenere informazioni su un particolare utente, utilizzare il `Membership` della classe [ `GetUser` metodo](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-297">To get information about a particular user, use the `Membership` class's [`GetUser` method](https://msdn.microsoft.com/library/system.web.security.membership.getuser.aspx).</span></span>

<span data-ttu-id="a5cd3-298">Il `GetUser` metodo ha un numero di overload.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-298">The `GetUser` method has a number of overloads.</span></span> <span data-ttu-id="a5cd3-299">Se utilizzato senza passare i parametri, restituisce informazioni sull'utente attualmente connesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-299">If used without passing in any parameters, it returns information about the currently logged in user.</span></span> <span data-ttu-id="a5cd3-300">Per ottenere informazioni su un particolare utente, chiamare `GetUser` passando il nome utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-300">To get information about a particular user, call `GetUser` passing in their username.</span></span> <span data-ttu-id="a5cd3-301">In entrambi i casi, `GetUser` restituisce un [ `MembershipUser` oggetto](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), che dispone di proprietà come `UserName`, `Email`, `IsApproved`, `IsOnline`e così via.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-301">Either way, `GetUser` returns a [`MembershipUser` object](https://msdn.microsoft.com/library/system.web.security.membershipuser.aspx), which has properties like `UserName`, `Email`, `IsApproved`, `IsOnline`, and so on.</span></span>

<span data-ttu-id="a5cd3-302">Il codice seguente implementa questi due controlli.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-302">The following code implements these two checks.</span></span> <span data-ttu-id="a5cd3-303">Se entrambi passa quindi `e.Authenticate` è impostato su `true`, in caso contrario viene assegnato `false`.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-303">If both pass, then `e.Authenticate` is set to `true`, otherwise it is assigned `false`.</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample4.cs)]

<span data-ttu-id="a5cd3-304">Con questo codice, tentare di accedere come utente valido, immettere la correttezza del nome utente, password e l'indirizzo di posta elettronica.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-304">With this code in place, attempt to log in as a valid user, entering the correct username, password, and email address.</span></span> <span data-ttu-id="a5cd3-305">Tentare nuovamente, ma questa volta usare intenzionalmente un indirizzo di posta elettronica non corretto (vedere la figura 10).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-305">Try it again, but this time purposefully use an incorrect email address (see Figure 10).</span></span> <span data-ttu-id="a5cd3-306">Infine, provare una terza volta utilizzando un nome utente inesistente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-306">Finally, try it a third time using a non-existent username.</span></span> <span data-ttu-id="a5cd3-307">Nel primo caso è deve essere connesso al sito, ma negli ultimi due casi verrà visualizzato il messaggio di credenziali non valide del controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-307">In the first case you should be successfully logged on to the site, but in the last two cases you should see the Login control's invalid credentials message.</span></span>


<span data-ttu-id="a5cd3-308">[![Tito non potrà accedere quando si specifica un indirizzo di posta elettronica non corretto](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-308">[![Tito Cannot Log In When Supplying an Incorrect Email Address](validating-user-credentials-against-the-membership-user-store-cs/_static/image29.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image28.png)</span></span>

<span data-ttu-id="a5cd3-309">**Figura 10**: Tito Impossibile Log In quando fornisce un indirizzo di posta elettronica non corretto ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-309">**Figure 10**: Tito Cannot Log In When Supplying an Incorrect Email Address  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image30.png))</span></span>


> [!NOTE]
> <span data-ttu-id="a5cd3-310">Come descritto nella sezione come l'appartenenza al Framework gestisce valido tentativi di accesso nel passaggio 1, quando il `Membership.ValidateUser` metodo viene chiamato e passato delle credenziali non valide, tiene traccia del tentativo di accesso non valido e per bloccare l'utente qualora superino una determinata soglia di tentativi non validi all'interno di un intervallo di tempo specificato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-310">As discussed in the How the Membership Framework Handles Invalid Login Attempts section in Step 1, when the `Membership.ValidateUser` method is called and passed invalid credentials, it keeps track of the invalid login attempt and locks out the user if they exceed a certain threshold of invalid attempts within a specified time window.</span></span> <span data-ttu-id="a5cd3-311">Poiché la logica di autenticazione personalizzato chiama il `ValidateUser` incrementa il contatore dei tentativi di accesso non validi (metodo), una password non corretta per un nome utente valido, ma questo contatore non viene incrementato nel caso in cui il nome utente e password validi, ma la indirizzo di posta elettronica non è corretto.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-311">Since our custom authentication logic calls the `ValidateUser` method, an incorrect password for a valid username will increment the invalid login attempt counter, but this counter is not incremented in the case where the username and password are valid, but the email address is incorrect.</span></span> <span data-ttu-id="a5cd3-312">Probabilità sono, questo comportamento è appropriato, perché è improbabile che un pirata informatico verrà conoscere il nome utente e password, ma è necessario utilizzare le tecniche di attacchi di forza bruta per determinare l'indirizzo di posta elettronica dell'utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-312">Chances are, this behavior is suitable, since it's unlikely that a hacker will know the username and password, but have to use brute force techniques to determine the user's email address.</span></span>


## <a name="step-4-improving-the-login-controls-invalid-credentials-message"></a><span data-ttu-id="a5cd3-313">Passaggio 4: Migliorare messaggio di credenziali non valide del controllo di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-313">Step 4: Improving the Login Control's Invalid Credentials Message</span></span>

<span data-ttu-id="a5cd3-314">Quando un utente tenta di accedere con credenziali non valide, il controllo di accesso viene visualizzato un messaggio che indica che il tentativo di accesso non è riuscito.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-314">When a user attempts to log on with invalid credentials, the Login control displays a message explaining that the login attempt was unsuccessful.</span></span> <span data-ttu-id="a5cd3-315">In particolare, il controllo Visualizza il messaggio specificato dal relativo [ `FailureText` proprietà](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), che presenta un valore predefinito di tentativo di accesso non è riuscita.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-315">In particular, the control displays the message specified by its [`FailureText` property](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.failuretext.aspx), which has a default value of Your login attempt was not successful.</span></span> <span data-ttu-id="a5cd3-316">Riprovare.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-316">Please try again.</span></span>

<span data-ttu-id="a5cd3-317">Tenere presente che vi sono molti i motivi per cui le credenziali dell'utente potrebbero essere non valide:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-317">Recall that there are many reasons why a user's credentials may be invalid:</span></span>

- <span data-ttu-id="a5cd3-318">Il nome utente non esiste</span><span class="sxs-lookup"><span data-stu-id="a5cd3-318">The username may not exist</span></span>
- <span data-ttu-id="a5cd3-319">Il nome utente esiste, ma la password non è valida</span><span class="sxs-lookup"><span data-stu-id="a5cd3-319">The username exists, but the password is invalid</span></span>
- <span data-ttu-id="a5cd3-320">Il nome utente e password sono validi, ma l'utente non è ancora approvato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-320">The username and password are valid, but the user is not yet approved</span></span>
- <span data-ttu-id="a5cd3-321">Il nome utente e password sono validi, ma l'utente è bloccato out (probabilmente perché è stato superato il numero di tentativi di accesso non valido nell'intervallo di tempo specificato)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-321">The username and password are valid, but the user is locked out (most likely because they exceeded the number of invalid login attempts within the specified time frame)</span></span>

<span data-ttu-id="a5cd3-322">E potrebbero essere presenti altri motivi quando si utilizza la logica di autenticazione personalizzato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-322">And there may be other reasons when using custom authentication logic.</span></span> <span data-ttu-id="a5cd3-323">Ad esempio, con il codice è stata scritta nel passaggio 3, il nome utente e password siano valide, ma l'indirizzo di posta elettronica potrebbe non essere corretto.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-323">For example, with the code we wrote in Step 3, the username and password may be valid, but the email address may be incorrect.</span></span>

<span data-ttu-id="a5cd3-324">Indipendentemente dal motivo per cui le credenziali sono valide, il controllo di accesso consente di visualizzare lo stesso messaggio di errore.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-324">Regardless of why the credentials are invalid, the Login control displays the same error message.</span></span> <span data-ttu-id="a5cd3-325">La mancanza di commenti e suggerimenti può essere ambigui per un utente il cui account non è ancora stata approvata o che è stato bloccato. Con un minimo di lavoro, tuttavia, possibile abbiamo il controllo di accesso viene visualizzato un messaggio più appropriato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-325">This lack of feedback can be confusing for a user whose account has not yet been approved or who has been locked out. With a little bit of work, though, we can have the Login control display a more appropriate message.</span></span>

<span data-ttu-id="a5cd3-326">Ogni volta che un utente tenta di accedere con credenziali non valide genera il controllo di accesso relativo `LoginError` evento.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-326">Whenever a user attempts to login with invalid credentials the Login control raises its `LoginError` event.</span></span> <span data-ttu-id="a5cd3-327">Vado avanti e creare un gestore eventi per questo evento e aggiungere il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-327">Go ahead and create an event handler for this event, and add the following code:</span></span>

[!code-csharp[Main](validating-user-credentials-against-the-membership-user-store-cs/samples/sample5.cs)]

<span data-ttu-id="a5cd3-328">Il codice sopra riportato viene avviato, impostare il controllo di accesso `FailureText` proprietà sul valore predefinito (tentativo di accesso non è riuscito.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-328">The above code starts by setting the Login control's `FailureText` property to the default value ( Your login attempt was not successful.</span></span> <span data-ttu-id="a5cd3-329">Riprova in seguito).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-329">Please try again ).</span></span> <span data-ttu-id="a5cd3-330">Viene quindi verificato se il nome utente specificato viene eseguito il mapping a un account utente esistente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-330">It then checks to see if the username supplied maps to an existing user account.</span></span> <span data-ttu-id="a5cd3-331">Se in tal caso, consulta risultante `MembershipUser` dell'oggetto `IsLockedOut` e `IsApproved` le proprietà per determinare se l'account è stato bloccato o non è ancora stato approvato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-331">If so, it consults the resulting `MembershipUser` object's `IsLockedOut` and `IsApproved` properties to determine if the account has been locked out or has not yet been approved.</span></span> <span data-ttu-id="a5cd3-332">In entrambi i casi il `FailureText` proprietà viene aggiornata in un valore corrispondente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-332">In either case, the `FailureText` property is updated to a corresponding value.</span></span>

<span data-ttu-id="a5cd3-333">Per testare questo codice, intenzionalmente tentare di accedere come un utente esistente, ma utilizzare una password errata.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-333">To test this code, purposefully attempt to log in as an existing user, but use an incorrect password.</span></span> <span data-ttu-id="a5cd3-334">Eseguire l'operazione di cinque volte in una riga all'interno di un intervallo di tempo di 10 minuti e l'account verrà bloccato. Come illustrato nella figura 11, accesso successivi tentativi verranno viene sempre esito negativo (anche con la password corretta), ma verranno visualizzati più descrittivo, l'account è stato bloccato a causa di troppi tentativi di accesso non valido.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-334">Do this five times in a row within a 10 minute time frame and the account will be locked out. As Figure 11 shows, subsequent login attempts will always fail (even with the correct password), but will now display the more descriptive Your account has been locked out because of too many invalid login attempts.</span></span> <span data-ttu-id="a5cd3-335">Contattare l'amministratore per il messaggio di sbloccare account.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-335">Please contact the administrator to have your account unlocked message.</span></span>


<span data-ttu-id="a5cd3-336">[![Tito eseguiti troppi tentativi di accesso non valide ed è stato bloccato](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-336">[![Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out](validating-user-credentials-against-the-membership-user-store-cs/_static/image32.png)](validating-user-credentials-against-the-membership-user-store-cs/_static/image31.png)</span></span>

<span data-ttu-id="a5cd3-337">**Figura 11**: Tito eseguita troppo numerosi tentativi non validi dell'account di accesso ed è stato bloccato ([fare clic per visualizzare l'immagine ingrandita](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span><span class="sxs-lookup"><span data-stu-id="a5cd3-337">**Figure 11**: Tito Performed Too Many Invalid Login Attempts and Has Been Locked Out  ([Click to view full-size image](validating-user-credentials-against-the-membership-user-store-cs/_static/image33.png))</span></span>


## <a name="summary"></a><span data-ttu-id="a5cd3-338">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="a5cd3-338">Summary</span></span>

<span data-ttu-id="a5cd3-339">Precedenti in questa esercitazione, la pagina di accesso convalidato le credenziali specificate con un elenco hardcoded di coppie di nome utente/password.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-339">Prior this tutorial, our login page validated the supplied credentials against a hard-coded list of username/password pairs.</span></span> <span data-ttu-id="a5cd3-340">In questa esercitazione è stata aggiornata la pagina per convalidare le credenziali per il framework di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-340">In this tutorial, we updated the page to validate credentials against the Membership framework.</span></span> <span data-ttu-id="a5cd3-341">Nel passaggio 1 è stato esaminato utilizzando le `Membership.ValidateUser` metodo a livello di codice.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-341">In Step 1 we looked at using the `Membership.ValidateUser` method programmatically.</span></span> <span data-ttu-id="a5cd3-342">Nel passaggio 2 pertanto abbiamo sostituito l'interfaccia utente creato manualmente e il codice con il controllo di accesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-342">In Step 2 we replaced our manually created user interface and code with the Login control.</span></span>

<span data-ttu-id="a5cd3-343">Il controllo di accesso viene eseguito il rendering di un'interfaccia utente di accesso standard e consente di convalidare automaticamente le credenziali dell'utente per il framework di appartenenza.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-343">The Login control renders a standard login user interface and automatically validates the user's credentials against the Membership framework.</span></span> <span data-ttu-id="a5cd3-344">Inoltre, in caso di credenziali valide, il controllo di accesso accede l'utente tramite l'autenticazione basata su form.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-344">Moreover, in the event of valid credentials, the Login control signs the user in via forms authentication.</span></span> <span data-ttu-id="a5cd3-345">In breve, è disponibile un'esperienza utente di accesso completamente funzionale semplicemente trascinando il controllo di accesso su una pagina, non molto dichiarativi markup o codice necessario.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-345">In short, a fully functional login user experience is available by simply dragging the Login control onto a page, no extra declarative markup or code necessary.</span></span> <span data-ttu-id="a5cd3-346">In particolare, il controllo di accesso è altamente personalizzabile, consentendo un ottimo livello di controllo sia visualizzabile logica dell'utente dell'interfaccia e l'autenticazione.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-346">What's more, the Login control is highly customizable, allowing for a fine degree of control over both the rendered user interface and authentication logic.</span></span>

<span data-ttu-id="a5cd3-347">A questo punto visitatori del sito possono creare un nuovo account utente e log nel sito, ma non è stato ancora esaminare la limitazione dell'accesso alle pagine in base all'utente autenticato.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-347">At this point visitors to our website can create a new user account and log into the site, but we have yet to look at restricting access to pages based on the authenticated user.</span></span> <span data-ttu-id="a5cd3-348">Attualmente, qualsiasi utente autenticato o anonimo, è possibile visualizzare qualsiasi pagina sul sito.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-348">Currently, any user, authenticated or anonymous, can view any page on our site.</span></span> <span data-ttu-id="a5cd3-349">Oltre a controllare l'accesso alle pagine del sito su base utente dall'utente, potremmo avere alcune pagine la cui funzionalità dipende dall'utente.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-349">Along with controlling access to our site's pages on a user-by-user basis, we might have certain pages whose functionality depends on the user.</span></span> <span data-ttu-id="a5cd3-350">La prossima esercitazione verrà illustrato come limitare l'accesso e delle funzionalità nella pagina in base all'utente connesso.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-350">The next tutorial looks at how to limit access and in-page functionality based on the logged in user.</span></span>

<span data-ttu-id="a5cd3-351">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="a5cd3-351">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="a5cd3-352">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="a5cd3-352">Further Reading</span></span>

<span data-ttu-id="a5cd3-353">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="a5cd3-353">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="a5cd3-354">Visualizzazione di messaggi personalizzati da bloccato e gli utenti di Non approvato</span><span class="sxs-lookup"><span data-stu-id="a5cd3-354">Displaying Custom Messages to Locked Out and Non-Approved Users</span></span>](http://aspnet.4guysfromrolla.com/articles/050306-1.aspx)
- [<span data-ttu-id="a5cd3-355">Analisi di ASP.NET 2.0 appartenenza, ruoli e profilo</span><span class="sxs-lookup"><span data-stu-id="a5cd3-355">Examining ASP.NET 2.0's Membership, Roles, and Profile</span></span>](http://aspnet.4guysfromrolla.com/articles/120705-1.aspx)
- [<span data-ttu-id="a5cd3-356">Procedura: Creare una pagina di accesso ASP.NET</span><span class="sxs-lookup"><span data-stu-id="a5cd3-356">How To: Create an ASP.NET Login Page</span></span>](https://msdn.microsoft.com/library/ms178331.aspx)
- [<span data-ttu-id="a5cd3-357">Documentazione tecnica di controllo dell'account di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-357">Login Control Technical Documentation</span></span>](https://msdn.microsoft.com/library/system.web.ui.webcontrols.login.aspx)
- [<span data-ttu-id="a5cd3-358">Usando i controlli di accesso</span><span class="sxs-lookup"><span data-stu-id="a5cd3-358">Using the Login Controls</span></span>](https://quickstarts.asp.net/QuickStartv20/aspnet/doc/security/login.aspx)

### <a name="about-the-author"></a><span data-ttu-id="a5cd3-359">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="a5cd3-359">About the Author</span></span>

<span data-ttu-id="a5cd3-360">Scott Mitchell, autore di più libri e fondatore di 4GuysFromRolla, ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-360">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="a5cd3-361">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-361">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="a5cd3-362">Il suo ultimo libro è  *[SAM insegna manualmente ASP.NET 2.0 nelle 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-362">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="a5cd3-363">Scott può essere raggiunto al [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) o tramite il suo blog all'indirizzo [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-363">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="a5cd3-364">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="a5cd3-364">Special Thanks To</span></span>

<span data-ttu-id="a5cd3-365">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-365">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="a5cd3-366">Lead revisori per questa esercitazione sono stati Teresa Murphy e Michael Olivero.</span><span class="sxs-lookup"><span data-stu-id="a5cd3-366">Lead reviewers for this tutorial were Teresa Murphy and Michael Olivero.</span></span> <span data-ttu-id="a5cd3-367">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="a5cd3-367">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="a5cd3-368">In caso affermativo, Inviami una riga alla [ mitchell@4GuysFromRolla.com ](mailto:mitchell@4guysfromrolla.com).</span><span class="sxs-lookup"><span data-stu-id="a5cd3-368">If so, drop me a line at [mitchell@4GuysFromRolla.com](mailto:mitchell@4guysfromrolla.com).</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="a5cd3-369">[Precedente](creating-user-accounts-cs.md)
> [Successivo](user-based-authorization-cs.md)</span><span class="sxs-lookup"><span data-stu-id="a5cd3-369">[Previous](creating-user-accounts-cs.md)
[Next](user-based-authorization-cs.md)</span></span>

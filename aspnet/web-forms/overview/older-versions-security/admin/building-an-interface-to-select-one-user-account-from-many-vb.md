---
uid: web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
title: Creazione di un'interfaccia per selezionare un Account utente da molti (VB) | Documenti Microsoft
author: rick-anderson
description: In questa esercitazione verrà compilata un'interfaccia utente con una griglia di paging, filtrabile. In particolare, l'interfaccia utente sarà costituito da una serie di LinkButton per...
ms.author: aspnetcontent
manager: wpickett
ms.date: 04/01/2008
ms.topic: article
ms.assetid: da53380c-a16b-41c7-a20d-24343c735c52
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/older-versions-security/admin/building-an-interface-to-select-one-user-account-from-many-vb
msc.type: authoredcontent
ms.openlocfilehash: 56f4d72993bfcb9629d6b4cd08efe0da6dea2486
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="building-an-interface-to-select-one-user-account-from-many-vb"></a><span data-ttu-id="f606b-104">Creazione di un'interfaccia per selezionare un Account utente da molti (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="f606b-104">Building an Interface to Select One User Account from Many (VB)</span></span>
====================
<span data-ttu-id="f606b-105">da [Scott Mitchell](https://twitter.com/ScottOnWriting)</span><span class="sxs-lookup"><span data-stu-id="f606b-105">by [Scott Mitchell](https://twitter.com/ScottOnWriting)</span></span>

<span data-ttu-id="f606b-106">[Scaricare codice](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) o [Scarica il PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span><span class="sxs-lookup"><span data-stu-id="f606b-106">[Download Code](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/VB.12.zip) or [Download PDF](http://download.microsoft.com/download/6/0/e/60e1bd94-e5f9-4d5a-a079-f23c98f4f67d/aspnet_tutorial12_SelectUser_vb.pdf)</span></span>

> <span data-ttu-id="f606b-107">In questa esercitazione verrà compilata un'interfaccia utente con una griglia di paging, filtrabile.</span><span class="sxs-lookup"><span data-stu-id="f606b-107">In this tutorial we will build a user interface with a paged, filterable grid.</span></span> <span data-ttu-id="f606b-108">In particolare, l'interfaccia utente sarà costituito da una serie di LinkButton per filtrare i risultati in base alla lettera inizia del nome utente e un controllo GridView per visualizzare gli utenti corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="f606b-108">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="f606b-109">Si inizierà elencando tutti gli account utente in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-109">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="f606b-110">Quindi, nel passaggio 3, si aggiungerà il filtro LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f606b-110">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="f606b-111">Passaggio 4 esamina i risultati filtrati di paging.</span><span class="sxs-lookup"><span data-stu-id="f606b-111">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="f606b-112">L'interfaccia creato nei passaggi da 2 a 4 verrà considerato nelle esercitazioni successive per eseguire attività amministrative per un particolare account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-112">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>


## <a name="introduction"></a><span data-ttu-id="f606b-113">Introduzione</span><span class="sxs-lookup"><span data-stu-id="f606b-113">Introduction</span></span>

<span data-ttu-id="f606b-114">Nel <a id="_msoanchor_1"> </a> [ *l'assegnazione di ruoli agli utenti* ](../roles/assigning-roles-to-users-vb.md) esercitazione creata un'interfaccia rudimentale all'amministratore di selezionare un utente e gestire i propri ruoli.</span><span class="sxs-lookup"><span data-stu-id="f606b-114">In the <a id="_msoanchor_1"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, we created a rudimentary interface for an administrator to select a user and manage her roles.</span></span> <span data-ttu-id="f606b-115">In particolare, l'interfaccia visualizzata all'amministratore un elenco a discesa di tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="f606b-115">Specifically, the interface presented the administrator with a drop-down list of all of the users.</span></span> <span data-ttu-id="f606b-116">Tale interfaccia è idoneo quando sono presenti, ma una dozzina utente account, ma è difficile da gestire per i siti con centinaia o migliaia di account.</span><span class="sxs-lookup"><span data-stu-id="f606b-116">Such an interface is suitable when there are but a dozen or so user accounts, but is unwieldy for sites with hundreds or thousands of accounts.</span></span> <span data-ttu-id="f606b-117">Una griglia di paging, filtrabile è più adatto dell'interfaccia utente per i siti Web con basi utente di grandi dimensioni.</span><span class="sxs-lookup"><span data-stu-id="f606b-117">A paged, filterable grid is more suitable user interface for websites with large user bases.</span></span>

<span data-ttu-id="f606b-118">In questa esercitazione verrà compilata un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-118">In this tutorial we will build such a user interface.</span></span> <span data-ttu-id="f606b-119">In particolare, l'interfaccia utente sarà costituito da una serie di LinkButton per filtrare i risultati in base alla lettera inizia del nome utente e un controllo GridView per visualizzare gli utenti corrispondenti.</span><span class="sxs-lookup"><span data-stu-id="f606b-119">In particular, our user interface will consist of a series of LinkButtons for filtering the results based on the starting letter of the username, and a GridView control to show the matching users.</span></span> <span data-ttu-id="f606b-120">Si inizierà elencando tutti gli account utente in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-120">We'll start by listing all of the user accounts in a GridView.</span></span> <span data-ttu-id="f606b-121">Quindi, nel passaggio 3, si aggiungerà il filtro LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f606b-121">Then, in Step 3, we will add the filter LinkButtons.</span></span> <span data-ttu-id="f606b-122">Passaggio 4 esamina i risultati filtrati di paging.</span><span class="sxs-lookup"><span data-stu-id="f606b-122">Step 4 looks at paging the filtered results.</span></span> <span data-ttu-id="f606b-123">L'interfaccia creato nei passaggi da 2 a 4 verrà considerato nelle esercitazioni successive per eseguire attività amministrative per un particolare account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-123">The interface constructed in Steps 2 through 4 will be used in the subsequent tutorials to perform administrative tasks for a particular user account.</span></span>

<span data-ttu-id="f606b-124">Iniziamo!</span><span class="sxs-lookup"><span data-stu-id="f606b-124">Let's get started!</span></span>

## <a name="step-1-adding-new-aspnet-pages"></a><span data-ttu-id="f606b-125">Passaggio 1: Aggiunta di nuove pagine ASP.NET</span><span class="sxs-lookup"><span data-stu-id="f606b-125">Step 1: Adding New ASP.NET Pages</span></span>

<span data-ttu-id="f606b-126">In questa esercitazione e i due successivi è verrà esaminando le funzioni di amministrazione e le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f606b-126">In this tutorial and the next two we will be examining various administration-related functions and capabilities.</span></span> <span data-ttu-id="f606b-127">È necessario una serie di pagine ASP.NET per implementare gli argomenti esaminati in queste esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="f606b-127">We will need a series of ASP.NET pages to implement the topics examined throughout these tutorials.</span></span> <span data-ttu-id="f606b-128">Di seguito creare queste pagine e aggiornare la mappa del sito.</span><span class="sxs-lookup"><span data-stu-id="f606b-128">Let's create these pages and update the site map.</span></span>

<span data-ttu-id="f606b-129">Iniziare creando una nuova cartella nel progetto denominato `Administration`.</span><span class="sxs-lookup"><span data-stu-id="f606b-129">Start by creating a new folder in the project named `Administration`.</span></span> <span data-ttu-id="f606b-130">Successivamente, aggiungere due nuove pagine ASP.NET per la cartella, il collegamento di ogni pagina con il `Site.master` pagina master.</span><span class="sxs-lookup"><span data-stu-id="f606b-130">Next, add two new ASP.NET pages to the folder, linking each page with the `Site.master` master page.</span></span> <span data-ttu-id="f606b-131">Le pagine dei nomi:</span><span class="sxs-lookup"><span data-stu-id="f606b-131">Name the pages:</span></span>

- `ManageUsers.aspx`
- `UserInformation.aspx`

<span data-ttu-id="f606b-132">Aggiungere due pagine alla directory radice del sito Web: `ChangePassword.aspx` e `RecoverPassword.aspx`.</span><span class="sxs-lookup"><span data-stu-id="f606b-132">Also add two pages to the website's root directory: `ChangePassword.aspx` and `RecoverPassword.aspx`.</span></span>

<span data-ttu-id="f606b-133">Queste quattro pagine, a questo punto, è necessario due controlli contenuto, uno per ogni ContentPlaceHolder pagina: `MainContent` e `LoginContent`.</span><span class="sxs-lookup"><span data-stu-id="f606b-133">These four pages should, at this point, have two Content controls, one for each of the master page's ContentPlaceHolders: `MainContent` and `LoginContent`.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample1.aspx)]

<span data-ttu-id="f606b-134">Si desidera mostrare il markup della pagina master predefinita per il `LoginContent` ContentPlaceHolder per tali pagine.</span><span class="sxs-lookup"><span data-stu-id="f606b-134">We want to show the master page's default markup for the `LoginContent` ContentPlaceHolder for these pages.</span></span> <span data-ttu-id="f606b-135">Pertanto, rimuovere il markup dichiarativo per la `Content2` controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="f606b-135">Therefore, remove the declarative markup for the `Content2` Content control.</span></span> <span data-ttu-id="f606b-136">Al termine dell'operazione, il markup alla pagina deve contenere solo un controllo contenuto.</span><span class="sxs-lookup"><span data-stu-id="f606b-136">After doing so, the pages' markup should contain just one Content control.</span></span>

<span data-ttu-id="f606b-137">Pagine ASP.NET il `Administration` cartella sono destinati esclusivamente agli utenti amministratori.</span><span class="sxs-lookup"><span data-stu-id="f606b-137">The ASP.NET pages in the `Administration` folder are intended solely for administrative users.</span></span> <span data-ttu-id="f606b-138">Abbiamo aggiunto un ruolo di amministratore per il sistema di <a id="_msoanchor_2"> </a> [ *creazione e gestione dei ruoli* ](../roles/creating-and-managing-roles-vb.md) esercitazione; limitare l'accesso a queste due pagine per questo ruolo.</span><span class="sxs-lookup"><span data-stu-id="f606b-138">We added an Administrators role to the system in the <a id="_msoanchor_2"></a>[*Creating and Managing Roles*](../roles/creating-and-managing-roles-vb.md) tutorial; restrict access to these two pages to this role.</span></span> <span data-ttu-id="f606b-139">A tale scopo, aggiungere un `Web.config` file per il `Administration` cartella e configurare il `<authorization>` elemento comunque gli utenti del ruolo di amministratori e per impedire tutti gli altri.</span><span class="sxs-lookup"><span data-stu-id="f606b-139">To accomplish this, add a `Web.config` file to the `Administration` folder and configure its `<authorization>` element to admit users in the Administrators role and to deny all others.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample2.xml)]

<span data-ttu-id="f606b-140">Esplora soluzioni del progetto a questo punto dovrebbe essere simile alla schermata illustrata nella figura 1.</span><span class="sxs-lookup"><span data-stu-id="f606b-140">At this point your project's Solution Explorer should look similar to the screen shot shown in Figure 1.</span></span>


<span data-ttu-id="f606b-141">[![Sono stati aggiunti quattro nuove pagine e un File Web. config per il sito Web](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-141">[![Four New Pages and a Web.config File Have Been Added to the Website](building-an-interface-to-select-one-user-account-from-many-vb/_static/image2.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image1.png)</span></span>

<span data-ttu-id="f606b-142">**Figura 1**: quattro nuove pagine e un `Web.config` File sono stati aggiunti al sito Web ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-142">**Figure 1**: Four New Pages and a `Web.config` File Have Been Added to the Website ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image3.png))</span></span>


<span data-ttu-id="f606b-143">Infine, aggiornare la mappa del sito (`Web.sitemap`) per includere una voce per il `ManageUsers.aspx` pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-143">Finally, update the site map (`Web.sitemap`) to include an entry to the `ManageUsers.aspx` page.</span></span> <span data-ttu-id="f606b-144">Aggiungere il seguente codice XML dopo la `<siteMapNode>` abbiamo aggiunto per le esercitazioni di ruoli.</span><span class="sxs-lookup"><span data-stu-id="f606b-144">Add the following XML after the `<siteMapNode>` we added for the Roles tutorials.</span></span>

[!code-xml[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample3.xml)]

<span data-ttu-id="f606b-145">Con la mappa del sito è stata aggiornata, visitare il sito tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f606b-145">With the site map updated, visit the site through a browser.</span></span> <span data-ttu-id="f606b-146">Come illustrato nella figura 2, la navigazione a sinistra ora include gli elementi per le esercitazioni di amministrazione.</span><span class="sxs-lookup"><span data-stu-id="f606b-146">As Figure 2 shows, the navigation on the left now includes items for the Administration tutorials.</span></span>


<span data-ttu-id="f606b-147">[![Mappa del sito include un nodo denominato Amministrazione utenti](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-147">[![The Site Map Includes a Node Titled User Administration](building-an-interface-to-select-one-user-account-from-many-vb/_static/image5.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image4.png)</span></span>

<span data-ttu-id="f606b-148">**Figura 2**: mappa del sito include un nodo denominato utente amministrazione ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-148">**Figure 2**: The Site Map Includes a Node Titled User Administration ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image6.png))</span></span>


## <a name="step-2-listing-all-user-accounts-in-a-gridview"></a><span data-ttu-id="f606b-149">Passaggio 2: Elenco di tutti gli account utente in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-149">Step 2: Listing All User Accounts in a GridView</span></span>

<span data-ttu-id="f606b-150">L'obiettivo finale per questa esercitazione consiste nel creare una griglia di paging, filtrabile tramite cui un amministratore può selezionare un account utente da gestire.</span><span class="sxs-lookup"><span data-stu-id="f606b-150">Our end goal for this tutorial is to create a paged, filterable grid through which an administrator can select a user account to manage.</span></span> <span data-ttu-id="f606b-151">Per iniziare, elenco *tutti* gli utenti in un controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-151">Let's start by listing *all* users in a GridView.</span></span> <span data-ttu-id="f606b-152">Dopo questa procedura guidata, si aggiungerà il filtraggio e paging interfacce e le funzionalità.</span><span class="sxs-lookup"><span data-stu-id="f606b-152">Once this is complete, we will add the filtering and paging interfaces and functionality.</span></span>

<span data-ttu-id="f606b-153">Aprire il `ManageUsers.aspx` nella pagina il `Administration` cartella e aggiungere un controllo GridView, impostare il relativo `ID` per `UserAccounts` breve, si scriverà il codice per associare il set di account utente per l'utilizzo di GridView il `Membership` della classe `GetAllUsers` (metodo).</span><span class="sxs-lookup"><span data-stu-id="f606b-153">Open the `ManageUsers.aspx` page in the `Administration` folder and add a GridView, setting its `ID` to `UserAccounts` In a moment, we will write code to bind the set of user accounts to the GridView using the `Membership` class's `GetAllUsers` method.</span></span> <span data-ttu-id="f606b-154">Come illustrato nelle esercitazioni precedenti, il `GetAllUsers` metodo restituisce un `MembershipUserCollection` oggetto, che è una raccolta di `MembershipUser` oggetti.</span><span class="sxs-lookup"><span data-stu-id="f606b-154">As discussed in earlier tutorials, the `GetAllUsers` method returns a `MembershipUserCollection` object, which is a collection of `MembershipUser` objects.</span></span> <span data-ttu-id="f606b-155">Ogni `MembershipUser` nella raccolta include le proprietà come `UserName`, `Email`, `IsApproved`e così via.</span><span class="sxs-lookup"><span data-stu-id="f606b-155">Each `MembershipUser` in the collection includes properties like `UserName`, `Email`, `IsApproved`, and so on.</span></span>

<span data-ttu-id="f606b-156">Per visualizzare le informazioni sull'account utente desiderato in GridView, impostare il controllo GridView `AutoGenerateColumns` la proprietà su False e aggiungere BoundField per il `UserName`, `Email`, e `Comment` proprietà e CheckBoxFields per il `IsApproved`, `IsLockedOut`, e `IsOnline` proprietà.</span><span class="sxs-lookup"><span data-stu-id="f606b-156">In order to display the desired user account information in the GridView, set the GridView's `AutoGenerateColumns` property to False and add BoundFields for the `UserName`, `Email`, and `Comment` properties and CheckBoxFields for the `IsApproved`, `IsLockedOut`, and `IsOnline` properties.</span></span> <span data-ttu-id="f606b-157">Questa configurazione può essere applicata tramite markup dichiarativo del controllo o la finestra di dialogo campi.</span><span class="sxs-lookup"><span data-stu-id="f606b-157">This configuration can be applied through the control's declarative markup or via the Fields dialog box.</span></span> <span data-ttu-id="f606b-158">Figura 3 mostra una schermata dei campi la finestra di dialogo dopo la casella di controllo campi di generazione automatica è stata deselezionata e la BoundField e CheckBoxFields aggiunti e configurati.</span><span class="sxs-lookup"><span data-stu-id="f606b-158">Figure 3 shows a screen shot of the Fields dialog box after the Auto-generate fields checkbox has been unchecked and the BoundFields and CheckBoxFields have been added and configured.</span></span>


<span data-ttu-id="f606b-159">[![Aggiungere tre BoundField e tre CheckBoxFields al controllo GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-159">[![Add Three BoundFields and Three CheckBoxFields to the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image8.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image7.png)</span></span>

<span data-ttu-id="f606b-160">**Figura 3**: aggiungere tre BoundField e tre CheckBoxFields a GridView ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-160">**Figure 3**: Add Three BoundFields and Three CheckBoxFields to the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image9.png))</span></span>


<span data-ttu-id="f606b-161">Dopo aver configurato il GridView, verificare che il markup dichiarativo è simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="f606b-161">After configuring your GridView, ensure that its declarative markup resembles the following:</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample4.aspx)]

<span data-ttu-id="f606b-162">Successivamente, è necessario scrivere codice che associa gli account utente a GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-162">Next, we need to write code that binds the user accounts to the GridView.</span></span> <span data-ttu-id="f606b-163">Creare un metodo denominato `BindUserAccounts` per eseguire questa attività e quindi chiamare dal `Page_Load` gestore dell'evento nella prima visita pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-163">Create a method named `BindUserAccounts` to perform this task and then call it from the `Page_Load` event handler on the first page visit.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample5.vb)]

<span data-ttu-id="f606b-164">Richiedere qualche istante per testare la pagina tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f606b-164">Take a moment to test the page through a browser.</span></span> <span data-ttu-id="f606b-165">Come illustrato nella figura 4, il `UserAccounts` GridView Elenca il nome utente, indirizzo di posta elettronica e altre informazioni pertinenti account per tutti gli utenti nel sistema.</span><span class="sxs-lookup"><span data-stu-id="f606b-165">As Figure 4 shows, the `UserAccounts` GridView lists the username, email address, and other pertinent account information for all users in the system.</span></span>


<span data-ttu-id="f606b-166">[![Vengono elencati gli account utente nel controllo GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-166">[![The User Accounts are Listed in the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image11.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image10.png)</span></span>

<span data-ttu-id="f606b-167">**Figura 4**: l'account utente sono elencati in GridView ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-167">**Figure 4**: The User Accounts are Listed in the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image12.png))</span></span>


## <a name="step-3-filtering-the-results-by-the-first-letter-of-the-username"></a><span data-ttu-id="f606b-168">Passaggio 3: Filtrare i risultati per la prima lettera del nome utente</span><span class="sxs-lookup"><span data-stu-id="f606b-168">Step 3: Filtering the Results by the First Letter of the Username</span></span>

<span data-ttu-id="f606b-169">Attualmente il `UserAccounts` GridView Mostra *tutti* degli account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-169">Currently the `UserAccounts` GridView shows *all* of the user accounts.</span></span> <span data-ttu-id="f606b-170">Per i siti Web con centinaia o migliaia di account utente, è fondamentale che sia in grado di ridurre rapidamente gli account visualizzati.</span><span class="sxs-lookup"><span data-stu-id="f606b-170">For websites with hundreds or thousands of user accounts, it is imperative that user be able to quickly pare down the displayed accounts.</span></span> <span data-ttu-id="f606b-171">Questa operazione può essere eseguita aggiungendo filtri LinkButton alla pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-171">This can be accomplished by adding filtering LinkButtons to the page.</span></span> <span data-ttu-id="f606b-172">Aggiungere alla pagina 27 LinkButton: uno denominato tutti insieme uno LinkButton per ogni lettera dell'alfabeto.</span><span class="sxs-lookup"><span data-stu-id="f606b-172">Let's add 27 LinkButtons to the page: one titled All along with one LinkButton for each letter of the alphabet.</span></span> <span data-ttu-id="f606b-173">Se un visitatore fa clic sull'elemento LinkButton di tutti, GridView visualizzerà tutti gli utenti.</span><span class="sxs-lookup"><span data-stu-id="f606b-173">If a visitor clicks the All LinkButton, the GridView will show all of the users.</span></span> <span data-ttu-id="f606b-174">Se si fa clic su una determinata lettera, verranno visualizzati solo agli utenti il cui nome utente inizia con la lettera selezionata.</span><span class="sxs-lookup"><span data-stu-id="f606b-174">If they click a particular letter, only those users whose username starts with the selected letter will be displayed.</span></span>

<span data-ttu-id="f606b-175">La prima attività consiste nell'aggiungere i controlli LinkButton 27.</span><span class="sxs-lookup"><span data-stu-id="f606b-175">Our first task is to add the 27 LinkButton controls.</span></span> <span data-ttu-id="f606b-176">Un'opzione, è possibile creare il 27 LinkButton in modo dichiarativo, uno alla volta.</span><span class="sxs-lookup"><span data-stu-id="f606b-176">One option would be to create the 27 LinkButtons declaratively, one at a time.</span></span> <span data-ttu-id="f606b-177">Un approccio più flessibile consiste nell'utilizzare un controllo Repeater con un `ItemTemplate` che esegue il rendering di un controllo LinkButton e quindi associa le opzioni di filtro Ripetitore come un `String` matrice.</span><span class="sxs-lookup"><span data-stu-id="f606b-177">A more flexible approach is to use a Repeater control with an `ItemTemplate` that renders a LinkButton and then binds the filtering options to the Repeater as a `String` array.</span></span>

<span data-ttu-id="f606b-178">Avvio tramite l'aggiunta di un controllo Repeater alla pagina precedente il `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-178">Start by adding a Repeater control to the page above the `UserAccounts` GridView.</span></span> <span data-ttu-id="f606b-179">Impostare il controllo Repeater `ID` proprietà `FilteringUI` configurare i modelli del ripetitore in modo che il relativo `ItemTemplate` esegue il rendering di un controllo LinkButton cui `Text` e `CommandName` proprietà sono associate all'elemento della matrice corrente.</span><span class="sxs-lookup"><span data-stu-id="f606b-179">Set the Repeater's `ID` property to `FilteringUI` Configure the Repeater's templates so that its `ItemTemplate` renders a LinkButton whose `Text` and `CommandName` properties are bound to the current array element.</span></span> <span data-ttu-id="f606b-180">Come illustrato nel <a id="_msoanchor_3"> </a> [ *l'assegnazione di ruoli agli utenti* ](../roles/assigning-roles-to-users-vb.md) dell'esercitazione, questa può essere eseguita tramite il `Container.DataItem` sintassi di associazione dati.</span><span class="sxs-lookup"><span data-stu-id="f606b-180">As we saw in the <a id="_msoanchor_3"></a>[*Assigning Roles to Users*](../roles/assigning-roles-to-users-vb.md) tutorial, this can be accomplished using the `Container.DataItem` databinding syntax.</span></span> <span data-ttu-id="f606b-181">Utilizzare il controllo Repeater `SeparatorTemplate` per visualizzare una linea verticale tra ogni collegamento.</span><span class="sxs-lookup"><span data-stu-id="f606b-181">Use the Repeater's `SeparatorTemplate` to display a vertical line between each link.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample6.aspx)]

<span data-ttu-id="f606b-182">Per popolare il controllo Repeater con le opzioni di filtro desiderate, creare un metodo denominato `BindFilteringUI`.</span><span class="sxs-lookup"><span data-stu-id="f606b-182">To populate this Repeater with the desired filtering options, create a method named `BindFilteringUI`.</span></span> <span data-ttu-id="f606b-183">Verificare di chiamare questo metodo il `Page_Load` gestore dell'evento il primo caricamento della pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-183">Be sure to call this method from the `Page_Load` event handler on the first page load.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample7.vb)]

<span data-ttu-id="f606b-184">Questo metodo consente di specificare le opzioni di filtro come elementi nel `String` matrice `filterOptions` per ogni elemento nella matrice, Ripetitore verrà eseguito il rendering di un elemento LinkButton con il relativo `Text` e `CommandName` le proprietà assegnate al valore della matrice elemento.</span><span class="sxs-lookup"><span data-stu-id="f606b-184">This method specifies the filtering options as elements in the `String` array `filterOptions` For each element in the array, the Repeater will render a LinkButton with its `Text` and `CommandName` properties assigned to the value of the array element.</span></span>

<span data-ttu-id="f606b-185">La figura 5 mostra il `ManageUsers.aspx` pagina quando viene visualizzato tramite un browser.</span><span class="sxs-lookup"><span data-stu-id="f606b-185">Figure 5 shows the `ManageUsers.aspx` page when viewed through a browser.</span></span>


<span data-ttu-id="f606b-186">[![Ripetitore Elenca 27 LinkButton filtro](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-186">[![The Repeater Lists 27 Filtering LinkButtons](building-an-interface-to-select-one-user-account-from-many-vb/_static/image14.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image13.png)</span></span>

<span data-ttu-id="f606b-187">**Figura 5**: il Ripetitore Elenca 27 filtro LinkButton ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-187">**Figure 5**: The Repeater Lists 27 Filtering LinkButtons ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image15.png))</span></span>


> [!NOTE]
> <span data-ttu-id="f606b-188">I nomi utente possono iniziare con qualsiasi carattere, inclusi i numeri e segni di punteggiatura.</span><span class="sxs-lookup"><span data-stu-id="f606b-188">Usernames may start with any character, including numbers and punctuation.</span></span> <span data-ttu-id="f606b-189">Per visualizzare questi account, l'amministratore dovrà utilizzare l'opzione tutti LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f606b-189">In order to view these accounts, the administrator will have to use the All LinkButton option.</span></span> <span data-ttu-id="f606b-190">In alternativa, è possibile aggiungere un controllo LinkButton per restituire tutti gli account utente che iniziano con un numero.</span><span class="sxs-lookup"><span data-stu-id="f606b-190">Alternatively, you could add a LinkButton to return all user accounts that start with a number.</span></span> <span data-ttu-id="f606b-191">Lasciare questo campo come esercizio per il lettore.</span><span class="sxs-lookup"><span data-stu-id="f606b-191">I leave this as an exercise for the reader.</span></span>


<span data-ttu-id="f606b-192">Fare clic su qualsiasi LinkButton il filtro provoca un postback e genera il Ripetitore `ItemCommand` evento, ma non è stata modificata nella griglia perché è stata ancora per scrivere codice per filtrare i risultati.</span><span class="sxs-lookup"><span data-stu-id="f606b-192">Clicking any of the filtering LinkButtons causes a postback and raises the Repeater's `ItemCommand` event, but there's no change in the grid because we've yet to write any code to filter the results.</span></span> <span data-ttu-id="f606b-193">Il `Membership` classe include un [ `FindUsersByName` metodo](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) che restituisce gli account utente il cui nome utente corrisponde a un criterio di ricerca specificati.</span><span class="sxs-lookup"><span data-stu-id="f606b-193">The `Membership` class includes a [`FindUsersByName` method](https://technet.microsoft.com/library/system.web.security.membership.findusersbyname.aspx) that returns those user accounts whose username matches a specified search pattern.</span></span> <span data-ttu-id="f606b-194">È possibile utilizzare questo metodo per recuperare solo gli account utente i cui nomi utente iniziano con la lettera specificata dal `CommandName` del controllo LinkButton filtrati che è stato fatto clic.</span><span class="sxs-lookup"><span data-stu-id="f606b-194">We can use this method to retrieve just those user accounts whose usernames start with the letter specified by the `CommandName` of the filtered LinkButton that was clicked.</span></span>

<span data-ttu-id="f606b-195">Avviare aggiornando il `ManageUser.aspx` codice della pagina classe in modo che includa una proprietà denominata `UsernameToMatch` questa proprietà viene mantenuta la stringa di filtro di nome utente durante i postback:</span><span class="sxs-lookup"><span data-stu-id="f606b-195">Start by updating the `ManageUser.aspx` page's code-behind class so that it includes a property named `UsernameToMatch` This property persists the username filter string across postbacks:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample8.vb)]

<span data-ttu-id="f606b-196">Il `UsernameToMatch` proprietà archivia il valore viene assegnato nel `ViewState` raccolta utilizzando la chiave UsernameToMatch.</span><span class="sxs-lookup"><span data-stu-id="f606b-196">The `UsernameToMatch` property stores its value it is assigned into the `ViewState` collection using the key �UsernameToMatch�.</span></span> <span data-ttu-id="f606b-197">Quando viene letto il valore di questa proprietà, viene verificato se esiste un valore nel `ViewState` raccolta; in caso contrario, viene restituito il valore predefinito, una stringa vuota.</span><span class="sxs-lookup"><span data-stu-id="f606b-197">When this property's value is read, it checks to see if a value exists in the `ViewState` collection; if not, it returns the default value, an empty string.</span></span> <span data-ttu-id="f606b-198">Il `UsernameToMatch` proprietà presenta un modello comune, vale a dire il mantenimento di un valore per lo stato di visualizzazione in modo che tutte le modifiche alla proprietà vengono rese persistenti tra i postback.</span><span class="sxs-lookup"><span data-stu-id="f606b-198">The `UsernameToMatch` property exhibits a common pattern, namely persisting a value to view state so that any changes to the property are persisted across postbacks.</span></span> <span data-ttu-id="f606b-199">Per altre informazioni su questo modello, vedere [informazioni sullo stato di visualizzazione ASP.NET](https://msdn.microsoftn-us/library/ms972976.aspx).</span><span class="sxs-lookup"><span data-stu-id="f606b-199">For more information on this pattern, read [Understanding ASP.NET View State](https://msdn.microsoftn-us/library/ms972976.aspx).</span></span>

<span data-ttu-id="f606b-200">Aggiornare quindi il `BindUserAccounts` metodo in modo che anziché chiamare `Membership.GetAllUsers`, chiama `Membership.FindUsersByName`, passando il valore della `UsernameToMatch` proprietà aggiunta con il carattere jolly SQL, %.</span><span class="sxs-lookup"><span data-stu-id="f606b-200">Next, update the `BindUserAccounts` method so that instead of calling `Membership.GetAllUsers`, it calls `Membership.FindUsersByName`, passing in the value of the `UsernameToMatch` property appended with the SQL wildcard character, %.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample9.vb)]

<span data-ttu-id="f606b-201">Per visualizzare solo gli utenti il cui nome utente inizia con la lettera A, impostare il `UsernameToMatch` proprietà su e quindi chiamare `BindUserAccounts` porterebbe alla creazione di una chiamata a `Membership.FindUsersByName("A%")`, che restituirà tutti gli utenti il cui nome utente inizia con A. Analogamente, per restituire *tutti* gli utenti, assegnare una stringa vuota per il `UsernameToMatch` proprietà in modo che il `BindUserAccounts` richiama il metodo `Membership.FindUsersByName("%")`, in tal modo la restituzione di tutti gli account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-201">To display just those users whose username starts with the letter A, set the `UsernameToMatch` property to A and then call `BindUserAccounts` This would result in a call to `Membership.FindUsersByName("A%")`, which will return all users whose username starts with A. Likewise, to return *all* users, assign an empty string to the `UsernameToMatch` property so that the `BindUserAccounts` method will invoke `Membership.FindUsersByName("%")`, thereby returning all user accounts.</span></span>

<span data-ttu-id="f606b-202">Creare un gestore eventi per il controllo Repeater `ItemCommand` evento.</span><span class="sxs-lookup"><span data-stu-id="f606b-202">Create an event handler for the Repeater's `ItemCommand` event.</span></span> <span data-ttu-id="f606b-203">Questo evento viene generato ogni volta che viene selezionato uno dei filtri LinkButton; viene passato sull'elemento LinkButton selezionato `CommandName` valore tramite il `RepeaterCommandEventArgs` oggetto.</span><span class="sxs-lookup"><span data-stu-id="f606b-203">This event is raised whenever one of the filter LinkButtons is clicked; it is passed the clicked LinkButton's `CommandName` value through the `RepeaterCommandEventArgs` object.</span></span> <span data-ttu-id="f606b-204">È necessario assegnare il valore appropriato per il `UsernameToMatch` proprietà e quindi chiamare il `BindUserAccounts` metodo.</span><span class="sxs-lookup"><span data-stu-id="f606b-204">We need to assign the appropriate value to the `UsernameToMatch` property and then call the `BindUserAccounts` method.</span></span> <span data-ttu-id="f606b-205">Se il `CommandName` è All, assegnare una stringa vuota per `UsernameToMatch` in modo che vengono visualizzati tutti gli account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-205">If the `CommandName` is All, assign an empty string to `UsernameToMatch` so that all user accounts are displayed.</span></span> <span data-ttu-id="f606b-206">In caso contrario, assegnare il `CommandName` valore `UsernameToMatch`</span><span class="sxs-lookup"><span data-stu-id="f606b-206">Otherwise, assign the `CommandName` value to `UsernameToMatch`</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample10.vb)]

<span data-ttu-id="f606b-207">Con questo codice, testare la funzionalità di filtro.</span><span class="sxs-lookup"><span data-stu-id="f606b-207">With this code in place, test out the filtering functionality.</span></span> <span data-ttu-id="f606b-208">Quando la pagina viene prima visitata, vengono visualizzati tutti gli account utente (vedere la figura 5).</span><span class="sxs-lookup"><span data-stu-id="f606b-208">When the page is first visited, all user accounts are displayed (refer back to Figure 5).</span></span> <span data-ttu-id="f606b-209">Facendo clic sull'elemento LinkButton A provoca un postback e filtra i risultati, la visualizzazione solo agli account utente che iniziano per a.</span><span class="sxs-lookup"><span data-stu-id="f606b-209">Clicking the A LinkButton causes a postback and filters the results, displaying only those user accounts that start with A .</span></span>


<span data-ttu-id="f606b-210">[![Utilizzare il filtro LinkButton per visualizzare tali utenti il cui nome utente inizia con una determinata lettera](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-210">[![Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter](building-an-interface-to-select-one-user-account-from-many-vb/_static/image17.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image16.png)</span></span>

<span data-ttu-id="f606b-211">**Figura 6**: utilizzare LinkButton filtro per visualizzare tali gli utenti il cui nome utente inizia con una lettera determinati ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-211">**Figure 6**: Use the Filtering LinkButtons to Display those Users Whose Username Starts with a Certain Letter ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image18.png))</span></span>


## <a name="step-4-updating-the-gridview-to-use-paging"></a><span data-ttu-id="f606b-212">Passaggio 4: Aggiornamento GridView per l'utilizzo di Paging</span><span class="sxs-lookup"><span data-stu-id="f606b-212">Step 4: Updating the GridView to Use Paging</span></span>

<span data-ttu-id="f606b-213">GridView illustrato nelle figure 5 e 6 sono elencati tutti i record restituiti dal `FindUsersByName` metodo.</span><span class="sxs-lookup"><span data-stu-id="f606b-213">The GridView shown in Figures 5 and 6 lists all of the records returned from the `FindUsersByName` method.</span></span> <span data-ttu-id="f606b-214">Se sono presenti centinaia o migliaia di account utente questo può causare all'overload di informazioni quando si visualizzano tutti gli account (come accade quando si fa clic sull'elemento LinkButton di tutte o quando inizialmente si visita la pagina).</span><span class="sxs-lookup"><span data-stu-id="f606b-214">If there are hundreds or thousands of user accounts this can lead to information overload when viewing all of the accounts (as is the case when clicking the All LinkButton or when initially visiting the page).</span></span> <span data-ttu-id="f606b-215">Per presentare gli account utente in blocchi più gestibile, configurazione GridView per visualizzare i 10 account utente alla volta.</span><span class="sxs-lookup"><span data-stu-id="f606b-215">To help present the user accounts in more manageable chunks, let's configure the GridView to display 10 user accounts at a time.</span></span>

<span data-ttu-id="f606b-216">Il controllo GridView offre due tipi di paging:</span><span class="sxs-lookup"><span data-stu-id="f606b-216">The GridView control offers two types of paging:</span></span>

- <span data-ttu-id="f606b-217">**Paging predefinito** : facile da implementare, ma non efficiente.</span><span class="sxs-lookup"><span data-stu-id="f606b-217">**Default paging** - easy to implement, but inefficient.</span></span> <span data-ttu-id="f606b-218">In breve, paging GridView predefinito prevede *tutti* dei record dall'origine dati.</span><span class="sxs-lookup"><span data-stu-id="f606b-218">In a nutshell, with default paging the GridView expects *all* of the records from its data source.</span></span> <span data-ttu-id="f606b-219">Quindi Visualizza solo la pagina di record appropriata.</span><span class="sxs-lookup"><span data-stu-id="f606b-219">It then only displays the appropriate page of records.</span></span>
- <span data-ttu-id="f606b-220">**Il paging personalizzato** -richiede maggiore impegno per implementare, ma è più efficiente predefinito paging perché con paging dei dati personalizzata origine restituisce solo il set di record per la visualizzazione precisa.</span><span class="sxs-lookup"><span data-stu-id="f606b-220">**Custom paging** - requires more work to implement, but is more efficient than default paging because with custom paging the data source returns only the precise set of records to display.</span></span>

<span data-ttu-id="f606b-221">La differenza nelle prestazioni tra l'impostazione predefinita e il paging personalizzato può rivelarsi piuttosto notevole paging migliaia di record.</span><span class="sxs-lookup"><span data-stu-id="f606b-221">The performance difference between default and custom paging can be quite substantial when paging through thousands of records.</span></span> <span data-ttu-id="f606b-222">Poiché stiamo creando questa interfaccia, presupponendo che può essere centinaia o migliaia di account utente, è possibile utilizzare il paging personalizzato.</span><span class="sxs-lookup"><span data-stu-id="f606b-222">Because we are building this interface assuming that there may be hundreds or thousands of user accounts, let's use custom paging.</span></span>

> [!NOTE]
> <span data-ttu-id="f606b-223">Per una discussione più approfondita sulle differenze tra l'impostazione predefinita e il paging personalizzato, nonché i problemi relativi all'implementazione del paging personalizzato, fare riferimento a [in modo efficiente il Paging tramite quantità di dati di grandi dimensioni](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span><span class="sxs-lookup"><span data-stu-id="f606b-223">For a more thorough discussion on the differences between default and custom paging, as well as the challenges involved in implementing custom paging, refer to [Efficiently Paging Through Large Amounts of Data](https://asp.net/learn/data-access/tutorial-25-vb.aspx).</span></span> <span data-ttu-id="f606b-224">Per alcune analisi della differenza di prestazioni tra l'impostazione predefinita e il paging personalizzato, vedere [il Paging personalizzato in ASP.NET con SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span><span class="sxs-lookup"><span data-stu-id="f606b-224">For some analysis of the performance difference between default and custom paging, see [Custom Paging in ASP.NET with SQL Server 2005](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx).</span></span>


<span data-ttu-id="f606b-225">Per implementare il paging personalizzato è necessario innanzitutto un meccanismo dal quale recuperare il subset di record visualizzato dal controllo GridView preciso.</span><span class="sxs-lookup"><span data-stu-id="f606b-225">To implement custom paging we first need some mechanism by which to retrieve the precise subset of records being displayed by the GridView.</span></span> <span data-ttu-id="f606b-226">Buone notizie consiste nel fatto che il `Membership` della classe `FindUsersByName` metodo presenta un overload che consente di specificare l'indice della pagina e le dimensioni di pagina e restituisce solo gli account utente che si trovano all'interno dell'intervallo di record.</span><span class="sxs-lookup"><span data-stu-id="f606b-226">The good news is that the `Membership` class's `FindUsersByName` method has an overload that allows us to specify the page index and page size, and returns only those user accounts that fall within that range of records.</span></span>

<span data-ttu-id="f606b-227">In particolare, questo overload ha la firma seguente: [ `FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)` ](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span><span class="sxs-lookup"><span data-stu-id="f606b-227">In particular, this overload has the following signature: [`FindUsersByName(usernameToMatch, pageIndex, pageSize, totalRecords)`](https://msdn.microsoft.com/library/fa5st8b2.aspx).</span></span>

<span data-ttu-id="f606b-228">Il *pageIndex* parametro specifica la pagina dell'account utente da restituire. *pageSize* indica il numero di record da visualizzare per pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-228">The *pageIndex* parameter specifies the page of user accounts to return; *pageSize* indicates how many records to display per page.</span></span> <span data-ttu-id="f606b-229">Il *totalRecords* parametro è un `ByRef` parametro che restituisce il numero di account utente totale nell'archivio dell'utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-229">The *totalRecords* parameter is a `ByRef` parameter that returns the number of total user accounts in the user store.</span></span>

> [!NOTE]
> <span data-ttu-id="f606b-230">I dati restituiti da `FindUsersByName` sono ordinati per nome utente; non è possibile personalizzare i criteri di ordinamento.</span><span class="sxs-lookup"><span data-stu-id="f606b-230">The data returned by `FindUsersByName` is sorted by username; the sort criteria cannot be customized.</span></span>


<span data-ttu-id="f606b-231">Controllo GridView. può essere configurato per usare il paging personalizzato, ma solo quando è associato a un controllo ObjectDataSource.</span><span class="sxs-lookup"><span data-stu-id="f606b-231">The GridView can be configured to utilize custom paging, but only when bound to an ObjectDataSource control.</span></span> <span data-ttu-id="f606b-232">Per il controllo ObjectDataSource implementare il paging personalizzato, richiede due metodi: uno che viene passato un indice di riga iniziale e il numero massimo di record da visualizzare, e restituisce il subset preciso di record che si trovano all'interno di tale intervallo. e di cui esegue il paging tramite un metodo che restituisce il numero totale di record.</span><span class="sxs-lookup"><span data-stu-id="f606b-232">For the ObjectDataSource control to implement custom paging, it requires two methods: one that is passed a start row index and the maximum number of records to display, and returns the precise subset of records that fall within that span; and a method that returns the total number of records being paged through.</span></span> <span data-ttu-id="f606b-233">Il `FindUsersByName` overload accetta un indice della pagina e le dimensioni di pagina e restituisce il numero totale di record mediante un `ByRef` parametro.</span><span class="sxs-lookup"><span data-stu-id="f606b-233">The `FindUsersByName` overload accepts a page index and page size, and returns the total number of records through a `ByRef` parameter.</span></span> <span data-ttu-id="f606b-234">È pertanto una mancata corrispondenza interfaccia qui.</span><span class="sxs-lookup"><span data-stu-id="f606b-234">So there is an interface mismatch here.</span></span>

<span data-ttu-id="f606b-235">Un'opzione, è possibile creare una classe proxy che espone l'interfaccia ObjectDataSource prevista e quindi chiama internamente il `FindUsersByName` metodo.</span><span class="sxs-lookup"><span data-stu-id="f606b-235">One option would be to create a proxy class that exposes the interface the ObjectDataSource expects, and then internally calls the `FindUsersByName` method.</span></span> <span data-ttu-id="f606b-236">Un'altra opzione e quella da usare per questo articolo, consiste nel creare la propria interfaccia di paging e utilizzare invece l'interfaccia di paging incorporata del controllo GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-236">Another option - and the one we'll use for this article - is to create our own paging interface and use that instead of the GridView's built-in paging interface.</span></span>

### <a name="creating-a-first-previous-next-last-paging-interface"></a><span data-ttu-id="f606b-237">Creazione di un primo, precedente, successivamente, ultimo interfaccia di Paging</span><span class="sxs-lookup"><span data-stu-id="f606b-237">Creating a First, Previous, Next, Last Paging Interface</span></span>

<span data-ttu-id="f606b-238">Creare ora un'interfaccia di paging con prima, precedente, successivo e ultimo LinkButton.</span><span class="sxs-lookup"><span data-stu-id="f606b-238">Let's build a paging interface with First, Previous, Next, and Last LinkButtons.</span></span> <span data-ttu-id="f606b-239">Il primo LinkButton, quando si fa clic, richiederà all'utente la prima pagina di dati, mentre la precedente quest'ultimo restituisce alla pagina precedente.</span><span class="sxs-lookup"><span data-stu-id="f606b-239">The First LinkButton, when clicked, will take the user to the first page of data, whereas Previous will return him to the previous page.</span></span> <span data-ttu-id="f606b-240">Analogamente, successivo e ultimo passerà l'utente alla pagina successiva e l'ultima, rispettivamente.</span><span class="sxs-lookup"><span data-stu-id="f606b-240">Likewise, Next and Last will move the user to the next and last page, respectively.</span></span> <span data-ttu-id="f606b-241">Aggiungere i quattro controlli LinkButton sotto il `UserAccounts` GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-241">Add the four LinkButton controls beneath the `UserAccounts` GridView.</span></span>

[!code-aspx[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample11.aspx)]

<span data-ttu-id="f606b-242">Successivamente, creare un gestore eventi per ogni sull'elemento LinkButton `Click` eventi.</span><span class="sxs-lookup"><span data-stu-id="f606b-242">Next, create an event handler for each of the LinkButton's `Click` events.</span></span>

<span data-ttu-id="f606b-243">Figura 7 illustra le quattro LinkButton quando viene visualizzato tramite la visualizzazione di progettazione di Visual Web Developer.</span><span class="sxs-lookup"><span data-stu-id="f606b-243">Figure 7 shows the four LinkButtons when viewed through the Visual Web Developer Design view.</span></span>


<span data-ttu-id="f606b-244">[![Suggerimenti da aggiungere prima, precedente, e l'ultimo LinkButton sotto controllo GridView.](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-244">[![Add First, Previous, Next, and Last LinkButtons Beneath the GridView](building-an-interface-to-select-one-user-account-from-many-vb/_static/image20.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image19.png)</span></span>

<span data-ttu-id="f606b-245">**Figura 7**: aggiungere prima, precedente, successivo e ultimo LinkButton di sotto di GridView ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-245">**Figure 7**: Add First, Previous, Next, and Last LinkButtons Beneath the GridView ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image21.png))</span></span>


### <a name="keeping-track-of-the-current-page-index"></a><span data-ttu-id="f606b-246">Tenere traccia dell'indice della pagina corrente</span><span class="sxs-lookup"><span data-stu-id="f606b-246">Keeping Track of the Current Page Index</span></span>

<span data-ttu-id="f606b-247">Quando un utente visita prima la `ManageUsers.aspx` pagina o fa clic su uno dei filtri del pulsante, si desidera visualizzare la prima pagina di dati in GridView.</span><span class="sxs-lookup"><span data-stu-id="f606b-247">When a user first visits the `ManageUsers.aspx` page or clicks one of the filtering buttons, we want to display the first page of data in the GridView.</span></span> <span data-ttu-id="f606b-248">Quando l'utente fa clic su uno degli spostamenti LinkButton, tuttavia, è necessario aggiornare l'indice della pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-248">When the user clicks one of the navigation LinkButtons, however, we need to update the page index.</span></span> <span data-ttu-id="f606b-249">Per mantenere l'indice della pagina e il numero di record da visualizzare per pagina, aggiungere le due proprietà seguenti nella classe code-behind della pagina:</span><span class="sxs-lookup"><span data-stu-id="f606b-249">To maintain the page index and the number of records to display per page, add the following two properties to the page's code-behind class:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample12.vb)]

<span data-ttu-id="f606b-250">Ad esempio il `UsernameToMatch` proprietà, il `PageIndex` proprietà mantiene il relativo valore per lo stato di visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="f606b-250">Like the `UsernameToMatch` property, the `PageIndex` property persists its value to view state.</span></span> <span data-ttu-id="f606b-251">La proprietà di sola lettura `PageSize` proprietà restituisce un valore hardcoded, 10.</span><span class="sxs-lookup"><span data-stu-id="f606b-251">The read-only `PageSize` property returns a hard-coded value, 10.</span></span> <span data-ttu-id="f606b-252">Invitare il lettore interessato per aggiornare questa proprietà per l'utilizzo dello stesso modello `PageIndex`e quindi per potenziare la `ManageUsers.aspx` pagina in modo che l'utente visita la pagina è possibile specificare il numero di account utente da visualizzare per ogni pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-252">I invite the interested reader to update this property to use the same pattern as `PageIndex`, and then to augment the `ManageUsers.aspx` page such that the person visiting the page can specify how many user accounts to display per page.</span></span>

### <a name="retrieving-just-the-current-pages-records-updating-the-page-index-and-enabling-and-disabling-the-paging-interface-linkbuttons"></a><span data-ttu-id="f606b-253">Il recupero solo i record della pagina corrente, di aggiornamento dell'indice, pagina e di abilitazione e disabilitazione di LinkButton di interfaccia di Paging</span><span class="sxs-lookup"><span data-stu-id="f606b-253">Retrieving Just the Current Page's Records, Updating the Page Index, and Enabling and Disabling the Paging Interface LinkButtons</span></span>

<span data-ttu-id="f606b-254">Con l'interfaccia di paging sul posto e `PageIndex` e `PageSize` aggiunta di proprietà, si è pronti per aggiornare il `BindUserAccounts` metodo in modo che utilizzi appropriata `FindUsersByName` rapporto di overload.</span><span class="sxs-lookup"><span data-stu-id="f606b-254">With the paging interface in place and the `PageIndex` and `PageSize` properties added, we are ready to update the `BindUserAccounts` method so that it uses the appropriate `FindUsersByName` overload.</span></span> <span data-ttu-id="f606b-255">Inoltre, è necessario abilitare o disabilitare l'interfaccia di paging a seconda di quale pagina viene visualizzata per questo metodo.</span><span class="sxs-lookup"><span data-stu-id="f606b-255">Additionally, we need to have this method enable or disable the paging interface depending on what page is being displayed.</span></span> <span data-ttu-id="f606b-256">Quando si visualizza la prima pagina di dati, i collegamenti del primo e precedente devono essere disabilitati; Successivamente e ultima deve essere disabilitata quando si visualizza l'ultima pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-256">When viewing the first page of data, the First and Previous links should be disabled; Next and Last should be disabled when viewing the last page.</span></span>

<span data-ttu-id="f606b-257">Aggiornare il metodo `BindUserAccounts` con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="f606b-257">Update the `BindUserAccounts` method with the following code:</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample13.vb)]

<span data-ttu-id="f606b-258">Si noti che il numero totale di record il paging tramite è determinato dal parametro ultimo del `FindUsersByName` metodo.</span><span class="sxs-lookup"><span data-stu-id="f606b-258">Note that the total number of records being paged through is determined by the last parameter of the `FindUsersByName` method.</span></span> <span data-ttu-id="f606b-259">Dopo la pagina specificata di account utente vengono restituiti i quattro LinkButton sono abilitato o disabilitato, a seconda se viene visualizzata prima o ultima pagina di dati.</span><span class="sxs-lookup"><span data-stu-id="f606b-259">After the specified page of user accounts are returned, the four LinkButtons are either enabled or disabled, depending on whether the first or last page of data is being viewed.</span></span>

<span data-ttu-id="f606b-260">L'ultimo passaggio consiste nello scrivere il codice per LinkButton quattro `Click` gestori eventi.</span><span class="sxs-lookup"><span data-stu-id="f606b-260">The last step is to write the code for the four LinkButtons' `Click` event handlers.</span></span> <span data-ttu-id="f606b-261">Questi gestori eventi è necessario aggiornare il `PageIndex` proprietà e quindi riassociare i dati a GridView mediante una chiamata a `BindUserAccounts` il primo, indietro e Avanti gestori di eventi sono molto semplici.</span><span class="sxs-lookup"><span data-stu-id="f606b-261">These event handlers need to update the `PageIndex` property and then rebind the data to the GridView via a call to `BindUserAccounts` The First, Previous, and Next event handlers are very simple.</span></span> <span data-ttu-id="f606b-262">Il `Click` gestore eventi per l'ultimo LinkButton, tuttavia, è un po' più complesso in quanto è necessario determinare il numero di record è visualizzato per determinare l'ultimo indice della pagina.</span><span class="sxs-lookup"><span data-stu-id="f606b-262">The `Click` event handler for the Last LinkButton, however, is a bit more complex because we need to determine how many records are being displayed in order to determine the last page index.</span></span>

[!code-vb[Main](building-an-interface-to-select-one-user-account-from-many-vb/samples/sample14.vb)]

<span data-ttu-id="f606b-263">Cifre 8 e 9 mostrano l'interfaccia di paging personalizzata in azione.</span><span class="sxs-lookup"><span data-stu-id="f606b-263">Figures 8 and 9 show the custom paging interface in action.</span></span> <span data-ttu-id="f606b-264">Figura 8 viene illustrata la `ManageUsers.aspx` pagina quando si visualizzano la prima pagina di dati per tutti gli account utente.</span><span class="sxs-lookup"><span data-stu-id="f606b-264">Figure 8 shows the `ManageUsers.aspx` page when viewing the first page of data for all user accounts.</span></span> <span data-ttu-id="f606b-265">Si noti che vengono visualizzati solo 10 degli 13 account.</span><span class="sxs-lookup"><span data-stu-id="f606b-265">Note that only 10 of the 13 accounts are displayed.</span></span> <span data-ttu-id="f606b-266">Il collegamento successivo o ultimo provoca un postback, gli aggiornamenti di `PageIndex` su 1 e associa la seconda pagina utente account alla griglia (vedere Figura 9).</span><span class="sxs-lookup"><span data-stu-id="f606b-266">Clicking the Next or Last link causes a postback, updates the `PageIndex` to 1, and binds the second page of user accounts to the grid (see Figure 9).</span></span>


<span data-ttu-id="f606b-267">[![Il primo account utente 10 vengono visualizzati](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-267">[![The First 10 User Accounts are Displayed](building-an-interface-to-select-one-user-account-from-many-vb/_static/image23.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image22.png)</span></span>

<span data-ttu-id="f606b-268">**Figura 8**: vengono visualizzati il primo account di 10 ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-268">**Figure 8**: The First 10 User Accounts are Displayed ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image24.png))</span></span>


<span data-ttu-id="f606b-269">[![Fare clic sul collegamento avanti consente di visualizzare la seconda pagina degli account utente](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span><span class="sxs-lookup"><span data-stu-id="f606b-269">[![Clicking the Next Link Displays the Second Page of User Accounts](building-an-interface-to-select-one-user-account-from-many-vb/_static/image26.png)](building-an-interface-to-select-one-user-account-from-many-vb/_static/image25.png)</span></span>

<span data-ttu-id="f606b-270">**Figura 9**: fare clic sul collegamento avanti consente di visualizzare la seconda pagina di account utente ([fare clic per visualizzare l'immagine ingrandita](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span><span class="sxs-lookup"><span data-stu-id="f606b-270">**Figure 9**: Clicking the Next Link Displays the Second Page of User Accounts ([Click to view full-size image](building-an-interface-to-select-one-user-account-from-many-vb/_static/image27.png))</span></span>


## <a name="summary"></a><span data-ttu-id="f606b-271">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="f606b-271">Summary</span></span>

<span data-ttu-id="f606b-272">Gli amministratori, spesso è necessario selezionare un utente dall'elenco di account.</span><span class="sxs-lookup"><span data-stu-id="f606b-272">Administrators often need to select a user from the list of accounts.</span></span> <span data-ttu-id="f606b-273">Nelle esercitazioni precedenti abbiamo esaminato tramite un elenco di riepilogo a discesa popolato con gli utenti, ma questo approccio non è facilmente scalabile.</span><span class="sxs-lookup"><span data-stu-id="f606b-273">In previous tutorials we looked at using a drop-down list populated with the users, but this approach does not scale well.</span></span> <span data-ttu-id="f606b-274">In questa esercitazione, è esplorare un'alternativa migliore: un'interfaccia filtrabile i cui risultati vengono visualizzati in un controllo GridView di paging.</span><span class="sxs-lookup"><span data-stu-id="f606b-274">In this tutorial we explored a better alternative: a filterable interface whose results are displayed in a paged GridView.</span></span> <span data-ttu-id="f606b-275">Con questa interfaccia utente, gli amministratori possono rapido ed efficiente individuare e selezionare un account utente tra le migliaia.</span><span class="sxs-lookup"><span data-stu-id="f606b-275">With this user interface, administrators can quickly and efficiently locate and select one user account among thousands.</span></span>

<span data-ttu-id="f606b-276">Buona programmazione!</span><span class="sxs-lookup"><span data-stu-id="f606b-276">Happy Programming!</span></span>

### <a name="further-reading"></a><span data-ttu-id="f606b-277">Ulteriori informazioni</span><span class="sxs-lookup"><span data-stu-id="f606b-277">Further Reading</span></span>

<span data-ttu-id="f606b-278">Per ulteriori informazioni sugli argomenti trattati in questa esercitazione, vedere le risorse seguenti:</span><span class="sxs-lookup"><span data-stu-id="f606b-278">For more information on the topics discussed in this tutorial, refer to the following resources:</span></span>

- [<span data-ttu-id="f606b-279">Paging personalizzato in ASP.NET con SQL Server 2005</span><span class="sxs-lookup"><span data-stu-id="f606b-279">Custom Paging in ASP.NET with SQL Server 2005</span></span>](http://aspnet.4guysfromrolla.com/articles/031506-1.aspx)
- [<span data-ttu-id="f606b-280">In modo efficiente Paging grandi quantità di dati</span><span class="sxs-lookup"><span data-stu-id="f606b-280">Efficiently Paging Through Large Amounts of Data</span></span>](https://asp.net/learn/data-access/tutorial-25-vb.aspx)
- [<span data-ttu-id="f606b-281">In sequenza il proprio strumento Amministrazione sito Web</span><span class="sxs-lookup"><span data-stu-id="f606b-281">Rolling Your Own Website Administration Tool</span></span>](http://aspnet.4guysfromrolla.com/articles/052307-1.aspx)

### <a name="about-the-author"></a><span data-ttu-id="f606b-282">Informazioni sull'autore</span><span class="sxs-lookup"><span data-stu-id="f606b-282">About the Author</span></span>

<span data-ttu-id="f606b-283">Scott Mitchell, autore di più libri e fondatore di 4GuysFromRolla, ha lavorato con tecnologie Web di Microsoft dal 1998.</span><span class="sxs-lookup"><span data-stu-id="f606b-283">Scott Mitchell, author of multiple ASP/ASP.NET books and founder of 4GuysFromRolla.com, has been working with Microsoft Web technologies since 1998.</span></span> <span data-ttu-id="f606b-284">Scott funziona come un consulente trainer e writer.</span><span class="sxs-lookup"><span data-stu-id="f606b-284">Scott works as an independent consultant, trainer, and writer.</span></span> <span data-ttu-id="f606b-285">Il suo ultimo libro è  *[SAM insegna manualmente ASP.NET 2.0 nelle 24 ore](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span><span class="sxs-lookup"><span data-stu-id="f606b-285">His latest book is *[Sams Teach Yourself ASP.NET 2.0 in 24 Hours](https://www.amazon.com/exec/obidos/ASIN/0672327384/4guysfromrollaco)*.</span></span> <span data-ttu-id="f606b-286">Scott può essere raggiunto al [ mitchell@4guysfromrolla.com ](mailto:mitchell@4guysfromrolla.com) o tramite il suo blog all'indirizzo [ http://ScottOnWriting.NET ](http://scottonwriting.net/).</span><span class="sxs-lookup"><span data-stu-id="f606b-286">Scott can be reached at [mitchell@4guysfromrolla.com](mailto:mitchell@4guysfromrolla.com) or via his blog at [http://ScottOnWriting.NET](http://scottonwriting.net/).</span></span>

### <a name="special-thanks-to"></a><span data-ttu-id="f606b-287">Ringraziamenti speciali</span><span class="sxs-lookup"><span data-stu-id="f606b-287">Special Thanks To</span></span>

<span data-ttu-id="f606b-288">Questa serie di esercitazioni è stata esaminata da diversi validi revisori.</span><span class="sxs-lookup"><span data-stu-id="f606b-288">This tutorial series was reviewed by many helpful reviewers.</span></span> <span data-ttu-id="f606b-289">Il revisore per questa esercitazione è stata Alicja Maziarz.</span><span class="sxs-lookup"><span data-stu-id="f606b-289">Lead reviewer for this tutorial was Alicja Maziarz.</span></span> <span data-ttu-id="f606b-290">Se si è interessati my prossimi articoli MSDN?</span><span class="sxs-lookup"><span data-stu-id="f606b-290">Interested in reviewing my upcoming MSDN articles?</span></span> <span data-ttu-id="f606b-291">In caso affermativo, Inviami una riga alla</span><span class="sxs-lookup"><span data-stu-id="f606b-291">If so, drop me a line at</span></span>

> [!div class="step-by-step"]
> <span data-ttu-id="f606b-292">[Precedente](unlocking-and-approving-user-accounts-cs.md)
> [Successivo](recovering-and-changing-passwords-vb.md)</span><span class="sxs-lookup"><span data-stu-id="f606b-292">[Previous](unlocking-and-approving-user-accounts-cs.md)
[Next](recovering-and-changing-passwords-vb.md)</span></span>

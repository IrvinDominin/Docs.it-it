---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
title: Creare il livello di accesso ai dati | Documenti Microsoft
author: Erikre
description: Questa serie di esercitazioni verranno fornite le nozioni di base della creazione di un'applicazione Web Form ASP.NET tramite ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per abbiamo...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 0bbf7a6e-d7eb-4091-91e4-fff892777f32
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/create_the_data_access_layer
msc.type: authoredcontent
ms.openlocfilehash: 671d1bbf661dfb3e56c6ccd67ce0d383990918d6
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
---
<a name="create-the-data-access-layer"></a><span data-ttu-id="c0b32-103">Creare il livello di accesso ai dati</span><span class="sxs-lookup"><span data-stu-id="c0b32-103">Create the Data Access Layer</span></span>
====================
<span data-ttu-id="c0b32-104">da [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="c0b32-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="c0b32-105">[Scarica progetto di esempio Wingtip Toys (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [scaricare E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="c0b32-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="c0b32-106">Questa serie di esercitazioni verranno fornite le nozioni di base della creazione di un'applicazione Web Form ASP.NET utilizzando ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per Web.</span><span class="sxs-lookup"><span data-stu-id="c0b32-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="c0b32-107">Un Visual Studio 2013 [progetto con il codice sorgente c#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) complemento questa serie di esercitazioni è disponibile.</span><span class="sxs-lookup"><span data-stu-id="c0b32-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="c0b32-108">In questa esercitazione viene descritto come creare, accedere ed esaminare i dati da un database utilizzando Code First di Entity Framework e Web Form ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c0b32-108">This tutorial describes how to create, access, and review data from a database using ASP.NET Web Forms and Entity Framework Code First.</span></span> <span data-ttu-id="c0b32-109">In questa esercitazione si basa sull'esercitazione precedente "Creare il progetto" e fa parte della serie di esercitazioni Wingtip giocattoli archivio.</span><span class="sxs-lookup"><span data-stu-id="c0b32-109">This tutorial builds on the previous tutorial "Create the Project" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="c0b32-110">Dopo aver completato questa esercitazione, verrà creata un gruppo di classi di accesso ai dati presenti il *modelli* nella cartella del progetto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-110">When you've completed this tutorial, you will have built a group of data-access classes that are in the *Models* folder of the project.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="c0b32-111">Illustra quanto segue:</span><span class="sxs-lookup"><span data-stu-id="c0b32-111">What you'll learn:</span></span>

- <span data-ttu-id="c0b32-112">Come creare i modelli di dati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-112">How to create the data models.</span></span>
- <span data-ttu-id="c0b32-113">Come inizializzare e inizializzazione del database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-113">How to initialize and seed the database.</span></span>
- <span data-ttu-id="c0b32-114">Come aggiornare e configurare l'applicazione per supportare il database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-114">How to update and configure the application to support the database.</span></span>

### <a name="these-are-the-features-introduced-in-the-tutorial"></a><span data-ttu-id="c0b32-115">Le funzionalità introdotte in questa esercitazione sono:</span><span class="sxs-lookup"><span data-stu-id="c0b32-115">These are the features introduced in the tutorial:</span></span>

- <span data-ttu-id="c0b32-116">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="c0b32-116">Entity Framework Code First</span></span>
- <span data-ttu-id="c0b32-117">LocalDB</span><span class="sxs-lookup"><span data-stu-id="c0b32-117">LocalDB</span></span>
- <span data-ttu-id="c0b32-118">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="c0b32-118">Data Annotations</span></span>

## <a name="creating-the-data-models"></a><span data-ttu-id="c0b32-119">Creazione dei modelli di dati</span><span class="sxs-lookup"><span data-stu-id="c0b32-119">Creating the Data Models</span></span>

<span data-ttu-id="c0b32-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) è un framework di mapping relazionale a oggetti (ORM).</span><span class="sxs-lookup"><span data-stu-id="c0b32-120">[Entity Framework](https://msdn.microsoft.com/data/aa937723) is an object-relational mapping (ORM) framework.</span></span> <span data-ttu-id="c0b32-121">Consente di utilizzare dati relazionali come oggetti, eliminando la maggior parte del codice di accesso ai dati che è in genere necessario scrivere.</span><span class="sxs-lookup"><span data-stu-id="c0b32-121">It lets you work with relational data as objects, eliminating most of the data-access code that you'd usually need to write.</span></span> <span data-ttu-id="c0b32-122">Tramite Entity Framework, è possibile eseguire query utilizzando [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), recuperare e manipolare i dati come oggetti fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-122">Using Entity Framework, you can issue queries using [LINQ](https://msdn.microsoft.com/library/bb397926.aspx), then retrieve and manipulate data as strongly typed objects.</span></span> <span data-ttu-id="c0b32-123">LINQ fornisce modelli per l'esecuzione di query e l'aggiornamento dei dati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-123">LINQ provides patterns for querying and updating data.</span></span> <span data-ttu-id="c0b32-124">Utilizzo di Entity Framework consente di concentrarsi sulla creazione il resto dell'applicazione, piuttosto che sui dati nozioni di base di accesso.</span><span class="sxs-lookup"><span data-stu-id="c0b32-124">Using Entity Framework allows you to focus on creating the rest of your application, rather than focusing on the data access fundamentals.</span></span> <span data-ttu-id="c0b32-125">Più avanti in questa serie di esercitazioni, vi mostreremo come utilizzare i dati per popolare le query di navigazione e product.</span><span class="sxs-lookup"><span data-stu-id="c0b32-125">Later in this tutorial series, we'll show you how to use the data to populate navigation and product queries.</span></span>

<span data-ttu-id="c0b32-126">Entity Framework supporta un paradigma di sviluppo denominato *Code First*.</span><span class="sxs-lookup"><span data-stu-id="c0b32-126">Entity Framework supports a development paradigm called *Code First*.</span></span> <span data-ttu-id="c0b32-127">Code First consente di definire i modelli di dati utilizzando le classi.</span><span class="sxs-lookup"><span data-stu-id="c0b32-127">Code First lets you define your data models using classes.</span></span> <span data-ttu-id="c0b32-128">Una classe è un costrutto che consente di creare tipi personalizzati raggruppando le variabili di altri tipi, metodi ed eventi.</span><span class="sxs-lookup"><span data-stu-id="c0b32-128">A class is a construct that enables you to create your own custom types by grouping together variables of other types, methods and events.</span></span> <span data-ttu-id="c0b32-129">È possibile eseguire il mapping delle classi a un database esistente o utilizzarle per generare un database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-129">You can map classes to an existing database or use them to generate a database.</span></span> <span data-ttu-id="c0b32-130">In questa esercitazione si creeranno i modelli di dati mediante la scrittura di classi del modello di dati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-130">In this tutorial, you'll create the data models by writing data model classes.</span></span> <span data-ttu-id="c0b32-131">Quindi, si riceverà una Entity Framework creare il database in base a queste nuove classi.</span><span class="sxs-lookup"><span data-stu-id="c0b32-131">Then, you'll let Entity Framework create the database on the fly from these new classes.</span></span>

<span data-ttu-id="c0b32-132">Si inizierà creando le classi di entità che definiscono i modelli di dati per l'applicazione Web Form.</span><span class="sxs-lookup"><span data-stu-id="c0b32-132">You will begin by creating the entity classes that define the data models for the Web Forms application.</span></span> <span data-ttu-id="c0b32-133">Si creerà quindi una classe del contesto che gestisce le classi di entità e fornisce accesso ai dati nel database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-133">Then you will create a context class that manages the entity classes and provides data access to the database.</span></span> <span data-ttu-id="c0b32-134">Si creerà inoltre una classe di inizializzatore che verrà utilizzato per popolare il database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-134">You will also create an initializer class that you will use to populate the database.</span></span>

### <a name="entity-framework-and-references"></a><span data-ttu-id="c0b32-135">I riferimenti e entity Framework</span><span class="sxs-lookup"><span data-stu-id="c0b32-135">Entity Framework and References</span></span>

<span data-ttu-id="c0b32-136">Per impostazione predefinita, Entity Framework è incluso quando si crea un nuovo **applicazione Web ASP.NET** utilizzando il **Web Form** modello.</span><span class="sxs-lookup"><span data-stu-id="c0b32-136">By default, Entity Framework is included when you create a new **ASP.NET Web Application** using the **Web Forms** template.</span></span> <span data-ttu-id="c0b32-137">Entity Framework è possibile installare, disinstallare e aggiornare come pacchetto NuGet.</span><span class="sxs-lookup"><span data-stu-id="c0b32-137">Entity Framework can be installed, uninstalled, and updated as a NuGet package.</span></span>

<span data-ttu-id="c0b32-138">Questo pacchetto NuGet include quanto segue **runtime** assembly all'interno del progetto:</span><span class="sxs-lookup"><span data-stu-id="c0b32-138">This NuGet package includes the following **runtime** assemblies within your project:</span></span>

- <span data-ttu-id="c0b32-139">File EntityFramework. dll: tutto il codice di runtime comune utilizzato da Entity Framework</span><span class="sxs-lookup"><span data-stu-id="c0b32-139">EntityFramework.dll – All the common runtime code used by Entity Framework</span></span>
- <span data-ttu-id="c0b32-140">EntityFramework.SqlServer.dll: il provider di Microsoft SQL Server per Entity Framework</span><span class="sxs-lookup"><span data-stu-id="c0b32-140">EntityFramework.SqlServer.dll – The Microsoft SQL Server provider for Entity Framework</span></span>

### <a name="entity-classes"></a><span data-ttu-id="c0b32-141">Classi di entità</span><span class="sxs-lookup"><span data-stu-id="c0b32-141">Entity Classes</span></span>

<span data-ttu-id="c0b32-142">Le classi create per definire lo schema dei dati sono dette classi di entità.</span><span class="sxs-lookup"><span data-stu-id="c0b32-142">The classes you create to define the schema of the data are called entity classes.</span></span> <span data-ttu-id="c0b32-143">Se si ha familiarità con Progettazione database, considerare le classi di entità come definizioni di tabella di un database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-143">If you're new to database design, think of the entity classes as table definitions of a database.</span></span> <span data-ttu-id="c0b32-144">Ogni proprietà nella classe specifica una colonna nella tabella del database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-144">Each property in the class specifies a column in the table of the database.</span></span> <span data-ttu-id="c0b32-145">Queste classi forniscono un'interfaccia leggera, relazionale a oggetti tra codice orientata agli oggetti e la struttura della tabella relazionale del database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-145">These classes provide a lightweight, object-relational interface between object-oriented code and the relational table structure of the database.</span></span>

<span data-ttu-id="c0b32-146">In questa esercitazione, verrà inizialmente tramite l'aggiunta di classi di entità semplici che rappresentano gli schemi per i prodotti e le categorie.</span><span class="sxs-lookup"><span data-stu-id="c0b32-146">In this tutorial, you'll start out by adding simple entity classes representing the schemas for products and categories.</span></span> <span data-ttu-id="c0b32-147">La classe di prodotti conterrà le definizioni per ciascun prodotto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-147">The products class will contain definitions for each product.</span></span> <span data-ttu-id="c0b32-148">Il nome di ogni membro della classe product sarà `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, e `Category`.</span><span class="sxs-lookup"><span data-stu-id="c0b32-148">The name of each of the members of the product class will be `ProductID`, `ProductName`, `Description`, `ImagePath`, `UnitPrice`, `CategoryID`, and `Category`.</span></span> <span data-ttu-id="c0b32-149">La classe della categoria conterrà le definizioni per ogni categoria di un prodotto può appartenere a, ad esempio Auto, barca o piano.</span><span class="sxs-lookup"><span data-stu-id="c0b32-149">The category class will contain definitions for each category that a product can belong to, such as Car, Boat, or Plane.</span></span> <span data-ttu-id="c0b32-150">Il nome di ogni membro della classe di categorie sarà `CategoryID`, `CategoryName`, `Description`, e `Products`.</span><span class="sxs-lookup"><span data-stu-id="c0b32-150">The name of each of the members of the category class will be `CategoryID`, `CategoryName`, `Description`, and `Products`.</span></span> <span data-ttu-id="c0b32-151">Ogni prodotto appartiene a una delle categorie.</span><span class="sxs-lookup"><span data-stu-id="c0b32-151">Each product will belong to one of the categories.</span></span> <span data-ttu-id="c0b32-152">Queste classi di entità verranno aggiunto il progetto esistente *modelli* cartella.</span><span class="sxs-lookup"><span data-stu-id="c0b32-152">These entity classes will be added to the project's existing *Models* folder.</span></span>

1. <span data-ttu-id="c0b32-153">In **Esplora**, fare doppio clic su di *modelli* cartella e quindi selezionare **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-153">In **Solution Explorer**, right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span> 

    ![Creare il livello di accesso ai dati - nuovo elemento Menu](create_the_data_access_layer/_static/image1.png)

   <span data-ttu-id="c0b32-155">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-155">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="c0b32-156">In **Visual c#** dal **installato** riquadro a sinistra, seleziona **codice**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-156">Under **Visual C#** from the **Installed** pane on the left, select **Code**.</span></span> 

    ![Creare il livello di accesso ai dati - nuovo elemento Menu](create_the_data_access_layer/_static/image2.png)
3. <span data-ttu-id="c0b32-158">Selezionare **classe** dal riquadro centrale e denominare la nuova classe *Product.cs*.</span><span class="sxs-lookup"><span data-stu-id="c0b32-158">Select **Class** from the middle pane and name this new class *Product.cs*.</span></span>
4. <span data-ttu-id="c0b32-159">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-159">Click **Add**.</span></span>  
   <span data-ttu-id="c0b32-160">Il nuovo file di classe viene visualizzato nell'editor.</span><span class="sxs-lookup"><span data-stu-id="c0b32-160">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="c0b32-161">Sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c0b32-161">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample1.cs)]
6. <span data-ttu-id="c0b32-162">Creare un'altra classe ripetendo i passaggi da 1 a 4, nome, tuttavia, la nuova classe *Category.cs* e sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c0b32-162">Create another class by repeating steps 1 through 4, however, name the new class *Category.cs* and replace the default code with the following code:</span></span>  

    [!code-csharp[Main](create_the_data_access_layer/samples/sample2.cs)]

<span data-ttu-id="c0b32-163">Come menzionato in precedenza, il `Category` classe rappresenta il tipo di prodotto che l'applicazione è progettata per vendere (ad esempio <a id="a"> </a> &quot;automobili&quot;, &quot;barche&quot;, &quot;Razzi&quot;e così via) e `Product` classe rappresenta i singoli prodotti (toys) nel database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-163">As previously mentioned, the `Category` class represents the type of product that the application is designed to sell (such as <a id="a"></a>&quot;Cars&quot;, &quot;Boats&quot;, &quot;Rockets&quot;, and so on), and the `Product` class represents the individual products (toys) in the database.</span></span> <span data-ttu-id="c0b32-164">Ogni istanza di un `Product` oggetto corrisponderà a una riga all'interno di una tabella di database relazionali e ciascuna proprietà della classe Product verrà eseguito il mapping a una colonna nella tabella di database relazionale.</span><span class="sxs-lookup"><span data-stu-id="c0b32-164">Each instance of a `Product` object will correspond to a row within a relational database table, and each property of the Product class will map to a column in the relational database table.</span></span> <span data-ttu-id="c0b32-165">Più avanti in questa esercitazione, si saranno esaminare i dati di prodotto contenuti nel database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-165">Later in this tutorial, you'll review the product data contained in the database.</span></span>

### <a name="data-annotations"></a><span data-ttu-id="c0b32-166">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="c0b32-166">Data Annotations</span></span>

<span data-ttu-id="c0b32-167">Si è notato che determinati membri delle classi hanno attributi specificando dettagli sul membro, ad esempio `[ScaffoldColumn(false)]`.</span><span class="sxs-lookup"><span data-stu-id="c0b32-167">You may have noticed that certain members of the classes have attributes specifying details about the member, such as `[ScaffoldColumn(false)]`.</span></span> <span data-ttu-id="c0b32-168">Si tratta di *le annotazioni dei dati*.</span><span class="sxs-lookup"><span data-stu-id="c0b32-168">These are *data annotations*.</span></span> <span data-ttu-id="c0b32-169">Gli attributi di annotazione dei dati è possono descrivere come convalidare l'input dell'utente per il membro, per specificare la formattazione per tale e per specificare come si è modellato quando viene creato il database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-169">The data annotation attributes can describe how to validate user input for that member, to specify formatting for it, and to specify how it is modeled when the database is created.</span></span>

### <a name="context-class"></a><span data-ttu-id="c0b32-170">Classe Context</span><span class="sxs-lookup"><span data-stu-id="c0b32-170">Context Class</span></span>

<span data-ttu-id="c0b32-171">Per iniziare a utilizzare le classi per accedere ai dati, è necessario definire una classe del contesto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-171">To start using the classes for data access, you must define a context class.</span></span> <span data-ttu-id="c0b32-172">Come accennato in precedenza, la classe del contesto gestisce le classi di entità (ad esempio il `Product` classe e `Category` classe) e fornisce l'accesso ai dati al database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-172">As mentioned previously, the context class manages the entity classes (such as the `Product` class and the `Category` class) and provides data access to the database.</span></span>

<span data-ttu-id="c0b32-173">Questa procedura consente di aggiungere una nuovo contesto classe c# per il *modelli* cartella.</span><span class="sxs-lookup"><span data-stu-id="c0b32-173">This procedure adds a new C# context class to the *Models* folder.</span></span>

1. <span data-ttu-id="c0b32-174">Fare doppio clic su di *modelli* cartella e quindi selezionare **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-174">Right-click the *Models* folder and then select **Add** -&gt; **New Item**.</span></span>   
   <span data-ttu-id="c0b32-175">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-175">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="c0b32-176">Selezionare **classe** dal riquadro centrale, denominarla *ProductContext.cs* e fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-176">Select **Class** from the middle pane, name it *ProductContext.cs* and click **Add**.</span></span>
3. <span data-ttu-id="c0b32-177">Sostituire il codice predefinito contenuto nella classe con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c0b32-177">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample3.cs)]

<span data-ttu-id="c0b32-178">Questo codice aggiunge il `System.Data.Entity` dello spazio dei nomi in modo da poter accedere a tutte le funzionalità principali di Entity Framework, che include la possibilità di query, inserire, aggiornare ed eliminare dati quando si lavora con oggetti fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-178">This code adds the `System.Data.Entity` namespace so that you have access to all the core functionality of Entity Framework, which includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span>

<span data-ttu-id="c0b32-179">Il `ProductContext` classe rappresenta il contesto del database di Entity Framework prodotto, che gestisce il recupero, l'archiviazione e l'aggiornamento `Product` classe istanze nel database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-179">The `ProductContext` class represents Entity Framework product database context, which handles fetching, storing, and updating `Product` class instances in the database.</span></span> <span data-ttu-id="c0b32-180">Il `ProductContext` deriva dalla classe di `DbContext` classe forniti da Entity Framework di base.</span><span class="sxs-lookup"><span data-stu-id="c0b32-180">The `ProductContext` class derives from the `DbContext` base class provided by Entity Framework.</span></span>

### <a name="initializer-class"></a><span data-ttu-id="c0b32-181">Classe di inizializzatore</span><span class="sxs-lookup"><span data-stu-id="c0b32-181">Initializer Class</span></span>

<span data-ttu-id="c0b32-182">È necessario eseguire una logica personalizzata per inizializzare l'ora del primo database che viene utilizzato il contesto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-182">You will need to run some custom logic to initialize the database the first time the context is used.</span></span> <span data-ttu-id="c0b32-183">In questo modo i dati iniziali da aggiungere al database in modo che è possibile visualizzare immediatamente i prodotti e le categorie.</span><span class="sxs-lookup"><span data-stu-id="c0b32-183">This will allow seed data to be added to the database so that you can immediately display products and categories.</span></span>

<span data-ttu-id="c0b32-184">Questa procedura consente di aggiungere una nuovo inizializzatore classe c# per il *modelli* cartella.</span><span class="sxs-lookup"><span data-stu-id="c0b32-184">This procedure adds a new C# initializer class to the *Models* folder.</span></span>

1. <span data-ttu-id="c0b32-185">Creare un altro `Class` nel *modelli* cartella e denominarla *ProductDatabaseInitializer.cs*.</span><span class="sxs-lookup"><span data-stu-id="c0b32-185">Create another `Class` in the *Models* folder and name it *ProductDatabaseInitializer.cs*.</span></span>
2. <span data-ttu-id="c0b32-186">Sostituire il codice predefinito contenuto nella classe con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="c0b32-186">Replace the default code contained in the class with the following code:</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample4.cs)]

<span data-ttu-id="c0b32-187">Come si può notare nel codice precedente, quando il database viene creato e inizializzato, il `Seed` proprietà è sottoposto a override e impostata.</span><span class="sxs-lookup"><span data-stu-id="c0b32-187">As you can see from the above code, when the database is created and initialized, the `Seed` property is overridden and set.</span></span> <span data-ttu-id="c0b32-188">Quando il `Seed` è impostata, i valori dalle categorie e i prodotti vengono utilizzati per popolare il database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-188">When the `Seed` property is set, the values from the categories and products are used to populate the database.</span></span> <span data-ttu-id="c0b32-189">Se si tenta di aggiornare i dati di inizializzazione modificando il codice precedente dopo aver creato il database, non verranno visualizzati tutti gli aggiornamenti quando si esegue l'applicazione Web.</span><span class="sxs-lookup"><span data-stu-id="c0b32-189">If you attempt to update the seed data by modifying the above code after the database has been created, you won't see any updates when you run the Web application.</span></span> <span data-ttu-id="c0b32-190">Il motivo è il codice precedente utilizza un'implementazione del `DropCreateDatabaseIfModelChanges` classe riconoscere se il modello (schema) è stato modificato prima di ripristinare i dati del valore di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-190">The reason is the above code uses an implementation of the `DropCreateDatabaseIfModelChanges` class to recognize if the model (schema) has changed before resetting the seed data.</span></span> <span data-ttu-id="c0b32-191">Se non vengono apportate modifiche per il `Category` e `Product` classi di entità, il database non verranno reinizializzate con i dati del valore di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-191">If no changes are made to the `Category` and `Product` entity classes, the database will not be reinitialized with the seed data.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="c0b32-192">Se si desidera che il database viene ricreato ogni volta che è stata eseguita l'applicazione, è possibile utilizzare il `DropCreateDatabaseAlways` classe anziché la `DropCreateDatabaseIfModelChanges` classe.</span><span class="sxs-lookup"><span data-stu-id="c0b32-192">If you wanted the database to be recreated every time you ran the application, you could use the `DropCreateDatabaseAlways` class instead of the `DropCreateDatabaseIfModelChanges` class.</span></span> <span data-ttu-id="c0b32-193">Tuttavia per questa serie di esercitazioni, usare la `DropCreateDatabaseIfModelChanges` classe.</span><span class="sxs-lookup"><span data-stu-id="c0b32-193">However for this tutorial series, use the `DropCreateDatabaseIfModelChanges` class.</span></span>


<span data-ttu-id="c0b32-194">A questo punto in questa esercitazione, si avrà un *modelli* cartella con quattro nuove classi e la classe di un valore predefinito:</span><span class="sxs-lookup"><span data-stu-id="c0b32-194">At this point in this tutorial, you will have a *Models* folder with four new classes and one default class:</span></span>

![Creare a livello di accesso ai dati - cartella modelli](create_the_data_access_layer/_static/image3.png)

### <a name="configuring-the-application-to-use-the-data-model"></a><span data-ttu-id="c0b32-196">Configurazione dell'applicazione per utilizzare il modello di dati</span><span class="sxs-lookup"><span data-stu-id="c0b32-196">Configuring the Application to Use the Data Model</span></span>

<span data-ttu-id="c0b32-197">Dopo aver creato le classi che rappresentano i dati, è necessario configurare l'applicazione per utilizzare le classi.</span><span class="sxs-lookup"><span data-stu-id="c0b32-197">Now that you've created the classes that represent the data, you must configure the application to use the classes.</span></span> <span data-ttu-id="c0b32-198">Nel *Global. asax* file, Aggiungi il codice che inizializza il modello.</span><span class="sxs-lookup"><span data-stu-id="c0b32-198">In the *Global.asax* file, you add code that initializes the model.</span></span> <span data-ttu-id="c0b32-199">Nel *Web. config* file aggiunto le informazioni che indicano l'applicazione, quali database che si userà per archiviare i dati che sono rappresentati da nuove classi di dati.</span><span class="sxs-lookup"><span data-stu-id="c0b32-199">In the *Web.config* file you add information that tells the application what database you'll use to store the data that's represented by the new data classes.</span></span> <span data-ttu-id="c0b32-200">Il *Global. asax* file può essere utilizzato per gestire gli eventi dell'applicazione o i metodi.</span><span class="sxs-lookup"><span data-stu-id="c0b32-200">The *Global.asax* file can be used to handle application events or methods.</span></span> <span data-ttu-id="c0b32-201">Il *Web. config* file consente di controllare la configurazione dell'applicazione web ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="c0b32-201">The *Web.config* file allows you to control the configuration of your ASP.NET web application.</span></span>

#### <a name="updating-the-globalasax-file"></a><span data-ttu-id="c0b32-202">L'aggiornamento del file Global. asax</span><span class="sxs-lookup"><span data-stu-id="c0b32-202">Updating the Global.asax file</span></span>

<span data-ttu-id="c0b32-203">Per inizializzare i modelli di data all'avvio dell'applicazione, si aggiornerà il `Application_Start` gestore il *Global.asax.cs* file.</span><span class="sxs-lookup"><span data-stu-id="c0b32-203">To initialize the data models when the application starts, you will update the `Application_Start` handler in the *Global.asax.cs* file.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="c0b32-204">In Esplora soluzioni, è possibile selezionare il *Global. asax* file o *Global.asax.cs* file per la modifica di *Global.asax.cs* file.</span><span class="sxs-lookup"><span data-stu-id="c0b32-204">In Solution Explorer, you can select either the *Global.asax* file or the *Global.asax.cs* file to edit the *Global.asax.cs* file.</span></span>


1. <span data-ttu-id="c0b32-205">Aggiungere il seguente codice evidenziato in giallo per il `Application_Start` metodo il *Global.asax.cs* file.</span><span class="sxs-lookup"><span data-stu-id="c0b32-205">Add the following code highlighted in yellow to the `Application_Start` method in the *Global.asax.cs* file.</span></span>   

    [!code-csharp[Main](create_the_data_access_layer/samples/sample5.cs?highlight=9-10,22-23)]

> [!NOTE] 
> 
> <span data-ttu-id="c0b32-206">Il browser supporti HTML5 per visualizzare il codice evidenziato in giallo durante la visualizzazione di questa serie di esercitazioni in un browser.</span><span class="sxs-lookup"><span data-stu-id="c0b32-206">Your browser must support HTML5 to view the code highlighted in yellow when viewing this tutorial series in a browser.</span></span>


<span data-ttu-id="c0b32-207">Come illustrato nel codice precedente, all'avvio dell'applicazione, l'applicazione specifica l'inizializzatore che verrà eseguiti durante la prima volta che i dati si accede.</span><span class="sxs-lookup"><span data-stu-id="c0b32-207">As shown in the above code, when the application starts, the application specifies the initializer that will run during the first time the data is accessed.</span></span> <span data-ttu-id="c0b32-208">I due spazi dei nomi aggiuntivi sono necessari per l'accesso di `Database` oggetto e `ProductDatabaseInitializer` oggetto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-208">The two additional namespaces are required to access the `Database` object and the `ProductDatabaseInitializer` object.</span></span>

 <span data-ttu-id="c0b32-209">Modifica del File Web. config</span><span class="sxs-lookup"><span data-stu-id="c0b32-209">Modifying the Web.Config File</span></span> 

<span data-ttu-id="c0b32-210">Anche se Entity Framework Code First verrà generato un database di in un percorso predefinito quando il database viene popolato con i dati di inizializzazione, l'aggiunta di informazioni di connessione per l'applicazione consente di controllo del percorso del database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-210">Although Entity Framework Code First will generate a database for you in a default location when the database is populated with seed data, adding your own connection information to your application gives you control of the database location.</span></span> <span data-ttu-id="c0b32-211">Specificare la connessione al database utilizzando una stringa di connessione dell'applicazione *Web. config* file alla radice del progetto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-211">You specify this database connection using a connection string in the application's *Web.config* file at the root of the project.</span></span> <span data-ttu-id="c0b32-212">Aggiungendo una nuova stringa di connessione, è possibile indirizzare il percorso del database (*wingtiptoys.mdf*) per essere compilato nella directory dei dati dell'applicazione (*App\_dati*), anziché sul valore predefinito percorso.</span><span class="sxs-lookup"><span data-stu-id="c0b32-212">By adding a new connection string, you can direct the location of the database (*wingtiptoys.mdf*) to be built in the application's data directory (*App\_Data*), rather than its default location.</span></span> <span data-ttu-id="c0b32-213">Questa modifica consente di individuare ed esaminare il file di database più avanti in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-213">Making this change will allow you to find and inspect the database file later in this tutorial.</span></span>

1. <span data-ttu-id="c0b32-214">In **Esplora**, trovare e aprire il *Web. config* file.</span><span class="sxs-lookup"><span data-stu-id="c0b32-214">In **Solution Explorer**, find and open the *Web.config* file.</span></span>
2. <span data-ttu-id="c0b32-215">Aggiungere la stringa di connessione evidenziata in giallo per il `<connectionStrings>` sezione la *Web. config* file come segue:</span><span class="sxs-lookup"><span data-stu-id="c0b32-215">Add the connection string highlighted in yellow to the `<connectionStrings>` section of the *Web.config* file as follows:</span></span>  

    [!code-xml[Main](create_the_data_access_layer/samples/sample6.xml?highlight=4-7)]

<span data-ttu-id="c0b32-216">Quando l'applicazione viene eseguita per la prima volta, creerà il database nel percorso specificato dalla stringa di connessione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-216">When the application is run for the first time, it will build the database at the location specified by the connection string.</span></span> <span data-ttu-id="c0b32-217">Ma prima di eseguire l'applicazione, creare ora, prima di tutto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-217">But before running the application, let's build it first.</span></span>

## <a name="building-the-application"></a><span data-ttu-id="c0b32-218">Compilazione dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="c0b32-218">Building the Application</span></span>

<span data-ttu-id="c0b32-219">Per assicurarsi che tutte le classi e le modifiche all'applicazione Web di lavoro, è necessario compilare l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-219">To make sure that all the classes and changes to your Web application work, you should build the application.</span></span>

1. <span data-ttu-id="c0b32-220">Dal **Debug** dal menu **compilare WingtipToys**.</span><span class="sxs-lookup"><span data-stu-id="c0b32-220">From the **Debug** menu, select **Build WingtipToys**.</span></span>  
 <span data-ttu-id="c0b32-221">Il **Output** verrà visualizzata la finestra e se l'assenza di errori, viene visualizzato un *ha avuto esito positivo* messaggio.</span><span class="sxs-lookup"><span data-stu-id="c0b32-221">The **Output** window is displayed, and if all went well, you see a *succeeded* message.</span></span>  

    ![Creare il livello di accesso ai dati - finestra di Output](create_the_data_access_layer/_static/image4.png)

<span data-ttu-id="c0b32-223">In caso di errore, ricontrollare i passaggi precedenti.</span><span class="sxs-lookup"><span data-stu-id="c0b32-223">If you run into an error, re-check the above steps.</span></span> <span data-ttu-id="c0b32-224">Le informazioni contenute nel **Output** finestra indicherà quali file ha un problema e in cui il file è necessaria una modifica.</span><span class="sxs-lookup"><span data-stu-id="c0b32-224">The information in the **Output** window will indicate which file has a problem and where in the file a change is required.</span></span> <span data-ttu-id="c0b32-225">Queste informazioni consentono di determinare quale parte della procedura devono essere esaminato e risolto nel progetto.</span><span class="sxs-lookup"><span data-stu-id="c0b32-225">This information will enable you to determine what part of the above steps need to be reviewed and fixed in your project.</span></span>

## <a name="summary"></a><span data-ttu-id="c0b32-226">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="c0b32-226">Summary</span></span>

<span data-ttu-id="c0b32-227">In questa esercitazione della serie è avere creato il modello di dati, nonché, aggiunto il codice che verrà utilizzato per inizializzare e inizializzazione del database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-227">In this tutorial of the series you have created the data model, as well as, added the code that will be used to initialize and seed the database.</span></span> <span data-ttu-id="c0b32-228">L'applicazione di utilizzare i modelli di data quando l'applicazione viene eseguita anche è stata configurata.</span><span class="sxs-lookup"><span data-stu-id="c0b32-228">You have also configured the application to use the data models when the application is run.</span></span>

<span data-ttu-id="c0b32-229">Nella prossima esercitazione, si sarà aggiornare l'interfaccia utente, aggiungere la navigazione e recuperare dati dal database.</span><span class="sxs-lookup"><span data-stu-id="c0b32-229">In the next tutorial, you'll update the UI, add navigation, and retrieve data from the database.</span></span> <span data-ttu-id="c0b32-230">Verrà creato il database viene creato automaticamente in base alle classi di entità che è stato creato in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="c0b32-230">This will result in the database being automatically created based on the entity classes that you created in this tutorial.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="c0b32-231">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="c0b32-231">Additional Resources</span></span>

<span data-ttu-id="c0b32-232">[Panoramica di Entity Framework](https://msdn.microsoft.com/library/bb399567.aspx) </span><span class="sxs-lookup"><span data-stu-id="c0b32-232">[Entity Framework Overview](https://msdn.microsoft.com/library/bb399567.aspx) </span></span>  
<span data-ttu-id="c0b32-233">[Guida per principianti a ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span><span class="sxs-lookup"><span data-stu-id="c0b32-233">[Beginner's Guide to the ADO.NET Entity Framework](https://msdn.microsoft.com/data/ee712907) </span></span>  
<span data-ttu-id="c0b32-234">[Prima di sviluppo con Entity Framework di codice](http://www.msteched.com/2010/Europe/DEV212) (video)</span><span class="sxs-lookup"><span data-stu-id="c0b32-234">[Code First Development with Entity Framework](http://www.msteched.com/2010/Europe/DEV212) (video)</span></span>   
<span data-ttu-id="c0b32-235">[Primo relazioni Fluent API del codice](https://msdn.microsoft.com/data/hh134698) </span><span class="sxs-lookup"><span data-stu-id="c0b32-235">[Code First Relationships Fluent API](https://msdn.microsoft.com/data/hh134698) </span></span>  
[<span data-ttu-id="c0b32-236">Annotazioni dei dati prima di codice</span><span class="sxs-lookup"><span data-stu-id="c0b32-236">Code First Data Annotations</span></span>](https://msdn.microsoft.com/data/gg193958)  
[<span data-ttu-id="c0b32-237">Miglioramenti per la produttività per Entity Framework</span><span class="sxs-lookup"><span data-stu-id="c0b32-237">Productivity Improvements for the Entity Framework</span></span>](https://blogs.msdn.com/b/efdesign/archive/2010/06/21/productivity-improvements-for-the-entity-framework.aspx?wa=wsignin1.0)

> [!div class="step-by-step"]
> <span data-ttu-id="c0b32-238">[Precedente](create-the-project.md)
> [Successivo](ui_and_navigation.md)</span><span class="sxs-lookup"><span data-stu-id="c0b32-238">[Previous](create-the-project.md)
[Next](ui_and_navigation.md)</span></span>

---
uid: web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
title: Carrello degli acquisti | Documenti Microsoft
author: Erikre
description: Questa serie di esercitazioni verranno fornite le nozioni di base della creazione di un'applicazione Web Form ASP.NET tramite ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per abbiamo...
ms.author: aspnetcontent
manager: wpickett
ms.date: 09/08/2014
ms.topic: article
ms.assetid: 6898c601-6c31-432f-8388-e6843f8a17cb
ms.technology: dotnet-webforms
ms.prod: .net-framework
msc.legacyurl: /web-forms/overview/getting-started/getting-started-with-aspnet-45-web-forms/shopping-cart
msc.type: authoredcontent
ms.openlocfilehash: a8e96da7737cdf649575711a464c4f7726cb6ded
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/06/2018
ms.locfileid: "30890720"
---
<a name="shopping-cart"></a><span data-ttu-id="fa3e2-103">Carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-103">Shopping Cart</span></span>
====================
<span data-ttu-id="fa3e2-104">da [Erik Reitan](https://github.com/Erikre)</span><span class="sxs-lookup"><span data-stu-id="fa3e2-104">by [Erik Reitan](https://github.com/Erikre)</span></span>

<span data-ttu-id="fa3e2-105">[Scarica progetto di esempio Wingtip Toys (c#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) o [scaricare E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span><span class="sxs-lookup"><span data-stu-id="fa3e2-105">[Download Wingtip Toys Sample Project (C#)](http://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) or [Download E-book (PDF)](http://download.microsoft.com/download/0/F/B/0FBFAA46-2BFD-478F-8E56-7BF3C672DF9D/Getting%20Started%20with%20ASP.NET%204.5%20Web%20Forms%20and%20Visual%20Studio%202013.pdf)</span></span>

> <span data-ttu-id="fa3e2-106">Questa serie di esercitazioni verranno fornite le nozioni di base della creazione di un'applicazione Web Form ASP.NET utilizzando ASP.NET 4.5 e Microsoft Visual Studio Express 2013 per Web.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-106">This tutorial series will teach you the basics of building an ASP.NET Web Forms application using ASP.NET 4.5 and Microsoft Visual Studio Express 2013 for Web.</span></span> <span data-ttu-id="fa3e2-107">Un Visual Studio 2013 [progetto con il codice sorgente c#](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) complemento questa serie di esercitazioni è disponibile.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-107">A Visual Studio 2013 [project with C# source code](https://go.microsoft.com/fwlink/?LinkID=389434&clcid=0x409) is available to accompany this tutorial series.</span></span>


<span data-ttu-id="fa3e2-108">Questa esercitazione vengono descritti la logica di business richiesta per aggiungere un carrello acquisti per l'applicazione Web Form ASP.NET di esempio Wingtip Toys.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-108">This tutorial describes the business logic required to add a shopping cart to the Wingtip Toys sample ASP.NET Web Forms application.</span></span> <span data-ttu-id="fa3e2-109">In questa esercitazione si basa sull'esercitazione precedente "Visualizzazione elementi e dettagli dati" e fa parte della serie di esercitazioni Wingtip giocattoli archivio.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-109">This tutorial builds on the previous tutorial "Display Data Items and Details" and is part of the Wingtip Toy Store tutorial series.</span></span> <span data-ttu-id="fa3e2-110">Dopo aver completato questa esercitazione, gli utenti della propria applicazione di esempio sarà in grado di aggiungere, rimuovere e modificare i prodotti nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-110">When you've completed this tutorial, the users of your sample app will be able to add, remove, and modify the products in their shopping cart.</span></span>

## <a name="what-youll-learn"></a><span data-ttu-id="fa3e2-111">Illustra quanto segue:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-111">What you'll learn:</span></span>

1. <span data-ttu-id="fa3e2-112">Come creare un carrello acquisti per l'applicazione web.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-112">How to create a shopping cart for the web application.</span></span>
2. <span data-ttu-id="fa3e2-113">Come consentire agli utenti di aggiungere elementi al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-113">How to enable users to add items to the shopping cart.</span></span>
3. <span data-ttu-id="fa3e2-114">Come aggiungere un [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) controllo per visualizzare i dettagli del carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-114">How to add a [GridView](https://msdn.microsoft.com/library/system.web.ui.webcontrols.gridview(v=vs.110).aspx#introduction) control to display shopping cart details.</span></span>
4. <span data-ttu-id="fa3e2-115">Come calcolare e visualizzare il totale dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-115">How to calculate and display the order total.</span></span>
5. <span data-ttu-id="fa3e2-116">Come rimuovere e aggiornare gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-116">How to remove and update items in the shopping cart.</span></span>
6. <span data-ttu-id="fa3e2-117">Come includere un contatore di carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-117">How to include a shopping cart counter.</span></span>

## <a name="code-features-in-this-tutorial"></a><span data-ttu-id="fa3e2-118">Funzionalità di codice in questa esercitazione:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-118">Code features in this tutorial:</span></span>

1. <span data-ttu-id="fa3e2-119">Entity Framework Code First</span><span class="sxs-lookup"><span data-stu-id="fa3e2-119">Entity Framework Code First</span></span>
2. <span data-ttu-id="fa3e2-120">Annotazioni dei dati</span><span class="sxs-lookup"><span data-stu-id="fa3e2-120">Data Annotations</span></span>
3. <span data-ttu-id="fa3e2-121">Fortemente tipizzate controlli dati</span><span class="sxs-lookup"><span data-stu-id="fa3e2-121">Strongly typed data controls</span></span>
4. <span data-ttu-id="fa3e2-122">Associazione di modelli</span><span class="sxs-lookup"><span data-stu-id="fa3e2-122">Model binding</span></span>

## <a name="creating-a-shopping-cart"></a><span data-ttu-id="fa3e2-123">Creazione di un carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-123">Creating a Shopping Cart</span></span>

<span data-ttu-id="fa3e2-124">In precedenza in questa serie di esercitazioni, è stato aggiunto pagine e il codice per visualizzare i dati di prodotto da un database.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-124">Earlier in this tutorial series, you added pages and code to view product data from a database.</span></span> <span data-ttu-id="fa3e2-125">In questa esercitazione si creerà un carrello acquisti per gestire i prodotti che gli utenti sono interessati all'acquisto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-125">In this tutorial, you'll create a shopping cart to manage the products that users are interested in buying.</span></span> <span data-ttu-id="fa3e2-126">Gli utenti saranno in grado di cercare e aggiungere elementi al carrello, anche se non sono registrati o registrati.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-126">Users will be able to browse and add items to the shopping cart even if they are not registered or logged in.</span></span> <span data-ttu-id="fa3e2-127">Per gestire l'accesso di carrello acquisti, si assegnano utenti univoco `ID` utilizzando un identificatore univoco globale (GUID) quando l'utente accede il market carrello per la prima volta.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-127">To manage shopping cart access, you will assign users a unique `ID` using a globally unique identifier (GUID) when the user accesses the shopping cart for the first time.</span></span> <span data-ttu-id="fa3e2-128">Archiviare questo `ID` utilizzando lo stato della sessione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-128">You'll store this `ID` using the ASP.NET Session state.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="fa3e2-129">Lo stato della sessione ASP.NET è una posizione comoda in cui archiviare informazioni specifiche dell'utente che scadranno dopo che l'utente ha lasciato il sito.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-129">The ASP.NET Session state is a convenient place to store user-specific information which will expire after the user leaves the site.</span></span> <span data-ttu-id="fa3e2-130">Durante l'utilizzo improprio dello stato sessione può avere implicazioni sulle prestazioni siti di grandi dimensioni, chiaro l'utilizzo della sessione stato funziona anche per scopi dimostrativi.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-130">While misuse of session state can have performance implications on larger sites, light use of session state works well for demonstration purposes.</span></span> <span data-ttu-id="fa3e2-131">Il progetto di esempio Wingtip Toys viene illustrato come utilizzare lo stato della sessione senza un provider esterno, in cui lo stato della sessione è archiviato in-process nel server web che ospita il sito.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-131">The Wingtip Toys sample project shows how to use session state without an external provider, where session state is stored in-process on the web server hosting the site.</span></span> <span data-ttu-id="fa3e2-132">Per i siti di grandi dimensioni che forniscono più istanze di un'applicazione o per i siti che eseguono più istanze di un'applicazione in server diversi, è possibile utilizzare **servizio Cache di Windows Azure**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-132">For larger sites that provide multiple instances of an application or for sites that run multiple instances of an application on different servers, consider using **Windows Azure Cache Service**.</span></span> <span data-ttu-id="fa3e2-133">Il servizio Cache fornisce un servizio di memorizzazione nella cache distribuito che è esterno al sito web e risolve il problema dello stato sessione in-process.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-133">This Cache Service provides a distributed caching service that is external to the web site and solves the problem of using in-process session state.</span></span> <span data-ttu-id="fa3e2-134">Per ulteriori informazioni, vedere [come utilizzare lo stato della sessione ASP.NET con siti Web di Azure](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-134">For more information see, [How to Use ASP.NET Session State with Windows Azure Web Sites](https://docs.microsoft.com/azure/redis-cache/cache-aspnet-session-state-provider).</span></span>


### <a name="add-cartitem-as-a-model-class"></a><span data-ttu-id="fa3e2-135">Aggiungere CartItem come una classe di modello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-135">Add CartItem as a Model Class</span></span>

<span data-ttu-id="fa3e2-136">Più indietro in questa serie di esercitazioni, è definito lo schema per i dati di categoria e prodotto tramite la creazione di `Category` e `Product` classi nel *modelli* cartella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-136">Earlier in this tutorial series, you defined the schema for the category and product data by creating the `Category` and `Product` classes in the *Models* folder.</span></span> <span data-ttu-id="fa3e2-137">A questo punto, aggiungere una nuova classe per definire lo schema per il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-137">Now, add a new class to define the schema for the shopping cart.</span></span> <span data-ttu-id="fa3e2-138">Più avanti in questa esercitazione si aggiungerà una classe per gestire l'accesso ai dati di `CartItem` tabella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-138">Later in this tutorial, you will add a class to handle data access to the `CartItem` table.</span></span> <span data-ttu-id="fa3e2-139">Questa classe fornirà la logica di business per aggiungere, rimuovere e aggiornare gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-139">This class will provide the business logic to add, remove, and update items in the shopping cart.</span></span>

1. <span data-ttu-id="fa3e2-140">Fare doppio clic su di *modelli* cartella e selezionare **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-140">Right-click the *Models* folder and select **Add** -&gt; **New Item**.</span></span> 

    ![Carrello acquisti - nuovo elemento](shopping-cart/_static/image1.png)
2. <span data-ttu-id="fa3e2-142">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-142">The **Add New Item** dialog box is displayed.</span></span> <span data-ttu-id="fa3e2-143">Selezionare **codice**, quindi selezionare **classe**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-143">Select **Code**, and then select **Class**.</span></span> 

    ![Shopping Cart - Aggiungi finestra di dialogo Nuovo elemento](shopping-cart/_static/image2.png)
3. <span data-ttu-id="fa3e2-145">Denominare la nuova classe *CartItem.cs*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-145">Name this new class *CartItem.cs*.</span></span>
4. <span data-ttu-id="fa3e2-146">Fare clic su **Aggiungi**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-146">Click **Add**.</span></span>  
   <span data-ttu-id="fa3e2-147">Il nuovo file di classe viene visualizzato nell'editor.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-147">The new class file is displayed in the editor.</span></span>
5. <span data-ttu-id="fa3e2-148">Sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-148">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample1.cs)]

<span data-ttu-id="fa3e2-149">La `CartItem` classe contiene lo schema che definisce ogni prodotto in cui un utente aggiunge al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-149">The `CartItem` class contains the schema that will define each product a user adds to the shopping cart.</span></span> <span data-ttu-id="fa3e2-150">Questa classe è simile alle altre classi di schema creato in precedenza in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-150">This class is similar to the other schema classes you created earlier in this tutorial series.</span></span> <span data-ttu-id="fa3e2-151">Per convenzione, Code First di Entity Framework si aspetta che la chiave primaria per la `CartItem` tabella può essere `CartItemId` o `ID`.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-151">By convention, Entity Framework Code First expects that the primary key for the `CartItem` table will be either `CartItemId` or `ID`.</span></span> <span data-ttu-id="fa3e2-152">Tuttavia, il codice esegue l'override del comportamento predefinito utilizzando l'annotazione dei dati `[Key]` attributo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-152">However, the code overrides the default behavior by using the data annotation `[Key]` attribute.</span></span> <span data-ttu-id="fa3e2-153">Il `Key` attributo della proprietà ItemId specifica che il `ItemID` proprietà è la chiave primaria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-153">The `Key` attribute of the ItemId property specifies that the `ItemID` property is the primary key.</span></span>

<span data-ttu-id="fa3e2-154">Il `CartId` proprietà specifica il `ID` dell'utente che è associato alla voce per l'acquisto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-154">The `CartId` property specifies the `ID` of the user that is associated with the item to purchase.</span></span> <span data-ttu-id="fa3e2-155">Verrà aggiunto il codice per creare l'utente `ID` quando l'utente accede il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-155">You'll add code to create this user `ID` when the user accesses the shopping cart.</span></span> <span data-ttu-id="fa3e2-156">Questo `ID` verrà anche archiviata come una variabile di sessione ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-156">This `ID` will also be stored as an ASP.NET Session variable.</span></span>

### <a name="update-the-product-context"></a><span data-ttu-id="fa3e2-157">Aggiornare il contesto del prodotto</span><span class="sxs-lookup"><span data-stu-id="fa3e2-157">Update the Product Context</span></span>

<span data-ttu-id="fa3e2-158">Oltre ad aggiungere il `CartItem` (classe), è necessario aggiornare la classe di contesto di database che gestisce le classi di entità e che fornisce accesso ai dati nel database.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-158">In addition to adding the `CartItem` class, you will need to update the database context class that manages the entity classes and that provides data access to the database.</span></span> <span data-ttu-id="fa3e2-159">A tale scopo, si aggiungeranno appena creato `CartItem` del modello di classe per la `ProductContext` classe.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-159">To do this, you will add the newly created `CartItem` model class to the `ProductContext` class.</span></span>

1. <span data-ttu-id="fa3e2-160">In **Esplora**, trovare e aprire il *ProductContext.cs* file nel *modelli* cartella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-160">In **Solution Explorer**, find and open the *ProductContext.cs* file in the *Models* folder.</span></span>
2. <span data-ttu-id="fa3e2-161">Aggiungere il codice evidenziato per il *ProductContext.cs* file come segue:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-161">Add the highlighted code to the *ProductContext.cs* file as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample2.cs?highlight=14)]

<span data-ttu-id="fa3e2-162">Come accennato in precedenza in questa serie di esercitazioni, il codice nel *ProductContext.cs* file aggiunge il `System.Data.Entity` dello spazio dei nomi in modo da poter accedere a tutte le funzionalità principali di Entity Framework.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-162">As mentioned previously in this tutorial series, the code in the *ProductContext.cs* file adds the `System.Data.Entity` namespace so that you have access to all the core functionality of the Entity Framework.</span></span> <span data-ttu-id="fa3e2-163">Questa funzionalità include la possibilità di eseguire una query, inserimento, aggiornamento ed eliminare i dati quando si lavora con oggetti fortemente tipizzati.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-163">This functionality includes the capability to query, insert, update, and delete data by working with strongly typed objects.</span></span> <span data-ttu-id="fa3e2-164">Il `ProductContext` classe aggiunge accesso appena aggiunto `CartItem` classe del modello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-164">The `ProductContext` class adds access to the newly added `CartItem` model class.</span></span>

### <a name="managing-the-shopping-cart-business-logic"></a><span data-ttu-id="fa3e2-165">Gestire la logica di Business carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-165">Managing the Shopping Cart Business Logic</span></span>

<span data-ttu-id="fa3e2-166">Successivamente, si creerà il `ShoppingCart` classe in un nuovo *logica* cartella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-166">Next, you'll create the `ShoppingCart` class in a new *Logic* folder.</span></span> <span data-ttu-id="fa3e2-167">Il `ShoppingCart` classe gestisce l'accesso ai dati di `CartItem` tabella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-167">The `ShoppingCart` class handles data access to the `CartItem` table.</span></span> <span data-ttu-id="fa3e2-168">La classe includerà inoltre la logica di business per aggiungere, rimuovere e aggiornare gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-168">The class will also include the business logic to add, remove, and update items in the shopping cart.</span></span>

<span data-ttu-id="fa3e2-169">La logica di carrello degli acquisti che verranno aggiunti conterrà la funzionalità per gestire le azioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-169">The shopping cart logic that you will add will contain the functionality to manage the following actions:</span></span>

1. <span data-ttu-id="fa3e2-170">Aggiunta di elementi al carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-170">Adding items to the shopping cart</span></span>
2. <span data-ttu-id="fa3e2-171">Rimozione di elementi dal carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-171">Removing items from the shopping cart</span></span>
3. <span data-ttu-id="fa3e2-172">Ottenere l'ID del carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-172">Getting the shopping cart ID</span></span>
4. <span data-ttu-id="fa3e2-173">Recupero elementi dal carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-173">Retrieving items from the shopping cart</span></span>
5. <span data-ttu-id="fa3e2-174">Per un totale la quantità di tutti gli elementi di carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-174">Totaling the amount of all the shopping cart items</span></span>
6. <span data-ttu-id="fa3e2-175">Aggiornamento dei dati del carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-175">Updating the shopping cart data</span></span>

<span data-ttu-id="fa3e2-176">Una pagina carrello acquisti (*ShoppingCart.aspx*) e la classe di carrello essere usata insieme per accedere ai dati del carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-176">A shopping cart page (*ShoppingCart.aspx*) and the shopping cart class will be used together to access shopping cart data.</span></span> <span data-ttu-id="fa3e2-177">La pagina carrello degli acquisti visualizzerà tutti gli elementi da cui che l'utente aggiunge al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-177">The shopping cart page will display all the items the user adds to the shopping cart.</span></span> <span data-ttu-id="fa3e2-178">Oltre il carrello pagina e la classe, si creerà una pagina (*AddToCart.aspx*) per aggiungere il carrello acquisti di prodotti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-178">Besides the shopping cart page and class, you'll create a page (*AddToCart.aspx*) to add products to the shopping cart.</span></span> <span data-ttu-id="fa3e2-179">Si aggiungerà inoltre codice per il *ProductList* pagina e *ProductDetails.aspx* pagina che fornirà un collegamento per il *AddToCart.aspx* pagina, in modo che l'utente può aggiungere prodotti per il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-179">You will also add code to the *ProductList.aspx* page and the *ProductDetails.aspx* page that will provide a link to the *AddToCart.aspx* page, so that the user can add products to the shopping cart.</span></span>

<span data-ttu-id="fa3e2-180">Nel diagramma seguente viene illustrato il processo di base che si verifica quando l'utente aggiunge un prodotto per il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-180">The following diagram shows the basic process that occurs when the user adds a product to the shopping cart.</span></span>

![Carrello acquisti - aggiunta al carrello](shopping-cart/_static/image3.png)

<span data-ttu-id="fa3e2-182">Quando l'utente fa clic il **Add To Cart** collegamento in entrambi i *ProductList* pagina o *ProductDetails.aspx* pagina, l'applicazione verrà visualizzata la *AddToCart.aspx* pagina e quindi automaticamente al *ShoppingCart.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-182">When the user clicks the **Add To Cart** link on either the *ProductList.aspx* page or the *ProductDetails.aspx* page, the application will navigate to the *AddToCart.aspx* page and then automatically to the *ShoppingCart.aspx* page.</span></span> <span data-ttu-id="fa3e2-183">Il *AddToCart.aspx* pagina aggiungerà il prodotto seleziona al carrello chiamando un metodo nella classe ShoppingCart.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-183">The *AddToCart.aspx* page will add the select product to the shopping cart by calling a method in the ShoppingCart class.</span></span> <span data-ttu-id="fa3e2-184">Il *ShoppingCart.aspx* pagina verrà visualizzati i prodotti che sono stati aggiunti al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-184">The *ShoppingCart.aspx* page will display the products that have been added to the shopping cart.</span></span>

#### <a name="creating-the-shopping-cart-class"></a><span data-ttu-id="fa3e2-185">Creazione della classe di carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-185">Creating the Shopping Cart Class</span></span>

<span data-ttu-id="fa3e2-186">La `ShoppingCart` classe verrà aggiunta in una cartella separata nell'applicazione in modo che non esiste una chiara distinzione tra il modello (cartella Models), le pagine (cartella radice) e la logica (cartella logica).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-186">The `ShoppingCart` class will be added to a separate folder in the application so that there will be a clear distinction between the model (Models folder), the pages (root folder) and the logic (Logic folder).</span></span>

1. <span data-ttu-id="fa3e2-187">In **Esplora**, fare doppio clic su di **WingtipToys**del progetto e selezionare **Aggiungi**-&gt;**nuova cartella**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-187">In **Solution Explorer**, right-click the **WingtipToys**project and select **Add**-&gt;**New Folder**.</span></span> <span data-ttu-id="fa3e2-188">Denominare la nuova cartella *logica*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-188">Name the new folder *Logic*.</span></span>
2. <span data-ttu-id="fa3e2-189">Fare doppio clic su di *logica* cartella e quindi selezionare **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-189">Right-click the *Logic* folder and then select **Add** -&gt; **New Item**.</span></span>
3. <span data-ttu-id="fa3e2-190">Aggiungere un nuovo file di classe denominato *ShoppingCartActions.cs*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-190">Add a new class file named *ShoppingCartActions.cs*.</span></span>
4. <span data-ttu-id="fa3e2-191">Sostituire il codice predefinito con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-191">Replace the default code with the following code:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample3.cs)]

<span data-ttu-id="fa3e2-192">Il `AddToCart` metodo consente di singoli prodotti da includere nel carrello acquisti in base al prodotto `ID`.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-192">The `AddToCart` method enables individual products to be included in the shopping cart based on the product `ID`.</span></span> <span data-ttu-id="fa3e2-193">Il prodotto viene aggiunto al carrello, o se il carrello contiene già un elemento per il prodotto, la quantità viene incrementata.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-193">The product is added to the cart, or if the cart already contains an item for that product, the quantity is incremented.</span></span>

<span data-ttu-id="fa3e2-194">Il `GetCartId` il metodo restituisce il carrello `ID` per l'utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-194">The `GetCartId` method returns the cart `ID` for the user.</span></span> <span data-ttu-id="fa3e2-195">Il carrello `ID` viene utilizzato per tenere traccia degli elementi di un utente nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-195">The cart `ID` is used to track the items that a user has in their shopping cart.</span></span> <span data-ttu-id="fa3e2-196">Se l'utente non dispone di un carrello esistente `ID`, un carrello nuovo `ID` viene creata per loro.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-196">If the user does not have an existing cart `ID`, a new cart `ID` is created for them.</span></span> <span data-ttu-id="fa3e2-197">Se l'utente ha effettuato l'accesso come utente registrato, il carrello `ID` è impostato su nome utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-197">If the user is signed in as a registered user, the cart `ID` is set to their user name.</span></span> <span data-ttu-id="fa3e2-198">Tuttavia, se l'utente non è connesso, il carrello `ID` è impostata su un valore univoco (GUID).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-198">However, if the user is not signed in, the cart `ID` is set to a unique value (a GUID).</span></span> <span data-ttu-id="fa3e2-199">Un GUID garantisce che solo un carrello viene creato per ogni utente, in base a una sessione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-199">A GUID ensures that only one cart is created for each user, based on session.</span></span>

<span data-ttu-id="fa3e2-200">Il `GetCartItems` metodo restituisce un elenco di shopping cart elementi per l'utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-200">The `GetCartItems` method returns a list of shopping cart items for the user.</span></span> <span data-ttu-id="fa3e2-201">Più avanti in questa esercitazione, si noterà che l'associazione di modelli viene utilizzata per visualizzare gli elementi del carrello nel carrello acquisti tramite il `GetCartItems` metodo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-201">Later in this tutorial, you will see that model binding is used to display the cart items in the shopping cart using the `GetCartItems` method.</span></span>

### <a name="creating-the-add-to-cart-functionality"></a><span data-ttu-id="fa3e2-202">Creare la funzionalità Aggiungi al carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-202">Creating the Add-To-Cart Functionality</span></span>

<span data-ttu-id="fa3e2-203">Come accennato in precedenza, si creerà una pagina di elaborazione denominata *AddToCart.aspx* che verrà usato per aggiungere nuovi prodotti al carrello acquisti dell'utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-203">As mentioned earlier, you will create a processing page named *AddToCart.aspx* that will be used to add new products to the shopping cart of the user.</span></span> <span data-ttu-id="fa3e2-204">Questa pagina verrà chiamato il `AddToCart` metodo la `ShoppingCart` classe appena creata.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-204">This page will call the `AddToCart` method in the `ShoppingCart` class that you just created.</span></span> <span data-ttu-id="fa3e2-205">Il *AddToCart.aspx* pagina si aspetta che un prodotto `ID` viene passato al metodo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-205">The *AddToCart.aspx* page will expect that a product `ID` is passed to it.</span></span> <span data-ttu-id="fa3e2-206">Questo prodotto `ID` verrà utilizzato quando si chiama il `AddToCart` metodo la `ShoppingCart` classe.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-206">This product `ID` will be used when calling the `AddToCart` method in the `ShoppingCart` class.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="fa3e2-207">È necessario modificare il code-behind (*AddToCart.aspx.cs*) per questa pagina, non la pagina dell'interfaccia utente (*AddToCart.aspx*).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-207">You will be modifying the code-behind (*AddToCart.aspx.cs*) for this page, not the page UI (*AddToCart.aspx*).</span></span>


#### <a name="to-create-the-add-to-cart-functionality"></a><span data-ttu-id="fa3e2-208">Per creare Add To Cart funzionalità:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-208">To create the Add-To-Cart functionality:</span></span>

1. <span data-ttu-id="fa3e2-209">In **Esplora**, fare doppio clic su di **WingtipToys**del progetto, fare clic su **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-209">In **Solution Explorer**, right-click the **WingtipToys**project, click **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="fa3e2-210">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-210">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="fa3e2-211">Aggiungere una nuova pagina standard (Web Form) per l'applicazione denominata *AddToCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-211">Add a standard new page (Web Form) to the application named *AddToCart.aspx*.</span></span> 

    ![Shopping Cart - aggiungere Web Form](shopping-cart/_static/image4.png)
3. <span data-ttu-id="fa3e2-213">In **Esplora**, fare doppio clic su di *AddToCart.aspx* pagina e quindi fare clic su **Visualizza codice**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-213">In **Solution Explorer**, right-click the *AddToCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="fa3e2-214">Il *AddToCart.aspx.cs* file code-behind è aperto nell'editor.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-214">The *AddToCart.aspx.cs* code-behind file is opened in the editor.</span></span>
4. <span data-ttu-id="fa3e2-215">Sostituire il codice esistente nel *AddToCart.aspx.cs* codice con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-215">Replace the existing code in the *AddToCart.aspx.cs* code-behind with the following:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample4.cs)]

<span data-ttu-id="fa3e2-216">Quando il *AddToCart.aspx* pagina viene caricata, il prodotto `ID` viene recuperato dalla stringa di query.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-216">When the *AddToCart.aspx* page is loaded, the product `ID` is retrieved from the query string.</span></span> <span data-ttu-id="fa3e2-217">Successivamente, un'istanza della classe di carrello acquisti viene creata e utilizzata per chiamare il `AddToCart` metodo aggiunto precedentemente in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-217">Next, an instance of the shopping cart class is created and used to call the `AddToCart` method that you added earlier in this tutorial.</span></span> <span data-ttu-id="fa3e2-218">Il `AddToCart` contenuta nel metodo il *ShoppingCartActions.cs* file, che include la logica per aggiungere il prodotto selezionato per il carrello acquisti o aumentare la quantità del prodotto del prodotto selezionato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-218">The `AddToCart` method, contained in the *ShoppingCartActions.cs* file, includes the logic to add the selected product to the shopping cart or increment the product quantity of the selected product.</span></span> <span data-ttu-id="fa3e2-219">Se il prodotto è stato aggiunto al carrello acquisti, il prodotto viene aggiunto per il `CartItem` tabella del database.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-219">If the product hasn't been added to the shopping cart, the product is added to the `CartItem` table of the database.</span></span> <span data-ttu-id="fa3e2-220">Se il prodotto è già stata aggiunta al carrello e l'utente aggiunge un elemento aggiuntivo dello stesso prodotto, la quantità di prodotto viene incrementata il `CartItem` tabella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-220">If the product has already been added to the shopping cart and the user adds an additional item of the same product, the product quantity is incremented in the `CartItem` table.</span></span> <span data-ttu-id="fa3e2-221">Infine, la pagina reindirizza il *ShoppingCart.aspx* pagina che verrà aggiunto nel passaggio successivo, in cui l'utente visualizza un elenco aggiornato di articoli nel carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-221">Finally, the page redirects back to the *ShoppingCart.aspx* page that you'll add in the next step, where the user sees an updated list of items in the cart.</span></span>

<span data-ttu-id="fa3e2-222">Come menzionato in precedenza, un utente `ID` viene utilizzato per identificare i prodotti che sono associati a un utente specifico.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-222">As previously mentioned, a user `ID` is used to identify the products that are associated with a specific user.</span></span> <span data-ttu-id="fa3e2-223">Questo `ID` viene aggiunto a una riga di `CartItem` tabella ogni volta che l'utente aggiunge un prodotto per il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-223">This `ID` is added to a row in the `CartItem` table each time the user adds a product to the shopping cart.</span></span>

### <a name="creating-the-shopping-cart-ui"></a><span data-ttu-id="fa3e2-224">Creazione del carrello degli acquisti dell'interfaccia utente</span><span class="sxs-lookup"><span data-stu-id="fa3e2-224">Creating the Shopping Cart UI</span></span>

<span data-ttu-id="fa3e2-225">Il *ShoppingCart.aspx* pagina verrà visualizzati i prodotti che l'utente ha aggiunto al carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-225">The *ShoppingCart.aspx* page will display the products that the user has added to their shopping cart.</span></span> <span data-ttu-id="fa3e2-226">Fornirà anche la possibilità di aggiungere, rimuovere e aggiornare gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-226">It will also provide the ability to add, remove and update items in the shopping cart.</span></span>

1. <span data-ttu-id="fa3e2-227">In **Esplora**, fare doppio clic su **WingtipToys**, fare clic su **Aggiungi**  - &gt; **nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-227">In **Solution Explorer**, right-click **WingtipToys**, click **Add** -&gt; **New Item**.</span></span>  
   <span data-ttu-id="fa3e2-228">Verrà visualizzata la finestra di dialogo **Aggiungi nuovo elemento**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-228">The **Add New Item** dialog box is displayed.</span></span>
2. <span data-ttu-id="fa3e2-229">Aggiungere una nuova pagina (Web Form) che include una pagina master selezionando **Web Form mediante pagina Master**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-229">Add a new page (Web Form) that includes a master page by selecting **Web Form using Master Page**.</span></span> <span data-ttu-id="fa3e2-230">Denominare la nuova pagina *ShoppingCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-230">Name the new page *ShoppingCart.aspx*.</span></span>
3. <span data-ttu-id="fa3e2-231">Selezionare **Site. master** per collegare la pagina master per l'oggetto appena creato *aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-231">Select **Site.Master** to attach the master page to the newly created *.aspx* page.</span></span>
4. <span data-ttu-id="fa3e2-232">Nel *ShoppingCart.aspx* pagina, sostituire il codice esistente con il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-232">In the *ShoppingCart.aspx* page, replace the existing markup with the following markup:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample5.aspx)]

<span data-ttu-id="fa3e2-233">Il *ShoppingCart.aspx* pagina include un **GridView** controllo denominato `CartList`.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-233">The *ShoppingCart.aspx* page includes a **GridView** control named `CartList`.</span></span> <span data-ttu-id="fa3e2-234">Questo controllo utilizza l'associazione di modelli per associare i dati del carrello acquisti del database per il **GridView** controllo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-234">This control uses model binding to bind the shopping cart data from the database to the **GridView** control.</span></span> <span data-ttu-id="fa3e2-235">Quando si imposta la `ItemType` proprietà del **GridView** di controllo, espressione di associazione dati `Item` è disponibile nel markup del controllo e il controllo diventa fortemente tipizzato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-235">When you set the `ItemType` property of the **GridView** control, the data-binding expression `Item` is available in the markup of the control and the control becomes strongly typed.</span></span> <span data-ttu-id="fa3e2-236">Come accennato in precedenza in questa serie di esercitazioni, è possibile selezionare i dettagli del `Item` utilizzando IntelliSense.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-236">As mentioned earlier in this tutorial series, you can select details of the `Item` object using IntelliSense.</span></span> <span data-ttu-id="fa3e2-237">Per configurare un controllo di dati per l'utilizzo di associazione di modelli per selezionare i dati, impostare il `SelectMethod` proprietà del controllo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-237">To configure a data control to use model binding to select data, you set the `SelectMethod` property of the control.</span></span> <span data-ttu-id="fa3e2-238">Nel codice precedente, si imposta la `SelectMethod` per utilizzare il metodo GetShoppingCartItems che restituisce un elenco di `CartItem` oggetti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-238">In the markup above, you set the `SelectMethod` to use the GetShoppingCartItems method which returns a list of `CartItem` objects.</span></span> <span data-ttu-id="fa3e2-239">Il **GridView** controllo dati chiama il metodo nel momento adeguato del ciclo di vita della pagina e associa automaticamente i dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-239">The **GridView** data control calls the method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="fa3e2-240">Il `GetShoppingCartItems` metodo deve ancora essere aggiunto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-240">The `GetShoppingCartItems` method must still be added.</span></span>

#### <a name="retrieving-the-shopping-cart-items"></a><span data-ttu-id="fa3e2-241">Recuperare gli elementi del carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-241">Retrieving the Shopping Cart Items</span></span>

<span data-ttu-id="fa3e2-242">Aggiungere quindi codice per il *ShoppingCart.aspx.cs* code-behind per recuperare e popolare il carrello acquisti dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-242">Next, you add code to the *ShoppingCart.aspx.cs* code-behind to retrieve and populate the Shopping Cart UI.</span></span>

1. <span data-ttu-id="fa3e2-243">In **Esplora**, fare doppio clic su di *ShoppingCart.aspx* pagina e quindi fare clic su **Visualizza codice**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-243">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and then click **View Code**.</span></span> <span data-ttu-id="fa3e2-244">Il *ShoppingCart.aspx.cs* file code-behind è aperto nell'editor.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-244">The *ShoppingCart.aspx.cs* code-behind file is opened in the editor.</span></span>
2. <span data-ttu-id="fa3e2-245">Sostituire il codice esistente con quello seguente:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-245">Replace the existing code with the following:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample6.cs)]

<span data-ttu-id="fa3e2-246">Come indicato in precedenza, il `GridView` chiamate di controllo ai dati di `GetShoppingCartItems` metodo nel momento adeguato del ciclo di vita della pagina del ciclo e associa automaticamente i dati restituiti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-246">As mentioned above, the `GridView` data control calls the `GetShoppingCartItems` method at the appropriate time in the page life cycle and automatically binds the returned data.</span></span> <span data-ttu-id="fa3e2-247">Il `GetShoppingCartItems` metodo crea un'istanza di `ShoppingCartActions` oggetto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-247">The `GetShoppingCartItems` method creates an instance of the `ShoppingCartActions` object.</span></span> <span data-ttu-id="fa3e2-248">Quindi, il codice usa tale istanza per restituire gli elementi nel carrello chiamando il `GetCartItems` metodo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-248">Then, the code uses that instance to return the items in the cart by calling the `GetCartItems` method.</span></span>

### <a name="adding-products-to-the-shopping-cart"></a><span data-ttu-id="fa3e2-249">Aggiunta di prodotti al carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-249">Adding Products to the Shopping Cart</span></span>

<span data-ttu-id="fa3e2-250">Quando entrambi i *ProductList.aspx* o *ProductDetails.aspx* viene visualizzata la pagina, l'utente sarà in grado di aggiungere il prodotto al carrello utilizzando un collegamento.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-250">When either the *ProductList.aspx* or the *ProductDetails.aspx* page is displayed, the user will be able to add the product to the shopping cart using a link.</span></span> <span data-ttu-id="fa3e2-251">Quando si fa clic sul collegamento, l'applicazione passa alla pagina elaborazione denominata *AddToCart.aspx*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-251">When they click the link, the application navigates to the processing page named *AddToCart.aspx*.</span></span> <span data-ttu-id="fa3e2-252">Il *AddToCart.aspx* pagina chiamerà il `AddToCart` metodo la `ShoppingCart` classe che è stato aggiunto in precedenza in questa esercitazione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-252">The *AddToCart.aspx* page will call the `AddToCart` method in the `ShoppingCart` class that you added earlier in this tutorial.</span></span>

<span data-ttu-id="fa3e2-253">A questo punto, si aggiungerà un **Aggiungi al carrello** collegamento sia il *ProductList.aspx* pagina e *ProductDetails.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-253">Now, you'll add an **Add to Cart** link to both the *ProductList.aspx* page and the *ProductDetails.aspx* page.</span></span> <span data-ttu-id="fa3e2-254">Questo collegamento verrà includono il prodotto `ID` recuperati dal database.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-254">This link will include the product `ID` that is retrieved from the database.</span></span>

1. <span data-ttu-id="fa3e2-255">In **Esplora**, trovare e aprire la pagina denominata *ProductList.aspx*.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-255">In **Solution Explorer**, find and open the page named *ProductList.aspx*.</span></span>
2. <span data-ttu-id="fa3e2-256">Aggiungere il markup evidenziato in giallo per il *ProductList.aspx* pagina in modo che l'intera pagina viene visualizzata come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-256">Add the markup highlighted in yellow to the *ProductList.aspx* page so that the entire page appears as follows:</span></span>  

    [!code-aspx[Main](shopping-cart/samples/sample7.aspx?highlight=50-54)]

### <a name="testing-the-shopping-cart"></a><span data-ttu-id="fa3e2-257">Test del carrello degli acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-257">Testing the Shopping Cart</span></span>

<span data-ttu-id="fa3e2-258">Eseguire l'applicazione per vedere come aggiungere prodotti al carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-258">Run the application to see how you add products to the shopping cart.</span></span>

1. <span data-ttu-id="fa3e2-259">Premere **F5** per eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-259">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="fa3e2-260">Dopo che il progetto ricrea il database, aprire il browser e visualizzare il *Default.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-260">After the project recreates the database, the browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="fa3e2-261">Selezionare **automobili** dal menu di navigazione di categoria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-261">Select **Cars** from the category navigation menu.</span></span>  
 <span data-ttu-id="fa3e2-262">Il *ProductList.aspx* viene visualizzata la pagina che mostra solo i prodotti inclusi nella categoria "Auto".</span><span class="sxs-lookup"><span data-stu-id="fa3e2-262">The *ProductList.aspx* page is displayed showing only products included in the "Cars" category.</span></span> 

    ![Carrello acquisti - automobili](shopping-cart/_static/image5.png)
3. <span data-ttu-id="fa3e2-264">Fare clic su di **Aggiungi al carrello** collegamento accanto a prima del prodotto elencato (car convertibile).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-264">Click the **Add to Cart** link next to the first product listed (the convertible car).</span></span>   
 <span data-ttu-id="fa3e2-265">Il *ShoppingCart.aspx* verrà visualizzata la pagina, che mostra la selezione nel carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-265">The *ShoppingCart.aspx* page is displayed, showing the selection in your shopping cart.</span></span> 

    ![Carrello acquisti - carrello](shopping-cart/_static/image6.png)
4. <span data-ttu-id="fa3e2-267">Visualizzare i prodotti aggiuntivi selezionando **piani** dal menu di navigazione di categoria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-267">View additional products by selecting **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="fa3e2-268">Fare clic su di **Aggiungi al carrello** collegamento accanto a elencato prima del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-268">Click the **Add to Cart** link next to the first product listed.</span></span>  
 <span data-ttu-id="fa3e2-269">Il *ShoppingCart.aspx* verrà visualizzata la pagina con l'elemento aggiuntiva.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-269">The *ShoppingCart.aspx* page is displayed with the additional item.</span></span>
6. <span data-ttu-id="fa3e2-270">Chiudere il browser.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-270">Close the browser.</span></span>

### <a name="calculating-and-displaying-the-order-total"></a><span data-ttu-id="fa3e2-271">Calcolo e il totale dell'ordine di visualizzazione</span><span class="sxs-lookup"><span data-stu-id="fa3e2-271">Calculating and Displaying the Order Total</span></span>

<span data-ttu-id="fa3e2-272">Oltre ad aggiungere prodotti al carrello acquisti, si aggiungerà un `GetTotal` metodo per la `ShoppingCart` classe e visualizzare la quantità totale dell'ordine nella pagina carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-272">In addition to adding products to the shopping cart, you will add a `GetTotal` method to the `ShoppingCart` class and display the total order amount in the shopping cart page.</span></span>

1. <span data-ttu-id="fa3e2-273">In **Esplora**, aprire il *ShoppingCartActions.cs* file nel *logica* cartella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-273">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="fa3e2-274">Aggiungere il seguente `GetTotal` metodo evidenziato in giallo per la `ShoppingCart` classe, in modo che la classe viene visualizzata come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-274">Add the following `GetTotal` method highlighted in yellow to the `ShoppingCart` class, so that the class appears as follows:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample8.cs?highlight=85-97)]

<span data-ttu-id="fa3e2-275">Prima di tutto, il `GetTotal` metodo ottiene l'ID del carrello acquisti dell'utente.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-275">First, the `GetTotal` method gets the ID of the shopping cart for the user.</span></span> <span data-ttu-id="fa3e2-276">Il metodo recupera quindi il carrello totale moltiplicando il prezzo del prodotto per la quantità del prodotto per ogni prodotto elencato nel carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-276">Then the method gets the cart total by multiplying the product price by the product quantity for each product listed in the cart.</span></span>

> [!NOTE] 
> 
> <span data-ttu-id="fa3e2-277">Il codice precedente utilizza il tipo nullable "`int?`".</span><span class="sxs-lookup"><span data-stu-id="fa3e2-277">The above code uses the nullable type "`int?`".</span></span> <span data-ttu-id="fa3e2-278">Tipi nullable possono rappresentare tutti i valori di un tipo sottostante ma anche come un valore null.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-278">Nullable types can represent all the values of an underlying type, and also as a null value.</span></span> <span data-ttu-id="fa3e2-279">Per ulteriori informazioni, vedere [utilizzando i tipi Nullable](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx).</span><span class="sxs-lookup"><span data-stu-id="fa3e2-279">For more information see, [Using Nullable Types](https://msdn.microsoft.com/library/2cf62fcy(v=vs.110).aspx).</span></span>


### <a name="modify-the-shopping-cart-display"></a><span data-ttu-id="fa3e2-280">Modificare la visualizzazione del carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-280">Modify the Shopping Cart Display</span></span>

<span data-ttu-id="fa3e2-281">Successivamente si verrà modificato il codice per il *ShoppingCart.aspx* pagina per chiamare il `GetTotal` (metodo) e visualizzare un totale nel *ShoppingCart.aspx* pagina durante il caricamento della pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-281">Next you'll modify the code for the *ShoppingCart.aspx* page to call the `GetTotal` method and display that total on the *ShoppingCart.aspx* page when the page loads.</span></span>

1. <span data-ttu-id="fa3e2-282">In **Esplora**, fare doppio clic su di *ShoppingCart.aspx* pagina e selezionare **Visualizza codice**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-282">In **Solution Explorer**, right-click the *ShoppingCart.aspx* page and select **View Code**.</span></span>
2. <span data-ttu-id="fa3e2-283">Nel *ShoppingCart.aspx.cs* file, aggiornare il `Page_Load` gestore aggiungendo il seguente codice evidenziato in giallo:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-283">In the *ShoppingCart.aspx.cs* file, update the `Page_Load` handler by adding the following code highlighted in yellow:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample9.cs?highlight=16-31)]

<span data-ttu-id="fa3e2-284">Quando il *ShoppingCart.aspx* caricamento della pagina, carica l'oggetto del carrello acquisti e recupera quindi il totale di carrello acquisti chiamando il `GetTotal` metodo la `ShoppingCart` classe.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-284">When the *ShoppingCart.aspx* page loads, it loads the shopping cart object and then retrieves the shopping cart total by calling the `GetTotal` method of the `ShoppingCart` class.</span></span> <span data-ttu-id="fa3e2-285">Se il carrello acquisti è vuoto, viene visualizzato un messaggio in tal senso.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-285">If the shopping cart is empty, a message to that effect is displayed.</span></span>

### <a name="testing-the-shopping-cart-total"></a><span data-ttu-id="fa3e2-286">Test totale carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-286">Testing the Shopping Cart Total</span></span>

<span data-ttu-id="fa3e2-287">Eseguire l'applicazione per vedere come non è possibile solo aggiungere un prodotto per il carrello acquisti, ma è possibile visualizzare il totale di carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-287">Run the application now to see how you can not only add a product to the shopping cart, but you can see the shopping cart total.</span></span>

1. <span data-ttu-id="fa3e2-288">Premere **F5** per eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-288">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="fa3e2-289">Aprire il browser e visualizzare il *Default.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-289">The browser will open and show the *Default.aspx* page.</span></span>
2. <span data-ttu-id="fa3e2-290">Selezionare **automobili** dal menu di navigazione di categoria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-290">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="fa3e2-291">Fare clic su di **Add To Cart** collegamento accanto a prima del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-291">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="fa3e2-292">Il *ShoppingCart.aspx* viene visualizzata la pagina con il totale dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-292">The *ShoppingCart.aspx* page is displayed with the order total.</span></span> 

    ![Shopping Cart - totale carrello](shopping-cart/_static/image7.png)
4. <span data-ttu-id="fa3e2-294">Aggiungere alcuni altri prodotti (ad esempio, un piano) al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-294">Add some other products (for example, a plane) to the cart.</span></span>
5. <span data-ttu-id="fa3e2-295">Il *ShoppingCart.aspx* viene visualizzata la pagina con un totale per tutti i prodotti aggiunti aggiornato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-295">The *ShoppingCart.aspx* page is displayed with an updated total for all the products you've added.</span></span> 

    ![Carrello acquisti - più prodotti](shopping-cart/_static/image8.png)
6. <span data-ttu-id="fa3e2-297">Arrestare l'applicazione in esecuzione, chiudere la finestra del browser.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-297">Stop the running app by closing the browser window.</span></span>

### <a name="adding-update-and-checkout-buttons-to-the-shopping-cart"></a><span data-ttu-id="fa3e2-298">Aggiunta di pulsanti di estrazione e di aggiornamento al carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-298">Adding Update and Checkout Buttons to the Shopping Cart</span></span>

<span data-ttu-id="fa3e2-299">Per consentire agli utenti di modificare il carrello acquisti, aggiungerai un **aggiornamento** pulsante e un **estrazione** pulsante alla pagina carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-299">To allow the users to modify the shopping cart, you'll add an **Update** button and a **Checkout** button to the shopping cart page.</span></span> <span data-ttu-id="fa3e2-300">Il **estrazione** pulsante non viene utilizzato fino a quando non più avanti in questa serie di esercitazioni.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-300">The **Checkout** button is not used until later in this tutorial series.</span></span>

1. <span data-ttu-id="fa3e2-301">In **Esplora**, aprire il *ShoppingCart.aspx* pagina nella radice del progetto di applicazione web.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-301">In **Solution Explorer**, open the *ShoppingCart.aspx* page in the root of the web application project.</span></span>
2. <span data-ttu-id="fa3e2-302">Per aggiungere il **aggiornamento** pulsante e **estrazione** pulsante per il *ShoppingCart.aspx* pagina, aggiungere il markup evidenziato in giallo al codice esistente, come illustrato di codice seguente:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-302">To add the **Update** button and the **Checkout** button to the *ShoppingCart.aspx* page, add the markup highlighted in yellow to the existing markup, as shown in the following code:</span></span>   

    [!code-aspx[Main](shopping-cart/samples/sample10.aspx?highlight=36-45)]

<span data-ttu-id="fa3e2-303">Quando l'utente sceglie il **aggiornamento** pulsante, il `UpdateBtn_Click` gestore verrà chiamato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-303">When the user clicks the **Update** button, the `UpdateBtn_Click` event handler will be called.</span></span> <span data-ttu-id="fa3e2-304">Questo gestore eventi chiama il codice che verrà aggiunto nel passaggio successivo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-304">This event handler will call the code that you'll add in the next step.</span></span>

<span data-ttu-id="fa3e2-305">Successivamente, è possibile aggiornare il codice contenuto nel *ShoppingCart.aspx.cs* file per scorrere gli elementi del carrello e chiamata di `RemoveItem` e `UpdateItem` metodi.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-305">Next, you can update the code contained in the *ShoppingCart.aspx.cs* file to loop through the cart items and call the `RemoveItem` and `UpdateItem` methods.</span></span>

1. <span data-ttu-id="fa3e2-306">In **Esplora**, aprire il *ShoppingCart.aspx.cs* file nella radice del progetto di applicazione web.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-306">In **Solution Explorer**, open the *ShoppingCart.aspx.cs* file in the root of the web application project.</span></span>
2. <span data-ttu-id="fa3e2-307">Aggiungere le seguenti sezioni di codice evidenziate in giallo per il *ShoppingCart.aspx.cs* file:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-307">Add the following code sections highlighted in yellow to the *ShoppingCart.aspx.cs* file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample11.cs?highlight=9-11,33,44-89)]

<span data-ttu-id="fa3e2-308">Quando l'utente fa clic il **aggiornamento** pulsante il *ShoppingCart.aspx* pagina, viene chiamato il metodo UpdateCartItems.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-308">When the user clicks the **Update** button on the *ShoppingCart.aspx* page, the UpdateCartItems method is called.</span></span> <span data-ttu-id="fa3e2-309">Il metodo UpdateCartItems Ottiene i valori aggiornati per ogni elemento nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-309">The UpdateCartItems method gets the updated values for each item in the shopping cart.</span></span> <span data-ttu-id="fa3e2-310">Chiama quindi il metodo UpdateCartItems il `UpdateShoppingCartDatabase` metodo (aggiunto e descritto nel passaggio successivo) per aggiungere o rimuovere gli elementi dal carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-310">Then, the UpdateCartItems method calls the `UpdateShoppingCartDatabase` method (added and explained in the next step) to either add or remove items from the shopping cart.</span></span> <span data-ttu-id="fa3e2-311">Una volta che il database è stato aggiornato per riflettere gli aggiornamenti al carrello acquisti, il **GridView** controllo viene aggiornato nella pagina carrello acquisti chiamando il `DataBind` metodo per il **GridView**.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-311">Once the database has been updated to reflect the updates to the shopping cart, the **GridView** control is updated on the shopping cart page by calling the `DataBind` method for the **GridView**.</span></span> <span data-ttu-id="fa3e2-312">Inoltre, la quantità totale dell'ordine della pagina carrello acquisti viene aggiornata per riflettere l'elenco aggiornato degli elementi.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-312">Also, the total order amount on the shopping cart page is updated to reflect the updated list of items.</span></span>

### <a name="updating-and-removing-shopping-cart-items"></a><span data-ttu-id="fa3e2-313">L'aggiornamento e rimozione di articoli del carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-313">Updating and Removing Shopping Cart Items</span></span>

<span data-ttu-id="fa3e2-314">Nel *ShoppingCart.aspx* pagina, è possibile visualizzare i controlli sono stati aggiunti per la quantità di un elemento di aggiornamento e rimozione di un elemento.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-314">On the *ShoppingCart.aspx* page, you can see controls have been added for updating the quantity of an item and removing an item.</span></span> <span data-ttu-id="fa3e2-315">A questo punto, aggiungere il codice che consentono a questi controlli di lavoro.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-315">Now, add the code that will make these controls work.</span></span>

1. <span data-ttu-id="fa3e2-316">In **Esplora**, aprire il *ShoppingCartActions.cs* file nel *logica* cartella.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-316">In **Solution Explorer**, open the *ShoppingCartActions.cs* file in the *Logic* folder.</span></span>
2. <span data-ttu-id="fa3e2-317">Aggiungere il seguente codice evidenziato in giallo per il *ShoppingCartActions.cs* file di classe:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-317">Add the following code highlighted in yellow to the *ShoppingCartActions.cs* class file:</span></span>   

    [!code-csharp[Main](shopping-cart/samples/sample12.cs?highlight=99-213)]

<span data-ttu-id="fa3e2-318">Il `UpdateShoppingCartDatabase` chiamato dal metodo di `UpdateCartItems` metodo sul *ShoppingCart.aspx.cs* pagina, contiene la logica per aggiornare o rimuovere gli elementi dal carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-318">The `UpdateShoppingCartDatabase` method, called from the `UpdateCartItems` method on the *ShoppingCart.aspx.cs* page, contains the logic to either update or remove items from the shopping cart.</span></span> <span data-ttu-id="fa3e2-319">Il `UpdateShoppingCartDatabase` metodo scorre tutte le righe all'interno dell'elenco di carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-319">The `UpdateShoppingCartDatabase` method iterates through all the rows within the shopping cart list.</span></span> <span data-ttu-id="fa3e2-320">Se un elemento del carrello acquisti è stato contrassegnato per essere rimosso o la quantità è inferiore a quello di `RemoveItem` metodo viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-320">If a shopping cart item has been marked to be removed, or the quantity is less than one, the `RemoveItem` method is called.</span></span> <span data-ttu-id="fa3e2-321">In caso contrario, l'elemento carrello acquisti è selezionata per gli aggiornamenti quando il `UpdateItem` metodo viene chiamato.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-321">Otherwise, the shopping cart item is checked for updates when the `UpdateItem` method is called.</span></span> <span data-ttu-id="fa3e2-322">Dopo aver rimosso l'elemento carrello acquisti o aggiornata, vengono salvate le modifiche del database.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-322">After the shopping cart item has been removed or updated, the database changes are saved.</span></span>

<span data-ttu-id="fa3e2-323">Il `ShoppingCartUpdates` struttura viene usata per contenere tutti gli elementi del carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-323">The `ShoppingCartUpdates` structure is used to hold all the shopping cart items.</span></span> <span data-ttu-id="fa3e2-324">Il `UpdateShoppingCartDatabase` metodo utilizza il `ShoppingCartUpdates` struttura per determinare se uno degli elementi devono essere aggiornato o rimosso.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-324">The `UpdateShoppingCartDatabase` method uses the `ShoppingCartUpdates` structure to determine if any of the items need to be updated or removed.</span></span>

<span data-ttu-id="fa3e2-325">Nella prossima esercitazione, si utilizzerà il `EmptyCart` metodo per cancellare il market carrello dopo l'acquisto di prodotti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-325">In the next tutorial, you will use the `EmptyCart` method to clear the shopping cart after purchasing products.</span></span> <span data-ttu-id="fa3e2-326">Ma per ora, si utilizzerà il `GetCount` metodo appena aggiunto per il *ShoppingCartActions.cs* file per determinare il numero di elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-326">But for now, you will use the `GetCount` method that you just added to the *ShoppingCartActions.cs* file to determine how many items are in the shopping cart.</span></span>

### <a name="adding-a-shopping-cart-counter"></a><span data-ttu-id="fa3e2-327">Aggiunta di un contatore di carrello acquisti</span><span class="sxs-lookup"><span data-stu-id="fa3e2-327">Adding a Shopping Cart Counter</span></span>

<span data-ttu-id="fa3e2-328">Per consentire all'utente di visualizzare il numero totale di elementi nel carrello acquisti, si aggiungerà un contatore per la *Site. master* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-328">To allow the user to view the total number of items in the shopping cart, you will add a counter to the *Site.Master* page.</span></span> <span data-ttu-id="fa3e2-329">Questo contatore fungerà anche un collegamento al carrello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-329">This counter will also act as a link to the shopping cart.</span></span>

1. <span data-ttu-id="fa3e2-330">In **Esplora**, aprire il *Site. master* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-330">In **Solution Explorer**, open the *Site.Master* page.</span></span>
2. <span data-ttu-id="fa3e2-331">Modificare il markup aggiungendo il collegamento al contatore carrello, come illustrato in giallo nella sezione di navigazione viene visualizzato come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-331">Modify the markup by adding the shopping cart counter link as shown in yellow to the navigation section so it appears as follows:</span></span>  

    [!code-html[Main](shopping-cart/samples/sample13.html?highlight=6)]
3. <span data-ttu-id="fa3e2-332">Aggiornare quindi il code-behind del *Site.Master.cs* file aggiungendo il codice evidenziato in giallo, come indicato di seguito:</span><span class="sxs-lookup"><span data-stu-id="fa3e2-332">Next, update the code-behind of the *Site.Master.cs* file by adding the code highlighted in yellow as follows:</span></span>  

    [!code-csharp[Main](shopping-cart/samples/sample14.cs?highlight=11,77-84)]

<span data-ttu-id="fa3e2-333">Prima del rendering della pagina in formato HTML, il `Page_PreRender` viene generato l'evento.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-333">Before the page is rendered as HTML, the `Page_PreRender` event is raised.</span></span> <span data-ttu-id="fa3e2-334">Nel `Page_PreRender` gestore, il conteggio totale del carrello acquisti viene determinato chiamando il `GetCount` metodo.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-334">In the `Page_PreRender` handler, the total count of the shopping cart is determined by calling the `GetCount` method.</span></span> <span data-ttu-id="fa3e2-335">Il valore restituito viene aggiunto per il `cartCount` incluso nel markup di intervallo il *Site. master* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-335">The returned value is added to the `cartCount` span included in the markup of the *Site.Master* page.</span></span> <span data-ttu-id="fa3e2-336">Il `<span>` tag consente gli elementi interni eseguire correttamente il rendering.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-336">The `<span>` tags enables the inner elements to be properly rendered.</span></span> <span data-ttu-id="fa3e2-337">Quando viene visualizzata una pagina del sito, verrà visualizzato il totale di carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-337">When any page of the site is displayed, the shopping cart total will be displayed.</span></span> <span data-ttu-id="fa3e2-338">L'utente è anche possibile scegliere il totale di carrello degli acquisti per visualizzare il carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-338">The user can also click the shopping cart total to display the shopping cart.</span></span>

## <a name="testing-the-completed-shopping-cart"></a><span data-ttu-id="fa3e2-339">Test completato carrello</span><span class="sxs-lookup"><span data-stu-id="fa3e2-339">Testing the Completed Shopping Cart</span></span>

<span data-ttu-id="fa3e2-340">È possibile eseguire l'applicazione per vedere come è possibile aggiungere, delete e update elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-340">You can run the application now to see how you can add, delete, and update items in the shopping cart.</span></span> <span data-ttu-id="fa3e2-341">Il totale di carrello acquisti rifletterà il costo totale di tutti gli elementi nel carrello acquisti.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-341">The shopping cart total will reflect the total cost of all items in the shopping cart.</span></span>

1. <span data-ttu-id="fa3e2-342">Premere **F5** per eseguire l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-342">Press **F5** to run the application.</span></span>  
 <span data-ttu-id="fa3e2-343">Il browser viene visualizzata e viene illustrato il *Default.aspx* pagina.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-343">The browser opens and shows the *Default.aspx* page.</span></span>
2. <span data-ttu-id="fa3e2-344">Selezionare **automobili** dal menu di navigazione di categoria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-344">Select **Cars** from the category navigation menu.</span></span>
3. <span data-ttu-id="fa3e2-345">Fare clic su di **Add To Cart** collegamento accanto a prima del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-345">Click the **Add To Cart** link next to the first product.</span></span>   
 <span data-ttu-id="fa3e2-346">Il *ShoppingCart.aspx* viene visualizzata la pagina con il totale dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-346">The *ShoppingCart.aspx* page is displayed with the order total.</span></span>
4. <span data-ttu-id="fa3e2-347">Selezionare **piani** dal menu di navigazione di categoria.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-347">Select **Planes** from the category navigation menu.</span></span>
5. <span data-ttu-id="fa3e2-348">Fare clic su di **Add To Cart** collegamento accanto a prima del prodotto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-348">Click the **Add To Cart** link next to the first product.</span></span>
6. <span data-ttu-id="fa3e2-349">Impostare la quantità del primo elemento nel carrello acquisti su 3 e selezionare il **Rimuovi elemento** casella di controllo del secondo elemento.<a id="a"></a></span><span class="sxs-lookup"><span data-stu-id="fa3e2-349">Set the quantity of the first item in the shopping cart to 3 and select the **Remove Item** check box of the second item.<a id="a"></a></span></span>
7. <span data-ttu-id="fa3e2-350">Fare clic su di **aggiornare** pulsante per aggiornare la pagina carrello degli acquisti e visualizzare il nuovo totale dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-350">Click the **Update** button to update the shopping cart page and display the new order total.</span></span> 

    ![Carrello acquisti - aggiornamento del carrello](shopping-cart/_static/image9.png)

## <a name="summary"></a><span data-ttu-id="fa3e2-352">Riepilogo</span><span class="sxs-lookup"><span data-stu-id="fa3e2-352">Summary</span></span>

<span data-ttu-id="fa3e2-353">In questa esercitazione è stato creato un carrello acquisti dell'applicazione di esempio Wingtip Toys Web Form.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-353">In this tutorial, you have created a shopping cart for the Wingtip Toys Web Forms sample application.</span></span> <span data-ttu-id="fa3e2-354">Durante questa esercitazione è stato utilizzato Entity Framework Code First, le annotazioni dei dati, i controlli di dati fortemente tipizzati e associazione del modello.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-354">During this tutorial you have used Entity Framework Code First, data annotations, strongly typed data controls, and model binding.</span></span>

<span data-ttu-id="fa3e2-355">Il carrello acquisti supporta l'aggiunta, eliminazione e aggiornamento degli elementi che l'utente ha selezionato per l'acquisto.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-355">The shopping cart supports adding, deleting, and updating items that the user has selected for purchase.</span></span> <span data-ttu-id="fa3e2-356">Oltre all'implementazione della funzionalità di carrello acquisti, si è appreso come visualizzare gli elementi di carrello acquisti in un **GridView** controllare e calcolare il totale dell'ordine.</span><span class="sxs-lookup"><span data-stu-id="fa3e2-356">In addition to implementing the shopping cart functionality, you have learned how to display shopping cart items in a **GridView** control and calculate the order total.</span></span>

## <a name="addition-information"></a><span data-ttu-id="fa3e2-357">Informazioni aggiuntive</span><span class="sxs-lookup"><span data-stu-id="fa3e2-357">Addition Information</span></span>

[<span data-ttu-id="fa3e2-358">Panoramica dello stato della sessione ASP.NET</span><span class="sxs-lookup"><span data-stu-id="fa3e2-358">ASP.NET Session State Overview</span></span>](https://msdn.microsoft.com/library/ms178581.aspx)

> [!div class="step-by-step"]
> <span data-ttu-id="fa3e2-359">[Precedente](display_data_items_and_details.md)
> [Successivo](checkout-and-payment-with-paypal.md)</span><span class="sxs-lookup"><span data-stu-id="fa3e2-359">[Previous](display_data_items_and_details.md)
[Next](checkout-and-payment-with-paypal.md)</span></span>

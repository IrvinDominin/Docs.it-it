---
uid: whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
title: 'Procedura: Aggiungere pagine per dispositivi mobili per il Web Form ASP.NET / applicazione MVC | Documenti Microsoft'
author: rick-anderson
description: In questa procedura vengono descritti vari modi per fornire pagine ottimizzate per i dispositivi mobili di Web Form ASP.NET / applicazione MVC e vengono suggerite alcune dell'architettura e...
ms.author: aspnetcontent
manager: wpickett
ms.date: 01/20/2011
ms.topic: article
ms.assetid: 3124f28e-cc32-418a-afe3-519fa56f4c36
ms.technology: ''
ms.prod: .net-framework
msc.legacyurl: /whitepapers/add-mobile-pages-to-your-aspnet-web-forms-mvc-application
msc.type: content
ms.openlocfilehash: a8358b91ca424f4f3e576057ab43d850081dda60
ms.sourcegitcommit: f8852267f463b62d7f975e56bea9aa3f68fbbdeb
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 04/10/2018
---
<a name="how-to-add-mobile-pages-to-your-aspnet-web-forms--mvc-application"></a><span data-ttu-id="12012-103">Procedura: Aggiungere pagine per dispositivi mobili per il Web Form ASP.NET / applicazione MVC</span><span class="sxs-lookup"><span data-stu-id="12012-103">How To: Add Mobile Pages to Your ASP.NET Web Forms / MVC Application</span></span>
====================
> <span data-ttu-id="12012-104">**Si applica a**</span><span class="sxs-lookup"><span data-stu-id="12012-104">**Applies To**</span></span>
> 
> - <span data-ttu-id="12012-105">Versione di Web Form ASP.NET 4.0</span><span class="sxs-lookup"><span data-stu-id="12012-105">ASP.NET Web Forms version 4.0</span></span>
> - <span data-ttu-id="12012-106">ASP.NET MVC versione 3.0</span><span class="sxs-lookup"><span data-stu-id="12012-106">ASP.NET MVC version 3.0</span></span>
> 
> <span data-ttu-id="12012-107">**Riepilogo**</span><span class="sxs-lookup"><span data-stu-id="12012-107">**Summary**</span></span>
> 
> <span data-ttu-id="12012-108">In questa procedura vengono descritti vari modi per fornire pagine ottimizzate per i dispositivi mobili di Web Form ASP.NET / applicazione MVC e suggerisce dell'architettura e problemi da prendere in considerazione quando la destinazione di un'ampia gamma di dispositivi di progettazione.</span><span class="sxs-lookup"><span data-stu-id="12012-108">This How To describes various ways to serve pages optimized for mobile devices from your ASP.NET Web Forms / MVC application, and suggests architectural and design issues to consider when targeting a broad range of devices.</span></span> <span data-ttu-id="12012-109">Questo documento illustra anche i controlli di ASP.NET Mobile da ASP.NET 2.0 a 3.5 perché sono ora obsoleti e vengono illustrate alcune alternative moderne.</span><span class="sxs-lookup"><span data-stu-id="12012-109">This document also explains why the ASP.NET Mobile Controls from ASP.NET 2.0 to 3.5 are now obsolete, and discusses some modern alternatives.</span></span>


## <a name="contents"></a><span data-ttu-id="12012-110">Sommario</span><span class="sxs-lookup"><span data-stu-id="12012-110">Contents</span></span>

- <span data-ttu-id="12012-111">Panoramica</span><span class="sxs-lookup"><span data-stu-id="12012-111">Overview</span></span>
- <span data-ttu-id="12012-112">Opzioni dell'architettura</span><span class="sxs-lookup"><span data-stu-id="12012-112">Architectural options</span></span>
- <span data-ttu-id="12012-113">Rilevamento di browser e dispositivi</span><span class="sxs-lookup"><span data-stu-id="12012-113">Browser and device detection</span></span>
- <span data-ttu-id="12012-114">Come le applicazioni Web Form ASP.NET possono presentare pagine specifiche di dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-114">How ASP.NET Web Forms applications can present mobile-specific pages</span></span>
- <span data-ttu-id="12012-115">Come le applicazioni ASP.NET MVC possono presentare pagine specifiche di dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-115">How ASP.NET MVC applications can present mobile-specific pages</span></span>
- <span data-ttu-id="12012-116">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="12012-116">Additional resources</span></span>

<span data-ttu-id="12012-117">Per esempi di codice scaricabile che illustra le tecniche di questo white paper per Web Form ASP.NET e MVC, vedere [App per dispositivi mobili e i siti con ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="12012-117">For downloadable code samples demonstrating this white paper's techniques for both ASP.NET Web Forms and MVC, see [Mobile Apps & Sites with ASP.NET](https://docs.microsoft.com/aspnet/mobile/overview).</span></span>

## <a name="overview"></a><span data-ttu-id="12012-118">Panoramica</span><span class="sxs-lookup"><span data-stu-id="12012-118">Overview</span></span>

<span data-ttu-id="12012-119">I dispositivi mobili: Smartphone, funzionalità telefoni e Tablet: continuano a crescere in popolarità come mezzo per accedere al Web.</span><span class="sxs-lookup"><span data-stu-id="12012-119">Mobile devices – smartphones, feature phones, and tablets – continue to grow in popularity as a means to access the Web.</span></span> <span data-ttu-id="12012-120">Per molti sviluppatori web e alle aziende orientata ai servizi web, questo significa che è sempre più importante fornire un'esperienza di esplorazione ottimale per i visitatori che utilizzano tali dispositivi.</span><span class="sxs-lookup"><span data-stu-id="12012-120">For many web developers and web-oriented businesses, this means it's increasingly important to provide a great browsing experience for visitors using those devices.</span></span>

### <a name="how-earlier-versions-of-aspnet-supported-mobile-browsers"></a><span data-ttu-id="12012-121">La modalità più versioni di browser per dispositivi mobili ASP.NET supportata</span><span class="sxs-lookup"><span data-stu-id="12012-121">How earlier versions of ASP.NET supported mobile browsers</span></span>

<span data-ttu-id="12012-122">Versioni di ASP.NET 2.0 a 3.5 incluso *controlli per dispositivi mobili ASP.NET*: un set di controlli server per i dispositivi mobili nel *System.Web.Mobile.dll* assembly e  *MobileControls* dello spazio dei nomi.</span><span class="sxs-lookup"><span data-stu-id="12012-122">ASP.NET versions 2.0 to 3.5 included *ASP.NET Mobile Controls*: a set of server controls for mobile devices in the *System.Web.Mobile.dll* assembly and the *System.Web.UI.MobileControls* namespace.</span></span> <span data-ttu-id="12012-123">L'assembly è ancora inclusa in ASP.NET 4, ma è deprecato.</span><span class="sxs-lookup"><span data-stu-id="12012-123">The assembly is still included in ASP.NET 4, but it is deprecated.</span></span> <span data-ttu-id="12012-124">Gli sviluppatori sono invitati a eseguire la migrazione a più moderni approcci, ad esempio quelli descritti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="12012-124">Developers are advised to migrate to more modern approaches, such as those described in this paper.</span></span>

<span data-ttu-id="12012-125">Il motivo per cui controlli per dispositivi mobili ASP.NET sono stati contrassegnati come obsolete è che la struttura è orientata telefoni cellulari comuni intorno 2005 e versioni precedenti.</span><span class="sxs-lookup"><span data-stu-id="12012-125">The reason why ASP.NET Mobile Controls have been marked as obsolete is that their design is oriented around the mobile phones that were common around 2005 and earlier.</span></span> <span data-ttu-id="12012-126">I controlli sono progettati principalmente per il rendering del markup WML o cHTML (anziché regolare HTML) per i browser WAP che era.</span><span class="sxs-lookup"><span data-stu-id="12012-126">The controls are mainly designed to render WML or cHTML markup (instead of regular HTML) for the WAP browsers of that era.</span></span> <span data-ttu-id="12012-127">Ma WAP, gli elementi WML e cHTML non sono più rilevanti per la maggior parte dei progetti, in quanto HTML è diventato il linguaggio di markup universale per dispositivi mobili e desktop browser simili.</span><span class="sxs-lookup"><span data-stu-id="12012-127">But WAP, WML, and cHTML are no longer relevant for most projects, because HTML has now become the ubiquitous markup language for mobile and desktop browsers alike.</span></span>

### <a name="the-challenges-of-supporting-mobile-devices-today"></a><span data-ttu-id="12012-128">I problemi di supportare i dispositivi mobili a oggi</span><span class="sxs-lookup"><span data-stu-id="12012-128">The challenges of supporting mobile devices today</span></span>

<span data-ttu-id="12012-129">Anche se i browser per dispositivi mobili supportano ora universalmente HTML, si dovranno affrontare comunque numerose problematiche, al fine di creare esperienze di esplorazione per dispositivi mobili:</span><span class="sxs-lookup"><span data-stu-id="12012-129">Even though mobile browsers now almost universally support HTML, you will still face many challenges when aiming to create great mobile browsing experiences:</span></span>

- <span data-ttu-id="12012-130">***Dimensione dello schermo*** : i dispositivi mobili variano notevolmente in form e gli schermi sono in genere molto inferiori rispetto a quella dei desktop.</span><span class="sxs-lookup"><span data-stu-id="12012-130">***Screen size*** - Mobile devices vary dramatically in form, and their screens are often much smaller than desktop monitors.</span></span> <span data-ttu-id="12012-131">In tal caso, potrebbe essere necessario progettare il layout di pagina completamente diversa per loro.</span><span class="sxs-lookup"><span data-stu-id="12012-131">So, you may need to design completely different page layouts for them.</span></span>
- <span data-ttu-id="12012-132">***Metodi di input*** – alcuni dispositivi dispongono di tastiere, alcuni degli stili del, mentre altri usano tocco.</span><span class="sxs-lookup"><span data-stu-id="12012-132">***Input methods*** – Some devices have keypads, some have styluses, others use touch.</span></span> <span data-ttu-id="12012-133">Potrebbe essere necessario prendere in considerazione la navigazione più dati e i meccanismi di metodi di input.</span><span class="sxs-lookup"><span data-stu-id="12012-133">You may need to consider multiple navigation mechanisms and data input methods.</span></span>
- <span data-ttu-id="12012-134">***Conformità agli standard*** – molti browser per dispositivi mobili non supportano gli standard più recenti di HTML, CSS o JavaScript.</span><span class="sxs-lookup"><span data-stu-id="12012-134">***Standards compliance*** – Many mobile browsers do not support the latest HTML, CSS, or JavaScript standards.</span></span>
- <span data-ttu-id="12012-135">***Larghezza di banda*** : variano notevolmente le prestazioni della rete dati del cellulare e alcuni utenti finali non sono in tariffe che applicano un addebito per il megabyte.</span><span class="sxs-lookup"><span data-stu-id="12012-135">***Bandwidth*** – Cellular data network performance varies wildly, and some end users are on tariffs that charge by the megabyte.</span></span>

<span data-ttu-id="12012-136">Non c'è alcuna soluzione giusto; l'applicazione sarà necessario esaminare e un comportamento diverso a seconda del dispositivo di accedervi.</span><span class="sxs-lookup"><span data-stu-id="12012-136">There's no one-size-fits-all solution; your application will have to look and behave differently according to the device accessing it.</span></span> <span data-ttu-id="12012-137">In base alla quale livello di supporto mobile desiderata, può trattarsi di una richiesta per gli sviluppatori web maggiore rispetto a quanto desktop "attraverso browser" mai.</span><span class="sxs-lookup"><span data-stu-id="12012-137">Depending on what level of mobile support you want, this can be a bigger challenge for web developers than the desktop "browser wars" ever was.</span></span>

<span data-ttu-id="12012-138">Gli sviluppatori per raggiungere il supporto browser per dispositivi mobili per la prima volta spesso inizialmente considerare che solo è importante supportare le più recenti e più sofisticati Smartphone (ad esempio, Windows Phone 7, iPhone o Android), probabilmente perché gli sviluppatori proprietaria spesso personalmente, ad dispositivi.</span><span class="sxs-lookup"><span data-stu-id="12012-138">Developers approaching mobile browser support for the first time often initially think it's only important to support the latest and most sophisticated smartphones (e.g., Windows Phone 7, iPhone, or Android), perhaps because developers often personally own such devices.</span></span> <span data-ttu-id="12012-139">Tuttavia, telefoni più economici sono comunque molto comuni e proprietari usarli per navigare in rete, in particolare nei paesi in cui sono semplici ottenere una connessione a banda larga telefoni cellulari.</span><span class="sxs-lookup"><span data-stu-id="12012-139">However, cheaper phones are still extremely popular, and their owners do use them to browse the web – especially in countries where mobile phones are easier to get than a broadband connection.</span></span> <span data-ttu-id="12012-140">L'azienda sarà necessario decidere quali gamma di dispositivi per supportare considerando i clienti di probabilità.</span><span class="sxs-lookup"><span data-stu-id="12012-140">Your business will need to decide what range of devices to support by considering its likely customers.</span></span> <span data-ttu-id="12012-141">Se si sta creando un brochure online per l'autenticazione spa integrità un lusso, si potrebbero prendere decisioni aziendali solo di destinazione avanzati Smartphone, mentre se si sta creando un sistema di prenotazione di ticket di cinema, è probabilmente necessario tenere conto per i visitatori con meno potenti funzionalità telefoni.</span><span class="sxs-lookup"><span data-stu-id="12012-141">If you're building an online brochure for a luxury health spa, you might make a business decision only to target advanced smartphones, whereas if you're creating a ticket booking system for a cinema, you probably need to account for visitors with less powerful feature phones.</span></span>

## <a name="architectural-options"></a><span data-ttu-id="12012-142">Opzioni dell'architettura</span><span class="sxs-lookup"><span data-stu-id="12012-142">Architectural options</span></span>

<span data-ttu-id="12012-143">Prima di passare ai dettagli tecnici specifici di MVC o Web Form ASP.NET, si noti che gli sviluppatori web sono in genere tre principali opzioni possibili per il supporto browser per dispositivi mobili:</span><span class="sxs-lookup"><span data-stu-id="12012-143">Before we get to the specific technical details of ASP.NET Web Forms or MVC, note that web developers in general have three main possible options for supporting mobile browsers:</span></span>

1. <span data-ttu-id="12012-144">***Non eseguire alcuna operazione –*** è semplicemente possibile creare un'applicazione web standard, orientato ai desktop e si basano su browser per dispositivi mobili per eseguire il rendering accettabile.</span><span class="sxs-lookup"><span data-stu-id="12012-144">***Do nothing –*** You can simply create a standard, desktop-oriented web application, and rely on mobile browsers to render it acceptably.</span></span> 

    - <span data-ttu-id="12012-145">**Vantaggio**: è l'opzione più economica da implementare e mantenere, non un ulteriore lavoro</span><span class="sxs-lookup"><span data-stu-id="12012-145">**Advantage**: It's the cheapest option to implement and maintain – no extra work</span></span>
    - <span data-ttu-id="12012-146">**Svantaggio**: fornisce l'esperienza dell'utente finale peggiore:</span><span class="sxs-lookup"><span data-stu-id="12012-146">**Disadvantage**: Gives the worst end-user experience:</span></span> 

        - <span data-ttu-id="12012-147">I più recenti Smartphone possono eseguire il rendering HTML così come un browser per desktop, ma gli utenti saranno costretti ancora per ingrandire e scorrere orizzontalmente e verticalmente per utilizzare il contenuto su schermi di piccole dimensioni.</span><span class="sxs-lookup"><span data-stu-id="12012-147">The latest smartphones may render your HTML just as well as a desktop browser, but users will still be forced to zoom and scroll horizontally and vertically to consume your content on a small screen.</span></span> <span data-ttu-id="12012-148">Questo è lontano dal ottimale.</span><span class="sxs-lookup"><span data-stu-id="12012-148">This is far from optimal.</span></span>
        - <span data-ttu-id="12012-149">Dispositivi meno recenti e i telefoni funzionalità potrebbero non riuscire a eseguire il rendering di markup in modo soddisfacente.</span><span class="sxs-lookup"><span data-stu-id="12012-149">Older devices and feature phones may fail to render your markup in a satisfactory way.</span></span>
        - <span data-ttu-id="12012-150">Anche in dispositivi tablet più recenti (il cui schermate possono essere grandi come schermi di computer portatili), si applicano le regole di interazione tra diversi.</span><span class="sxs-lookup"><span data-stu-id="12012-150">Even on the latest tablet devices (whose screens can be as big as laptop screens), different interaction rules apply.</span></span> <span data-ttu-id="12012-151">Input basato sul tocco funziona meglio con i pulsanti di dimensioni maggiori e collega spread ulteriormente separati e non vi è alcun modo per passare un puntatore del mouse su un menu a comparsa.</span><span class="sxs-lookup"><span data-stu-id="12012-151">Touch-based input works best with larger buttons and links spread further apart, and there's no way to hover a mouse cursor over a fly-out menu.</span></span>
2. <span data-ttu-id="12012-152">***Risolvere il problema sul client* –** con un'attenta utilizzo di CSS e [progressivo miglioramento](http://en.wikipedia.org/wiki/Progressive_enhancement) è possibile creare markup, stili e script che si adattano a qualsiasi browser li esegue.</span><span class="sxs-lookup"><span data-stu-id="12012-152">***Solve the problem on the client* –** With careful use of CSS and [progressive enhancement](http://en.wikipedia.org/wiki/Progressive_enhancement) you can create markup, styles, and scripts that adapt to whatever browser is running them.</span></span> <span data-ttu-id="12012-153">Ad esempio, con [query di supporto di CSS 3](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), è possibile creare un layout a più colonne che trasforma in un layout a colonna singola su dispositivi la cui schermate sono più ristretta rispetto a una soglia specifica.</span><span class="sxs-lookup"><span data-stu-id="12012-153">For example, with [CSS 3 media queries](http://www.w3.org/TR/2010/CR-css3-mediaqueries-20100727/), you could create a multi-column layout that turns into a single column layout on devices whose screens are narrower than a chosen threshold.</span></span> 

    - <span data-ttu-id="12012-154">**Vantaggio**: consente di ottimizzare il rendering per il dispositivo specifico in uso, anche per i dispositivi futuri sconosciuti in base a qualsiasi schermata e le caratteristiche di input hanno</span><span class="sxs-lookup"><span data-stu-id="12012-154">**Advantage**: Optimizes rendering for the specific device in use, even for unknown future devices according to whatever screen and input characteristics they have</span></span>
    - <span data-ttu-id="12012-155">**Vantaggio**: facilmente consente di condividere logica sul lato server in tutti i tipi di dispositivo, la duplicazione minima di codice o il lavoro richiesto</span><span class="sxs-lookup"><span data-stu-id="12012-155">**Advantage**: Easily lets you share server-side logic across all device types – minimal duplication of code or effort</span></span>
    - <span data-ttu-id="12012-156">**Svantaggio**: i dispositivi mobili sono talmente diversi dai dispositivi desktop che è effettivamente possibile pagine per dispositivi mobili può essere completamente diverso dalle pagine desktop, che mostra informazioni diverse.</span><span class="sxs-lookup"><span data-stu-id="12012-156">**Disadvantage**: Mobile devices are so different from desktop devices that you may really want your mobile pages to be completely different from your desktop pages, showing different information.</span></span> <span data-ttu-id="12012-157">Le variazioni possono risultare inefficiente o impossibili da soddisfare in modo affidabile tramite CSS da solo, specie se si considera come incoerente dispositivi meno recenti interpretano le regole CSS.</span><span class="sxs-lookup"><span data-stu-id="12012-157">Such variations can be inefficient or impossible to achieve robustly through CSS alone, especially considering how inconsistently older devices interpret CSS rules.</span></span> <span data-ttu-id="12012-158">Questo vale in particolare degli attributi di CSS 3.</span><span class="sxs-lookup"><span data-stu-id="12012-158">This is particularly true of CSS 3 attributes.</span></span>
    - <span data-ttu-id="12012-159">**Svantaggio**: non fornisce supporto per diversa logica sul lato server e i flussi di lavoro per dispositivi diversi.</span><span class="sxs-lookup"><span data-stu-id="12012-159">**Disadvantage**: Provides no support for varying server-side logic and workflows for different devices.</span></span> <span data-ttu-id="12012-160">Mezzo CSS da solo non è possibile, ad esempio, implementare un workflow estrazione carrello acquisti semplificato per gli utenti mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-160">You can't, for example, implement a simplified shopping cart checkout workflow for mobile users by means of CSS alone.</span></span>
    - <span data-ttu-id="12012-161">**Svantaggio**: uso non efficiente della larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="12012-161">**Disadvantage**: Inefficient bandwidth use.</span></span> <span data-ttu-id="12012-162">Il server potrebbe essere necessario trasmettere il markup e stili che si applicano a tutti i dispositivi possibili, anche se il dispositivo di destinazione verrà utilizzato solo un subset di informazioni.</span><span class="sxs-lookup"><span data-stu-id="12012-162">You server may have to transmit the markup and styles that apply to all possible devices, even though the target device will only use a subset of that information.</span></span>
3. <span data-ttu-id="12012-163">***Risolvere il problema nel server* –** se il server sa quale dispositivo accede a tale colonna – o meno le caratteristiche del dispositivo, ad esempio le dimensioni dello schermo e il metodo di input, e se si tratta di un dispositivo mobile può essere eseguito una logica diversa e markup HTML diverso di output.</span><span class="sxs-lookup"><span data-stu-id="12012-163">***Solve the problem on the server* –** If your server knows what device is accessing it – or at least the characteristics of that device, such as its screen size and input method, and whether it's a mobile device – it can run different logic and output different HTML markup.</span></span> 

    - <span data-ttu-id="12012-164">**Vantaggio:** flessibilità massima.</span><span class="sxs-lookup"><span data-stu-id="12012-164">**Advantage:** Maximum flexibility.</span></span> <span data-ttu-id="12012-165">Non è previsto alcun limite per quanto è possibile variare la logica sul lato server per dispositivi mobili o ottimizzare il markup per il layout desiderato, specifico del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-165">There's no limit to how much you can vary your server-side logic for mobiles or optimize your markup for the desired, device-specific layout.</span></span>
    - <span data-ttu-id="12012-166">**Vantaggio:** utilizzo efficiente della larghezza di banda.</span><span class="sxs-lookup"><span data-stu-id="12012-166">**Advantage:** Efficient bandwidth use.</span></span> <span data-ttu-id="12012-167">È necessario solo trasmettere il markup e informazioni sugli stili che il dispositivo di destinazione che verrà utilizzata.</span><span class="sxs-lookup"><span data-stu-id="12012-167">You only need to transmit the markup and styling information that the target device is going to use.</span></span>
    - <span data-ttu-id="12012-168">**Svantaggi:** volte forza la ripetizione del lavoro richiesto o del codice (ad esempio, rendendo si creare copie simili, ma leggermente diverse del pagine Web Form o le visualizzazioni MVC).</span><span class="sxs-lookup"><span data-stu-id="12012-168">**Disadvantage:** Sometimes forces repetition of effort or code (e.g., making you create similar but slightly different copies of your Web Forms pages or MVC views).</span></span> <span data-ttu-id="12012-169">Dove possibile, che verrà basta fattorizzare logica comune in un livello sottostante o il servizio, ma comunque alcune parti del markup o codice dell'interfaccia utente potrebbe essere necessario duplicato e quindi gestiti in parallelo.</span><span class="sxs-lookup"><span data-stu-id="12012-169">Where possible you will factor out common logic into an underlying layer or service, but still, some parts of your UI code or markup may have to be duplicated and then maintained in parallel.</span></span>
    - <span data-ttu-id="12012-170">**Svantaggi:** il rilevamento dei dispositivi non è semplice.</span><span class="sxs-lookup"><span data-stu-id="12012-170">**Disadvantage:** Device detection is not trivial.</span></span> <span data-ttu-id="12012-171">Richiede un elenco o un database di tipi di dispositivi noti e le relative caratteristiche (che potrebbero non essere sempre aggiornati perfettamente) e non sempre corrispondono in modo accurato di ogni richiesta in ingresso.</span><span class="sxs-lookup"><span data-stu-id="12012-171">It requires a list or database of known device types and their characteristics (which may not always be perfectly up-to-date) and isn't guaranteed to accurately match every incoming request.</span></span> <span data-ttu-id="12012-172">Questo documento descrive alcune opzioni e i relativi problemi in un secondo momento.</span><span class="sxs-lookup"><span data-stu-id="12012-172">This document describes some options and their pitfalls later.</span></span>

<span data-ttu-id="12012-173">Per ottenere i migliori risultati, la maggior parte degli sviluppatori trovano che devono combinare opzioni (2) e (3).</span><span class="sxs-lookup"><span data-stu-id="12012-173">To get the best results, most developers find they need to combine options (2) and (3).</span></span> <span data-ttu-id="12012-174">Commento differenze sono più indicate sul client utilizzando CSS o JavaScript anche, mentre le differenze principali nel markup, del flusso di lavoro o dati vengono implementate in modo più efficiente in codice lato server.</span><span class="sxs-lookup"><span data-stu-id="12012-174">Minor stylistic differences are best accommodated on the client using CSS or even JavaScript, whereas major differences in data, workflow, or markup are most effectively implemented in server-side code.</span></span>

### <a name="this-paper-focuses-on-server-side-techniques"></a><span data-ttu-id="12012-175">Questo documento vengono descritte le tecniche sul lato server</span><span class="sxs-lookup"><span data-stu-id="12012-175">This paper focuses on server-side techniques</span></span>

<span data-ttu-id="12012-176">Poiché MVC e Web Form ASP.NET sono entrambe le tecnologie principalmente sul lato server, in questo white paper sarà incentrata sui tecniche sul lato server che consentono di produrre codice diverso e la logica per browser per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-176">Since ASP.NET Web Forms and MVC are both primarily server-side technologies, this white paper will focus on server-side techniques that let you produce different markup and logic for mobile browsers.</span></span> <span data-ttu-id="12012-177">Naturalmente, è anche possibile combinare questa con qualsiasi tecnica sul lato client (ad esempio, CSS 3 supporti le query, JavaScript progressivo miglioramento), ma è più una questione di progettazione web di sviluppo ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12012-177">Of course, you can also combine this with any client-side technique (e.g., CSS 3 media queries, progressive-enhancement JavaScript), but that's more a matter of web design than ASP.NET development.</span></span>

## <a name="browser-and-device-detection"></a><span data-ttu-id="12012-178">Rilevamento di browser e dispositivi</span><span class="sxs-lookup"><span data-stu-id="12012-178">Browser and device detection</span></span>

<span data-ttu-id="12012-179">Il prerequisito di chiave per tutte le tecniche sul lato server per supportare i dispositivi mobili è sapere quale dispositivo utilizza il visitatore.</span><span class="sxs-lookup"><span data-stu-id="12012-179">The key prerequisite for all server-side techniques for supporting mobile devices is to know what device your visitor is using.</span></span> <span data-ttu-id="12012-180">Infatti, ancora migliore conoscere il numero di produttore e modello del dispositivo è conoscere il *caratteristiche* del dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-180">In fact, even better than knowing the manufacturer and model number of that device is knowing the *characteristics* of the device.</span></span> <span data-ttu-id="12012-181">Caratteristiche possono includere:</span><span class="sxs-lookup"><span data-stu-id="12012-181">Characteristics may include:</span></span>

- <span data-ttu-id="12012-182">Si tratta di un dispositivo mobile?</span><span class="sxs-lookup"><span data-stu-id="12012-182">Is it a mobile device?</span></span>
- <span data-ttu-id="12012-183">Metodo di input (mouse o tastiera, tocco, tastierino, joystick,...)</span><span class="sxs-lookup"><span data-stu-id="12012-183">Input method (mouse/keyboard, touch, keypad, joystick, …)</span></span>
- <span data-ttu-id="12012-184">La dimensione dello schermo (fisicamente e, in pixel)</span><span class="sxs-lookup"><span data-stu-id="12012-184">Screen size (physically and in pixels)</span></span>
- <span data-ttu-id="12012-185">Formati di dati e i supporti supportati</span><span class="sxs-lookup"><span data-stu-id="12012-185">Supported media and data formats</span></span>
- <span data-ttu-id="12012-186">E così via.</span><span class="sxs-lookup"><span data-stu-id="12012-186">Etc.</span></span>

<span data-ttu-id="12012-187">Si consiglia di prendere decisioni in base alle caratteristiche del numero di modello, in quanto, quindi è in grado di gestire dispositivi futuri.</span><span class="sxs-lookup"><span data-stu-id="12012-187">It's better to make decisions based on characteristics than model number, because then you'll be better equipped to handle future devices.</span></span>

### <a name="using-aspnets-built-in-browser-detection-support"></a><span data-ttu-id="12012-188">Utilizzo di ASP. Supporto per il rilevamento di rete browser predefinito</span><span class="sxs-lookup"><span data-stu-id="12012-188">Using ASP.NET's built-in browser detection support</span></span>

<span data-ttu-id="12012-189">Gli sviluppatori di Web Form ASP.NET e MVC possono individuare immediatamente importanti caratteristiche di un controllo browser controllando le proprietà del *Request* oggetto.</span><span class="sxs-lookup"><span data-stu-id="12012-189">ASP.NET Web Forms and MVC developers can immediately discover important characteristics of a visiting browser by inspecting properties of the *Request.Browser* object.</span></span> <span data-ttu-id="12012-190">Ad esempio, vedere</span><span class="sxs-lookup"><span data-stu-id="12012-190">For example, see</span></span>

- <span data-ttu-id="12012-191">Request.Browser.IsMobileDevice</span><span class="sxs-lookup"><span data-stu-id="12012-191">Request.Browser.IsMobileDevice</span></span>
- <span data-ttu-id="12012-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span><span class="sxs-lookup"><span data-stu-id="12012-192">Request.Browser.MobileDeviceManufacturer, Request.Browser.MobileDeviceModel</span></span>
- <span data-ttu-id="12012-193">Request.Browser.ScreenPixelsWidth</span><span class="sxs-lookup"><span data-stu-id="12012-193">Request.Browser.ScreenPixelsWidth</span></span>
- <span data-ttu-id="12012-194">Request.Browser.SupportsXmlHttp</span><span class="sxs-lookup"><span data-stu-id="12012-194">Request.Browser.SupportsXmlHttp</span></span>
- <span data-ttu-id="12012-195">... e molti altri</span><span class="sxs-lookup"><span data-stu-id="12012-195">…and many others</span></span>

<span data-ttu-id="12012-196">Dietro le quinte, la piattaforma di ASP.NET corrisponde in ingresso *User-Agent* intestazione HTTP (agente utente) con le espressioni regolari in un set di file XML di definizione del Browser.</span><span class="sxs-lookup"><span data-stu-id="12012-196">Behind the scenes, the ASP.NET platform matches the incoming *User-Agent* (UA) HTTP header against regular expressions in a set of Browser Definition XML files.</span></span> <span data-ttu-id="12012-197">È possibile aggiungere file di definizione del Browser personalizzati ad altri utenti che si desidera riconoscere per impostazione predefinita la piattaforma include le definizioni per molti dispositivi mobili comuni.</span><span class="sxs-lookup"><span data-stu-id="12012-197">By default the platform includes definitions for many common mobile devices, and you can add custom Browser Definition files for others you wish to recognize.</span></span> <span data-ttu-id="12012-198">Per ulteriori informazioni, vedere la pagina MSDN [controlli Server Web ASP.NET e le funzionalità del Browser](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span><span class="sxs-lookup"><span data-stu-id="12012-198">For more details, see the MSDN page [ASP.NET Web Server Controls and Browser Capabilities](https://msdn.microsoft.com/library/x3k2ssx2.aspx).</span></span>

### <a name="using-the-wurfl-device-database-via-51degreesmobi-foundation"></a><span data-ttu-id="12012-199">Usando il database di dispositivo WURFL tramite 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="12012-199">Using the WURFL device database via 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="12012-200">Mentre ASP. Supporto per il rilevamento di rete browser predefiniti saranno sufficiente per molte applicazioni, esistono due casi principali quando potrebbe non essere sufficiente:</span><span class="sxs-lookup"><span data-stu-id="12012-200">While ASP.NET's built-in browser detection support will be sufficient for many applications, there are two main cases when it might not be enough:</span></span>

- <span data-ttu-id="12012-201">***Per riconoscere i dispositivi più recenti***(senza creare manualmente i file di definizione del Browser per essi).</span><span class="sxs-lookup"><span data-stu-id="12012-201">***You want to recognize the latest devices***(without manually creating Browser Definition files for them).</span></span> <span data-ttu-id="12012-202">Si noti che i file di definizione del Browser .NET 4 non sono abbastanza recenti per riconoscere Apple iPad, telefoni Android, il browser Opera Mobile o Windows Phone 7.</span><span class="sxs-lookup"><span data-stu-id="12012-202">Note that .NET 4's Browser Definition files are not recent enough to recognize Windows Phone 7, Android phones, Opera Mobile browsers, or Apple iPads.</span></span>
- <span data-ttu-id="12012-203">***Sono necessarie informazioni più dettagliate sulle funzionalità del dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="12012-203">***You need more detailed information about device capabilities***.</span></span> <span data-ttu-id="12012-204">Potrebbe essere necessario conoscere il metodo di input di un dispositivo (ad esempio, tastierino vs tocco) o quali audio formati il browser supporta.</span><span class="sxs-lookup"><span data-stu-id="12012-204">You may need to know about a device's input method (e.g., touch vs keypad), or what audio formats the browser supports.</span></span> <span data-ttu-id="12012-205">Queste informazioni non sono disponibile nei file di definizione del Browser standard.</span><span class="sxs-lookup"><span data-stu-id="12012-205">This information isn't available in the standard Browser Definition files.</span></span>

<span data-ttu-id="12012-206">Il [ *File di risorsa universale Wireless* progetto (WURFL)](http://wurfl.sourceforge.net/) gestisce più aggiornate e dettagliate informazioni sui dispositivi mobili in uso oggi.</span><span class="sxs-lookup"><span data-stu-id="12012-206">The [*Wireless Universal Resource File* (WURFL) project](http://wurfl.sourceforge.net/) maintains much more up-to-date and detailed information about mobile devices in use today.</span></span>

<span data-ttu-id="12012-207">Le novità per gli sviluppatori di .NET è che ASP. Funzionalità di rilevamento del browser di rete è estensibile, pertanto è possibile migliorare in modo da risolvere tali problemi.</span><span class="sxs-lookup"><span data-stu-id="12012-207">The great news for .NET developers is that ASP.NET's browser detection feature is extensible, so it's possible to enhance it to overcome these problems.</span></span> <span data-ttu-id="12012-208">Ad esempio, è possibile aggiungere open source [ *51Degrees.mobi Foundation* ](https://github.com/51Degrees/dotNET-Device-Detection) libreria al progetto.</span><span class="sxs-lookup"><span data-stu-id="12012-208">For example, you can add the open source [*51Degrees.mobi Foundation*](https://github.com/51Degrees/dotNET-Device-Detection) library to your project.</span></span> <span data-ttu-id="12012-209">È un IHttpModule ASP.NET o un Browser funzionalità Provider (utilizzabile in applicazioni di Web Form e MVC), che legge i dati WURFL direttamente e lo collega in ASP. Meccanismo di rilevamento di rete browser predefinito.</span><span class="sxs-lookup"><span data-stu-id="12012-209">It's an ASP.NET IHttpModule or Browser Capabilities Provider (usable on both Web Forms and MVC applications), that directly reads WURFL data and hooks it into ASP.NET's built-in browser detection mechanism.</span></span> <span data-ttu-id="12012-210">Dopo aver installato il modulo, *Request* improvvisamente conterrà informazioni molto più precise e dettagliate: verrà correttamente riconoscere molti dei dispositivi indicati in precedenza e le funzionalità (ad esempio elenco funzionalità aggiuntive come metodo di input).</span><span class="sxs-lookup"><span data-stu-id="12012-210">Once you've installed the module, *Request.Browser* will suddenly contain a lot more accurate and detailed information: it will correctly recognize many of the devices previously mentioned and list their capabilities (including additional capabilities such as input method).</span></span> <span data-ttu-id="12012-211">Vedere la documentazione del progetto per maggiori dettagli.</span><span class="sxs-lookup"><span data-stu-id="12012-211">See the project's documentation for more details.</span></span>

## <a name="how-web-forms-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="12012-212">Come le applicazioni Web Form possono presentare pagine specifiche di dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-212">How Web Forms applications can present mobile-specific pages</span></span>

<span data-ttu-id="12012-213">Per impostazione predefinita, ecco come una nuova applicazione Web Form viene visualizzata nei dispositivi mobili comuni:</span><span class="sxs-lookup"><span data-stu-id="12012-213">By default, here's how a brand new Web Forms application displays on common mobile devices:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image1.png)

<span data-ttu-id="12012-214">Chiaramente, né layout appaia molto mobile-friendly: questa pagina è stata progettata per un monitor di grandi dimensioni, con orientamento orizzontale, non per schermi di piccole dimensioni orientamento verticale.</span><span class="sxs-lookup"><span data-stu-id="12012-214">Clearly, neither layout looks very mobile-friendly – this page was designed for a large, landscape-oriented monitor, not for a small portrait-oriented screen.</span></span> <span data-ttu-id="12012-215">Pertanto, operazioni su di esso?</span><span class="sxs-lookup"><span data-stu-id="12012-215">So what can you do about it?</span></span>

<span data-ttu-id="12012-216">Come descritto in precedenza in questo documento, sono disponibili vari modi per personalizzare le pagine per i dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-216">As discussed earlier in this paper, there are many ways to tailor your pages for mobile devices.</span></span> <span data-ttu-id="12012-217">Alcune tecniche sono basate su server, altri vengono eseguiti nel client.</span><span class="sxs-lookup"><span data-stu-id="12012-217">Some techniques are server-based, others run on the client.</span></span>

### <a name="creating-a-mobile-specific-master-page"></a><span data-ttu-id="12012-218">Creazione di una pagina master specifici dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-218">Creating a mobile-specific master page</span></span>

<span data-ttu-id="12012-219">A seconda dei requisiti, è possibile usare la stessa di Web Form per tutti i visitatori, ma disporre di due pagine master distinte: uno per i visitatori del desktop, un altro per i visitatori per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-219">Depending on your requirements, you may be able to use the same Web Forms for all visitors, but have two separate master pages: one for desktop visitors, another for mobile visitors.</span></span> <span data-ttu-id="12012-220">Questo offre la flessibilità della modifica del foglio di stile CSS o nel markup HTML di primo livello in base alle esigenze di dispositivi mobili, evitando di duplicare qualsiasi logica di pagina.</span><span class="sxs-lookup"><span data-stu-id="12012-220">This gives you the flexibility of changing the CSS stylesheet or your top-level HTML markup to suit mobile devices, without forcing you to duplicate any page logic.</span></span>

<span data-ttu-id="12012-221">Si tratta di un'operazione semplice.</span><span class="sxs-lookup"><span data-stu-id="12012-221">This is easy to do.</span></span> <span data-ttu-id="12012-222">Ad esempio, è possibile aggiungere un gestore PreInit come illustrato di seguito a un Web Form:</span><span class="sxs-lookup"><span data-stu-id="12012-222">For example, you can add a PreInit handler such as the following to a Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample1.cs)]

<span data-ttu-id="12012-223">A questo punto, creare una pagina master denominata Mobile.Master nella cartella principale dell'applicazione e verrà utilizzato quando viene rilevato un dispositivo mobile.</span><span class="sxs-lookup"><span data-stu-id="12012-223">Now, create a master page called Mobile.Master in the top-level folder of your application, and it will be used when a mobile device is detected.</span></span> <span data-ttu-id="12012-224">Pagina master per dispositivi mobili può fare riferimento a un foglio di stile CSS specifiche mobile se necessario.</span><span class="sxs-lookup"><span data-stu-id="12012-224">Your mobile master page can reference a mobile-specific CSS stylesheet if necessary.</span></span> <span data-ttu-id="12012-225">Visitatori desktop continueranno a vedere la pagina master predefinita, non a quello per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-225">Desktop visitors will still see your default master page, not the mobile one.</span></span>

### <a name="creating-independent-mobile-specific-web-forms"></a><span data-ttu-id="12012-226">Creazione di indipendenti specifiche mobile Web Form</span><span class="sxs-lookup"><span data-stu-id="12012-226">Creating independent mobile-specific Web Forms</span></span>

<span data-ttu-id="12012-227">Per la massima flessibilità, è possibile passare maggiore rispetto a solo pagine master separate per diversi tipi di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-227">For maximum flexibility, you can go much further than just having separate master pages for different device types.</span></span> <span data-ttu-id="12012-228">È possibile implementare due *completamente separare insiemi di pagine Web Form* -impostata per i browser desktop, un altro set per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-228">You can implement two *totally separate sets of Web Forms pages* – one set for desktop browsers, another set for mobiles.</span></span> <span data-ttu-id="12012-229">Questa situazione è ideale se si desidera presentare informazioni molto diverse o flussi di lavoro per dispositivi mobili visitatori.</span><span class="sxs-lookup"><span data-stu-id="12012-229">This works best if you want to present very different information or workflows to mobile visitors.</span></span> <span data-ttu-id="12012-230">Il resto di questa sezione viene descritto questo approccio in modo dettagliato.</span><span class="sxs-lookup"><span data-stu-id="12012-230">The rest of this section describes this approach in detail.</span></span>

<span data-ttu-id="12012-231">Se che si dispone già di un'applicazione Web Form progettata per i browser desktop, il modo più semplice per procedere consiste nel creare una sottocartella denominata "Mobile" all'interno del progetto e creare pagine per dispositivi mobili non esiste.</span><span class="sxs-lookup"><span data-stu-id="12012-231">Assuming you already have a Web Forms application designed for desktop browsers, the easiest way to proceed is to create a subfolder called "Mobile" within your project, and build your mobile pages there.</span></span> <span data-ttu-id="12012-232">È possibile costruire un intero sito secondario, con il proprio pagine master, fogli di stile e pagine, con le stesse tecniche che si utilizzerebbe per qualsiasi altra applicazione Web Form.</span><span class="sxs-lookup"><span data-stu-id="12012-232">You can construct an entire sub-site, with its own master pages, style sheets, and pages, using all the same techniques that you'd use for any other Web Forms application.</span></span> <span data-ttu-id="12012-233">Non è necessario produrre un equivalente per dispositivi mobili per *ogni* pagina nel sito desktop; è possibile scegliere il sottoinsieme di funzionalità è significativa per dispositivi mobili visitatori.</span><span class="sxs-lookup"><span data-stu-id="12012-233">You don't necessarily need to produce a mobile equivalent for *every* page in your desktop site; you can choose what subset of functionality makes sense for mobile visitors.</span></span>

<span data-ttu-id="12012-234">Pagine per dispositivi mobili possono condividere risorse statiche comuni (ad esempio immagini, JavaScript o CSS file) con le pagine regolari se si desidera.</span><span class="sxs-lookup"><span data-stu-id="12012-234">Your mobile pages can share common static resources (such as images, JavaScript, or CSS files) with your regular pages if you wish.</span></span> <span data-ttu-id="12012-235">Poiché la cartella "Mobile" verrà *non* essere contrassegnato come applicazione separata ospitato in IIS (è sufficiente una semplice sottocartella delle pagine Web Form), anche condividono le stesse configurazione, i dati della sessione e un'altra infrastruttura come il pagine desktop.</span><span class="sxs-lookup"><span data-stu-id="12012-235">Since your "Mobile" folder will *not* be marked as a separate application when hosted in IIS (it's just a simple subfolder of Web Forms pages), it will also share all the same configuration, Session data, and other infrastructure as your desktop pages.</span></span>

> [!NOTE]
> <span data-ttu-id="12012-236">Poiché in genere, questo approccio comporta alcuni la duplicazione del codice (pagine per dispositivi mobili sono probabile che condividono alcune analogie con pagine desktop), è importante separare comuni business logica dati accesso codice o in un livello sottostante condiviso o un servizio.</span><span class="sxs-lookup"><span data-stu-id="12012-236">Since this approach usually involves some duplication of code (mobile pages are likely to share some similarities with desktop pages), it's important to factor out any common business logic or data access code into a shared underlying layer or service.</span></span> <span data-ttu-id="12012-237">In caso contrario, sarà necessario raddoppiare l'impegno di creazione e gestione dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="12012-237">Otherwise, you'll double the effort of creating and maintaining your application.</span></span>


#### <a name="redirecting-mobile-visitors-to-your-mobile-pages"></a><span data-ttu-id="12012-238">Reindirizzamento visitatori pagine per dispositivi mobili per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-238">Redirecting mobile visitors to your mobile pages</span></span>

<span data-ttu-id="12012-239">Spesso risulta utile reindirizzamento visitatori pagine per dispositivi mobili per dispositivi mobili solo in caso di *prima* richiesta nella sessione di esplorazione e non a ogni richiesta nella sessione, perché:</span><span class="sxs-lookup"><span data-stu-id="12012-239">It's often convenient to redirect mobile visitors to the mobile pages only on the *first* request in their browsing session (and not on every request in their session), because:</span></span>

- <span data-ttu-id="12012-240">È possibile quindi consentire ai visitatori per dispositivi mobili accedere alle pagine desktop, se necessario, inserire un collegamento nella pagina master che passa a "Versione Desktop".</span><span class="sxs-lookup"><span data-stu-id="12012-240">You can then easily allow mobile visitors to access your desktop pages if they wish – just put a link on your master page that goes to "Desktop version".</span></span> <span data-ttu-id="12012-241">Visitatore non verrà reindirizzato a una pagina mobile, perché non è più la prima richiesta nella sessione.</span><span class="sxs-lookup"><span data-stu-id="12012-241">The visitor won't be redirected back to a mobile page, because it's no longer the first request in their session.</span></span>
- <span data-ttu-id="12012-242">Evita il rischio di interferire con le richieste per tutte le risorse dinamiche condivise tra le parti di desktop e mobile del sito (ad esempio, se si dispone di un Form Web comuni che consentono di visualizzare le parti mobili e desktop del sito in un IFRAME, o alcuni gestori Ajax)</span><span class="sxs-lookup"><span data-stu-id="12012-242">It avoids the risk of interfering with requests for any dynamic resources shared between desktop and mobile parts of your site (e.g., if you have a common Web Form that both desktop and mobile parts of your site display in an IFRAME, or certain Ajax handlers)</span></span>

<span data-ttu-id="12012-243">A tale scopo, è possibile inserire la logica di reindirizzamento in un **sessione\_avviare** metodo.</span><span class="sxs-lookup"><span data-stu-id="12012-243">To do this, you can place your redirection logic in a **Session\_Start** method.</span></span> <span data-ttu-id="12012-244">Ad esempio, aggiungere il metodo seguente al file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="12012-244">For example, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample2.cs)]

#### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="12012-245">Configurazione dell'autenticazione form di rispettare pagine per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-245">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="12012-246">Si noti che l'autenticazione form su alcuni presupposti in cui è possibile reindirizzare i visitatori durante e dopo il processo di autenticazione:</span><span class="sxs-lookup"><span data-stu-id="12012-246">Note that Forms Authentication makes certain assumptions about where it can redirect visitors during and after the authentication process:</span></span>

- <span data-ttu-id="12012-247">Quando un utente deve essere autenticata, autenticazione basata su form reindirizzerà alla pagina di accesso del desktop, indipendentemente dal fatto che sono relative a un utente di computer desktop o portatile (perché dispone solo di un concetto di *uno* URL di accesso).</span><span class="sxs-lookup"><span data-stu-id="12012-247">When a user needs to be authenticated, Forms Authentication will redirect them to your desktop login page, regardless of whether they're a desktop or mobile user (because it only has a concept of *one* login URL).</span></span> <span data-ttu-id="12012-248">Supponendo che si desidera applicare uno stile di pagina di accesso per dispositivi mobili in modo diverso, è necessario ottimizzare la pagina di accesso desktop in modo che gli utenti mobili viene reindirizzato a una pagina di accesso mobile separato.</span><span class="sxs-lookup"><span data-stu-id="12012-248">Assuming you want to style your mobile login page differently, you need to enhance your desktop login page so that it redirects mobile users to a separate mobile login page.</span></span> <span data-ttu-id="12012-249">Ad esempio, aggiungere il codice seguente per il **desktop** codice pagina account di accesso:</span><span class="sxs-lookup"><span data-stu-id="12012-249">For example, add the following code to your **desktop** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample3.cs)]
- <span data-ttu-id="12012-250">Dopo che un utente accede correttamente, autenticazione basata su form per impostazione predefinita reindirizzerà alla home page del desktop (perché dispone solo di un concetto di *uno* pagina predefinita).</span><span class="sxs-lookup"><span data-stu-id="12012-250">After a user successfully logs in, Forms Authentication will by default redirect them to your desktop home page (because it only has a concept of *one* default page).</span></span> <span data-ttu-id="12012-251">È necessario ottimizzare la pagina di accesso per dispositivi mobili in modo che esegue il reindirizzamento alla home page di mobile dopo un log ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="12012-251">You need to enhance your mobile login page so that it redirects to the mobile home page after a successful log-in.</span></span> <span data-ttu-id="12012-252">Ad esempio, aggiungere il codice seguente per il **mobili** codice pagina account di accesso:</span><span class="sxs-lookup"><span data-stu-id="12012-252">For example, add the following code to your **mobile** login page code-behind:</span></span> 

    [!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample4.cs)]
  
  <span data-ttu-id="12012-253">Questo codice si presuppone che la pagina è un controllo di accesso server chiamato LoginUser, come il modello di progetto predefinito.</span><span class="sxs-lookup"><span data-stu-id="12012-253">This code assumes your page has a Login server control called LoginUser, as in the default project template.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="12012-254">Utilizzo di memorizzazione nella cache di Output</span><span class="sxs-lookup"><span data-stu-id="12012-254">Working with Output Caching</span></span>

<span data-ttu-id="12012-255">Se si utilizza la memorizzazione nella cache di output, tenere presente che per impostazione predefinita, che è possibile che un utente desktop accedere a un determinato URL (causando l'output da memorizzare nella cache), seguita da un utente mobile, che quindi riceve l'output del desktop memorizzati nella cache.</span><span class="sxs-lookup"><span data-stu-id="12012-255">If you're using output caching, beware that by default it's possible for a desktop user to visit a certain URL (causing its output to be cached), followed by a mobile user who then receives the cached desktop output.</span></span> <span data-ttu-id="12012-256">Questo avviso si applica sia appena variare la pagina master per tipo di dispositivo, implementare completamente separata Web Form per ogni tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-256">This warning applies whether you're just varying your master page by device type, or implementing totally separate Web Forms per device type.</span></span>

<span data-ttu-id="12012-257">Per evitare il problema, è possibile indicare ASP.NET per variare la voce della cache in base che il visitatore utilizzi un dispositivo mobile.</span><span class="sxs-lookup"><span data-stu-id="12012-257">To avoid the problem, you can instruct ASP.NET to vary the cache entry according to whether the visitor is using a mobile device.</span></span> <span data-ttu-id="12012-258">Aggiungere un parametro VaryByCustom alla dichiarazione OutputCache della pagina, come segue:</span><span class="sxs-lookup"><span data-stu-id="12012-258">Add a VaryByCustom parameter to your page's OutputCache declaration as follows:</span></span>

[!code-aspx[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample5.aspx)]

<span data-ttu-id="12012-259">Successivamente, definire *isMobileDevice* come cache personalizzata parametro aggiungendo il seguente metodo di override per il file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="12012-259">Next, define *isMobileDevice* as a custom cache parameter by adding the following method override to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample6.cs)]

<span data-ttu-id="12012-260">Ciò garantisce che i dispositivi mobili visitatori non ricevono output precedentemente inseriti nella cache per un visitatore di un desktop.</span><span class="sxs-lookup"><span data-stu-id="12012-260">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="12012-261">Un esempio funzionante</span><span class="sxs-lookup"><span data-stu-id="12012-261">A working example</span></span>

<span data-ttu-id="12012-262">Per visualizzare queste tecniche in azione, scaricare [esempi di codice di questo white paper](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="12012-262">To see these techniques in action, download [this white paper's code samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="12012-263">L'applicazione di esempio di Web Form reindirizza automaticamente gli utenti mobili a un set di pagine mobile specifiche in una sottocartella denominata Mobile.</span><span class="sxs-lookup"><span data-stu-id="12012-263">The Web Forms sample application automatically redirects mobile users to a set of mobile-specific pages in a subfolder called Mobile.</span></span> <span data-ttu-id="12012-264">Il markup e lo stile di tali pagine meglio è ottimizzata per il browser per dispositivi mobili, come si può vedere dalle schermate seguenti:</span><span class="sxs-lookup"><span data-stu-id="12012-264">The markup and styling of those pages is better optimized for mobile browsers, as you can see from the following screenshots:</span></span>

![](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/_static/image2.png)

<span data-ttu-id="12012-265">Per altri suggerimenti su come ottimizzare il markup e CSS per i browser per dispositivi mobili, vedere la sezione "Applicazione di stili pagine per dispositivi mobili per i browser per dispositivi mobili" più avanti in questo documento.</span><span class="sxs-lookup"><span data-stu-id="12012-265">For more tips about optimizing your markup and CSS for mobile browsers, see the section "Styling mobile pages for mobile browsers" later in this document.</span></span>

## <a name="how-aspnet-mvc-applications-can-present-mobile-specific-pages"></a><span data-ttu-id="12012-266">Come le applicazioni ASP.NET MVC possono presentare pagine specifiche di dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-266">How ASP.NET MVC applications can present mobile-specific pages</span></span>

<span data-ttu-id="12012-267">Poiché il modello Model-View-Controller separa la logica dell'applicazione (in controller) dalla logica di presentazione (nelle viste), è possibile scegliere da uno degli approcci seguenti per la gestione di supporto per dispositivi mobili nel codice sul lato server:</span><span class="sxs-lookup"><span data-stu-id="12012-267">Since the Model-View-Controller pattern decouples application logic (in controllers) from presentation logic (in views), you can choose from any of the following approaches to handling mobile support in server-side code:</span></span>

1. <span data-ttu-id="12012-268">***Utilizzare lo stesso controller e visualizzazioni per i browser desktop e mobili, ma il rendering di visualizzazioni con layout di Razor diversi a seconda del tipo di dispositivo *.**</span><span class="sxs-lookup"><span data-stu-id="12012-268">***Use the same controllers and views for both desktop and mobile browsers, but render the views with different Razor layouts depending on the device type*.**</span></span> <span data-ttu-id="12012-269">Questa opzione funziona meglio se si sta visualizzando dati identici in tutti i dispositivi, ma desidera semplicemente specificare diversi fogli di stile CSS o modificare alcuni elementi HTML di livello superiore per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-269">This option works best if you're displaying identical data on all devices, but simply want to supply different CSS stylesheets or change a few top-level HTML elements for mobiles.</span></span>
2. <span data-ttu-id="12012-270">***Utilizzare gli stessi controller per i browser desktop e mobili, ma il rendering di visualizzazioni diverse a seconda del tipo di dispositivo***.</span><span class="sxs-lookup"><span data-stu-id="12012-270">***Use the same controllers for both desktop and mobile browsers, but render different views depending on the device type***.</span></span> <span data-ttu-id="12012-271">Questa opzione funziona meglio se è attiva la visualizzazione all'incirca gli stessi dati e fornire la stesse dei flussi di lavoro per gli utenti finali, ma desidera eseguire il rendering di markup HTML molto diversi per soddisfare il dispositivo in uso.</span><span class="sxs-lookup"><span data-stu-id="12012-271">This option works best if you're displaying roughly the same data and providing the same workflows for end users, but want to render very different HTML markup to suit the device being used.</span></span>
3. <span data-ttu-id="12012-272">***Creare aree separate per i browser desktop e mobile, implementazione indipendente controller e visualizzazioni per ogni *.**</span><span class="sxs-lookup"><span data-stu-id="12012-272">***Create separate areas for desktop and mobile browsers, implementing independent controllers and views for each*.**</span></span> <span data-ttu-id="12012-273">Questa opzione funziona meglio se si sta visualizzare schermate molto diverse, che contiene informazioni diverse e che l'utente attraverso diversi flussi di lavoro ottimizzato per il relativo tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-273">This option works best if you're displaying very different screens, containing different information and leading the user through different workflows optimized for their device type.</span></span> <span data-ttu-id="12012-274">Ciò può significare alcuni ripetizione di codice, ma è possibile ridurre al minimo eseguendo il factoring logica comune in un servizio o il livello sottostante.</span><span class="sxs-lookup"><span data-stu-id="12012-274">It may mean some repetition of code, but you can minimize that by factoring out common logic into an underlying layer or service.</span></span>

<span data-ttu-id="12012-275">Se si desidera eseguire il **prima** opzione e il layout di Razor variano per ogni tipo di dispositivo, è molto semplice.</span><span class="sxs-lookup"><span data-stu-id="12012-275">If you want to take the **first** option and vary only the Razor layout per device type, it's very easy.</span></span> <span data-ttu-id="12012-276">Modificare solo il \_ViewStart.cshtml file come segue:</span><span class="sxs-lookup"><span data-stu-id="12012-276">Just modify your \_ViewStart.cshtml file as follows:</span></span>

[!code-cshtml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample7.cshtml)]

<span data-ttu-id="12012-277">Ora è possibile creare un layout specifico mobile denominato \_LayoutMobile.cshtml con una struttura della pagina e CSS regole ottimizzate per i dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-277">Now you can create a mobile-specific layout called \_LayoutMobile.cshtml with a page structure and CSS rules optimized for mobile devices.</span></span>

<span data-ttu-id="12012-278">Se si desidera eseguire il **secondo** opzione rendering viste completamente diversi in base al tipo di dispositivo del visitatore, vedere [post di blog di Scott Hanselman](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span><span class="sxs-lookup"><span data-stu-id="12012-278">If you want to take the **second** option render totally different views according to the visitor's device type, see [Scott Hanselman's blog post](http://www.hanselman.com/blog/ABetterASPNETMVCMobileDeviceCapabilitiesViewEngine.aspx).</span></span>

<span data-ttu-id="12012-279">Il resto di questo documento è incentrato sul **terzo** opzione: creazione di controller separato *e* viste per dispositivi mobili, è pertanto possibile controllare esattamente il sottoinsieme di funzionalità è disponibile per i visitatori per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-279">The rest of this paper focuses on the **third** option – creating separate controllers *and* views for mobile devices – so you can control exactly what subset of functionality is offered for mobile visitors.</span></span>

### <a name="setting-up-a-mobile-area-within-your-aspnet-mvc-application"></a><span data-ttu-id="12012-280">Configurazione di un'area all'interno dell'applicazione MVC ASP.NET per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-280">Setting up a Mobile area within your ASP.NET MVC application</span></span>

<span data-ttu-id="12012-281">È possibile aggiungere un'area denominata "Mobile" a un'applicazione MVC ASP.NET esistente in modo normale: fare clic sul nome del progetto in Esplora soluzioni, quindi scegliere Aggiungi à Area.</span><span class="sxs-lookup"><span data-stu-id="12012-281">You can add an area called "Mobile" to an existing ASP.NET MVC application in the normal way: right-click on your project name in Solution Explorer, then choose Add à Area.</span></span> <span data-ttu-id="12012-282">È quindi possibile aggiungere controller e visualizzazioni, come si farebbe per qualsiasi altra area all'interno di un'applicazione MVC ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="12012-282">You can then add controllers and views as you would for any other area within an ASP.NET MVC application.</span></span> <span data-ttu-id="12012-283">Ad esempio, aggiungere al portale Mobile un nuovo controller chiamato HomeController di agire come una home page per i visitatori per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-283">For example, add to your Mobile area a new controller called HomeController to act as a homepage for mobile visitors.</span></span>

### <a name="ensuring-the-url-mobile-reaches-the-mobile-homepage"></a><span data-ttu-id="12012-284">Garantire il /Mobile URL raggiunge la home page di dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-284">Ensuring the URL /Mobile reaches the mobile homepage</span></span>

<span data-ttu-id="12012-285">Se si desidera /Mobile l'URL per raggiungere l'operazione sull'indice in HomeController all'interno della superficie di dispositivi mobili, è necessario apportare due piccole modifiche alla configurazione di routing.</span><span class="sxs-lookup"><span data-stu-id="12012-285">If you want the URL /Mobile to reach the Index action on HomeController inside your Mobile area, you will need to make two small changes to your routing configuration.</span></span> <span data-ttu-id="12012-286">In primo luogo, aggiornare la classe MobileAreaRegistration in modo da HomeController controller predefinito nella propria zona per dispositivi mobili, come illustrato nel codice seguente:</span><span class="sxs-lookup"><span data-stu-id="12012-286">First, update your MobileAreaRegistration class so that HomeController is the default controller in your Mobile area, as shown in the following code:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample8.cs)]

<span data-ttu-id="12012-287">Ciò significa che la home page di dispositivi mobili ora sarà posizionata /Mobile, piuttosto che Mobile/Home, perché "Home" è ora l'in modo implicito nome controller predefinito per le pagine mobile.</span><span class="sxs-lookup"><span data-stu-id="12012-287">This means the mobile homepage will now be located at /Mobile, rather than /Mobile/Home, because "Home" is now the implicitly default controller name for mobile pages.</span></span>

<span data-ttu-id="12012-288">Successivamente, si noti che aggiungendo un secondo HomeController all'applicazione (ad esempio, per dispositivi mobili quella, oltre a un desktop esistente), si verrà interrotto della home page desktop regolare.</span><span class="sxs-lookup"><span data-stu-id="12012-288">Next, note that by adding a second HomeController to your application (i.e., the mobile one, in addition to the existing desktop one), you'll have broken your regular desktop homepage.</span></span> <span data-ttu-id="12012-289">Avrà esito negativo con l'errore "*sono stati trovati più tipi corrispondenti del controller specificato"Home"*".</span><span class="sxs-lookup"><span data-stu-id="12012-289">It will fail with the error "*Multiple types were found that match the controller named 'Home'*".</span></span> <span data-ttu-id="12012-290">Per risolvere questo problema, aggiornare la configurazione di routing di livello superiore (in Global.asax.cs) per specificare che il desktop HomeController devono avere la priorità di ambiguità:</span><span class="sxs-lookup"><span data-stu-id="12012-290">To resolve this, update your top-level routing configuration (in Global.asax.cs) to specify that your desktop HomeController should take priority when there's ambiguity:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample9.cs)]

<span data-ttu-id="12012-291">Dopo l'errore entra di stoccaggio e l'URL http://<em>yoursite</em>/ raggiungerà la home page del desktop e http://<em>yoursite</em>/mobile/ raggiungerà la home page di dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-291">Now the error will go away, and the URL http://<em>yoursite</em>/ will reach the desktop homepage, and http://<em>yoursite</em>/mobile/ will reach the mobile homepage.</span></span>

### <a name="redirecting-mobile-visitors-to-your-mobile-area"></a><span data-ttu-id="12012-292">Reindirizzamento visitatori mobili al portale mobile</span><span class="sxs-lookup"><span data-stu-id="12012-292">Redirecting mobile visitors to your mobile area</span></span>

<span data-ttu-id="12012-293">Vi sono molti punti di estendibilità diversi in ASP.NET MVC, pertanto vi sono molti modi per inserire la logica di reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="12012-293">There are many different extensibility points in ASP.NET MVC, so there are many possible ways to inject redirection logic.</span></span> <span data-ttu-id="12012-294">I cosiddetti è possibile creare un attributo di filtro, [RedirectMobileDevicesToMobileArea], che esegue un reindirizzamento, se vengono soddisfatte le condizioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="12012-294">One neat option is to create a filter attribute, [RedirectMobileDevicesToMobileArea], that performs a redirection if the following conditions are met:</span></span>

1. <span data-ttu-id="12012-295">È la prima richiesta nella sessione dell'utente (ad esempio, Session.IsNewSession è uguale a true)</span><span class="sxs-lookup"><span data-stu-id="12012-295">It's the first request in the user's session (i.e., Session.IsNewSession equals true)</span></span>
2. <span data-ttu-id="12012-296">La richiesta proviene da un browser per dispositivi mobili (ad esempio, Request.Browser.IsMobileDevice è uguale a true)</span><span class="sxs-lookup"><span data-stu-id="12012-296">The request comes from a mobile browser (i.e., Request.Browser.IsMobileDevice equals true)</span></span>
3. <span data-ttu-id="12012-297">L'utente non richiede già una risorsa nell'area di dispositivi mobili (ad esempio, il *percorso* parte dell'URL non inizia con /Mobile)</span><span class="sxs-lookup"><span data-stu-id="12012-297">The user is not already requesting a resource in the mobile area (i.e., the *path* part of the URL does not begin with /Mobile)</span></span>

<span data-ttu-id="12012-298">L'esempio scaricabile incluso in questo white paper include un'implementazione di questa logica.</span><span class="sxs-lookup"><span data-stu-id="12012-298">The downloadable sample included with this white paper includes an implementation of this logic.</span></span> <span data-ttu-id="12012-299">Viene implementato come un filtro di autorizzazione, derivato da AuthorizeAttribute, il che significa che è possibile utilizzare correttamente anche se si utilizza la memorizzazione nella cache di output (in caso contrario, se accede a un primo visitatore desktop un determinato URL, l'output desktop potrebbero essere memorizzate nella cache e quindi resi disponibili alle visitatori mobili successivi).</span><span class="sxs-lookup"><span data-stu-id="12012-299">It's implemented as an authorization filter, derived from AuthorizeAttribute, which means it can work correctly even if you are using output caching (otherwise, if a desktop visitor first accesses a certain URL, the desktop output might be cached and then served to subsequent mobile visitors).</span></span>

<span data-ttu-id="12012-300">Perché è un filtro, è possibile scegliere di applicarlo ai controller specifico e le azioni, ad esempio,</span><span class="sxs-lookup"><span data-stu-id="12012-300">As it's a filter, you can choose either to apply it to specific controllers and actions, e.g.,</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample10.cs)]

<span data-ttu-id="12012-301">…</span><span class="sxs-lookup"><span data-stu-id="12012-301">…</span></span> <span data-ttu-id="12012-302">è possibile applicare a tutti i controller e azioni come un MVC 3 *filtro globale* nel file di Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="12012-302">or you can apply it to all controllers and actions as an MVC 3 *global filter* in your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample11.cs)]

<span data-ttu-id="12012-303">L'esempio scaricabile viene inoltre illustrato come è possibile creare sottoclassi di questo attributo che reindirizza a percorsi specifici all'interno della superficie di dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-303">The downloadable sample also demonstrates how you can create subclasses of this attribute that redirect to specific locations within your mobile area.</span></span> <span data-ttu-id="12012-304">Ciò significa, ad esempio, che è possibile:</span><span class="sxs-lookup"><span data-stu-id="12012-304">This means, for example, you can:</span></span>

- <span data-ttu-id="12012-305">Registrare un filtro globale come illustrato sopra che invia mobili visitatori alla home page per dispositivi mobili per impostazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="12012-305">Register a global filter as shown above that sends mobile visitors to the mobile homepage by default.</span></span>
- <span data-ttu-id="12012-306">Applica un filtro [RedirectMobileDevicesToMobileProductPage] speciale a un'azione "Visualizza prodotti" che accetta visitatori per dispositivi mobili per la versione mobile di qualsiasi pagina del prodotto che ha richiesto.</span><span class="sxs-lookup"><span data-stu-id="12012-306">Also apply a special [RedirectMobileDevicesToMobileProductPage] filter to a "view product" action that takes mobile visitors to the mobile version of whatever product page they had requested.</span></span>
- <span data-ttu-id="12012-307">Altri sottoclassi speciale del filtro si applicano anche alle azioni specifiche, reindirizzando mobili i visitatori equivalente per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-307">Also apply other special subclasses of the filter to specific actions, redirecting mobile visitors to the equivalent mobile page</span></span>

### <a name="configuring-forms-authentication-to-respect-your-mobile-pages"></a><span data-ttu-id="12012-308">Configurazione dell'autenticazione form di rispettare pagine per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-308">Configuring Forms Authentication to respect your mobile pages</span></span>

<span data-ttu-id="12012-309">Se si utilizza l'autenticazione basata su form, si noti che quando un utente deve accedere, automaticamente l'utente viene reindirizzato a un singolo "accesso" URL specifico, che per impostazione predefinita è **/Account/accesso**.</span><span class="sxs-lookup"><span data-stu-id="12012-309">If you're using Forms Authentication, you should note that when a user needs to log in, it automatically redirects the user to a single specific "log on" URL, which by default is **/Account/LogOn**.</span></span> <span data-ttu-id="12012-310">Ciò significa che gli utenti mobili reindirizzarlo all'azione desktop "accesso".</span><span class="sxs-lookup"><span data-stu-id="12012-310">This means that mobile users may be redirected to your desktop "log on" action.</span></span>

<span data-ttu-id="12012-311">Per evitare questo problema, aggiungere logica all'azione di "accesso" desktop in modo che gli utenti mobili viene reindirizzato nuovamente a un'azione di "accesso" per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-311">To avoid this problem, add logic to your desktop "log on" action so that it redirects mobile users again to a mobile "log on" action.</span></span> <span data-ttu-id="12012-312">Se si utilizza il modello di applicazione MVC ASP.NET predefinito, aggiornare l'azione di accesso del AccountController come segue:</span><span class="sxs-lookup"><span data-stu-id="12012-312">If you're using the default ASP.NET MVC application template, update AccountController's LogOn action as follows:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample12.cs)]

<span data-ttu-id="12012-313">…</span><span class="sxs-lookup"><span data-stu-id="12012-313">…</span></span> <span data-ttu-id="12012-314">e quindi implementare un'azione di "accesso" specifici dispositivi mobili adatta in un controller denominato AccountController nell'area di interesse per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-314">and then implement a suitable mobile-specific "log on" action on a controller called AccountController in your Mobile area.</span></span>

### <a name="working-with-output-caching"></a><span data-ttu-id="12012-315">Utilizzo di memorizzazione nella cache di Output</span><span class="sxs-lookup"><span data-stu-id="12012-315">Working with Output Caching</span></span>

<span data-ttu-id="12012-316">Se si utilizza il filtro [OutputCache], è necessario forzare la voce della cache per variano a seconda del tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-316">If you're using the [OutputCache] filter, you must force the cache entry to vary by device type.</span></span> <span data-ttu-id="12012-317">Ad esempio, scrivere:</span><span class="sxs-lookup"><span data-stu-id="12012-317">For example, write:</span></span>

[!code-javascript[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample13.js)]

<span data-ttu-id="12012-318">Quindi, aggiungere il metodo seguente al file Global.asax.cs:</span><span class="sxs-lookup"><span data-stu-id="12012-318">Then, add the following method to your Global.asax.cs file:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample14.cs)]

<span data-ttu-id="12012-319">Ciò garantisce che i dispositivi mobili visitatori non ricevono output precedentemente inseriti nella cache per un visitatore di un desktop.</span><span class="sxs-lookup"><span data-stu-id="12012-319">This will ensure that mobile visitors to the page don't receive output previously put into the cache by a desktop visitor.</span></span>

### <a name="a-working-example"></a><span data-ttu-id="12012-320">Un esempio funzionante</span><span class="sxs-lookup"><span data-stu-id="12012-320">A working example</span></span>

<span data-ttu-id="12012-321">Per visualizzare queste tecniche in azione, scaricare [codice di questo white paper associati esempi](https://docs.microsoft.com/aspnet/mobile/overview).</span><span class="sxs-lookup"><span data-stu-id="12012-321">To see these techniques in action, download [this white paper's code associated samples](https://docs.microsoft.com/aspnet/mobile/overview).</span></span> <span data-ttu-id="12012-322">L'esempio include un'applicazione ASP.NET MVC 3 (versione finale candidata) migliorata per supportare i dispositivi mobili utilizzando i metodi descritti sopra.</span><span class="sxs-lookup"><span data-stu-id="12012-322">The sample includes an ASP.NET MVC 3 (Release Candidate) application enhanced to support mobile devices using the methods described above.</span></span>

## <a name="further-guidance-and-suggestions"></a><span data-ttu-id="12012-323">Ulteriori linee guida e suggerimenti</span><span class="sxs-lookup"><span data-stu-id="12012-323">Further guidance and suggestions</span></span>

<span data-ttu-id="12012-324">La seguente discussione si applica sia al Web Form e gli sviluppatori MVC che utilizzano le tecniche illustrate in questo documento.</span><span class="sxs-lookup"><span data-stu-id="12012-324">The following discussion applies both to Web Forms and MVC developers who are using the techniques covered in this document.</span></span>

### <a name="enhancing-your-redirection-logic-using-51degreesmobi-foundation"></a><span data-ttu-id="12012-325">Miglioramento della logica di reindirizzamento utilizzando 51Degrees.mobi Foundation</span><span class="sxs-lookup"><span data-stu-id="12012-325">Enhancing your redirection logic using 51Degrees.mobi Foundation</span></span>

<span data-ttu-id="12012-326">La logica di reindirizzamento illustrata in questo documento può essere perfettamente sufficiente per l'applicazione, ma non funzionerà se è necessario disabilitare le sessioni o con un browser per dispositivi mobili che rifiuta i cookie (questi non possono avere sessioni), perché non conoscere se una determinata richiesta è il primo da tale visitatore.</span><span class="sxs-lookup"><span data-stu-id="12012-326">The redirection logic shown in this document may be perfectly sufficient for your application, but it won't work if you need to disable sessions, or with mobile browsers that reject cookies (these can't have sessions), because it won't know whether a given request is the first one from that visitor.</span></span>

<span data-ttu-id="12012-327">Si è già appreso come il 51Degrees.mobi Apri origine Foundation può migliorare l'accuratezza di ASP. Rilevamento del browser di rete.</span><span class="sxs-lookup"><span data-stu-id="12012-327">You already learned how the open source 51Degrees.mobi Foundation can improve the accuracy of ASP.NET's browser detection.</span></span> <span data-ttu-id="12012-328">Include anche un integrato che consente di reindirizzare mobili visitatori a indirizzi specifici configurati in Web. config. È in grado di funzionare a seconda delle sessioni ASP.NET (e pertanto i cookie) mediante l'archiviazione di un log temporaneo degli hash delle intestazioni HTTP e gli indirizzi IP dei visitatori, in modo che sappia se ogni richiesta è il primo da un determinato vistor.</span><span class="sxs-lookup"><span data-stu-id="12012-328">It also has a built-in ability to redirect mobile visitors to specific locations configured in Web.config. It's able to work without depending on ASP.NET Sessions (and hence cookies) by storing a temporary log of hashes of visitors' HTTP headers and IP addresses, so it knows whether or not each request is the first one from a given vistor.</span></span>

<span data-ttu-id="12012-329">Il seguente elemento aggiunto alla sezione del file Web. config fiftyOne reindirizzerà la prima richiesta da un dispositivo mobile rilevato alla pagina ~ / Mobile/Default.aspx.</span><span class="sxs-lookup"><span data-stu-id="12012-329">The following element added to the fiftyOne section of the web.config file will redirect the first request from a detected mobile device to the page ~/Mobile/Default.aspx.</span></span> <span data-ttu-id="12012-330">Tutte le richieste di pagine all'interno della cartella per dispositivi mobili verranno *non* reindirizzato, indipendentemente dal tipo di dispositivo.</span><span class="sxs-lookup"><span data-stu-id="12012-330">Any requests to pages under the Mobile folder will *not* be redirected, regardless of device type.</span></span> <span data-ttu-id="12012-331">Se il dispositivo mobile è rimasto inattivo per un periodo di 20 minuti o più il dispositivo verrà dimenticato e le richieste successive verranno considerate come nuovi per gli scopi di reindirizzamento.</span><span class="sxs-lookup"><span data-stu-id="12012-331">If the mobile device has been inactive for a period of 20 minutes or more the device will be forgotten and subsequent requests will be treated as new ones for the purposes of redirection.</span></span>

[!code-xml[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample15.xml)]

<span data-ttu-id="12012-332">Per ulteriori informazioni, vedere [51degrees.mobi documentazione Foundation](https://github.com/51Degrees/dotNET-Device-Detection).</span><span class="sxs-lookup"><span data-stu-id="12012-332">For more details, see [51degrees.mobi Foundation documentation](https://github.com/51Degrees/dotNET-Device-Detection).</span></span>

> [!NOTE]
> <span data-ttu-id="12012-333">Si *possibile* funzionalità di reindirizzamento della Fondazione 51Degrees.mobi utilizzare in applicazioni ASP.NET MVC, ma è necessario definire la configurazione di reindirizzamento in termini di URL normale, non in termini di parametri di routing o inserendo i filtri MVC in azioni.</span><span class="sxs-lookup"><span data-stu-id="12012-333">You *can* use 51Degrees.mobi Foundation's redirection feature on ASP.NET MVC applications, but you will need to define your redirection configuration in terms of plain URLs, not in terms of routing parameters or by putting MVC filters on actions.</span></span> <span data-ttu-id="12012-334">In questo modo (al momento della scrittura) 51Degrees.mobi Foundation non riconosce il routing o filtri.</span><span class="sxs-lookup"><span data-stu-id="12012-334">This is because (at the time of writing) 51Degrees.mobi Foundation does not recognize filters or routing.</span></span>


### <a name="disabling-transcoders-and-proxy-servers"></a><span data-ttu-id="12012-335">La disabilitazione di server Proxy e Transcodificatori</span><span class="sxs-lookup"><span data-stu-id="12012-335">Disabling Transcoders and Proxy Servers</span></span>

<span data-ttu-id="12012-336">Gli operatori di telefonia mobile hanno due obiettivi generali nell'approccio a internet per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-336">Mobile network operators have two broad objectives in their approach to the mobile internet:</span></span>

1. <span data-ttu-id="12012-337">Specificare come contenuto molto rilevante possibili</span><span class="sxs-lookup"><span data-stu-id="12012-337">Provide as much relevant content as possible</span></span>
2. <span data-ttu-id="12012-338">Aumentare il numero di clienti che possono condividere la larghezza di banda limitata radio</span><span class="sxs-lookup"><span data-stu-id="12012-338">Maximize the number of customers who can share the limited radio network bandwidth</span></span>

<span data-ttu-id="12012-339">Poiché la maggior parte delle pagine web sono stati progettati per schermi di grandi dimensioni desktop e connessioni a banda larga fissa fast-line, molti operatori usano *transcodificatori* o *server proxy* che modificare dinamicamente il contenuto web.</span><span class="sxs-lookup"><span data-stu-id="12012-339">Since most web pages were designed for large desktop-sized screens and fast fixed-line broadband connections, many operators use *transcoders* or *proxy servers* that dynamically alter web content.</span></span> <span data-ttu-id="12012-340">Si può modificare il markup HTML o CSS in base alle esigenze di schermi più piccoli (soprattutto per "funzionalità telefoni" che non dispongono di potenza di elaborazione per la gestione di layout complessi) e potrebbe ricomprimere immagini (riducendo notevolmente la qualità) per migliorare la velocità di recapito di pagina.</span><span class="sxs-lookup"><span data-stu-id="12012-340">They may modify your HTML markup or CSS to suit smaller screens (especially for "feature phones" that lack the processing power to handle complex layouts), and they may recompress your images (significantly reducing their quality) to improve page delivery speeds.</span></span>

<span data-ttu-id="12012-341">Ma se è stata acquisita l'impegno di produrre una versione ottimizzata del sito, probabilmente non si vuole interferire con eventuali ulteriormente l'operatore di rete.</span><span class="sxs-lookup"><span data-stu-id="12012-341">But if you've taken the effort to produce a mobile-optimized version of your site, you probably don't want the network operator to interfere with it any further.</span></span> <span data-ttu-id="12012-342">È possibile aggiungere la riga seguente alla pagina\_evento di caricamento in un Web Form ASP.NET:</span><span class="sxs-lookup"><span data-stu-id="12012-342">You can add the following line to the Page\_Load event in any ASP.NET Web Form:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample16.cs)]

<span data-ttu-id="12012-343">In alternativa, per un controller di ASP.NET MVC, è possibile aggiungere il seguente override del metodo in modo che venga applicata a tutte le azioni nell'ambito del controller:</span><span class="sxs-lookup"><span data-stu-id="12012-343">Or, for an ASP.NET MVC controller, you could add the following method override so that it applies to all actions on that controller:</span></span>

[!code-csharp[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample17.cs)]

<span data-ttu-id="12012-344">Il messaggio HTTP risultante informa transcodificatori conformi W3C e i proxy non è necessario modificare il contenuto.</span><span class="sxs-lookup"><span data-stu-id="12012-344">The resulting HTTP message informs W3C compliant transcoders and proxies not to alter content.</span></span> <span data-ttu-id="12012-345">Ovviamente, non è garantito che gli operatori di telefonia mobile rispetterà questo messaggio.</span><span class="sxs-lookup"><span data-stu-id="12012-345">Of course, there is no guarantee that mobile network operators will respect this message.</span></span>

### <a name="styling-mobile-pages-for-mobile-browsers"></a><span data-ttu-id="12012-346">Stile di pagine per i browser per dispositivi mobili per dispositivi mobili</span><span class="sxs-lookup"><span data-stu-id="12012-346">Styling mobile pages for mobile browsers</span></span>

<span data-ttu-id="12012-347">Rientra nell'ambito di questo documento per descrivere in dettaglio i tipi di lavoro di markup HTML correttamente o le tecniche di progettazione web ottimizzare l'usabilità in dispositivi specifici.</span><span class="sxs-lookup"><span data-stu-id="12012-347">It's beyond the scope of this document to describe in great detail what kinds of HTML markup work correctly or which web design techniques maximize usability on particular devices.</span></span> <span data-ttu-id="12012-348">Dispone di backup per individuare un layout sufficientemente semplice, ottimizzato per una schermata di dimensioni di dispositivi mobili, senza utilizzare non affidabile HTML o CSS posizionamento consigli.</span><span class="sxs-lookup"><span data-stu-id="12012-348">It's up to you to find a sufficiently simple layout, optimized for a mobile-sized screen, without using unreliable HTML or CSS positioning tricks.</span></span> <span data-ttu-id="12012-349">Una tecnica importante importante ricordare, tuttavia, è il *tag meta viewport*.</span><span class="sxs-lookup"><span data-stu-id="12012-349">One important technique worth mentioning, however, is the *viewport meta tag*.</span></span>

<span data-ttu-id="12012-350">Alcuni browser per dispositivi mobili moderni, nelle pagine di web visualizzato impegno destinata dei desktop, il rendering della pagina in un'area di disegno virtuale, detta anche "viewport" (ad esempio, il riquadro di visualizzazione virtuale è 980 pixel su iPhone e 850 pixel in Opera Mobile per impostazione predefinita), quindi ridurre il risultato per adattarla pixel fisici della schermata.</span><span class="sxs-lookup"><span data-stu-id="12012-350">Certain modern mobile browsers, in an effort display web pages meant for desktop monitors, render the page on a virtual canvas, also called "viewport" (e.g., the virtual viewport is 980 pixels wide on iPhone, and 850 pixels wide on Opera Mobile by default) and then scale the result down to fit onto the screen's physical pixels.</span></span> <span data-ttu-id="12012-351">L'utente può quindi eseguire lo zoom avanti e scorrere per il viewport.</span><span class="sxs-lookup"><span data-stu-id="12012-351">The user can then zoom in and pan around that viewport.</span></span> <span data-ttu-id="12012-352">Il vantaggio che consente il browser di visualizzare la pagina in un layout desiderato, ma è anche ha lo svantaggio che impone lo zoom e traslazione, che non è pratico per l'utente.</span><span class="sxs-lookup"><span data-stu-id="12012-352">This has the advantage that it lets the browser display the page in its intended layout, but it's also has the disadvantage that it forces zooming and panning, which is inconvenient for the user.</span></span> <span data-ttu-id="12012-353">Se si sta progettando per dispositivi mobili, è consigliabile progettare una schermata "narrow" in modo che non sia necessario alcun valore di zoom o lo scorrimento orizzontale.</span><span class="sxs-lookup"><span data-stu-id="12012-353">If you're designing for mobile, it's better to design for a narrow screen so that no zooming or horizontal scrolling is necessary.</span></span>

<span data-ttu-id="12012-354">Un modo per indicare al browser in dispositivi mobili la larghezza deve essere il viewport è tramite il non conforme allo standard *viewport* tag meta.</span><span class="sxs-lookup"><span data-stu-id="12012-354">A way to tell the mobile browser how wide the viewport should be is through the nonstandard *viewport* meta tag.</span></span> <span data-ttu-id="12012-355">Ad esempio, se si aggiunge il seguente alla sezione di intestazione della pagina,</span><span class="sxs-lookup"><span data-stu-id="12012-355">For example, if you add the following to your page's HEAD section,</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample18.html)]

<span data-ttu-id="12012-356">…</span><span class="sxs-lookup"><span data-stu-id="12012-356">…</span></span> <span data-ttu-id="12012-357">quindi supporto browser smartphone layout della pagina in un'area di disegno virtuale a livello di 480 pixel.</span><span class="sxs-lookup"><span data-stu-id="12012-357">then supporting smartphone browsers will lay out the page on a 480-pixel wide virtual canvas.</span></span> <span data-ttu-id="12012-358">Ciò significa che se gli elementi HTML definiscono la larghezza in percentuale, le percentuali verranno interpretate rispetto a questa larghezza 480 pixel, non la larghezza del riquadro di visualizzazione predefinita.</span><span class="sxs-lookup"><span data-stu-id="12012-358">This means that if your HTML elements define their widths in percentage terms, the percentages will be interpreted with respect to this 480-pixel width, not the default viewport width.</span></span> <span data-ttu-id="12012-359">Di conseguenza, l'utente è meno probabile che è necessario eseguire lo zoom e scorrere orizzontalmente: notevolmente migliorare l'esperienza di esplorazione per dispositivi mobili.</span><span class="sxs-lookup"><span data-stu-id="12012-359">As a result, the user is less likely to have to zoom and pan horizontally – considerably improving the mobile browsing experience.</span></span>

<span data-ttu-id="12012-360">Se si desidera la larghezza del viewport per la corrispondenza di pixel fisici del dispositivo, è possibile specificare quanto segue:</span><span class="sxs-lookup"><span data-stu-id="12012-360">If you want the viewport width to match the device's physical pixels, you can specify the following:</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample19.html)]

<span data-ttu-id="12012-361">Per questa soluzione funzioni correttamente, non è necessario forzare in modo esplicito gli elementi supera la larghezza (ad esempio, utilizzando un *larghezza* attributo o una proprietà CSS), in caso contrario il browser dovrà utilizzare indipendentemente dal fatto che un riquadro di visualizzazione più grande.</span><span class="sxs-lookup"><span data-stu-id="12012-361">For this to work correctly, you must not explicitly force elements to exceed that width (e.g., using a *width* attribute or CSS property), otherwise the browser will be forced to use a larger viewport regardless.</span></span> <span data-ttu-id="12012-362">Vedere anche: [ulteriori dettagli sul tag viewport non conforme allo standard](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span><span class="sxs-lookup"><span data-stu-id="12012-362">See also: [more details about the nonstandard viewport tag](https://developer.apple.com/library/safari/#documentation/AppleApplications/Reference/SafariHTMLRef/Articles/MetaTags.html).</span></span>

<span data-ttu-id="12012-363">Supportano più recenti Smartphone *Orientamento doppia*: può essere mantenuti in modalità verticale o orizzontale.</span><span class="sxs-lookup"><span data-stu-id="12012-363">Most modern smartphones support *dual orientation*: they can be held in either portrait or landscape mode.</span></span> <span data-ttu-id="12012-364">In tal caso, è importante evitare di basarsi su presupposti relativi alla larghezza dello schermo in pixel.</span><span class="sxs-lookup"><span data-stu-id="12012-364">So, it's important not to make assumptions about the screen width in pixels.</span></span> <span data-ttu-id="12012-365">Non ancora presupporre che la larghezza dello schermo è fissa, perché l'utente può orientare nuovamente il dispositivo mentre si trovano nella pagina.</span><span class="sxs-lookup"><span data-stu-id="12012-365">Don't even assume that the screen width is fixed, because the user can re-orient their device while they are on your page.</span></span>

<span data-ttu-id="12012-366">Dispositivi Windows Mobile e Blackberry meno recenti possono accettare anche i seguenti tag meta nell'intestazione di pagina per informarli del contenuto è stato ottimizzato per dispositivi mobili e pertanto non devono essere trasformate.</span><span class="sxs-lookup"><span data-stu-id="12012-366">Older Windows Mobile and Blackberry devices may also accept the following meta tags in the page header to inform them content has been optimized for mobile and therefore should not be transformed.</span></span>

[!code-html[Main](add-mobile-pages-to-your-aspnet-web-forms-mvc-application/samples/sample20.html)]

## <a name="additional-resources"></a><span data-ttu-id="12012-367">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="12012-367">Additional Resources</span></span>

<span data-ttu-id="12012-368">Per un elenco di emulatori di dispositivi mobili e i simulatori è possibile utilizzare per testare l'applicazione web ASP.NET per dispositivi mobili, vedere la pagina [simulare diffusi dispositivi mobili per il testing](../mobile/device-simulators.md).</span><span class="sxs-lookup"><span data-stu-id="12012-368">For a list of mobile device emulators and simulators you can use to test your mobile ASP.NET web application, see the page [Simulate popular mobile devices for testing](../mobile/device-simulators.md).</span></span>

## <a name="credits"></a><span data-ttu-id="12012-369">Crediti</span><span class="sxs-lookup"><span data-stu-id="12012-369">Credits</span></span>

- <span data-ttu-id="12012-370">Autore principale: Steven Sanderson</span><span class="sxs-lookup"><span data-stu-id="12012-370">Primary author: Steven Sanderson</span></span>
- <span data-ttu-id="12012-371">Revisori / aggiuntive contenuto writer: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span><span class="sxs-lookup"><span data-stu-id="12012-371">Reviewers / additional content writers: James Rosewell, Mikael Söderström, Scott Hanselman, Scott Hunter</span></span>

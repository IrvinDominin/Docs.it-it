## <a name="call-the-web-api-with-jquery"></a><span data-ttu-id="058d8-101">Chiamare l'API Web con jQuery</span><span class="sxs-lookup"><span data-stu-id="058d8-101">Call the Web API with jQuery</span></span>

<span data-ttu-id="058d8-102">In questa sezione viene aggiunta una pagina HTML che usa jQuery per chiamare l'API Web.</span><span class="sxs-lookup"><span data-stu-id="058d8-102">In this section, an HTML page is added that uses jQuery to call the Web API.</span></span> <span data-ttu-id="058d8-103">jQuery avvia la richiesta e aggiorna la pagina con i dettagli ottenuti dalla risposta dell'API.</span><span class="sxs-lookup"><span data-stu-id="058d8-103">jQuery initiates the request and updates the page with the details from the API's response.</span></span>

<span data-ttu-id="058d8-104">Configurare il progetto in modo che gestisca i file statici e consenta il mapping di file predefinito.</span><span class="sxs-lookup"><span data-stu-id="058d8-104">Configure the project to serve static files and to enable default file mapping.</span></span> <span data-ttu-id="058d8-105">Questa funzionalità si ottiene chiamando i metodi di estensione [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) e [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) in *Startup.Configure*.</span><span class="sxs-lookup"><span data-stu-id="058d8-105">This is accomplished by invoking the [UseStaticFiles](/dotnet/api/microsoft.aspnetcore.builder.staticfileextensions.usestaticfiles#Microsoft_AspNetCore_Builder_StaticFileExtensions_UseStaticFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) and [UseDefaultFiles](/dotnet/api/microsoft.aspnetcore.builder.defaultfilesextensions.usedefaultfiles#Microsoft_AspNetCore_Builder_DefaultFilesExtensions_UseDefaultFiles_Microsoft_AspNetCore_Builder_IApplicationBuilder_) extension methods in *Startup.Configure*.</span></span> <span data-ttu-id="058d8-106">Per altre informazioni, vedere [File statici](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="058d8-106">For more information, see [Static files](xref:fundamentals/static-files).</span></span>

[!code-csharp[](../../tutorials/first-web-api/samples/2.0/TodoApi/Startup2.cs?name=snippet_Configure&highlight=3-4)]

<span data-ttu-id="058d8-107">Aggiungere un file HTML denominato *index.html* alla directory *wwwroot* del progetto.</span><span class="sxs-lookup"><span data-stu-id="058d8-107">Add an HTML file, named *index.html*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="058d8-108">Sostituire il contenuto con il markup seguente:</span><span class="sxs-lookup"><span data-stu-id="058d8-108">Replace its contents with the following markup:</span></span>

[!code-html[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/index.html)]

<span data-ttu-id="058d8-109">Aggiungere un file JavaScript con nome *site.js* alla directory *wwwroot* del progetto.</span><span class="sxs-lookup"><span data-stu-id="058d8-109">Add a JavaScript file, named *site.js*, to the project's *wwwroot* directory.</span></span> <span data-ttu-id="058d8-110">Sostituire il contenuto con il codice seguente:</span><span class="sxs-lookup"><span data-stu-id="058d8-110">Replace its contents with the following code:</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_SiteJs)]

<span data-ttu-id="058d8-111">Può essere necessario modificare le impostazioni di avvio del progetto ASP.NET Core per il test della pagina HTML in locale.</span><span class="sxs-lookup"><span data-stu-id="058d8-111">A change to the ASP.NET Core project's launch settings may be required to test the HTML page locally.</span></span> <span data-ttu-id="058d8-112">Aprire *launchSettings.json* nella directory *Properties* del progetto.</span><span class="sxs-lookup"><span data-stu-id="058d8-112">Open *launchSettings.json* in the *Properties* directory of the project.</span></span> <span data-ttu-id="058d8-113">Rimuovere la proprietà `launchUrl` per forzare l'app ad aprire *index.html*, il file predefinito del progetto.</span><span class="sxs-lookup"><span data-stu-id="058d8-113">Remove the `launchUrl` property to force the app to open at *index.html*&mdash;the project's default file.</span></span>

<span data-ttu-id="058d8-114">È possibile ottenere jQuery in vari modi.</span><span class="sxs-lookup"><span data-stu-id="058d8-114">There are several ways to get jQuery.</span></span> <span data-ttu-id="058d8-115">Nel frammento precedente la libreria viene caricata da una rete CDN.</span><span class="sxs-lookup"><span data-stu-id="058d8-115">In the preceding snippet, the library is loaded from a CDN.</span></span> <span data-ttu-id="058d8-116">Si tratta di un esempio CRUD completo di chiamata dell'API con jQuery.</span><span class="sxs-lookup"><span data-stu-id="058d8-116">This sample is a complete CRUD example of calling the API with jQuery.</span></span> <span data-ttu-id="058d8-117">L'esempio include funzionalità aggiuntive che rendono l'esperienza più completa.</span><span class="sxs-lookup"><span data-stu-id="058d8-117">There are additional features in this sample to make the experience richer.</span></span> <span data-ttu-id="058d8-118">Di seguito vengono incluse spiegazioni relative alle chiamate all'API.</span><span class="sxs-lookup"><span data-stu-id="058d8-118">Below are explanations around the calls to the API.</span></span>

### <a name="get-a-list-of-to-do-items"></a><span data-ttu-id="058d8-119">Ottenere un elenco di elementi attività</span><span class="sxs-lookup"><span data-stu-id="058d8-119">Get a list of to-do items</span></span>

<span data-ttu-id="058d8-120">Per ottenere un elenco di elementi attività, inviare una richiesta HTTP GET a */api/todo*.</span><span class="sxs-lookup"><span data-stu-id="058d8-120">To get a list of to-do items, send an HTTP GET request to */api/todo*.</span></span>

<span data-ttu-id="058d8-121">La funzione [ajax](https://api.jquery.com/jquery.ajax/) di jQuery invia una richiesta AJAX all'API, la quale restituisce codice JSON che rappresenta un oggetto o una matrice.</span><span class="sxs-lookup"><span data-stu-id="058d8-121">The jQuery [ajax](https://api.jquery.com/jquery.ajax/) function sends an AJAX request to the API, which returns JSON representing an object or array.</span></span> <span data-ttu-id="058d8-122">Questa funzione può gestire tutte le forme di interazione HTTP inviando una richiesta HTTP all'`url` specificato.</span><span class="sxs-lookup"><span data-stu-id="058d8-122">This function can handle all forms of HTTP interaction, sending an HTTP request to the specified `url`.</span></span> <span data-ttu-id="058d8-123">`GET` viene usata come `type`.</span><span class="sxs-lookup"><span data-stu-id="058d8-123">`GET` is used as the `type`.</span></span> <span data-ttu-id="058d8-124">La funzione di callback `success` viene chiamata se la richiesta ha esito positivo.</span><span class="sxs-lookup"><span data-stu-id="058d8-124">The `success` callback function is invoked if the request succeeds.</span></span> <span data-ttu-id="058d8-125">Nel callback il modello DOM viene aggiornato con le informazioni dell'elemento attività.</span><span class="sxs-lookup"><span data-stu-id="058d8-125">In the callback, the DOM is updated with the to-do information.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_GetData)]

### <a name="add-a-to-do-item"></a><span data-ttu-id="058d8-126">Aggiungere un elemento attività</span><span class="sxs-lookup"><span data-stu-id="058d8-126">Add a to-do item</span></span>

<span data-ttu-id="058d8-127">Per aggiungere un elemento attività, inviare una richiesta HTTP POST a */api/todo/*.</span><span class="sxs-lookup"><span data-stu-id="058d8-127">To add a to-do item, send an HTTP POST request to */api/todo/*.</span></span> <span data-ttu-id="058d8-128">Il corpo della richiesta deve contenere un oggetto attività.</span><span class="sxs-lookup"><span data-stu-id="058d8-128">The request body should contain a to-do object.</span></span> <span data-ttu-id="058d8-129">La funzione [ajax](https://api.jquery.com/jquery.ajax/) usa `POST` per chiamare l'API.</span><span class="sxs-lookup"><span data-stu-id="058d8-129">The [ajax](https://api.jquery.com/jquery.ajax/) function is using `POST` to call the API.</span></span> <span data-ttu-id="058d8-130">Per le richieste `POST` e `PUT` il corpo della richiesta rappresenta i dati inviati all'API.</span><span class="sxs-lookup"><span data-stu-id="058d8-130">For `POST` and `PUT` requests, the request body represents the data sent to the API.</span></span> <span data-ttu-id="058d8-131">L'API prevede un corpo della richiesta JSON.</span><span class="sxs-lookup"><span data-stu-id="058d8-131">The API is expecting a JSON request body.</span></span> <span data-ttu-id="058d8-132">Le opzioni `accepts` e `contentType` sono impostate su `application/json` per classificare rispettivamente il tipo di supporto ricevuto e inviato.</span><span class="sxs-lookup"><span data-stu-id="058d8-132">The `accepts` and `contentType` options are set to `application/json` to classify the media type being received and sent, respectively.</span></span> <span data-ttu-id="058d8-133">I dati viene convertiti in un oggetto JSON mediante [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span><span class="sxs-lookup"><span data-stu-id="058d8-133">The data is converted to a JSON object using [`JSON.stringify`](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify).</span></span> <span data-ttu-id="058d8-134">Quando l'API restituisce un codice di stato di esecuzione riuscita, viene chiamata la funzione `getData` per aggiornare la tabella HTML.</span><span class="sxs-lookup"><span data-stu-id="058d8-134">When the API returns a successful status code, the `getData` function is invoked to update the HTML table.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AddItem)]

### <a name="update-a-to-do-item"></a><span data-ttu-id="058d8-135">Aggiornare un elemento attività</span><span class="sxs-lookup"><span data-stu-id="058d8-135">Update a to-do item</span></span>

<span data-ttu-id="058d8-136">L'aggiornamento di un elemento attività è molto simile all'aggiunta, perché entrambe le operazioni si basano su un corpo della richiesta.</span><span class="sxs-lookup"><span data-stu-id="058d8-136">Updating a to-do item is very similar to adding one, since both rely on a request body.</span></span> <span data-ttu-id="058d8-137">In questo caso l'unica vera differenza tra le due operazioni è il fatto che `url` viene modificato per aggiungere l'identificatore univoco dell'elemento e `type` è `PUT`.</span><span class="sxs-lookup"><span data-stu-id="058d8-137">The only real difference between the two in this case is that the `url` changes to add the unique identifier of the item, and the `type` is `PUT`.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxPut)]

### <a name="delete-a-to-do-item"></a><span data-ttu-id="058d8-138">Eliminare un elemento attività</span><span class="sxs-lookup"><span data-stu-id="058d8-138">Delete a to-do item</span></span>

<span data-ttu-id="058d8-139">È possibile eliminare un elemento attività impostando `type` su `DELETE` nella chiamata AJAX e specificando l'identificatore univoco dell'elemento nell'URL.</span><span class="sxs-lookup"><span data-stu-id="058d8-139">Deleting a to-do item is accomplished by setting the `type` on the AJAX call to `DELETE` and specifing the item's unique identifier in the URL.</span></span>

[!code-javascript[](../../tutorials/first-web-api/samples/2.0/TodoApi/wwwroot/site.js?name=snippet_AjaxDelete)]

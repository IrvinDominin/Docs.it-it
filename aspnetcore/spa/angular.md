---
title: Utilizzare il modello di progetto Angular con ASP.NET Core
author: SteveSandersonMS
description: Informazioni su come iniziare con il modello di progetto ASP.NET Core singolo pagina applicazione (SPA) per angolare e CLI angolare.
manager: wpickett
ms.author: scaddie
ms.custom: mvc
ms.date: 02/21/2018
ms.devlang: csharp
ms.prod: aspnet-core
ms.technology: aspnet
ms.topic: article
uid: spa/angular
ms.openlocfilehash: b4e48f40c3d4e3167e7fdb3534d2c33b3544592c
ms.sourcegitcommit: 9bc34b8269d2a150b844c3b8646dcb30278a95ea
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 05/12/2018
---
# <a name="use-the-angular-project-template-with-aspnet-core"></a><span data-ttu-id="b885e-103">Utilizzare il modello di progetto Angular con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="b885e-103">Use the Angular project template with ASP.NET Core</span></span>

> [!NOTE]
> <span data-ttu-id="b885e-104">Questa documentazione non è incluso sul modello di progetto angolare in ASP.NET 2.0 Core.</span><span class="sxs-lookup"><span data-stu-id="b885e-104">This documentation isn't about the Angular project template included in ASP.NET Core 2.0.</span></span> <span data-ttu-id="b885e-105">È sul modello di angolare più recente a cui è possibile aggiornare manualmente.</span><span class="sxs-lookup"><span data-stu-id="b885e-105">It's about the newer Angular template to which you can update manually.</span></span> <span data-ttu-id="b885e-106">Per impostazione predefinita, il modello è incluso in ASP.NET Core 2.1.</span><span class="sxs-lookup"><span data-stu-id="b885e-106">The template is included in ASP.NET Core 2.1 by default.</span></span>

<span data-ttu-id="b885e-107">Il modello di progetto angolare aggiornato fornisce un punto di partenza ideale per ASP.NET Core App utilizzando angolare e CLI angolare per implementare un'interfaccia utente avanzata, sul lato client (UI).</span><span class="sxs-lookup"><span data-stu-id="b885e-107">The updated Angular project template provides a convenient starting point for ASP.NET Core apps using Angular and the Angular CLI to implement a rich, client-side user interface (UI).</span></span>

<span data-ttu-id="b885e-108">Il modello è equivalente alla creazione di un progetto ASP.NET Core per agire come un back-end dell'API e un progetto CLI angolare come un'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b885e-108">The template is equivalent to creating an ASP.NET Core project to act as an API backend and an Angular CLI project to act as a UI.</span></span> <span data-ttu-id="b885e-109">Il modello offre il vantaggio di hosting di entrambi i tipi di progetto in un progetto di app single.</span><span class="sxs-lookup"><span data-stu-id="b885e-109">The template offers the convenience of hosting both project types in a single app project.</span></span> <span data-ttu-id="b885e-110">Di conseguenza, il progetto di applicazione da compilare e pubblicato come una singola unità.</span><span class="sxs-lookup"><span data-stu-id="b885e-110">Consequently, the app project can be built and published as a single unit.</span></span>

## <a name="create-a-new-app"></a><span data-ttu-id="b885e-111">Creare una nuova app</span><span class="sxs-lookup"><span data-stu-id="b885e-111">Create a new app</span></span>

<span data-ttu-id="b885e-112">Se utilizza componenti di base di ASP.NET 2.0, assicurarsi che la [installato il modello di progetto angolare aggiornato](xref:spa/index#installation).</span><span class="sxs-lookup"><span data-stu-id="b885e-112">If using ASP.NET Core 2.0, ensure you've [installed the updated Angular project template](xref:spa/index#installation).</span></span> <span data-ttu-id="b885e-113">Se si dispone di ASP.NET Core 2.1, non è necessario installarlo.</span><span class="sxs-lookup"><span data-stu-id="b885e-113">If you have ASP.NET Core 2.1, there's no need to install it.</span></span>

<span data-ttu-id="b885e-114">Creare un nuovo progetto da un prompt dei comandi utilizzando il comando `dotnet new angular` in una directory vuota.</span><span class="sxs-lookup"><span data-stu-id="b885e-114">Create a new project from a command prompt using the command `dotnet new angular` in an empty directory.</span></span> <span data-ttu-id="b885e-115">Ad esempio, i comandi seguenti creano l'app in un *my-nuova-app* directory e passare alla directory:</span><span class="sxs-lookup"><span data-stu-id="b885e-115">For example, the following commands create the app in a *my-new-app* directory and switch to that directory:</span></span>

```console
dotnet new angular -o my-new-app
cd my-new-app
```

<span data-ttu-id="b885e-116">Eseguire l'app da Visual Studio o l'interfaccia CLI di .NET Core:</span><span class="sxs-lookup"><span data-stu-id="b885e-116">Run the app from either Visual Studio or the .NET Core CLI:</span></span>

# <a name="visual-studiotabvisual-studio"></a>[<span data-ttu-id="b885e-117">Visual Studio</span><span class="sxs-lookup"><span data-stu-id="b885e-117">Visual Studio</span></span>](#tab/visual-studio/)

<span data-ttu-id="b885e-118">Aprire generato *csproj* file ed eseguire l'app come al solito da qui.</span><span class="sxs-lookup"><span data-stu-id="b885e-118">Open the generated *.csproj* file, and run the app as normal from there.</span></span>

<span data-ttu-id="b885e-119">Il processo di compilazione consente di ripristinare le dipendenze di npm alla prima esecuzione, che può richiedere alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="b885e-119">The build process restores npm dependencies on the first run, which can take several minutes.</span></span> <span data-ttu-id="b885e-120">Le compilazioni successive sono molto più veloce.</span><span class="sxs-lookup"><span data-stu-id="b885e-120">Subsequent builds are much faster.</span></span>

# <a name="net-core-clitabnetcore-cli"></a>[<span data-ttu-id="b885e-121">Interfaccia della riga di comando di .NET Core</span><span class="sxs-lookup"><span data-stu-id="b885e-121">.NET Core CLI</span></span>](#tab/netcore-cli/)

<span data-ttu-id="b885e-122">Assicurarsi di disporre di una variabile di ambiente denominata `ASPNETCORE_Environment` con un valore di `Development`.</span><span class="sxs-lookup"><span data-stu-id="b885e-122">Ensure you have an environment variable called `ASPNETCORE_Environment` with a value of `Development`.</span></span> <span data-ttu-id="b885e-123">In Windows (in istruzioni non PowerShell), eseguire `SET ASPNETCORE_Environment=Development`.</span><span class="sxs-lookup"><span data-stu-id="b885e-123">On Windows (in non-PowerShell prompts), run `SET ASPNETCORE_Environment=Development`.</span></span> <span data-ttu-id="b885e-124">In Linux o Mac OS, eseguire `export ASPNETCORE_Environment=Development`.</span><span class="sxs-lookup"><span data-stu-id="b885e-124">On Linux or macOS, run `export ASPNETCORE_Environment=Development`.</span></span>

<span data-ttu-id="b885e-125">Eseguire [compilazione dotnet](/dotnet/core/tools/dotnet-build) di verificare l'applicazione venga compilata correttamente.</span><span class="sxs-lookup"><span data-stu-id="b885e-125">Run [dotnet build](/dotnet/core/tools/dotnet-build) to verify the app builds correctly.</span></span> <span data-ttu-id="b885e-126">Alla prima esecuzione, il processo di compilazione consente di ripristinare le dipendenze di npm, che possono richiedere alcuni minuti.</span><span class="sxs-lookup"><span data-stu-id="b885e-126">On the first run, the build process restores npm dependencies, which can take several minutes.</span></span> <span data-ttu-id="b885e-127">Le compilazioni successive sono molto più veloce.</span><span class="sxs-lookup"><span data-stu-id="b885e-127">Subsequent builds are much faster.</span></span>

<span data-ttu-id="b885e-128">Eseguire [dotnet eseguire](/dotnet/core/tools/dotnet-run) per avviare l'app.</span><span class="sxs-lookup"><span data-stu-id="b885e-128">Run [dotnet run](/dotnet/core/tools/dotnet-run) to start the app.</span></span> <span data-ttu-id="b885e-129">Viene registrato un messaggio simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="b885e-129">A message similar to the following is logged:</span></span>

```console
Now listening on: http://localhost:<port>
```

<span data-ttu-id="b885e-130">Passare a questo URL in un browser.</span><span class="sxs-lookup"><span data-stu-id="b885e-130">Navigate to this URL in a browser.</span></span>

<span data-ttu-id="b885e-131">L'app viene avviata un'istanza del server CLI angolare in background.</span><span class="sxs-lookup"><span data-stu-id="b885e-131">The app starts up an instance of the Angular CLI server in the background.</span></span> <span data-ttu-id="b885e-132">Viene registrato un messaggio simile al seguente: <em>NG in tempo reale il Server di sviluppo è in ascolto su localhost:&lt;otherport&gt;, aprire il browser sul http://localhost:&lt; otherport&gt; /</em>  .</span><span class="sxs-lookup"><span data-stu-id="b885e-132">A message similar to the following is logged: <em>NG Live Development Server is listening on localhost:&lt;otherport&gt;, open your browser on http://localhost:&lt;otherport&gt;/</em>.</span></span> <span data-ttu-id="b885e-133">Ignorare questo messaggio&mdash;ha <strong>non</strong> l'URL per l'applicazione ASP.NET Core e CLI angolare combinato.</span><span class="sxs-lookup"><span data-stu-id="b885e-133">Ignore this message&mdash;it's <strong>not</strong> the URL for the combined ASP.NET Core and Angular CLI app.</span></span>

---

<span data-ttu-id="b885e-134">Il modello di progetto crea un'applicazione ASP.NET Core e un'app angolare.</span><span class="sxs-lookup"><span data-stu-id="b885e-134">The project template creates an ASP.NET Core app and an Angular app.</span></span> <span data-ttu-id="b885e-135">L'applicazione ASP.NET di base deve essere utilizzato per l'accesso ai dati, l'autorizzazione e altri problemi sul lato server.</span><span class="sxs-lookup"><span data-stu-id="b885e-135">The ASP.NET Core app is intended to be used for data access, authorization, and other server-side concerns.</span></span> <span data-ttu-id="b885e-136">L'app angolare, che si trovano nel *ClientApp* sottodirectory, dovrà essere utilizzato per tutti i problemi dell'interfaccia utente.</span><span class="sxs-lookup"><span data-stu-id="b885e-136">The Angular app, residing in the *ClientApp* subdirectory, is intended to be used for all UI concerns.</span></span>

## <a name="add-pages-images-styles-modules-etc"></a><span data-ttu-id="b885e-137">Aggiungere pagine, immagini, stili, moduli e così via.</span><span class="sxs-lookup"><span data-stu-id="b885e-137">Add pages, images, styles, modules, etc.</span></span>

<span data-ttu-id="b885e-138">Il *ClientApp* directory contiene un'app CLI angolare standard.</span><span class="sxs-lookup"><span data-stu-id="b885e-138">The *ClientApp* directory contains a standard Angular CLI app.</span></span> <span data-ttu-id="b885e-139">Vedere ufficiali [documentazione angolare](https://github.com/angular/angular-cli/wiki) per ulteriori informazioni.</span><span class="sxs-lookup"><span data-stu-id="b885e-139">See the official [Angular documentation](https://github.com/angular/angular-cli/wiki) for more information.</span></span>

<span data-ttu-id="b885e-140">Vi sono piccole differenze tra l'app angolare creato da questo modello e quello creato da angolare CLI (tramite `ng new`); tuttavia, non vengono modificate le funzionalità dell'app.</span><span class="sxs-lookup"><span data-stu-id="b885e-140">There are slight differences between the Angular app created by this template and the one created by Angular CLI itself (via `ng new`); however, the app's capabilities are unchanged.</span></span> <span data-ttu-id="b885e-141">L'app creata tramite il modello contiene un [Bootstrap](https://getbootstrap.com/)-base di layout e un esempio di routing di base.</span><span class="sxs-lookup"><span data-stu-id="b885e-141">The app created by the template contains a [Bootstrap](https://getbootstrap.com/)-based layout and a basic routing example.</span></span>

## <a name="run-ng-commands"></a><span data-ttu-id="b885e-142">Eseguire i comandi ng</span><span class="sxs-lookup"><span data-stu-id="b885e-142">Run ng commands</span></span>

<span data-ttu-id="b885e-143">In un prompt dei comandi, passare il *ClientApp* sottodirectory:</span><span class="sxs-lookup"><span data-stu-id="b885e-143">In a command prompt, switch to the *ClientApp* subdirectory:</span></span>

```console
cd ClientApp
```

<span data-ttu-id="b885e-144">Se si dispone di `ng` strumento installato globalmente, è possibile eseguire i relativi comandi.</span><span class="sxs-lookup"><span data-stu-id="b885e-144">If you have the `ng` tool installed globally, you can run any of its commands.</span></span> <span data-ttu-id="b885e-145">Ad esempio, è possibile eseguire `ng lint`, `ng test`, o qualsiasi altra [i comandi CLI angolare](https://github.com/angular/angular-cli/wiki#additional-commands).</span><span class="sxs-lookup"><span data-stu-id="b885e-145">For example, you can run `ng lint`, `ng test`, or any of the other [Angular CLI commands](https://github.com/angular/angular-cli/wiki#additional-commands).</span></span> <span data-ttu-id="b885e-146">Non è necessario eseguire `ng serve` , tuttavia, poiché l'app ASP.NET Core si occupa del lato server sia lato client parti dell'app.</span><span class="sxs-lookup"><span data-stu-id="b885e-146">There's no need to run `ng serve` though, because your ASP.NET Core app deals with serving both server-side and client-side parts of your app.</span></span> <span data-ttu-id="b885e-147">Internamente, viene utilizzato `ng serve` in fase di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b885e-147">Internally, it uses `ng serve` in development.</span></span>

<span data-ttu-id="b885e-148">Se non si dispone di `ng` strumento installato, eseguire `npm run ng` invece.</span><span class="sxs-lookup"><span data-stu-id="b885e-148">If you don't have the `ng` tool installed, run `npm run ng` instead.</span></span> <span data-ttu-id="b885e-149">Ad esempio, è possibile eseguire `npm run ng lint` o `npm run ng test`.</span><span class="sxs-lookup"><span data-stu-id="b885e-149">For example, you can run `npm run ng lint` or `npm run ng test`.</span></span>

## <a name="install-npm-packages"></a><span data-ttu-id="b885e-150">Installa nuovi pacchetti npm</span><span class="sxs-lookup"><span data-stu-id="b885e-150">Install npm packages</span></span>

<span data-ttu-id="b885e-151">Per installare i pacchetti di terze parti npm, utilizzare un prompt dei comandi nel *ClientApp* sottodirectory.</span><span class="sxs-lookup"><span data-stu-id="b885e-151">To install third-party npm packages, use a command prompt in the *ClientApp* subdirectory.</span></span> <span data-ttu-id="b885e-152">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="b885e-152">For example:</span></span>

```console
cd ClientApp
npm install --save <package_name>
```

## <a name="publish-and-deploy"></a><span data-ttu-id="b885e-153">Pubblicare e distribuire</span><span class="sxs-lookup"><span data-stu-id="b885e-153">Publish and deploy</span></span>

<span data-ttu-id="b885e-154">In fase di sviluppo, l'app viene eseguita in modalità ottimizzata per praticità per sviluppatori.</span><span class="sxs-lookup"><span data-stu-id="b885e-154">In development, the app runs in a mode optimized for developer convenience.</span></span> <span data-ttu-id="b885e-155">Ad esempio, JavaScript bundle includono mapping di origine (in modo che durante il debug, è possibile visualizzare il codice TypeScript originale).</span><span class="sxs-lookup"><span data-stu-id="b885e-155">For example, JavaScript bundles include source maps (so that when debugging, you can see your original TypeScript code).</span></span> <span data-ttu-id="b885e-156">L'applicazione verifica la presenza di modifiche al file TypeScript, HTML e CSS nel disco automaticamente ricompilazioni e ricarica quando rileva tali file modificare.</span><span class="sxs-lookup"><span data-stu-id="b885e-156">The app watches for TypeScript, HTML, and CSS file changes on disk and automatically recompiles and reloads when it sees those files change.</span></span>

<span data-ttu-id="b885e-157">Nell'ambiente di produzione, utilizzare una versione dell'app che è ottimizzato per le prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b885e-157">In production, serve a version of your app that's optimized for performance.</span></span> <span data-ttu-id="b885e-158">Questo è configurato per eseguire automaticamente.</span><span class="sxs-lookup"><span data-stu-id="b885e-158">This is configured to happen automatically.</span></span> <span data-ttu-id="b885e-159">Quando si pubblica, la configurazione della build genera un minimizzata, ahead di tempo (AoT) compilati compilazione del codice sul lato client.</span><span class="sxs-lookup"><span data-stu-id="b885e-159">When you publish, the build configuration emits a minified, ahead-of-time (AoT) compiled build of your client-side code.</span></span> <span data-ttu-id="b885e-160">A differenza della compilazione di sviluppo, la compilazione di produzione non richiede Node.js essere installato nel server (a meno che non è stato abilitato [il rendering preliminare sul lato server](#server-side-rendering)).</span><span class="sxs-lookup"><span data-stu-id="b885e-160">Unlike the development build, the production build doesn't require Node.js to be installed on the server (unless you have enabled [server-side prerendering](#server-side-rendering)).</span></span>

<span data-ttu-id="b885e-161">È possibile utilizzare standard [metodi di distribuzione e hosting ASP.NET Core](xref:host-and-deploy/index).</span><span class="sxs-lookup"><span data-stu-id="b885e-161">You can use standard [ASP.NET Core hosting and deployment methods](xref:host-and-deploy/index).</span></span>

## <a name="run-ng-serve-independently"></a><span data-ttu-id="b885e-162">Eseguire "ng serve" in modo indipendente</span><span class="sxs-lookup"><span data-stu-id="b885e-162">Run "ng serve" independently</span></span>

<span data-ttu-id="b885e-163">Il progetto è configurato per avviare la propria istanza del server CLI angolare in background all'avvio dell'app di ASP.NET Core in modalità di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b885e-163">The project is configured to start its own instance of the Angular CLI server in the background when the ASP.NET Core app starts in development mode.</span></span> <span data-ttu-id="b885e-164">Ciò risulta utile in quanto non è necessario eseguire manualmente un server separato.</span><span class="sxs-lookup"><span data-stu-id="b885e-164">This is convenient because you don't have to run a separate server manually.</span></span>

<span data-ttu-id="b885e-165">È uno svantaggio di questo programma di installazione predefinito.</span><span class="sxs-lookup"><span data-stu-id="b885e-165">There's a drawback to this default setup.</span></span> <span data-ttu-id="b885e-166">Ogni volta che si modifica il codice c# e il ASP.NET Core app richiede il riavvio, il server di CLI angolare viene riavviato.</span><span class="sxs-lookup"><span data-stu-id="b885e-166">Each time you modify your C# code and your ASP.NET Core app needs to restart, the Angular CLI server restarts.</span></span> <span data-ttu-id="b885e-167">Per avviare il backup, è necessario circa 10 secondi.</span><span class="sxs-lookup"><span data-stu-id="b885e-167">Around 10 seconds is required to start back up.</span></span> <span data-ttu-id="b885e-168">Se si apportano spesso modifiche al codice c# e non si desidera attendere angolare CLI il riavvio, eseguire il server di CLI angolare esternamente, indipendentemente dal processo ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="b885e-168">If you're making frequent C# code edits and don't want to wait for Angular CLI to restart, run the Angular CLI server externally, independently of the ASP.NET Core process.</span></span> <span data-ttu-id="b885e-169">A tale scopo:</span><span class="sxs-lookup"><span data-stu-id="b885e-169">To do so:</span></span>

1. <span data-ttu-id="b885e-170">In un prompt dei comandi, passare il *ClientApp* sottodirectory e avviare il server di sviluppo CLI angolare:</span><span class="sxs-lookup"><span data-stu-id="b885e-170">In a command prompt, switch to the *ClientApp* subdirectory, and launch the Angular CLI development server:</span></span>

    ```console
    cd ClientApp
    npm start
    ```

    > [!IMPORTANT]
    > <span data-ttu-id="b885e-171">Utilizzare `npm start` per avviare il server di sviluppo angolare CLI non `ng serve`, in modo che la configurazione in *package. JSON* viene rispettato.</span><span class="sxs-lookup"><span data-stu-id="b885e-171">Use `npm start` to launch the Angular CLI development server, not `ng serve`, so that the configuration in *package.json* is respected.</span></span> <span data-ttu-id="b885e-172">Per passare parametri aggiuntivi al server angolare CLI, aggiungerli alla pertinente `scripts` riga il *package. JSON* file.</span><span class="sxs-lookup"><span data-stu-id="b885e-172">To pass additional parameters to the Angular CLI server, add them to the relevant `scripts` line in your *package.json* file.</span></span>

2. <span data-ttu-id="b885e-173">Modificare l'applicazione ASP.NET Core per utilizzare l'istanza di CLI angolare esterno anziché avviare uno dei propri.</span><span class="sxs-lookup"><span data-stu-id="b885e-173">Modify your ASP.NET Core app to use the external Angular CLI instance instead of launching one of its own.</span></span> <span data-ttu-id="b885e-174">Nel *avvio* classe, sostituire il `spa.UseAngularCliServer` chiamata con quanto segue:</span><span class="sxs-lookup"><span data-stu-id="b885e-174">In your *Startup* class, replace the `spa.UseAngularCliServer` invocation with the following:</span></span>

    ```csharp
    spa.UseProxyToSpaDevelopmentServer("http://localhost:4200");
    ```

<span data-ttu-id="b885e-175">Quando si avvia l'app ASP.NET Core, non verrà avviato un server di CLI angolare.</span><span class="sxs-lookup"><span data-stu-id="b885e-175">When you start your ASP.NET Core app, it won't launch an Angular CLI server.</span></span> <span data-ttu-id="b885e-176">Viene utilizzato l'istanza che è stato avviato manualmente.</span><span class="sxs-lookup"><span data-stu-id="b885e-176">The instance you started manually is used instead.</span></span> <span data-ttu-id="b885e-177">Ciò consente di avviare e riavviare più velocemente.</span><span class="sxs-lookup"><span data-stu-id="b885e-177">This enables it to start and restart faster.</span></span> <span data-ttu-id="b885e-178">Non è in attesa per CLI angolare ricompilare l'app client ogni volta.</span><span class="sxs-lookup"><span data-stu-id="b885e-178">It's no longer waiting for Angular CLI to rebuild your client app each time.</span></span>

## <a name="server-side-rendering"></a><span data-ttu-id="b885e-179">Rendering lato server</span><span class="sxs-lookup"><span data-stu-id="b885e-179">Server-side rendering</span></span>

<span data-ttu-id="b885e-180">Come una funzionalità di prestazioni, è possibile pre-eseguire il rendering dell'app angolare sul server, nonché a eseguirlo sul client.</span><span class="sxs-lookup"><span data-stu-id="b885e-180">As a performance feature, you can choose to pre-render your Angular app on the server as well as running it on the client.</span></span> <span data-ttu-id="b885e-181">Ciò significa che i browser ricevano il markup HTML che rappresenta di interfaccia utente iniziale dell'app, in modo che contengano anche prima del download e l'esecuzione i bundle di JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b885e-181">This means that browsers receive HTML markup representing your app's initial UI, so they display it even before downloading and executing your JavaScript bundles.</span></span> <span data-ttu-id="b885e-182">La maggior parte dell'implementazione di questo proviene da una funzione angolare [angolare universale](https://universal.angular.io/).</span><span class="sxs-lookup"><span data-stu-id="b885e-182">Most of the implementation of this comes from an Angular feature called [Angular Universal](https://universal.angular.io/).</span></span>

> [!TIP]
> <span data-ttu-id="b885e-183">Abilitazione di rendering lato server (SSR) introduce un numero di complessità aggiuntiva sia durante lo sviluppo e distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b885e-183">Enabling server-side rendering (SSR) introduces a number of extra complications both during development and deployment.</span></span> <span data-ttu-id="b885e-184">Lettura [svantaggi SSR](#drawbacks-of-ssr) per determinare se SSR è una scelta ottimale per le proprie esigenze.</span><span class="sxs-lookup"><span data-stu-id="b885e-184">Read [drawbacks of SSR](#drawbacks-of-ssr) to determine if SSR is a good fit for your requirements.</span></span>

<span data-ttu-id="b885e-185">Per abilitare SSR, è necessario eseguire un certo numero di aggiunte al progetto.</span><span class="sxs-lookup"><span data-stu-id="b885e-185">To enable SSR, you need to make a number of additions to your project.</span></span>

<span data-ttu-id="b885e-186">Nel *avvio* (classe), *dopo* la riga che configura `spa.Options.SourcePath`, e *prima* la chiamata a `UseAngularCliServer` o `UseProxyToSpaDevelopmentServer`, aggiungere quanto segue:</span><span class="sxs-lookup"><span data-stu-id="b885e-186">In the *Startup* class, *after* the line that configures `spa.Options.SourcePath`, and *before* the call to `UseAngularCliServer` or `UseProxyToSpaDevelopmentServer`, add the following:</span></span>

[!code-csharp[](sample/AngularServerSideRendering/Startup.cs?name=snippet_Call_UseSpa&highlight=5-12)]

<span data-ttu-id="b885e-187">In modalità di sviluppo, il codice tenta di compilare il bundle SSR eseguendo lo script `build:ssr`, definito in *ClientApp\package.json*.</span><span class="sxs-lookup"><span data-stu-id="b885e-187">In development mode, this code attempts to build the SSR bundle by running the script `build:ssr`, which is defined in *ClientApp\package.json*.</span></span> <span data-ttu-id="b885e-188">Si compila un'app angolare denominata `ssr`, che non è ancora definita.</span><span class="sxs-lookup"><span data-stu-id="b885e-188">This builds an Angular app named `ssr`, which isn't yet defined.</span></span> 

<span data-ttu-id="b885e-189">Alla fine del `apps` matrice *ClientApp/.angular-cli.json*, definire un'app aggiuntiva con nome `ssr`.</span><span class="sxs-lookup"><span data-stu-id="b885e-189">At the end of the `apps` array in *ClientApp/.angular-cli.json*, define an extra app with name `ssr`.</span></span> <span data-ttu-id="b885e-190">Utilizzare le opzioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b885e-190">Use the following options:</span></span>

[!code-json[](sample/AngularServerSideRendering/ClientApp/.angular-cli.json?range=24-41)]

<span data-ttu-id="b885e-191">La configurazione della nuova app abilitata SSR richiede due file ulteriore: *tsconfig.server.json* e *main.server.ts*.</span><span class="sxs-lookup"><span data-stu-id="b885e-191">This new SSR-enabled app configuration requires two further files: *tsconfig.server.json* and *main.server.ts*.</span></span> <span data-ttu-id="b885e-192">Il *tsconfig.server.json* file specifica le opzioni di compilazione TypeScript.</span><span class="sxs-lookup"><span data-stu-id="b885e-192">The *tsconfig.server.json* file specifies TypeScript compilation options.</span></span> <span data-ttu-id="b885e-193">Il *main.server.ts* file viene utilizzato come il punto di ingresso del codice durante SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-193">The *main.server.ts* file serves as the code entry point during SSR.</span></span>

<span data-ttu-id="b885e-194">Aggiungere un nuovo file denominato *tsconfig.server.json* all'interno di *ClientApp/src* (insieme esistente *tsconfig.app.json*), che contiene le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b885e-194">Add a new file called *tsconfig.server.json* inside *ClientApp/src* (alongside the existing *tsconfig.app.json*), containing the following:</span></span>

[!code-json[](sample/AngularServerSideRendering/ClientApp/src/tsconfig.server.json)]

<span data-ttu-id="b885e-195">Questo file Configura del compilatore AoT del angolare per individuare un modulo denominato `app.server.module`.</span><span class="sxs-lookup"><span data-stu-id="b885e-195">This file configures Angular's AoT compiler to look for a module called `app.server.module`.</span></span> <span data-ttu-id="b885e-196">Aggiungere questo elemento mediante la creazione di un nuovo file in *ClientApp/src/app/app.server.module.ts* (insieme esistente *app.module.ts*) contenente le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b885e-196">Add this by creating a new file at *ClientApp/src/app/app.server.module.ts* (alongside the existing *app.module.ts*) containing the following:</span></span> 

[!code-typescript[](sample/AngularServerSideRendering/ClientApp/src/app/app.server.module.ts)]

<span data-ttu-id="b885e-197">Questo modulo eredita da sul lato client `app.module` e definisce i moduli Angular aggiuntive sono disponibili durante SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-197">This module inherits from your client-side `app.module` and defines which extra Angular modules are available during SSR.</span></span>

<span data-ttu-id="b885e-198">Tenere presente che il nuovo `ssr` voce *.angular cli.json* a cui fa riferimento a un file del punto di ingresso chiamato *main.server.ts*.</span><span class="sxs-lookup"><span data-stu-id="b885e-198">Recall that the new `ssr` entry in *.angular-cli.json* referenced an entry point file called *main.server.ts*.</span></span> <span data-ttu-id="b885e-199">Ancora non sono stati aggiunti file e a questo punto è necessario eseguire questa operazione.</span><span class="sxs-lookup"><span data-stu-id="b885e-199">You haven't yet added that file, and now is time to do so.</span></span> <span data-ttu-id="b885e-200">Creare un nuovo file in *ClientApp/src/main.server.ts* (insieme esistente *main.ts*), che contiene le operazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="b885e-200">Create a new file at *ClientApp/src/main.server.ts* (alongside the existing *main.ts*), containing the following:</span></span>

[!code-typescript[](sample/AngularServerSideRendering/ClientApp/src/main.server.ts)]

<span data-ttu-id="b885e-201">Codice di questo file viene ASP.NET Core eseguito per ogni richiesta durante l'esecuzione di `UseSpaPrerendering` middleware che è stato aggiunto per il *avvio* classe.</span><span class="sxs-lookup"><span data-stu-id="b885e-201">This file's code is what ASP.NET Core executes for each request when it runs the `UseSpaPrerendering` middleware that you added to the *Startup* class.</span></span> <span data-ttu-id="b885e-202">Si occupa delle ricezione `params` dal codice di .NET (ad esempio l'URL richiesto) e chiamate alle API SSR angolare per ottenere il codice HTML risultante.</span><span class="sxs-lookup"><span data-stu-id="b885e-202">It deals with receiving `params` from the .NET code (such as the URL being requested), and making calls to Angular SSR APIs to get the resulting HTML.</span></span> 

<span data-ttu-id="b885e-203">In-senso stretto, ciò è sufficiente abilitare SSR in modalità di sviluppo.</span><span class="sxs-lookup"><span data-stu-id="b885e-203">Strictly-speaking, this is sufficient to enable SSR in development mode.</span></span> <span data-ttu-id="b885e-204">È essenziale per apportare una modifica finale in modo che l'app funziona correttamente quando pubblicato.</span><span class="sxs-lookup"><span data-stu-id="b885e-204">It's essential to make one final change so that your app works correctly when published.</span></span> <span data-ttu-id="b885e-205">Nella finestra principale dell'app *csproj* file, impostare il `BuildServerSideRenderer` valore della proprietà da `true`:</span><span class="sxs-lookup"><span data-stu-id="b885e-205">In your app's main *.csproj* file, set the `BuildServerSideRenderer` property value to `true`:</span></span>

[!code-xml[](sample/AngularServerSideRendering/AngularServerSideRendering.csproj?name=snippet_EnableBuildServerSideRenderer)]

<span data-ttu-id="b885e-206">In questo modo il processo di compilazione per eseguire `build:ssr` durante la pubblicazione e distribuzione dei file SSR al server.</span><span class="sxs-lookup"><span data-stu-id="b885e-206">This configures the build process to run `build:ssr` during publishing and deploy the SSR files to the server.</span></span> <span data-ttu-id="b885e-207">Se non si abilita questa SSR ha esito negativo in fase di produzione.</span><span class="sxs-lookup"><span data-stu-id="b885e-207">If you don't enable this, SSR fails in production.</span></span>

<span data-ttu-id="b885e-208">Quando l'app viene eseguita in modalità di sviluppo o di produzione, il codice angolare pre-esegue il rendering in formato HTML nel server.</span><span class="sxs-lookup"><span data-stu-id="b885e-208">When your app runs in either development or production mode, the Angular code pre-renders as HTML on the server.</span></span> <span data-ttu-id="b885e-209">Il codice sul lato client viene eseguito normalmente.</span><span class="sxs-lookup"><span data-stu-id="b885e-209">The client-side code executes as normal.</span></span>

### <a name="pass-data-from-net-code-into-typescript-code"></a><span data-ttu-id="b885e-210">Passare i dati dal codice .NET nel codice TypeScript</span><span class="sxs-lookup"><span data-stu-id="b885e-210">Pass data from .NET code into TypeScript code</span></span>

<span data-ttu-id="b885e-211">Durante SSR, si potrebbe decidere di passare dati per ogni richiesta dall'app ASP.NET Core nell'app angolare.</span><span class="sxs-lookup"><span data-stu-id="b885e-211">During SSR, you might want to pass per-request data from your ASP.NET Core app into your Angular app.</span></span> <span data-ttu-id="b885e-212">Ad esempio, è possibile passare le informazioni sui cookie o un elemento leggere da un database.</span><span class="sxs-lookup"><span data-stu-id="b885e-212">For example, you could pass cookie information or something read from a database.</span></span> <span data-ttu-id="b885e-213">A tale scopo, modificare il *avvio* classe.</span><span class="sxs-lookup"><span data-stu-id="b885e-213">To do this, edit your *Startup* class.</span></span> <span data-ttu-id="b885e-214">Nel callback per `UseSpaPrerendering`, impostare un valore per `options.SupplyData` come illustrato di seguito:</span><span class="sxs-lookup"><span data-stu-id="b885e-214">In the callback for `UseSpaPrerendering`, set a value for `options.SupplyData` such as the following:</span></span>

```csharp
options.SupplyData = (context, data) =>
{
    // Creates a new value called isHttpsRequest that's passed to TypeScript code
    data["isHttpsRequest"] = context.Request.IsHttps;
};
```

<span data-ttu-id="b885e-215">Il `SupplyData` consente di callback di passare arbitrario, per ogni richiesta, dati serializzabili con JSON (ad esempio stringhe, valori booleani o numeri).</span><span class="sxs-lookup"><span data-stu-id="b885e-215">The `SupplyData` callback lets you pass arbitrary, per-request, JSON-serializable data (for example, strings, booleans, or numbers).</span></span> <span data-ttu-id="b885e-216">Il *main.server.ts* codice riceve come `params.data`.</span><span class="sxs-lookup"><span data-stu-id="b885e-216">Your *main.server.ts* code receives this as `params.data`.</span></span> <span data-ttu-id="b885e-217">Ad esempio, l'esempio di codice precedente passa un valore booleano come `params.data.isHttpsRequest` nel `createServerRenderer` callback.</span><span class="sxs-lookup"><span data-stu-id="b885e-217">For example, the preceding code sample passes a boolean value as `params.data.isHttpsRequest` into the `createServerRenderer` callback.</span></span> <span data-ttu-id="b885e-218">Questo è possibile passare ad altre parti dell'app in qualsiasi modo supportato dal angolare.</span><span class="sxs-lookup"><span data-stu-id="b885e-218">You can pass this to other parts of your app in any way supported by Angular.</span></span> <span data-ttu-id="b885e-219">Ad esempio, vedere come *main.server.ts* passa il `BASE_URL` valore a qualsiasi componente il cui costruttore viene dichiarato per la ricezione.</span><span class="sxs-lookup"><span data-stu-id="b885e-219">For example, see how *main.server.ts* passes the `BASE_URL` value to any component whose constructor is declared to receive it.</span></span>

### <a name="drawbacks-of-ssr"></a><span data-ttu-id="b885e-220">Svantaggi di SSR</span><span class="sxs-lookup"><span data-stu-id="b885e-220">Drawbacks of SSR</span></span>

<span data-ttu-id="b885e-221">Non tutte le app trarre vantaggio da SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-221">Not all apps benefit from SSR.</span></span> <span data-ttu-id="b885e-222">Il vantaggio principale viene percepito delle prestazioni.</span><span class="sxs-lookup"><span data-stu-id="b885e-222">The primary benefit is perceived performance.</span></span> <span data-ttu-id="b885e-223">Visitatori raggiungere l'app tramite una connessione di rete lenta o nei dispositivi mobili lenta vedere interfaccia utente iniziale rapidamente, anche se occorre un po' di tempo per recuperare o analizzare i bundle di JavaScript.</span><span class="sxs-lookup"><span data-stu-id="b885e-223">Visitors reaching your app over a slow network connection or on slow mobile devices see the initial UI quickly, even if it takes a while to fetch or parse the JavaScript bundles.</span></span> <span data-ttu-id="b885e-224">Tuttavia, molti SPAs sono usata principalmente su reti aziendali interne, veloce nei computer veloci in cui l'app viene visualizzata quasi istantaneamente.</span><span class="sxs-lookup"><span data-stu-id="b885e-224">However, many SPAs are mainly used over fast, internal company networks on fast computers where the app appears almost instantly.</span></span>

<span data-ttu-id="b885e-225">Allo stesso tempo, esistono alcune limitazioni significative all'abilitazione SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-225">At the same time, there are significant drawbacks to enabling SSR.</span></span> <span data-ttu-id="b885e-226">Il processo di sviluppo aumenta la complessità.</span><span class="sxs-lookup"><span data-stu-id="b885e-226">It adds complexity to your development process.</span></span> <span data-ttu-id="b885e-227">Il codice deve essere eseguito in due diversi ambienti: lato client e lato server (in un ambiente di Node.js richiamato da ASP.NET Core).</span><span class="sxs-lookup"><span data-stu-id="b885e-227">Your code must run in two different environments: client-side and server-side (in a Node.js environment invoked from ASP.NET Core).</span></span> <span data-ttu-id="b885e-228">Di seguito sono illustrati alcuni aspetti da tenere presente:</span><span class="sxs-lookup"><span data-stu-id="b885e-228">Here are some things to bear in mind:</span></span>

* <span data-ttu-id="b885e-229">SSR richiede un'installazione di Node.js nei server di produzione.</span><span class="sxs-lookup"><span data-stu-id="b885e-229">SSR requires a Node.js installation on your production servers.</span></span> <span data-ttu-id="b885e-230">Ciò avviene automaticamente per alcuni scenari di distribuzione, ad esempio servizi di App di Azure, ma non per altri utenti, ad esempio Azure Service Fabric.</span><span class="sxs-lookup"><span data-stu-id="b885e-230">This is automatically the case for some deployment scenarios, such as Azure App Services, but not for others, such as Azure Service Fabric.</span></span>
* <span data-ttu-id="b885e-231">Abilitazione di `BuildServerSideRenderer` cause di flag di compilazione il *node_modules* directory per la pubblicazione.</span><span class="sxs-lookup"><span data-stu-id="b885e-231">Enabling the `BuildServerSideRenderer` build flag causes your *node_modules* directory to publish.</span></span> <span data-ttu-id="b885e-232">Questa cartella contiene 20.000 file, che aumenta il tempo di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="b885e-232">This folder contains 20,000+ files, which increases deployment time.</span></span>
* <span data-ttu-id="b885e-233">Per eseguire il codice in un ambiente di Node.js, è possibile basarsi sull'esistenza di specifiche del browser JavaScript APIs, ad esempio `window` o `localStorage`.</span><span class="sxs-lookup"><span data-stu-id="b885e-233">To run your code in a Node.js environment, it can't rely on the existence of browser-specific JavaScript APIs such as `window` or `localStorage`.</span></span> <span data-ttu-id="b885e-234">Se il codice (o alcuni libreria di terze parti che si fa riferimento) tenta di utilizzare queste API, si otterrà un errore durante la SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-234">If your code (or some third-party library you reference) tries to use these APIs, you'll get an error during SSR.</span></span> <span data-ttu-id="b885e-235">Ad esempio, non utilizzare jQuery perché fa riferimento API specifiche del browser in numerose posizioni.</span><span class="sxs-lookup"><span data-stu-id="b885e-235">For example, don't use jQuery because it references browser-specific APIs in many places.</span></span> <span data-ttu-id="b885e-236">Per evitare errori, è necessario evitare SSR o evitare di API o librerie specifiche del browser.</span><span class="sxs-lookup"><span data-stu-id="b885e-236">To prevent errors, you must either avoid SSR or avoid browser-specific APIs or libraries.</span></span> <span data-ttu-id="b885e-237">È possibile eseguire il wrapping di tutte le chiamate a tali API nei controlli per assicurarsi che non vengono richiamati durante SSR.</span><span class="sxs-lookup"><span data-stu-id="b885e-237">You can wrap any calls to such APIs in checks to ensure they aren't invoked during SSR.</span></span> <span data-ttu-id="b885e-238">Nel codice JavaScript o TypeScript, ad esempio, utilizzare un controllo simile al seguente:</span><span class="sxs-lookup"><span data-stu-id="b885e-238">For example, use a check such as the following in JavaScript or TypeScript code:</span></span>

    ```javascript
    if (typeof window !== 'undefined') {
        // Call browser-specific APIs here
    }
    ```

---
title: Inserimento delle dipendenze in ASP.NET Core
author: ardalis
description: Informazioni su come ASP.NET Core implementa l'inserimento delle dipendenze e su come usare questa funzionalità.
manager: wpickett
ms.author: riande
ms.custom: H1Hack27Feb2017
ms.date: 10/14/2016
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: fundamentals/dependency-injection
ms.openlocfilehash: 067d9bd09f6d5e54bbafd953eea169d2df2be34e
ms.sourcegitcommit: a66f38071e13685bbe59d48d22aa141ac702b432
ms.translationtype: HT
ms.contentlocale: it-IT
ms.lasthandoff: 05/17/2018
---
# <a name="dependency-injection-in-aspnet-core"></a><span data-ttu-id="e2893-103">Inserimento delle dipendenze in ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="e2893-103">Dependency injection in ASP.NET Core</span></span>

<a name="fundamentals-dependency-injection"></a>

<span data-ttu-id="e2893-104">[Steve Smith](https://ardalis.com/) e [Scott Addie](https://scottaddie.com)</span><span class="sxs-lookup"><span data-stu-id="e2893-104">By [Steve Smith](https://ardalis.com/) and [Scott Addie](https://scottaddie.com)</span></span>

<span data-ttu-id="e2893-105">ASP.NET Core è stato interamente progettato per supportare e usare l'inserimento delle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-105">ASP.NET Core is designed from the ground up to support and leverage dependency injection.</span></span> <span data-ttu-id="e2893-106">Le applicazioni ASP.NET Core possono usare servizi di framework incorporati inserendoli nei metodi nella classe Startup, mentre anche i servizi di applicazione possono essere configurati per l'inserimento.</span><span class="sxs-lookup"><span data-stu-id="e2893-106">ASP.NET Core applications can leverage built-in framework services by having them injected into methods in the Startup class, and application services can be configured for injection as well.</span></span> <span data-ttu-id="e2893-107">Il contenitore di servizi predefinito incluso in ASP.NET Core offre un insieme di funzionalità di base e non è stato progettato per sostituire altri contenitori.</span><span class="sxs-lookup"><span data-stu-id="e2893-107">The default services container provided by ASP.NET Core provides a minimal feature set and isn't intended to replace other containers.</span></span>

<span data-ttu-id="e2893-108">[Visualizzare o scaricare il codice di esempio](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/dependency-injection/sample) ([procedura per il download](xref:tutorials/index#how-to-download-a-sample))</span><span class="sxs-lookup"><span data-stu-id="e2893-108">[View or download sample code](https://github.com/aspnet/Docs/tree/master/aspnetcore/fundamentals/dependency-injection/sample) ([how to download](xref:tutorials/index#how-to-download-a-sample))</span></span>

## <a name="what-is-dependency-injection"></a><span data-ttu-id="e2893-109">Che cos'è l'inserimento delle dipendenze?</span><span class="sxs-lookup"><span data-stu-id="e2893-109">What is dependency injection?</span></span>

<span data-ttu-id="e2893-110">L'inserimento delle dipendenze (Dependency Injection, DI)è una tecnica per ottenere un regime di controllo libero tra gli oggetti e i relativi collaboratori o dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-110">Dependency injection (DI) is a technique for achieving loose coupling between objects and their collaborators, or dependencies.</span></span> <span data-ttu-id="e2893-111">Anziché creare direttamente un'istanza dei collaboratori o usare riferimenti statici, gli oggetti necessari a una classe per eseguire le azioni vengono forniti alla classe in qualche modo.</span><span class="sxs-lookup"><span data-stu-id="e2893-111">Rather than directly instantiating collaborators, or using static references, the objects a class needs in order to perform its actions are provided to the class in some fashion.</span></span> <span data-ttu-id="e2893-112">Nella maggior parte dei casi le classi dichiarano le loro dipendenze tramite il costruttore consentendo di seguire il [principio delle dipendenze esplicite](http://deviq.com/explicit-dependencies-principle/).</span><span class="sxs-lookup"><span data-stu-id="e2893-112">Most often, classes will declare their dependencies via their constructor, allowing them to follow the [Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/).</span></span> <span data-ttu-id="e2893-113">Questo approccio è chiamato "inserimento del costruttore".</span><span class="sxs-lookup"><span data-stu-id="e2893-113">This approach is known as "constructor injection".</span></span>

<span data-ttu-id="e2893-114">Quando vengono progettate tenendo presente l'inserimento delle dipendenze, le classi risultano accoppiate in modo più libero poiché non hanno dipendenze dirette e hardcoded sui relativi collaboratori.</span><span class="sxs-lookup"><span data-stu-id="e2893-114">When classes are designed with DI in mind, they're more loosely coupled because they don't have direct, hard-coded dependencies on their collaborators.</span></span> <span data-ttu-id="e2893-115">Ciò segue il [principio di inversione delle dipendenze](http://deviq.com/dependency-inversion-principle/) che afferma che *"i moduli di alto livello non devono dipendere da quelli di basso livello; entrambi devono dipendere da astrazioni".*</span><span class="sxs-lookup"><span data-stu-id="e2893-115">This follows the [Dependency Inversion Principle](http://deviq.com/dependency-inversion-principle/), which states that *"high level modules shouldn't depend on low level modules; both should depend on abstractions."*</span></span> <span data-ttu-id="e2893-116">Anziché fare riferimento a implementazioni specifiche, le classi richiedono astrazioni (in genere `interfaces`) che vengono fornite quando viene costruita la classe.</span><span class="sxs-lookup"><span data-stu-id="e2893-116">Instead of referencing specific implementations, classes request abstractions (typically `interfaces`) which are provided to them when the class is constructed.</span></span> <span data-ttu-id="e2893-117">Anche l'estrazione delle dipendenze nelle interfacce e la specifica delle implementazioni di queste interfacce come parametri sono un esempio dello [schema progettuale di strategia](http://deviq.com/strategy-design-pattern/).</span><span class="sxs-lookup"><span data-stu-id="e2893-117">Extracting dependencies into interfaces and providing implementations of these interfaces as parameters is also an example of the [Strategy design pattern](http://deviq.com/strategy-design-pattern/).</span></span>

<span data-ttu-id="e2893-118">Quando un sistema è progettato per l'utilizzo dell'inserimento delle dipendenze, con numerose classi che richiedono le relative dipendenze tramite il costruttore (o le proprietà), è utile avere una classe dedicata alla creazione di queste classi con le relative dipendenze associate.</span><span class="sxs-lookup"><span data-stu-id="e2893-118">When a system is designed to use DI, with many classes requesting their dependencies via their constructor (or properties), it's helpful to have a class dedicated to creating these classes with their associated dependencies.</span></span> <span data-ttu-id="e2893-119">Queste classi vengono chiamate *contenitori*, o più specificatamente contenitori di [inversione del controllo (IoC)](http://deviq.com/inversion-of-control/) o contenitori di inserimento delle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-119">These classes are referred to as *containers*, or more specifically, [Inversion of Control (IoC)](http://deviq.com/inversion-of-control/) containers or Dependency Injection (DI) containers.</span></span> <span data-ttu-id="e2893-120">Un contenitore è essenzialmente una factory che è responsabile di fornire le istanze dei tipi richiesti.</span><span class="sxs-lookup"><span data-stu-id="e2893-120">A container is essentially a factory that's responsible for providing instances of types that are requested from it.</span></span> <span data-ttu-id="e2893-121">Se un determinato tipo ha dichiarato di avere dipendenze e il contenitore è stato configurato per specificare i tipi di dipendenze, il tipo creerà le dipendenze come parte del processo di creazione dell'istanza richiesta.</span><span class="sxs-lookup"><span data-stu-id="e2893-121">If a given type has declared that it has dependencies, and the container has been configured to provide the dependency types, it will create the dependencies as part of creating the requested instance.</span></span> <span data-ttu-id="e2893-122">In questo modo è possibile fornire alle classi grafici delle dipendenze complessi senza la necessità di costruire oggetti hardcoded.</span><span class="sxs-lookup"><span data-stu-id="e2893-122">In this way, complex dependency graphs can be provided to classes without the need for any hard-coded object construction.</span></span> <span data-ttu-id="e2893-123">Oltre a creare gli oggetti con le relative dipendenze, i contenitori gestiscono in genere la durata degli oggetti all'interno dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-123">In addition to creating objects with their dependencies, containers typically manage object lifetimes within the application.</span></span>

<span data-ttu-id="e2893-124">ASP.NET Core include un semplice contenitore incorporato (rappresentato dall'interfaccia `IServiceProvider`) che supporta l'inserimento del costruttore per impostazione predefinita, mentre ASP.NET rende disponibili determinati servizi tramite l'inserimento delle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-124">ASP.NET Core includes a simple built-in container (represented by the `IServiceProvider` interface) that supports constructor injection by default, and ASP.NET makes certain services available through DI.</span></span> <span data-ttu-id="e2893-125">Il contenitore di ASP.NET fa riferimento ai tipi gestiti come *servizi*.</span><span class="sxs-lookup"><span data-stu-id="e2893-125">ASP.NET's container refers to the types it manages as *services*.</span></span> <span data-ttu-id="e2893-126">Nella parte restante di questo articolo il termine *servizi* fa riferimento ai tipi gestiti dal contenitore IoC di ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="e2893-126">Throughout the rest of this article, *services* will refer to types that are managed by ASP.NET Core's IoC container.</span></span> <span data-ttu-id="e2893-127">I servizi del contenitore incorporato vengono configurati nel metodo `ConfigureServices` nella classe `Startup` dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-127">You configure the built-in container's services in the `ConfigureServices` method in your application's `Startup` class.</span></span>

> [!NOTE]
> <span data-ttu-id="e2893-128">Martin Fowler ha scritto l'articolo [Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html) (Contenitori di inversione del controllo e modello di inserimento delle dipendenze).</span><span class="sxs-lookup"><span data-stu-id="e2893-128">Martin Fowler has written an extensive article on [Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html).</span></span> <span data-ttu-id="e2893-129">Una descrizione dell'[inserimento delle dipendenze](https://msdn.microsoft.com/library/hh323705.aspx) è disponibile anche in Microsoft Patterns and Practices.</span><span class="sxs-lookup"><span data-stu-id="e2893-129">Microsoft Patterns and Practices also has a great description of [Dependency Injection](https://msdn.microsoft.com/library/hh323705.aspx).</span></span>

> [!NOTE]
> <span data-ttu-id="e2893-130">Questo articolo descrive l'inserimento delle dipendenze poiché si applica a tutte le applicazioni ASP.NET.</span><span class="sxs-lookup"><span data-stu-id="e2893-130">This article covers Dependency Injection as it applies to all ASP.NET applications.</span></span> <span data-ttu-id="e2893-131">L'inserimento delle dipendenze all'interno di controller MVC è descritto in [Inserimento di dipendenze e controller](../mvc/controllers/dependency-injection.md).</span><span class="sxs-lookup"><span data-stu-id="e2893-131">Dependency Injection within MVC controllers is covered in [Dependency Injection and Controllers](../mvc/controllers/dependency-injection.md).</span></span>

### <a name="constructor-injection-behavior"></a><span data-ttu-id="e2893-132">Comportamento dell'inserimento del costruttore</span><span class="sxs-lookup"><span data-stu-id="e2893-132">Constructor injection behavior</span></span>

<span data-ttu-id="e2893-133">Per eseguire l'inserimento del costruttore è necessario che il costruttore sia *pubblico*.</span><span class="sxs-lookup"><span data-stu-id="e2893-133">Constructor injection requires that the constructor in question be *public*.</span></span> <span data-ttu-id="e2893-134">In caso contrario, l'applicazione genera `InvalidOperationException`:</span><span class="sxs-lookup"><span data-stu-id="e2893-134">Otherwise, your app will throw an `InvalidOperationException`:</span></span>

> <span data-ttu-id="e2893-135">Impossibile trovare un costruttore adatto per il tipo 'TipoPersonale'.</span><span class="sxs-lookup"><span data-stu-id="e2893-135">A suitable constructor for type 'YourType' couldn't be located.</span></span> <span data-ttu-id="e2893-136">Verificare che il tipo sia concreto e che i servizi siano registrati per tutti i parametri di un costruttore pubblico.</span><span class="sxs-lookup"><span data-stu-id="e2893-136">Ensure the type is concrete and services are registered for all parameters of a public constructor.</span></span>

<span data-ttu-id="e2893-137">L'inserimento del costruttore richiede l'esistenza di un solo costruttore applicabile.</span><span class="sxs-lookup"><span data-stu-id="e2893-137">Constructor injection requires that only one applicable constructor exist.</span></span> <span data-ttu-id="e2893-138">Sebbene siano supportati gli overload dei costruttori, può essere presente un solo overload i cui argomenti possono essere tutti specificati tramite l'inserimento delle dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-138">Constructor overloads are supported, but only one overload can exist whose arguments can all be fulfilled by dependency injection.</span></span> <span data-ttu-id="e2893-139">Se sono presenti più overload, l'app genererà `InvalidOperationException`:</span><span class="sxs-lookup"><span data-stu-id="e2893-139">If more than one exists, your app will throw an `InvalidOperationException`:</span></span>

> <span data-ttu-id="e2893-140">Nel tipo 'TipoPersonale' sono stati individuati più costruttori che accettano tutti i tipi di argomenti specificati.</span><span class="sxs-lookup"><span data-stu-id="e2893-140">Multiple constructors accepting all given argument types have been found in type 'YourType'.</span></span> <span data-ttu-id="e2893-141">Deve essere presente solo un costruttore applicabile.</span><span class="sxs-lookup"><span data-stu-id="e2893-141">There should only be one applicable constructor.</span></span>

<span data-ttu-id="e2893-142">I costruttori possono accettare argomenti non forniti tramite l'inserimento di dipendenze, ma devono supportare i valori predefiniti.</span><span class="sxs-lookup"><span data-stu-id="e2893-142">Constructors can accept arguments that are not provided by dependency injection, but these must support default values.</span></span> <span data-ttu-id="e2893-143">Ad esempio:</span><span class="sxs-lookup"><span data-stu-id="e2893-143">For example:</span></span>

```csharp
// throws InvalidOperationException: Unable to resolve service for type 'System.String'...
public CharactersController(ICharacterRepository characterRepository, string title)
{
    _characterRepository = characterRepository;
    _title = title;
}

// runs without error
public CharactersController(ICharacterRepository characterRepository, string title = "Characters")
{
    _characterRepository = characterRepository;
    _title = title;
}
```

## <a name="using-framework-provided-services"></a><span data-ttu-id="e2893-144">Uso dei servizi forniti dal framework</span><span class="sxs-lookup"><span data-stu-id="e2893-144">Using framework-provided services</span></span>

<span data-ttu-id="e2893-145">Il metodo `ConfigureServices` nella classe `Startup` è responsabile della definizione dei servizi che verranno usati dall'applicazione, incluse le funzionalità di piattaforma come Entity Framework Core e ASP.NET Core MVC.</span><span class="sxs-lookup"><span data-stu-id="e2893-145">The `ConfigureServices` method in the `Startup` class is responsible for defining the services the application will use, including platform features like Entity Framework Core and ASP.NET Core MVC.</span></span> <span data-ttu-id="e2893-146">Inizialmente, l'interfaccia `IServiceCollection` fornita a `ConfigureServices` ha i seguenti servizi definiti (in base alla [modalità di configurazione dell'host](xref:fundamentals/host/index)):</span><span class="sxs-lookup"><span data-stu-id="e2893-146">Initially, the `IServiceCollection` provided to `ConfigureServices` has the following services defined (depending on [how the host was configured](xref:fundamentals/host/index)):</span></span>

| <span data-ttu-id="e2893-147">Tipo di servizio</span><span class="sxs-lookup"><span data-stu-id="e2893-147">Service Type</span></span> | <span data-ttu-id="e2893-148">Durata</span><span class="sxs-lookup"><span data-stu-id="e2893-148">Lifetime</span></span> |
| ----- | ------- |
| [<span data-ttu-id="e2893-149">Microsoft.AspNetCore.Hosting.IHostingEnvironment</span><span class="sxs-lookup"><span data-stu-id="e2893-149">Microsoft.AspNetCore.Hosting.IHostingEnvironment</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.ihostingenvironment) | <span data-ttu-id="e2893-150">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-150">Singleton</span></span> |
| [<span data-ttu-id="e2893-151">Microsoft.Extensions.Logging.ILoggerFactory</span><span class="sxs-lookup"><span data-stu-id="e2893-151">Microsoft.Extensions.Logging.ILoggerFactory</span></span>](/dotnet/api/microsoft.extensions.logging.iloggerfactory) | <span data-ttu-id="e2893-152">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-152">Singleton</span></span> |
| [<span data-ttu-id="e2893-153">Microsoft.Extensions.Logging.ILogger&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="e2893-153">Microsoft.Extensions.Logging.ILogger&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.logging.ilogger) | <span data-ttu-id="e2893-154">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-154">Singleton</span></span> |
| [<span data-ttu-id="e2893-155">Microsoft.AspNetCore.Hosting.Builder.IApplicationBuilderFactory</span><span class="sxs-lookup"><span data-stu-id="e2893-155">Microsoft.AspNetCore.Hosting.Builder.IApplicationBuilderFactory</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.builder.iapplicationbuilderfactory) | <span data-ttu-id="e2893-156">Temporaneo</span><span class="sxs-lookup"><span data-stu-id="e2893-156">Transient</span></span> |
| [<span data-ttu-id="e2893-157">Microsoft.AspNetCore.Http.IHttpContextFactory</span><span class="sxs-lookup"><span data-stu-id="e2893-157">Microsoft.AspNetCore.Http.IHttpContextFactory</span></span>](/dotnet/api/microsoft.aspnetcore.http.ihttpcontextfactory) | <span data-ttu-id="e2893-158">Temporaneo</span><span class="sxs-lookup"><span data-stu-id="e2893-158">Transient</span></span> |
| [<span data-ttu-id="e2893-159">Microsoft.Extensions.Options.IOptions&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="e2893-159">Microsoft.Extensions.Options.IOptions&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.options.ioptions-1) | <span data-ttu-id="e2893-160">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-160">Singleton</span></span> |
| [<span data-ttu-id="e2893-161">System.Diagnostics.DiagnosticSource</span><span class="sxs-lookup"><span data-stu-id="e2893-161">System.Diagnostics.DiagnosticSource</span></span>](https://docs.microsoft.com/dotnet/core/api/system.diagnostics.diagnosticsource) | <span data-ttu-id="e2893-162">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-162">Singleton</span></span> |
| [<span data-ttu-id="e2893-163">System.Diagnostics.DiagnosticListener</span><span class="sxs-lookup"><span data-stu-id="e2893-163">System.Diagnostics.DiagnosticListener</span></span>](https://docs.microsoft.com/dotnet/core/api/system.diagnostics.diagnosticlistener) | <span data-ttu-id="e2893-164">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-164">Singleton</span></span> |
| [<span data-ttu-id="e2893-165">Microsoft.AspNetCore.Hosting.IStartupFilter</span><span class="sxs-lookup"><span data-stu-id="e2893-165">Microsoft.AspNetCore.Hosting.IStartupFilter</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.istartupfilter) | <span data-ttu-id="e2893-166">Temporaneo</span><span class="sxs-lookup"><span data-stu-id="e2893-166">Transient</span></span> |
| [<span data-ttu-id="e2893-167">Microsoft.Extensions.ObjectPool.ObjectPoolProvider</span><span class="sxs-lookup"><span data-stu-id="e2893-167">Microsoft.Extensions.ObjectPool.ObjectPoolProvider</span></span>](/dotnet/api/microsoft.extensions.objectpool.objectpoolprovider) | <span data-ttu-id="e2893-168">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-168">Singleton</span></span> |
| [<span data-ttu-id="e2893-169">Microsoft.Extensions.Options.IConfigureOptions&lt;T&gt;</span><span class="sxs-lookup"><span data-stu-id="e2893-169">Microsoft.Extensions.Options.IConfigureOptions&lt;T&gt;</span></span>](/dotnet/api/microsoft.extensions.options.iconfigureoptions-1) | <span data-ttu-id="e2893-170">Temporaneo</span><span class="sxs-lookup"><span data-stu-id="e2893-170">Transient</span></span> |
| [<span data-ttu-id="e2893-171">Microsoft.AspNetCore.Hosting.Server.IServer</span><span class="sxs-lookup"><span data-stu-id="e2893-171">Microsoft.AspNetCore.Hosting.Server.IServer</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.server.iserver) | <span data-ttu-id="e2893-172">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-172">Singleton</span></span> |
| [<span data-ttu-id="e2893-173">Microsoft.AspNetCore.Hosting.IStartup</span><span class="sxs-lookup"><span data-stu-id="e2893-173">Microsoft.AspNetCore.Hosting.IStartup</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.istartup) | <span data-ttu-id="e2893-174">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-174">Singleton</span></span> |
| [<span data-ttu-id="e2893-175">Microsoft.AspNetCore.Hosting.IApplicationLifetime</span><span class="sxs-lookup"><span data-stu-id="e2893-175">Microsoft.AspNetCore.Hosting.IApplicationLifetime</span></span>](/dotnet/api/microsoft.aspnetcore.hosting.iapplicationlifetime) | <span data-ttu-id="e2893-176">Singleton</span><span class="sxs-lookup"><span data-stu-id="e2893-176">Singleton</span></span> |

<span data-ttu-id="e2893-177">L'esempio seguente illustra come aggiungere servizi aggiuntivi al contenitore usando metodi di estensione come `AddDbContext`, `AddIdentity` e `AddMvc`.</span><span class="sxs-lookup"><span data-stu-id="e2893-177">Below is an example of how to add additional services to the container using a number of extension methods like `AddDbContext`, `AddIdentity`, and `AddMvc`.</span></span>

[!code-csharp[](../common/samples/WebApplication1/Startup.cs?highlight=5-6,8-10,12&range=39-56)]

<span data-ttu-id="e2893-178">Le funzionalità e il middleware forniti da ASP.NET, ad esempio MVC, seguono una convenzione per l'uso di un singolo metodo di estensione Add*ServiceName* per registrare tutti i servizi richiesti dalla funzionalità.</span><span class="sxs-lookup"><span data-stu-id="e2893-178">The features and middleware provided by ASP.NET, such as MVC, follow a convention of using a single Add*ServiceName* extension method to register all of the services required by that feature.</span></span>

> [!TIP]
> <span data-ttu-id="e2893-179">È possibile richiedere determinati servizi forniti dal framework all'interno di metodi `Startup` tramite i relativi elenchi di parametri. Per informazioni dettagliate, vedere [Avvio dell'applicazione](startup.md).</span><span class="sxs-lookup"><span data-stu-id="e2893-179">You can request certain framework-provided services within `Startup` methods through their parameter lists - see [Application Startup](startup.md) for more details.</span></span>

## <a name="registering-services"></a><span data-ttu-id="e2893-180">Registrazione di servizi</span><span class="sxs-lookup"><span data-stu-id="e2893-180">Registering services</span></span>

<span data-ttu-id="e2893-181">È possibile registrare i servizi dell'applicazione come descritto di seguito.</span><span class="sxs-lookup"><span data-stu-id="e2893-181">You can register your own application services as follows.</span></span> <span data-ttu-id="e2893-182">Il primo tipo generico rappresenta il tipo (in genere un'interfaccia) che verrà richiesto dal contenitore.</span><span class="sxs-lookup"><span data-stu-id="e2893-182">The first generic type represents the type (typically an interface) that will be requested from the container.</span></span> <span data-ttu-id="e2893-183">Il secondo tipo generico rappresenta il tipo concreto di cui verrà creata un'istanza mediante il contenitore e che verrà usato per soddisfare le richieste.</span><span class="sxs-lookup"><span data-stu-id="e2893-183">The second generic type represents the concrete type that will be instantiated by the container and used to fulfill such requests.</span></span>

[!code-csharp[](../common/samples/WebApplication1/Startup.cs?range=53-54)]

> [!NOTE]
> <span data-ttu-id="e2893-184">Ogni metodo di estensione `services.Add<ServiceName>` aggiunge (e potenzialmente configura) i servizi.</span><span class="sxs-lookup"><span data-stu-id="e2893-184">Each `services.Add<ServiceName>` extension method adds (and potentially configures) services.</span></span> <span data-ttu-id="e2893-185">Ad esempio, `services.AddMvc()` aggiunge i servizi richiesti da MVC.</span><span class="sxs-lookup"><span data-stu-id="e2893-185">For example, `services.AddMvc()` adds the services MVC requires.</span></span> <span data-ttu-id="e2893-186">È consigliabile attenersi a questa convenzione, inserendo i metodi di estensione nello spazio dei nomi `Microsoft.Extensions.DependencyInjection` per incapsulare i gruppi di registrazioni di servizi.</span><span class="sxs-lookup"><span data-stu-id="e2893-186">It's recommended that you follow this convention, placing extension methods in the `Microsoft.Extensions.DependencyInjection` namespace, to encapsulate groups of service registrations.</span></span>

<span data-ttu-id="e2893-187">Il metodo `AddTransient` viene usato per eseguire il mapping di tipi astratti a servizi concreti di cui viene creata un'istanza separatamente per ogni oggetto che lo richiede.</span><span class="sxs-lookup"><span data-stu-id="e2893-187">The `AddTransient` method is used to map abstract types to concrete services that are instantiated separately for every object that requires it.</span></span> <span data-ttu-id="e2893-188">Viene definita *durata* del servizio. Ulteriori opzioni di durata sono descritte di seguito.</span><span class="sxs-lookup"><span data-stu-id="e2893-188">This is known as the service's *lifetime*, and additional lifetime options are described below.</span></span> <span data-ttu-id="e2893-189">È importante scegliere una durata appropriata per ognuno dei servizi registrati.</span><span class="sxs-lookup"><span data-stu-id="e2893-189">It's important to choose an appropriate lifetime for each of the services you register.</span></span> <span data-ttu-id="e2893-190">È necessario fornire una nuova istanza del servizio a ogni classe che la richiede?</span><span class="sxs-lookup"><span data-stu-id="e2893-190">Should a new instance of the service be provided to each class that requests it?</span></span> <span data-ttu-id="e2893-191">È necessario usare un'unica istanza in una richiesta Web specificata?</span><span class="sxs-lookup"><span data-stu-id="e2893-191">Should one instance be used throughout a given web request?</span></span> <span data-ttu-id="e2893-192">Oppure è necessario usare una sola istanza per la durata dell'applicazione?</span><span class="sxs-lookup"><span data-stu-id="e2893-192">Or should a single instance be used for the lifetime of the application?</span></span>

<span data-ttu-id="e2893-193">Nell'esempio di questo articolo è presente un controller semplice che visualizza i nomi dei caratteri denominato `CharactersController`.</span><span class="sxs-lookup"><span data-stu-id="e2893-193">In the sample for this article, there's a simple controller that displays character names, called `CharactersController`.</span></span> <span data-ttu-id="e2893-194">Il metodo `Index` visualizza l'elenco di caratteri corrente memorizzati nell'applicazione e, se necessario, inizializza la raccolta con alcuni caratteri.</span><span class="sxs-lookup"><span data-stu-id="e2893-194">Its `Index` method displays the current list of characters that have been stored in the application, and initializes the collection with a handful of characters if none exist.</span></span> <span data-ttu-id="e2893-195">Si noti che sebbene questa applicazione usi Entity Framework Core e la classe `ApplicationDbContext` per la relativa persistenza, non appare nel controller.</span><span class="sxs-lookup"><span data-stu-id="e2893-195">Note that although this application uses Entity Framework Core and the `ApplicationDbContext` class for its persistence, none of that's apparent in the controller.</span></span> <span data-ttu-id="e2893-196">Al contrario, il meccanismo di accesso ai dati specifici è stato astratto da un'interfaccia, `ICharacterRepository`, che segue il [modello di repository](http://deviq.com/repository-pattern/).</span><span class="sxs-lookup"><span data-stu-id="e2893-196">Instead, the specific data access mechanism has been abstracted behind an interface, `ICharacterRepository`, which follows the [repository pattern](http://deviq.com/repository-pattern/).</span></span> <span data-ttu-id="e2893-197">Un'istanza di `ICharacterRepository` viene richiesta tramite il costruttore e assegnata a un campo privato che viene quindi usato per accedere ai caratteri in base alle esigenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-197">An instance of `ICharacterRepository` is requested via the constructor and assigned to a private field, which is then used to access characters as necessary.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Controllers/CharactersController.cs?highlight=3,5,6,7,8,14,21-27&range=8-36)]

<span data-ttu-id="e2893-198">`ICharacterRepository` definisce i due metodi necessari al controller per l'uso delle istanze `Character`.</span><span class="sxs-lookup"><span data-stu-id="e2893-198">The `ICharacterRepository` defines the two methods the controller needs to work with `Character` instances.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Interfaces/ICharacterRepository.cs?highlight=8,9)]

<span data-ttu-id="e2893-199">Questa interfaccia viene a sua volta implementata da un tipo concreto, `CharacterRepository`, usato durante il runtime.</span><span class="sxs-lookup"><span data-stu-id="e2893-199">This interface is in turn implemented by a concrete type, `CharacterRepository`, that's used at runtime.</span></span>

> [!NOTE]
> <span data-ttu-id="e2893-200">La modalità di utilizzo dell'inserimento delle dipendenze con la classe `CharacterRepository` è un modello generale che è possibile seguire per tutti i servizi dell'applicazione, non solo nei "repository" o nelle classi di accesso ai dati.</span><span class="sxs-lookup"><span data-stu-id="e2893-200">The way DI is used with the `CharacterRepository` class is a general model you can follow for all of your application services, not just in "repositories" or data access classes.</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Models/CharacterRepository.cs?highlight=9,11,12,13,14)]

<span data-ttu-id="e2893-201">Si noti che `CharacterRepository` richiede `ApplicationDbContext` nel costruttore.</span><span class="sxs-lookup"><span data-stu-id="e2893-201">Note that `CharacterRepository` requests an `ApplicationDbContext` in its constructor.</span></span> <span data-ttu-id="e2893-202">Non è raro che l'inserimento delle dipendenze venga usato in modo concatenato e che ogni dipendenza richiesta richieda a sua volta le proprie dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-202">It's not unusual for dependency injection to be used in a chained fashion like this, with each requested dependency in turn requesting its own dependencies.</span></span> <span data-ttu-id="e2893-203">Il contenitore è responsabile della risoluzione di tutte le dipendenze nel grafico e della restituzione del servizio completamente risolto.</span><span class="sxs-lookup"><span data-stu-id="e2893-203">The container is responsible for resolving all of the dependencies in the graph and returning the fully resolved service.</span></span>

> [!NOTE]
> <span data-ttu-id="e2893-204">La creazione dell'oggetto richiesto, di tutti gli oggetti che l'oggetto richiede e di tutti gli oggetti richiesti da quest'ultimi viene a volte chiamata *grafico oggetto*.</span><span class="sxs-lookup"><span data-stu-id="e2893-204">Creating the requested object, and all of the objects it requires, and all of the objects those require, is sometimes referred to as an *object graph*.</span></span> <span data-ttu-id="e2893-205">Analogamente, l'insieme di dipendenze che devono essere risolte viene generalmente chiamato *albero delle dipendenze* o *grafico dipendenze*.</span><span class="sxs-lookup"><span data-stu-id="e2893-205">Likewise, the collective set of dependencies that must be resolved is typically referred to as a *dependency tree* or *dependency graph*.</span></span>

<span data-ttu-id="e2893-206">In questo caso `ICharacterRepository` e `ApplicationDbContext` devono essere entrambi registrati nel contenitore di servizi in `ConfigureServices` in `Startup`.</span><span class="sxs-lookup"><span data-stu-id="e2893-206">In this case, both `ICharacterRepository` and in turn `ApplicationDbContext` must be registered with the services container in `ConfigureServices` in `Startup`.</span></span> <span data-ttu-id="e2893-207">`ApplicationDbContext` è configurato con la chiamata al metodo di estensione `AddDbContext<T>`.</span><span class="sxs-lookup"><span data-stu-id="e2893-207">`ApplicationDbContext` is configured with the call to the extension method `AddDbContext<T>`.</span></span> <span data-ttu-id="e2893-208">Il codice seguente illustra la registrazione del tipo `CharacterRepository`.</span><span class="sxs-lookup"><span data-stu-id="e2893-208">The following code shows the registration of the `CharacterRepository` type.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Startup.cs?highlight=3-5,11&range=16-32)]

<span data-ttu-id="e2893-209">Aggiungere i contesti di Entity Framework al contenitore di servizi usando la durata `Scoped`.</span><span class="sxs-lookup"><span data-stu-id="e2893-209">Entity Framework contexts should be added to the services container using the `Scoped` lifetime.</span></span> <span data-ttu-id="e2893-210">Questa operazione viene eseguita automaticamente se si usano i metodi helper come illustrato di seguito.</span><span class="sxs-lookup"><span data-stu-id="e2893-210">This is taken care of automatically if you use the helper methods as shown above.</span></span> <span data-ttu-id="e2893-211">I repository che useranno Entity Framework devono usare la stessa durata.</span><span class="sxs-lookup"><span data-stu-id="e2893-211">Repositories that will make use of Entity Framework should use the same lifetime.</span></span>

> [!WARNING]
> <span data-ttu-id="e2893-212">L'unico rischio da tenere presente è rappresentato dalla risoluzione di un servizio `Scoped` da un singleton.</span><span class="sxs-lookup"><span data-stu-id="e2893-212">The main danger to be wary of is resolving a `Scoped` service from a singleton.</span></span> <span data-ttu-id="e2893-213">È probabile che in tal caso il servizio abbia uno stato non corretto durante l'elaborazione delle richieste successive.</span><span class="sxs-lookup"><span data-stu-id="e2893-213">It's likely in such a case that the service will have incorrect state when processing subsequent requests.</span></span>

<span data-ttu-id="e2893-214">I servizi che hanno dipendenze devono registrarle nel contenitore.</span><span class="sxs-lookup"><span data-stu-id="e2893-214">Services that have dependencies should register them in the container.</span></span> <span data-ttu-id="e2893-215">Se il costruttore di un servizio richiede una primitiva, ad esempio `string`, è possibile inserirla usando la [configurazione](xref:fundamentals/configuration/index) e il [modello di opzioni](xref:fundamentals/configuration/options).</span><span class="sxs-lookup"><span data-stu-id="e2893-215">If a service's constructor requires a primitive, such as a `string`, this can be injected by using [configuration](xref:fundamentals/configuration/index) and the [options pattern](xref:fundamentals/configuration/options).</span></span>

## <a name="service-lifetimes-and-registration-options"></a><span data-ttu-id="e2893-216">Opzioni di durata e di registrazione dei servizi</span><span class="sxs-lookup"><span data-stu-id="e2893-216">Service lifetimes and registration options</span></span>

<span data-ttu-id="e2893-217">I servizi ASP.NET possono essere configurati con le impostazioni di durata seguenti:</span><span class="sxs-lookup"><span data-stu-id="e2893-217">ASP.NET services can be configured with the following lifetimes:</span></span>

<span data-ttu-id="e2893-218">**Temporaneo**</span><span class="sxs-lookup"><span data-stu-id="e2893-218">**Transient**</span></span>

<span data-ttu-id="e2893-219">I servizi con durata temporanea vengono creati ogni volta che vengono richiesti.</span><span class="sxs-lookup"><span data-stu-id="e2893-219">Transient lifetime services are created each time they're requested.</span></span> <span data-ttu-id="e2893-220">Questa impostazione di durata è consigliata per i servizi semplici senza stati.</span><span class="sxs-lookup"><span data-stu-id="e2893-220">This lifetime works best for lightweight, stateless services.</span></span>

<span data-ttu-id="e2893-221">**Con ambito**</span><span class="sxs-lookup"><span data-stu-id="e2893-221">**Scoped**</span></span>

<span data-ttu-id="e2893-222">I servizi con durata con ambito vengono creati una volta per ogni richiesta.</span><span class="sxs-lookup"><span data-stu-id="e2893-222">Scoped lifetime services are created once per request.</span></span>

> [!WARNING]
> <span data-ttu-id="e2893-223">Se si usa un servizio con ambito in un middleware, inserire il servizio nel metodo `Invoke` o `InvokeAsync`.</span><span class="sxs-lookup"><span data-stu-id="e2893-223">If you're using a scoped service in a middleware, inject the service into the `Invoke` or `InvokeAsync` method.</span></span> <span data-ttu-id="e2893-224">Evitare l'inserimento tramite il costruttore, che impone al servizio il comportamento singleton.</span><span class="sxs-lookup"><span data-stu-id="e2893-224">Don't inject via constructor injection because it forces the service to behave like a singleton.</span></span>

<span data-ttu-id="e2893-225">**Singleton**</span><span class="sxs-lookup"><span data-stu-id="e2893-225">**Singleton**</span></span>

<span data-ttu-id="e2893-226">I servizi con durata singleton vengono creati la prima volta che vengono richiesti (o quando viene eseguito `ConfigureServices` se si specifica un'istanza). La stessa istanza viene usata in seguito da tutte le richieste successive.</span><span class="sxs-lookup"><span data-stu-id="e2893-226">Singleton lifetime services are created the first time they're requested (or when `ConfigureServices` is run if you specify an instance there) and then every subsequent request will use the same instance.</span></span> <span data-ttu-id="e2893-227">Se l'applicazione richiede un comportamento singleton, è consigliabile consentire al contenitore di servizi di gestire la durata del servizio anziché implementare lo schema progettuale singleton e gestire la durata dell'oggetto nella classe.</span><span class="sxs-lookup"><span data-stu-id="e2893-227">If your application requires singleton behavior, allowing the services container to manage the service's lifetime is recommended instead of implementing the singleton design pattern and managing your object's lifetime in the class yourself.</span></span>

<span data-ttu-id="e2893-228">I servizi possono essere registrati nel contenitore in diversi modi.</span><span class="sxs-lookup"><span data-stu-id="e2893-228">Services can be registered with the container in several ways.</span></span> <span data-ttu-id="e2893-229">In precedenza è già stato descritto come registrare l'implementazione di un servizio con un determinato tipo specificando il tipo concreto da usare.</span><span class="sxs-lookup"><span data-stu-id="e2893-229">We have already seen how to register a service implementation with a given type by specifying the concrete type to use.</span></span> <span data-ttu-id="e2893-230">È anche possibile specificare una factory che verrà usata in seguito per creare l'istanza su richiesta.</span><span class="sxs-lookup"><span data-stu-id="e2893-230">In addition, a factory can be specified, which will then be used to create the instance on demand.</span></span> <span data-ttu-id="e2893-231">Il terzo approccio consiste nello specificare direttamente l'istanza del tipo da usare. In tal caso il contenitore non tenterà di creare un'istanza (né eliminerà l'istanza).</span><span class="sxs-lookup"><span data-stu-id="e2893-231">The third approach is to directly specify the instance of the type to use, in which case the container will never attempt to create an instance (nor will it dispose of the instance).</span></span>

<span data-ttu-id="e2893-232">Per illustrare la differenza tra queste opzioni di durata e registrazione, si consideri un'interfaccia semplice che rappresenta una o più attività come *operazione* con un identificatore univoco, `OperationId`.</span><span class="sxs-lookup"><span data-stu-id="e2893-232">To demonstrate the difference between these lifetime and registration options, consider a simple interface that represents one or more tasks as an *operation* with a unique identifier, `OperationId`.</span></span> <span data-ttu-id="e2893-233">A seconda di come viene configurata la durata di questo servizio, il contenitore offre la stessa istanza o istanze diverse del servizio alla classe richiedente.</span><span class="sxs-lookup"><span data-stu-id="e2893-233">Depending on how we configure the lifetime for this service, the container will provide either the same or different instances of the service to the requesting class.</span></span> <span data-ttu-id="e2893-234">Per indicare la durata richiesta, verrà creato un singolo tipo per ogni opzione di durata:</span><span class="sxs-lookup"><span data-stu-id="e2893-234">To make it clear which lifetime is being requested, we will create one type per lifetime option:</span></span>

[!code-csharp[](../fundamentals/dependency-injection/sample/DependencyInjectionSample/Interfaces/IOperation.cs?highlight=5-8)]

<span data-ttu-id="e2893-235">Queste interfacce vengono implementate usando un'unica classe, `Operation`, che accetta `Guid` nel costruttore o usa un nuovo `Guid` se non ne viene specificato uno.</span><span class="sxs-lookup"><span data-stu-id="e2893-235">We implement these interfaces using a single class, `Operation`, that accepts a `Guid` in its constructor, or uses a new `Guid` if none is provided.</span></span>

<span data-ttu-id="e2893-236">Successivamente, in `ConfigureServices`, ogni tipo viene aggiunto al contenitore in base alla durata denominata:</span><span class="sxs-lookup"><span data-stu-id="e2893-236">Next, in `ConfigureServices`, each type is added to the container according to its named lifetime:</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Startup.cs?range=26-32)]

<span data-ttu-id="e2893-237">Si noti che poiché il servizio `IOperationSingletonInstance` usa un'istanza specifica con un ID noto di `Guid.Empty`, è facile individuare quando il tipo è in uso (il GUID includerà solo zeri).</span><span class="sxs-lookup"><span data-stu-id="e2893-237">Note that the `IOperationSingletonInstance` service is using a specific instance with a known ID of `Guid.Empty` so it will be clear when this type is in use (its Guid will be all zeroes).</span></span> <span data-ttu-id="e2893-238">È stato registrato anche `OperationService` che dipende da ognuno degli altri tipi `Operation`, in modo che sia possibile individuare all'interno di una richiesta se il servizio ottiene la stessa istanza del controller o una nuova istanza per ogni tipo di operazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-238">We have also registered an `OperationService` that depends on each of the other `Operation` types, so that it will be clear within a request whether this service is getting the same instance as the controller, or a new one, for each operation type.</span></span> <span data-ttu-id="e2893-239">Il servizio si limita a esporre le relative dipendenze come proprietà in modo che possano essere incluse nella visualizzazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-239">All this service does is expose its dependencies as properties, so they can be displayed in the view.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Services/OperationService.cs)]

<span data-ttu-id="e2893-240">Per indicare le durata degli oggetti nelle singole richieste separate all'applicazione, l'esempio include `OperationsController` che richiede ogni tipo di `IOperation` e `OperationService`.</span><span class="sxs-lookup"><span data-stu-id="e2893-240">To demonstrate the object lifetimes within and between separate individual requests to the application, the sample includes an `OperationsController` that requests each kind of `IOperation` type as well as an `OperationService`.</span></span> <span data-ttu-id="e2893-241">L'azione `Index` visualizza quindi tutti i valori `OperationId` del controller e del servizio.</span><span class="sxs-lookup"><span data-stu-id="e2893-241">The `Index` action then displays all of the controller's and service's `OperationId` values.</span></span>

[!code-csharp[](dependency-injection/sample/DependencyInjectionSample/Controllers/OperationsController.cs)]

<span data-ttu-id="e2893-242">Sono ora presenti due richieste separate all'azione del controller seguente:</span><span class="sxs-lookup"><span data-stu-id="e2893-242">Now two separate requests are made to this controller action:</span></span>

![Visualizzazione delle operazioni dell'applicazione Web di esempio di inserimento delle dipendenze eseguita in Microsoft Edge che mostra i valori di ID operazione (GUID) del controller temporaneo, con ambito, singleton e di istanza e delle operazioni del servizio nella prima richiesta.](dependency-injection/_static/lifetimes_request1.png)

![Visualizzazione delle operazioni con i valori di ID operazione per una seconda richiesta.](dependency-injection/_static/lifetimes_request2.png)

<span data-ttu-id="e2893-245">Osservare i valori `OperationId` che variano all'interno della richiesta e da una richiesta e l'altra.</span><span class="sxs-lookup"><span data-stu-id="e2893-245">Observe which of the `OperationId` values vary within a request, and between requests.</span></span>

* <span data-ttu-id="e2893-246">Gli oggetti *temporanei* sono sempre diversi; a ogni controller e a ogni servizio viene fornita una nuova istanza.</span><span class="sxs-lookup"><span data-stu-id="e2893-246">*Transient* objects are always different; a new instance is provided to every controller and every service.</span></span>

* <span data-ttu-id="e2893-247">Gli oggetti *con ambito* sono gli stessi all'interno di una richiesta, ma variano nelle diverse richieste</span><span class="sxs-lookup"><span data-stu-id="e2893-247">*Scoped* objects are the same within a request, but different across different requests</span></span>

* <span data-ttu-id="e2893-248">Gli oggetti *singleton* sono gli stessi per ogni oggetto e ogni richiesta, indipendentemente dall'istanza fornita in `ConfigureServices`</span><span class="sxs-lookup"><span data-stu-id="e2893-248">*Singleton* objects are the same for every object and every request (regardless of whether an instance is provided in `ConfigureServices`)</span></span>

## <a name="resolve-a-scoped-service-within-the-application-scope"></a><span data-ttu-id="e2893-249">Risolvere un servizio con ambito nell'ambito dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="e2893-249">Resolve a scoped service within the application scope</span></span>

<span data-ttu-id="e2893-250">Creare un [IServiceScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescope) con [IServiceScopeFactory.CreateScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescopefactory.createscope) per risolvere un servizio con ambito nell'ambito dell'app.</span><span class="sxs-lookup"><span data-stu-id="e2893-250">Create an [IServiceScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescope) with [IServiceScopeFactory.CreateScope](/dotnet/api/microsoft.extensions.dependencyinjection.iservicescopefactory.createscope) to resolve a scoped service within the app's scope.</span></span> <span data-ttu-id="e2893-251">Questo approccio è utile per l'accesso a un servizio con ambito all'avvio e per l'esecuzione di attività di inizializzazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-251">This approach is useful to access a scoped service at startup to run initialization tasks.</span></span> <span data-ttu-id="e2893-252">L'esempio seguente indica come ottenere un contesto per `MyScopedService` in `Program.Main`:</span><span class="sxs-lookup"><span data-stu-id="e2893-252">The following example shows how to obtain a context for the `MyScopedService` in `Program.Main`:</span></span>

```csharp
public static void Main(string[] args)
{
    var host = BuildWebHost(args);

    using (var serviceScope = host.Services.CreateScope())
    {
        var services = serviceScope.ServiceProvider;

        try
        {
            var serviceContext = services.GetRequiredService<MyScopedService>();
            // Use the context here
        }
        catch (Exception ex)
        {
            var logger = services.GetRequiredService<ILogger<Program>>();
            logger.LogError(ex, "An error occurred.");
        }
    }

    host.Run();
}
```

## <a name="scope-validation"></a><span data-ttu-id="e2893-253">Convalida dell'ambito</span><span class="sxs-lookup"><span data-stu-id="e2893-253">Scope validation</span></span>

<span data-ttu-id="e2893-254">Quando l'app viene eseguita nell'ambiente di sviluppo in ASP.NET Core 2.0 o versioni successive, il provider di servizi predefinito esegue controlli per verificare che:</span><span class="sxs-lookup"><span data-stu-id="e2893-254">When the app is running in the Development environment on ASP.NET Core 2.0 or later, the default service provider performs checks to verify that:</span></span>

* <span data-ttu-id="e2893-255">I servizi con ambito non vengano risolti direttamente o indirettamente dal provider di servizi radice.</span><span class="sxs-lookup"><span data-stu-id="e2893-255">Scoped services aren't directly or indirectly resolved from the root service provider.</span></span>
* <span data-ttu-id="e2893-256">I servizi con ambito non vengano inseriti direttamente o indirettamente in singleton.</span><span class="sxs-lookup"><span data-stu-id="e2893-256">Scoped services aren't directly or indirectly injected into singletons.</span></span>

<span data-ttu-id="e2893-257">Il provider di servizi radice venga creato con la chiamata di [BuildServiceProvider](/dotnet/api/microsoft.extensions.dependencyinjection.servicecollectioncontainerbuilderextensions.buildserviceprovider).</span><span class="sxs-lookup"><span data-stu-id="e2893-257">The root service provider is created when [BuildServiceProvider](/dotnet/api/microsoft.extensions.dependencyinjection.servicecollectioncontainerbuilderextensions.buildserviceprovider) is called.</span></span> <span data-ttu-id="e2893-258">La durata del provider di servizi radice corrisponde alla durata dell'app/server quando il provider viene avviato con l'app e viene eliminato alla chiusura dell'app.</span><span class="sxs-lookup"><span data-stu-id="e2893-258">The root service provider's lifetime corresponds to the app/server's lifetime when the provider starts with the app and is disposed when the app shuts down.</span></span>

<span data-ttu-id="e2893-259">I servizi con ambito vengono eliminati dal contenitore che li ha creati.</span><span class="sxs-lookup"><span data-stu-id="e2893-259">Scoped services are disposed by the container that created them.</span></span> <span data-ttu-id="e2893-260">Se un servizio con ambito viene creato nel contenitore radice, la durata del servizio viene di fatto convertita in singleton, perché il servizio viene eliminato solo dal contenitore radice alla chiusura dell'app/server.</span><span class="sxs-lookup"><span data-stu-id="e2893-260">If a scoped service is created in the root container, the service's lifetime is effectively promoted to singleton because it's only disposed by the root container when app/server is shut down.</span></span> <span data-ttu-id="e2893-261">La convalida degli ambiti servizio rileva queste situazioni nel contesto della chiamata di `BuildServiceProvider`.</span><span class="sxs-lookup"><span data-stu-id="e2893-261">Validating service scopes catches these situations when `BuildServiceProvider` is called.</span></span>

<span data-ttu-id="e2893-262">Per altre informazioni, vedere [Convalida dell'ambito](xref:fundamentals/host/web-host#scope-validation) nell'argomento relativo all'host Web.</span><span class="sxs-lookup"><span data-stu-id="e2893-262">For more information, see [Scope validation in the Web Host topic](xref:fundamentals/host/web-host#scope-validation).</span></span>

## <a name="request-services"></a><span data-ttu-id="e2893-263">Servizi di richiesta</span><span class="sxs-lookup"><span data-stu-id="e2893-263">Request Services</span></span>

<span data-ttu-id="e2893-264">I servizi disponibili all'interno di una richiesta ASP.NET da `HttpContext` vengono esposti tramite la raccolta `RequestServices`.</span><span class="sxs-lookup"><span data-stu-id="e2893-264">The services available within an ASP.NET request from `HttpContext` are exposed through the `RequestServices` collection.</span></span>

![Finestra di dialogo contestuale di Intellisense dei servizi di richiesta HttpContext che indica che i servizi di richiesta ottengono o impostano IServiceProvider che offre l'accesso al contenitore di servizi della richiesta.](dependency-injection/_static/request-services.png)

<span data-ttu-id="e2893-266">I servizi di richiesta rappresentano i servizi configurati e richiesti come parte dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-266">Request Services represent the services you configure and request as part of your application.</span></span> <span data-ttu-id="e2893-267">Quando gli oggetti specificano le dipendenze, le dipendenze sono soddisfatte dai tipi individuati in `RequestServices`, non in `ApplicationServices`.</span><span class="sxs-lookup"><span data-stu-id="e2893-267">When your objects specify dependencies, these are satisfied by the types found in `RequestServices`, not `ApplicationServices`.</span></span>

<span data-ttu-id="e2893-268">In genere, è consigliabile non usare queste proprietà direttamente e richiedere invece i tipi necessari alle classi tramite il costruttore della classe e lasciare che il framework inserisca le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-268">Generally, you shouldn't use these properties directly, preferring instead to request the types your classes you require via your class's constructor, and letting the framework inject these dependencies.</span></span> <span data-ttu-id="e2893-269">Si ottengono classi più facili da testare (vedere [Test e debug](xref:testing/index)) e abbinate in modo più libero.</span><span class="sxs-lookup"><span data-stu-id="e2893-269">This yields classes that are easier to test (see [Test and debug](xref:testing/index)) and are more loosely coupled.</span></span>

> [!NOTE]
> <span data-ttu-id="e2893-270">È consigliabile richiedere le dipendenze come parametri del costruttore per l'accesso alla raccolta `RequestServices`.</span><span class="sxs-lookup"><span data-stu-id="e2893-270">Prefer requesting dependencies as constructor parameters to accessing the `RequestServices` collection.</span></span>

## <a name="designing-services-for-dependency-injection"></a><span data-ttu-id="e2893-271">Progettazione dei servizi per l'inserimento di dipendenze</span><span class="sxs-lookup"><span data-stu-id="e2893-271">Designing services for dependency injection</span></span>

<span data-ttu-id="e2893-272">È consigliabile progettare i servizi in modo che venga usato l'inserimento di dipendenze per ottenere i collaboratori.</span><span class="sxs-lookup"><span data-stu-id="e2893-272">You should design your services to use dependency injection to get their collaborators.</span></span> <span data-ttu-id="e2893-273">Ciò significa evitare l'uso di chiamate ai metodi statici con stato (che producono un codice [static cling](http://deviq.com/static-cling/)) e la creazione di istanze delle classi dipendenti all'interno dei servizi.</span><span class="sxs-lookup"><span data-stu-id="e2893-273">This means avoiding the use of stateful static method calls (which result in a code smell known as [static cling](http://deviq.com/static-cling/)) and the direct instantiation of dependent classes within your services.</span></span> <span data-ttu-id="e2893-274">Può essere utile ricordare la frase [New is Glue](https://ardalis.com/new-is-glue) quando si sceglie se creare un'istanza di un tipo oppure richiederlo usando l'inserimento di dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-274">It may help to remember the phrase, [New is Glue](https://ardalis.com/new-is-glue), when choosing whether to instantiate a type or to request it via dependency injection.</span></span> <span data-ttu-id="e2893-275">Se si seguono i [principi di programmazione ad oggetti SOLID](http://deviq.com/solid/), le classi tenderanno a essere piccole, con refactoring corretto e facili da testare.</span><span class="sxs-lookup"><span data-stu-id="e2893-275">By following the [SOLID Principles of Object Oriented Design](http://deviq.com/solid/), your classes will naturally tend to be small, well-factored, and easily tested.</span></span>

<span data-ttu-id="e2893-276">Cosa accade se le classi tendono ad avere troppe dipendenze inserite?</span><span class="sxs-lookup"><span data-stu-id="e2893-276">What if you find that your classes tend to have way too many dependencies being injected?</span></span> <span data-ttu-id="e2893-277">Ciò significa in genere che la classe sta tentando di eseguire troppe operazioni e probabilmente sta violando il principio di singola responsabilità SRP ([Single Responsibility Principle](http://deviq.com/single-responsibility-principle/)).</span><span class="sxs-lookup"><span data-stu-id="e2893-277">This is generally a sign that your class is trying to do too much, and is probably violating SRP - the [Single Responsibility Principle](http://deviq.com/single-responsibility-principle/).</span></span> <span data-ttu-id="e2893-278">Verificare se è possibile effettuare il refactoring della classe spostando alcune delle responsabilità in una nuova classe.</span><span class="sxs-lookup"><span data-stu-id="e2893-278">See if you can refactor the class by moving some of its responsibilities into a new class.</span></span> <span data-ttu-id="e2893-279">Tenere presente che le classi `Controller` devono essere incentrate sulle problematiche dell'interfaccia utente. Di conseguenza, le regole business e i dettagli di implementazione di accesso ai dati devono essere inseriti in classi appropriate per queste [problematiche separate](http://deviq.com/separation-of-concerns/).</span><span class="sxs-lookup"><span data-stu-id="e2893-279">Keep in mind that your `Controller` classes should be focused on UI concerns, so business rules and data access implementation details should be kept in classes appropriate to these [separate concerns](http://deviq.com/separation-of-concerns/).</span></span>

<span data-ttu-id="e2893-280">Per quanto riguarda l'accesso ai dati in particolare, è possibile inserire `DbContext` nei controller (presupponendo che sia stato aggiunto EF al contenitore di servizi in `ConfigureServices`).</span><span class="sxs-lookup"><span data-stu-id="e2893-280">With regards to data access specifically, you can inject the `DbContext` into your controllers (assuming you've added EF to the services container in `ConfigureServices`).</span></span> <span data-ttu-id="e2893-281">Alcuni sviluppatori preferiscono usare un'interfaccia di repository per il database anziché inserire `DbContext` direttamente.</span><span class="sxs-lookup"><span data-stu-id="e2893-281">Some developers prefer to use a repository interface to the database rather than injecting the `DbContext` directly.</span></span> <span data-ttu-id="e2893-282">L'uso di un'interfaccia per incapsulare la logica di accesso ai dati in un'unica posizione consente di ridurre i punti da modificare quando vengono eseguite modifiche al database.</span><span class="sxs-lookup"><span data-stu-id="e2893-282">Using an interface to encapsulate the data access logic in one place can minimize how many places you will have to change when your database changes.</span></span>

### <a name="disposing-of-services"></a><span data-ttu-id="e2893-283">Eliminazione dei servizi</span><span class="sxs-lookup"><span data-stu-id="e2893-283">Disposing of services</span></span>

<span data-ttu-id="e2893-284">Il contenitore chiamerà `Dispose` per i tipi `IDisposable` creati.</span><span class="sxs-lookup"><span data-stu-id="e2893-284">The container will call `Dispose` for `IDisposable` types it creates.</span></span> <span data-ttu-id="e2893-285">Tuttavia, se si aggiunge un'istanza al contenitore, l'istanza non verrà eliminata.</span><span class="sxs-lookup"><span data-stu-id="e2893-285">However, if you add an instance to the container yourself, it will not be disposed.</span></span>

<span data-ttu-id="e2893-286">Esempio:</span><span class="sxs-lookup"><span data-stu-id="e2893-286">Example:</span></span>

```csharp
// Services implement IDisposable:
public class Service1 : IDisposable {}
public class Service2 : IDisposable {}
public class Service3 : IDisposable {}

public interface ISomeService {}
public class SomeServiceImplementation : ISomeService, IDisposable {}


public void ConfigureServices(IServiceCollection services)
{
    // container will create the instance(s) of these types and will dispose them
    services.AddScoped<Service1>();
    services.AddSingleton<Service2>();
    services.AddSingleton<ISomeService>(sp => new SomeServiceImplementation());

    // container didn't create instance so it will NOT dispose it
    services.AddSingleton<Service3>(new Service3());
    services.AddSingleton(new Service3());
}
```

> [!NOTE]
> <span data-ttu-id="e2893-287">Nella versione 1.0 il contenitore chiama Dispose per *tutti* gli oggetti `IDisposable`, inclusi quelli non creati dal contenitore.</span><span class="sxs-lookup"><span data-stu-id="e2893-287">In version 1.0, the container called dispose on *all* `IDisposable` objects, including those it didn't create.</span></span>

## <a name="replacing-the-default-services-container"></a><span data-ttu-id="e2893-288">Sostituzione del contenitore di servizi predefinito</span><span class="sxs-lookup"><span data-stu-id="e2893-288">Replacing the default services container</span></span>

<span data-ttu-id="e2893-289">Il contenitore di servizi incorporato è progettato per soddisfare le esigenze di base del framework e della maggior parte delle applicazioni basate su di esso.</span><span class="sxs-lookup"><span data-stu-id="e2893-289">The built-in services container is meant to serve the basic needs of the framework and most consumer applications built on it.</span></span> <span data-ttu-id="e2893-290">Tuttavia, gli sviluppatori possono sostituire il contenitore incorporato con il contenitore preferito.</span><span class="sxs-lookup"><span data-stu-id="e2893-290">However, developers can replace the built-in container with their preferred container.</span></span> <span data-ttu-id="e2893-291">Il metodo `ConfigureServices` restituisce in genere `void`. Tuttavia, se la firma del metodo viene modificata per restituire `IServiceProvider`, è possibile configurare e restituire un contenitore diverso.</span><span class="sxs-lookup"><span data-stu-id="e2893-291">The `ConfigureServices` method typically returns `void`, but if its signature is changed to return `IServiceProvider`, a different container can be configured and returned.</span></span> <span data-ttu-id="e2893-292">Sono disponibili numerosi contenitori IOC per .NET.</span><span class="sxs-lookup"><span data-stu-id="e2893-292">There are many IOC containers available for .NET.</span></span> <span data-ttu-id="e2893-293">In questo esempio, viene usato il pacchetto [Autofac](https://autofac.org/).</span><span class="sxs-lookup"><span data-stu-id="e2893-293">In this example, the [Autofac](https://autofac.org/) package is used.</span></span>

<span data-ttu-id="e2893-294">Installare innanzitutto i pacchetti contenitore appropriati:</span><span class="sxs-lookup"><span data-stu-id="e2893-294">First, install the appropriate container package(s):</span></span>

* `Autofac`
* `Autofac.Extensions.DependencyInjection`

<span data-ttu-id="e2893-295">Configurare quindi il contenitore in `ConfigureServices` e restituire `IServiceProvider`:</span><span class="sxs-lookup"><span data-stu-id="e2893-295">Next, configure the container in `ConfigureServices` and return an `IServiceProvider`:</span></span>

```csharp
public IServiceProvider ConfigureServices(IServiceCollection services)
{
    services.AddMvc();
    // Add other framework services

    // Add Autofac
    var containerBuilder = new ContainerBuilder();
    containerBuilder.RegisterModule<DefaultModule>();
    containerBuilder.Populate(services);
    var container = containerBuilder.Build();
    return new AutofacServiceProvider(container);
}
```

> [!NOTE]
> <span data-ttu-id="e2893-296">Quando si usa un contenitore di inserimento delle dipendenze di terze parti, è necessario modificare `ConfigureServices` in modo che restituisca `IServiceProvider` anziché `void`.</span><span class="sxs-lookup"><span data-stu-id="e2893-296">When using a third-party DI container, you must change `ConfigureServices` so that it returns `IServiceProvider` instead of `void`.</span></span>

<span data-ttu-id="e2893-297">Configurare infine Autofac normalmente in `DefaultModule`:</span><span class="sxs-lookup"><span data-stu-id="e2893-297">Finally, configure Autofac as normal in `DefaultModule`:</span></span>

```csharp
public class DefaultModule : Module
{
    protected override void Load(ContainerBuilder builder)
    {
        builder.RegisterType<CharacterRepository>().As<ICharacterRepository>();
    }
}
```

<span data-ttu-id="e2893-298">Durante il runtime, Autofac viene usato per risolvere i tipi e inserire le dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-298">At runtime, Autofac will be used to resolve types and inject dependencies.</span></span> <span data-ttu-id="e2893-299">[Altre informazioni sull'uso di Autofac e ASP.NET Core](http://docs.autofac.org/en/latest/integration/aspnetcore.html).</span><span class="sxs-lookup"><span data-stu-id="e2893-299">[Learn more about using Autofac and ASP.NET Core](http://docs.autofac.org/en/latest/integration/aspnetcore.html).</span></span>

### <a name="thread-safety"></a><span data-ttu-id="e2893-300">Thread safety</span><span class="sxs-lookup"><span data-stu-id="e2893-300">Thread safety</span></span>

<span data-ttu-id="e2893-301">I servizi singleton devono essere thread-safe.</span><span class="sxs-lookup"><span data-stu-id="e2893-301">Singleton services need to be thread safe.</span></span> <span data-ttu-id="e2893-302">Se un servizio singleton ha una dipendenza in un servizio temporaneo, è necessario che anche il servizio temporaneo sia thread-safe, a seconda di come viene usato dal singleton.</span><span class="sxs-lookup"><span data-stu-id="e2893-302">If a singleton service has a dependency on a transient service, the transient service may also need to be thread safe depending how it's used by the singleton.</span></span>

## <a name="recommendations"></a><span data-ttu-id="e2893-303">Suggerimenti</span><span class="sxs-lookup"><span data-stu-id="e2893-303">Recommendations</span></span>

<span data-ttu-id="e2893-304">Quando si usa l'inserimento di dipendenze, tenere presente le raccomandazioni seguenti:</span><span class="sxs-lookup"><span data-stu-id="e2893-304">When working with dependency injection, keep the following recommendations in mind:</span></span>

* <span data-ttu-id="e2893-305">L'inserimento di dipendenze è adatto agli oggetti con dipendenze complesse.</span><span class="sxs-lookup"><span data-stu-id="e2893-305">DI is for objects that have complex dependencies.</span></span> <span data-ttu-id="e2893-306">I controller, i servizi, gli adattatori e i repository sono tutti esempi di oggetti che possono essere aggiunti all'inserimento di dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-306">Controllers, services, adapters, and repositories are all examples of objects that might be added to DI.</span></span>

* <span data-ttu-id="e2893-307">Evitare di memorizzare i dati e la configurazione direttamente nell'inserimento di dipendenze.</span><span class="sxs-lookup"><span data-stu-id="e2893-307">Avoid storing data and configuration directly in DI.</span></span> <span data-ttu-id="e2893-308">Ad esempio, il carrello acquisti di un utente non dovrebbe in genere essere aggiunto al contenitore dei servizi.</span><span class="sxs-lookup"><span data-stu-id="e2893-308">For example, a user's shopping cart shouldn't typically be added to the services container.</span></span> <span data-ttu-id="e2893-309">La configurazione deve usare il [modello di opzioni](xref:fundamentals/configuration/options).</span><span class="sxs-lookup"><span data-stu-id="e2893-309">Configuration should use the [options pattern](xref:fundamentals/configuration/options).</span></span> <span data-ttu-id="e2893-310">Analogamente, evitare gli oggetti "contenitori di dati" che hanno la sola funzione di consentire l'accesso ad altri oggetti.</span><span class="sxs-lookup"><span data-stu-id="e2893-310">Similarly, avoid "data holder" objects that only exist to allow access to some other object.</span></span> <span data-ttu-id="e2893-311">È preferibile richiedere l'elemento necessario tramite l'inserimento di dipendenze, se possibile.</span><span class="sxs-lookup"><span data-stu-id="e2893-311">It's better to request the actual item needed via DI, if possible.</span></span>

* <span data-ttu-id="e2893-312">Evitare l'accesso statico ai servizi.</span><span class="sxs-lookup"><span data-stu-id="e2893-312">Avoid static access to services.</span></span>

* <span data-ttu-id="e2893-313">Evitare la posizione del servizio nel codice dell'applicazione.</span><span class="sxs-lookup"><span data-stu-id="e2893-313">Avoid service location in your application code.</span></span>

* <span data-ttu-id="e2893-314">Evitare l'accesso statico a `HttpContext`.</span><span class="sxs-lookup"><span data-stu-id="e2893-314">Avoid static access to `HttpContext`.</span></span>

<span data-ttu-id="e2893-315">È tuttavia possibile che in alcuni casi queste raccomandazioni debbano essere ignorate.</span><span class="sxs-lookup"><span data-stu-id="e2893-315">Like all sets of recommendations, you may encounter situations where ignoring one is required.</span></span> <span data-ttu-id="e2893-316">Le eccezioni sono rare, in genere casi speciali all'interno del framework.</span><span class="sxs-lookup"><span data-stu-id="e2893-316">We have found exceptions to be rare -- mostly very special cases within the framework itself.</span></span>

<span data-ttu-id="e2893-317">L'inserimento di dipendenze è un'*alternativa* ai modelli di accesso agli oggetti statici/globali.</span><span class="sxs-lookup"><span data-stu-id="e2893-317">Dependency injection is an *alternative* to static/global object access patterns.</span></span> <span data-ttu-id="e2893-318">Se l'inserimento di dipendenze viene usato con l'accesso agli oggetti statico i vantaggi non saranno evidenti.</span><span class="sxs-lookup"><span data-stu-id="e2893-318">You may not be able to realize the benefits of DI if you mix it with static object access.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="e2893-319">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="e2893-319">Additional resources</span></span>

* [<span data-ttu-id="e2893-320">Inserimento di dipendenze in visualizzazioni</span><span class="sxs-lookup"><span data-stu-id="e2893-320">Dependency injection into views</span></span>](xref:mvc/views/dependency-injection)
* [<span data-ttu-id="e2893-321">Inserimento di dipendenze in controller</span><span class="sxs-lookup"><span data-stu-id="e2893-321">Dependency injection into controllers</span></span>](xref:mvc/controllers/dependency-injection)
* [<span data-ttu-id="e2893-322">Inserimento di dipendenze nei gestori di requisiti</span><span class="sxs-lookup"><span data-stu-id="e2893-322">Dependency injection in requirement handlers</span></span>](xref:security/authorization/dependencyinjection)
* [<span data-ttu-id="e2893-323">Avvio dell'applicazione</span><span class="sxs-lookup"><span data-stu-id="e2893-323">Application Startup</span></span>](xref:fundamentals/startup)
* [<span data-ttu-id="e2893-324">Test e debug</span><span class="sxs-lookup"><span data-stu-id="e2893-324">Test and debug</span></span>](xref:testing/index)
* [<span data-ttu-id="e2893-325">Attivazione del middleware basata sulla factory</span><span class="sxs-lookup"><span data-stu-id="e2893-325">Factory-based middleware activation</span></span>](xref:fundamentals/middleware/extensibility)
* [<span data-ttu-id="e2893-326">Scrittura di codice pulito in ASP.NET Core con inserimento delle dipendenze (MSDN)</span><span class="sxs-lookup"><span data-stu-id="e2893-326">Writing Clean Code in ASP.NET Core with Dependency Injection (MSDN)</span></span>](https://msdn.microsoft.com/magazine/mt703433.aspx)
* <span data-ttu-id="e2893-327">[Container-Managed Application Design, Prelude: Where does the Container Belong?](https://blogs.msdn.microsoft.com/nblumhardt/2008/12/26/container-managed-application-design-prelude-where-does-the-container-belong/) (Progettazione di applicazioni gestite da contenitori. Prologo: qual è la posizione del contenitore?)</span><span class="sxs-lookup"><span data-stu-id="e2893-327">[Container-Managed Application Design, Prelude: Where does the Container Belong?](https://blogs.msdn.microsoft.com/nblumhardt/2008/12/26/container-managed-application-design-prelude-where-does-the-container-belong/)</span></span>
* <span data-ttu-id="e2893-328">[Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/) (Principio delle dipendenze esplicite)</span><span class="sxs-lookup"><span data-stu-id="e2893-328">[Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/)</span></span>
* <span data-ttu-id="e2893-329">[Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html) (Fowler) (Contenitori di inversione del controllo e modello di inserimento delle dipendenze)</span><span class="sxs-lookup"><span data-stu-id="e2893-329">[Inversion of Control Containers and the Dependency Injection Pattern](https://www.martinfowler.com/articles/injection.html) (Fowler)</span></span>
